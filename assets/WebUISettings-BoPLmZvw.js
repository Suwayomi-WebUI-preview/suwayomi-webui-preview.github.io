import{u as j,r as p,d as V,m as S,h,j as t,w as N,aE as U,ar as I,b as k,f as F,i as A,bq as c,q as P,br as _,bs as w}from"./index-D2_dCMBF.js";import{N as R}from"./NumberSetting-C3zHIwEn.js";import{u as M,g as W}from"./usePersistedValue-CsLYLNRb.js";import{S as E}from"./Switch-DZXnjGvA.js";import{T as y}from"./TextSetting-D6wDPF4R.js";import{S as f}from"./SelectSetting-48LUn2iX.js";import{E as B}from"./EmptyViewAbsoluteCentered-rO8MR0G-.js";import{u as q}from"./useAppTitle-_3PqlVnx.js";import"./TextField-kswmo9A1.js";import"./useFormControl-BBRgs61F.js";import"./formControlState-Dq1zat_P.js";import"./InputAdornment-Dl9od6QX.js";import"./Slider-Ds2-YWnr.js";import"./SwitchBase-C-QbNHM0.js";import"./PasswordTextField-Chpea7dr.js";import"./Select-D8FEiwW7.js";const L=23,D=1,H=23,K=({disabled:e=!1,updateCheckInterval:b})=>{const{t:n}=j(),l=!!b,[m]=p.useUpdateServerSettings(),[r,v]=M("lastUpdateCheckInterval",L,b,W),d=V.useCallback(s=>{v(s===0?r:s),m({variables:{input:{settings:{webUIUpdateCheckInterval:s}}}}).catch(g=>S(n("global.error.label.failed_to_save_changes"),"error",h(g)))},[r]),u=s=>{d(s?r:0)};return t.jsxs(N,{children:[t.jsxs(U,{children:[t.jsx(I,{primary:n("settings.webui.auto_update.label.title")}),t.jsx(E,{disabled:e,edge:"end",checked:l,onChange:s=>u(s.target.checked)})]}),t.jsx(R,{settingTitle:n("settings.webui.auto_update.label.interval"),settingValue:n("library.settings.global_update.auto_update.interval.label.value",{hours:r}),value:r,minValue:D,maxValue:H,defaultValue:L,showSlider:!0,valueUnit:n("global.time.hour_short"),handleUpdate:d,disabled:e||!l})]})},Y=Object.values(c),G={[c.Webui]:{text:"settings.webui.title.webui",description:"settings.webui.flavor.option.webui.label.description",disclaimer:"settings.webui.flavor.label.info"},[c.Vui]:{text:"settings.webui.flavor.option.vui.label.title",description:"settings.webui.flavor.option.vui.label.description",disclaimer:"settings.webui.flavor.label.info"},[c.Custom]:{text:"settings.webui.flavor.option.custom.label.title",description:"settings.webui.flavor.option.custom.label.description"}},Q=Y.map(e=>[e,G[e]]),X=Object.values(w),z={[w.Bundled]:{text:"settings.webui.channel.option.bundled.label.title",description:"settings.webui.channel.option.bundled.label.description",disclaimer:"settings.webui.flavor.label.info"},[w.Stable]:{text:"settings.webui.channel.option.stable.label.title",description:"settings.webui.channel.option.stable.label.description",disclaimer:"settings.webui.flavor.label.info"},[w.Preview]:{text:"settings.webui.channel.option.preview.label.title",description:"settings.webui.channel.option.preview.label.description",disclaimer:"settings.webui.channel.option.preview.label.disclaimer"}},J=X.map(e=>[e,z[e]]),Z=Object.values(_),$={[_.Browser]:{text:"settings.webui.interface.option.label.browser",description:"settings.webui.interface.label.description"},[_.Electron]:{text:"settings.webui.interface.option.label.electron",description:"settings.webui.interface.label.description"}},ee=Z.map(e=>[e,$[e]]),te=e=>({webUIFlavor:e.webUIFlavor,initialOpenInBrowserEnabled:e.initialOpenInBrowserEnabled,webUIInterface:e.webUIInterface,electronPath:e.electronPath,webUIChannel:e.webUIChannel,webUIUpdateCheckInterval:e.webUIUpdateCheckInterval}),fe=()=>{const{t:e}=j();q(e("settings.webui.title.webui"));const{settings:{webUIInformAvailableUpdate:b},loading:n,request:{error:l,refetch:m}}=k(),r=P(a=>S(e("global.error.label.failed_to_save_changes"),"error",h(a))),{data:v,loading:d,error:u,refetch:s}=p.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[g]=p.useUpdateServerSettings(),o=(a,T)=>{a==="webUIChannel"&&p.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),g({variables:{input:{settings:{[a]:T}}}}).catch(O=>S(e("global.error.label.failed_to_save_changes"),"error",h(O)))};if(n||d)return t.jsx(F,{});const x=l!=null?l:u;if(x)return t.jsx(B,{message:e("global.error.label.failed_to_load_data"),messageExtra:h(x),retry:()=>{l&&m().catch(A()),u&&s().catch(A())}});const i=te(v.settings),C=i.webUIFlavor===c.Custom;return t.jsxs(N,{sx:{pt:0},children:[t.jsx(f,{settingName:e("settings.webui.flavor.label.title"),value:i.webUIFlavor,values:Q,handleChange:a=>o("webUIFlavor",a)}),t.jsxs(U,{children:[t.jsx(I,{primary:e("settings.webui.label.initial_open_browser")}),t.jsx(E,{edge:"end",checked:i.initialOpenInBrowserEnabled,onChange:a=>o("initialOpenInBrowserEnabled",a.target.checked)})]}),t.jsx(f,{settingName:e("settings.webui.interface.label.title"),value:i.webUIInterface,values:ee,handleChange:a=>o("webUIInterface",a)}),t.jsx(y,{settingName:e("settings.webui.electron_path.label.title"),dialogDescription:e("settings.webui.electron_path.label.description"),value:i.electronPath,settingDescription:i.electronPath.length?i.electronPath:e("global.label.default"),handleChange:a=>o("electronPath",a)}),t.jsx(f,{settingName:e("settings.webui.channel.label.title"),value:i.webUIChannel,values:J,handleChange:a=>o("webUIChannel",a),disabled:C}),t.jsx(K,{disabled:C,updateCheckInterval:i.webUIUpdateCheckInterval}),!i.webUIUpdateCheckInterval&&t.jsxs(U,{children:[t.jsx(I,{primary:e("global.update.settings.inform.label.title"),secondary:e("global.update.settings.inform.label.description")}),t.jsx(E,{edge:"end",checked:b,onChange:a=>r("webUIInformAvailableUpdate",a.target.checked)})]})]})};export{fe as WebUISettings};
