var fr=Object.defineProperty;var _r=(e,t,r)=>t in e?fr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var He=(e,t,r)=>_r(e,typeof t!="symbol"?t+"":t,r);import{r as K,b as _,R as at,dF as A,Q as mr,dG as xe,dH as pr,dz as xr,dI as Bt,dJ as br,dK as Sr,bJ as vr,j as o,z as Q,at as x,d3 as be,dr as $,dl as Te,dn as H,am as ot,cS as W,dL as N,d5 as j,av as fe,d6 as Er,aX as ge,O as Ne,ds as De,d4 as te,bW as ie,d2 as Ft,dM as Rr,dN as ct,dO as Ar,a as Tr,dP as dt,dQ as Pr,dR as ut,cd as yr,m as gt,g as ht,as as ft,dS as B,bd as Or,d as Ir,A as jr,dT as Se,f as Cr,u as m,S as p,T as R,B as re,C as ke,df as Gt,dg as Ht,dU as Dr,dV as wr,cZ as oe,dd as Lr,de as Mr,dc as Nr,c as de,I as zt,dW as ze,aN as kr,dh as $t,cT as ve,dk as je,dX as Ur,dY as _e,dZ as L,d_ as Vr,d$ as Br,e0 as Fr,c$ as me,e1 as $e,a1 as Gr,e2 as Hr,i as zr,k as $r,n as Wr,q as Yr,a3 as Zr,a4 as Kr,dt as D,e3 as Xr,e4 as _t,cR as he}from"./index-TsR_l2G6.js";import{T as Qr}from"./TabsMenu-BgdCUN-s.js";import{C as F}from"./Chapters-BumiL_h7.js";import{a as qr,F as mt}from"./Mangas-BUrrPiNN.js";import{S as Jr}from"./SpinnerImage-Cfl4QtPD.js";import{r as en}from"./Strings-CAV0u705.js";import{T as tn,a as ae}from"./Tabs-CMi24aH2.js";import{T as Wt}from"./Trans-MK4vteSp.js";import{S as rn}from"./Slider-7jcvvXwW.js";import{C as y}from"./CheckboxInput-CYjYUrTi.js";import{L as nn}from"./ListSubheader-CNiwOZ-l.js";import{A as sn}from"./Add-BGjPJ8WP.js";const Yt=(e,t,r)=>{var l;const n=Sr(),s=n===vr,a=Object.keys((l=r.meta)!=null?l:{}).filter(c=>{var u;return s?((u=c.match(/_/g))==null?void 0:u.length)===1:c.startsWith("".concat(br,"_").concat(n,"_"))}).map(c=>Bt(c));return Object.fromEntries(Object.entries(t).map(([c,u])=>{if(xe.includes(c))return[c,u];const d=e==="manga"&&!a.includes(c);return[c,{value:u,isDefault:d}]}))},Ke=e=>({...e,tapZoneInvertMode:JSON.stringify(e.tapZoneInvertMode),customFilter:JSON.stringify(e.customFilter),readerWidth:JSON.stringify(e.readerWidth),hotkeys:JSON.stringify(e.hotkeys),autoScroll:JSON.stringify(e.autoScroll)}),pt=Yt("global",A,{meta:Ke(A)}),Zt=(e,t,r=A,n,s)=>mr(e,t,r,s!==void 0?[s.toString()]:void 0,n);function Kt(e,t,r=A,n,s){const a=Zt(e,t,r,n,s);return Yt(e,a,t)}const an=(e,t,r,n)=>Kt("manga",{...e,meta:at(e.meta,s=>!xe.includes(Bt(s)))},t,r,n),Ba=(e,t)=>an(e,t),Fa=e=>{const t=K.useGetGlobalMeta({notifyOnNetworkStatusChange:!0}),{data:r,loading:n}=t,s=_.useMemo(()=>at(r==null?void 0:r.metas.nodes),[r==null?void 0:r.metas.nodes]),a=_.useMemo(()=>({meta:s}),[s]),i=Zt("global",a,void 0,_.useEffect,e),l=_.useMemo(()=>i,[a,e]);return _.useMemo(()=>({metadata:s,settings:l,loading:n,request:t}),[s,l,n,t])},on=e=>{const t=K.useGetGlobalMeta({notifyOnNetworkStatusChange:!0}),{data:r,loading:n}=t,s=_.useMemo(()=>at(r==null?void 0:r.metas.nodes),[r==null?void 0:r.metas.nodes]),a=_.useMemo(()=>({meta:s}),[s]),i=Kt("global",a,void 0,_.useEffect,e),l=_.useMemo(()=>i,[a,e]);return _.useMemo(()=>({metadata:s,settings:l,loading:n,request:t}),[s,l,n,t])},ln=async(e,t,r,n=!1,s)=>n||xe.includes(t)?pr([[t,Ke({[t]:r})[t]]],s!==void 0?[s==null?void 0:s.toString()]:void 0):xr(e,[[t,Ke({[t]:r})[t]]],s!==void 0?[s==null?void 0:s.toString()]:void 0),xt=e=>e===$.END?Number.MAX_SAFE_INTEGER:-1,cn=_.forwardRef(({currentPageIndex:e,pages:t,transitionPageMode:r,imageRefs:n,createPage:s,slots:a,readingMode:i,imagePreLoadAmount:l,isCurrentChapter:c,isPreviousChapter:u,isNextChapter:g,customFilter:d,pageScaleMode:f,shouldStretchPage:h,readerWidth:b,readerNavBarWidth:S,resumeMode:v,handleAsInitialRender:E},O)=>{var I,w,M,Y;const T=_.useRef(xt(v));E&&(T.current=xt(v));const P=_.useMemo(()=>ds(e,t,T.current,l,i,c,u,g),[e,t,l,i,c,u,g]);_.useEffect(()=>{c&&(T.current=e)},[P,c]);const C=_.useCallback((ue,ye)=>{n.current[ue]=ye},[n]);return o.jsx(Q,{ref:O,...a==null?void 0:a.boxProps,sx:[{width:"fit-content",height:"fit-content"},...Array.isArray((I=a==null?void 0:a.boxProps)==null?void 0:I.sx)?(M=(w=a==null?void 0:a.boxProps)==null?void 0:w.sx)!=null?M:[]:[(Y=a==null?void 0:a.boxProps)==null?void 0:Y.sx],x(!q(i)&&us(r,i),{visibility:"hidden",width:0,height:0,m:0,p:0})],children:t.map((ue,ye)=>s(ue,ye,P.includes(ye),[be.NONE,be.BOTH].includes(r),C,i,d,f,h,b,S))})}),Ue=_.memo(cn),dn=_.forwardRef(({onLoad:e,onError:t,pageLoadStates:r,retryFailedPagesKeyPrefix:n,isPreloadMode:s,...a},i)=>{const{currentPageIndex:l,totalPages:c}=a;return o.jsx(Ue,{ref:i,...a,createPage:(u,g,d,f,h,...b)=>Ae(u,g,!0,r[u.primary.index].loaded,s,e,t,d,f&&d&&l===u.primary.index,l,c,...b,r[u.primary.index].error?n:void 0),slots:{boxProps:{sx:{margin:"auto"}}}})}),un=_.memo(dn),Xt=(e,t)=>{const r=t.findIndex(({primary:s,secondary:a})=>[s.index,a==null?void 0:a.index].includes(e));return{...t[Te(r,0,t.length-1)],pagesIndex:r}},Xe=e=>{var t,r;return(r=(t=e.secondary)==null?void 0:t.index)!=null?r:e.primary.index},Ga=(e,t,r)=>{switch(e){case"previous":return Xe(r[Math.max(0,t-1)]);case"next":return Xe(r[Math.min(r.length-1,t+1)]);default:throw new Error('Unexpected offset "'.concat(e,'"'))}},Ha=(e,t,r,n,s,a)=>{const i=n?e.clientX:e.clientY,{paddingTop:l,paddingBottom:c,paddingLeft:u,paddingRight:g}=getComputedStyle(t),d=t.getBoundingClientRect(),f=n?parseFloat(u)+parseFloat(g):parseFloat(l)+parseFloat(c),h=n?d.left:d.top,S=(n?d.width:d.height)-f,v=i-h-f/2,E=r.length-+!s,O=S/E,T=Math.floor(v/O),P=(T+(s?1:.5))*O,C=v<=P?T:T+1,I=Math.max(0,C),w=Math.min(I,r.length-1),M=a(w,r.length-1-w);return r[M]},za=e=>{const t=e===H.BOTTOM,r=e===H.LEFT,n=e===H.RIGHT;return{isBottom:t,isLeft:r,isRight:n,isHorizontal:t,isVertical:r||n}},bt=(e,t,r)=>{const n=r===W.LTR;return e==="first"?t==="ltr"?n?"right":"left":n?"left":"right":t==="ltr"?n?"left":"right":n?"right":"left"},gn=_.forwardRef(({onLoad:e,onError:t,pageLoadStates:r,retryFailedPagesKeyPrefix:n,isPreloadMode:s,...a},i)=>{const{currentPageIndex:l,pages:c,totalPages:u,readingDirection:g,pageScaleMode:d}=a,{direction:f}=ot(),h=_.useMemo(()=>Xt(l,c),[l,c]),b=g===W.LTR;return o.jsx(Ue,{ref:i,...a,createPage:(S,v,E,O,T,...P)=>{const{primary:C,secondary:I}=S,w=Xe(h),M=!!I,Y=h.primary.index===C.index,ue=!!I&&w===I.index;return o.jsxs(_.Fragment,{children:[Ae(S,v,!0,r[C.index].loaded,s,e,t,E,O&&Y&&E,h.primary.index,u,...P,r[C.index].error?n:void 0,M?bt("first",f,g):void 0,M),M&&Ae({...S,primary:{...S.secondary}},v,!1,r[I.index].loaded,s,e,t,E,O&&ue&&E,w,u,...P,r[I.index].error?n:void 0,bt("second",f,g),!0)]},"".concat(C.url,"_").concat(I==null?void 0:I.url))},slots:{boxProps:{sx:{...x(d===N.ORIGINAL,{margin:"auto"}),width:"100%",minWidth:"fit-content",height:"100%",minHeight:"fit-content",display:"flex",flexDirection:"row",flexWrap:"nowrap",...x(f==="ltr",{flexDirection:b?"row":"row-reverse"}),...x(f==="rtl",{flexDirection:b?"row-reverse":"row"})}}}})}),hn=_.memo(gn),fn=_.forwardRef(({onLoad:e,onError:t,pageLoadStates:r,retryFailedPagesKeyPrefix:n,isPreloadMode:s,...a},i)=>{const{currentPageIndex:l,totalPages:c,readingMode:u,pageGap:g}=a,f=u===j.WEBTOON?0:g;return o.jsx(Ue,{ref:i,...a,createPage:(h,b,S,v,E,...O)=>Ae(h,b,!0,r[h.primary.index].loaded,s,e,t,S,!s,l,c,...O,r[h.primary.index].error?n:void 0,void 0,void 0,h.primary.index!==0?f:0,E),slots:{boxProps:{sx:{margin:"auto"}}}})}),_n=_.memo(fn),mn=_.forwardRef(({onLoad:e,onError:t,pageLoadStates:r,retryFailedPagesKeyPrefix:n,isPreloadMode:s,...a},i)=>{const{currentPageIndex:l,totalPages:c,pageGap:u,readingDirection:g}=a,{direction:d}=ot(),f=g===W.LTR;return o.jsx(Ue,{ref:i,...a,createPage:(h,b,S,v,E,...O)=>Ae(h,b,!0,r[h.primary.index].loaded,s,e,t,S,!s,l,c,...O,r[h.primary.index].error?n:void 0,void 0,void 0,void 0,E),slots:{boxProps:{sx:{my:"auto",display:"flex",flexWrap:"nowrap",alignItems:"center",gap:"".concat(u,"px"),...x(d==="ltr",{flexDirection:f?"row":"row-reverse",justifyContent:f?"flex-start":"flex-end"}),...x(d==="rtl",{flexDirection:f?"row-reverse":"row",justifyContent:f?"flex-end":"flex-start"})}}}})}),pn=_.memo(mn),xn=e=>e===j.DOUBLE_PAGE,Qt=e=>[N.WIDTH,N.SCREEN].includes(e),$a=e=>[N.HEIGHT,N.SCREEN].includes(e),qt=(e,t)=>!!(e!=null&&e.enabled)&&Qt(t),bn=(e,t)=>{if(qt(e,t))return e==null?void 0:e.value},q=e=>[j.CONTINUOUS_VERTICAL,j.CONTINUOUS_HORIZONTAL,j.WEBTOON].includes(e),Ce=e=>[j.CONTINUOUS_VERTICAL,j.WEBTOON].includes(e),Wa=(e,t,r)=>t&&r.isDefault&&qr.isLongStripType(e),Ya=e=>{switch(e){case j.SINGLE_PAGE:return un;case j.DOUBLE_PAGE:return hn;case j.CONTINUOUS_VERTICAL:case j.WEBTOON:return _n;case j.CONTINUOUS_HORIZONTAL:return pn;default:throw new Error('Unexpected "ReadingMode" ('.concat(e,")"))}},Za=(e,t,r=0,n=0)=>e!==H.AUTO?e:window.innerHeight-r>window.innerWidth-n?t:H.BOTTOM,St=e=>{let t;const r=new Set,n=(u,g)=>{const d=typeof u=="function"?u(t):u;if(!Object.is(d,t)){const f=t;t=(g!=null?g:typeof d!="object"||d===null)?d:Object.assign({},t,d),r.forEach(h=>h(t,f))}},s=()=>t,l={setState:n,getState:s,getInitialState:()=>c,subscribe:u=>(r.add(u),()=>r.delete(u))},c=t=e(n,s,l);return l},Sn=e=>e?St(e):St,vn=e=>e;function En(e,t=vn){const r=fe.useSyncExternalStore(e.subscribe,fe.useCallback(()=>t(e.getState()),[e,t]),fe.useCallback(()=>t(e.getInitialState()),[e,t]));return fe.useDebugValue(r),r}const vt=e=>{const t=Sn(e),r=n=>En(t,n);return Object.assign(r,t),r},Rn=e=>e?vt(e):vt;var Jt=Symbol.for("immer-nothing"),Et=Symbol.for("immer-draftable"),k=Symbol.for("immer-state");function G(e,...t){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var le=Object.getPrototypeOf;function ce(e){return!!e&&!!e[k]}function ne(e){var t;return e?er(e)||Array.isArray(e)||!!e[Et]||!!((t=e.constructor)!=null&&t[Et])||Be(e)||Fe(e):!1}var An=Object.prototype.constructor.toString();function er(e){if(!e||typeof e!="object")return!1;const t=le(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===An}function we(e,t){Ve(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Ve(e){const t=e[k];return t?t.type_:Array.isArray(e)?1:Be(e)?2:Fe(e)?3:0}function Qe(e,t){return Ve(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function tr(e,t,r){const n=Ve(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Tn(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Be(e){return e instanceof Map}function Fe(e){return e instanceof Set}function ee(e){return e.copy_||e.base_}function qe(e,t){if(Be(e))return new Map(e);if(Fe(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=er(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[k];let s=Reflect.ownKeys(n);for(let a=0;a<s.length;a++){const i=s[a],l=n[i];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[i]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[i]})}return Object.create(le(e),n)}else{const n=le(e);if(n!==null&&r)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function it(e,t=!1){return Ge(e)||ce(e)||!ne(e)||(Ve(e)>1&&(e.set=e.add=e.clear=e.delete=Pn),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>it(n,!0))),e}function Pn(){G(2)}function Ge(e){return Object.isFrozen(e)}var yn={};function se(e){const t=yn[e];return t||G(0,e),t}var Ee;function rr(){return Ee}function On(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Rt(e,t){t&&(se("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Je(e){et(e),e.drafts_.forEach(In),e.drafts_=null}function et(e){e===Ee&&(Ee=e.parent_)}function At(e){return Ee=On(Ee,e)}function In(e){const t=e[k];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Tt(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[k].modified_&&(Je(t),G(4)),ne(e)&&(e=Le(t,e),t.parent_||Me(t,e)),t.patches_&&se("Patches").generateReplacementPatches_(r[k].base_,e,t.patches_,t.inversePatches_)):e=Le(t,r,[]),Je(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Jt?e:void 0}function Le(e,t,r){if(Ge(t))return t;const n=t[k];if(!n)return we(t,(s,a)=>Pt(e,n,t,s,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Me(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let a=s,i=!1;n.type_===3&&(a=new Set(s),s.clear(),i=!0),we(a,(l,c)=>Pt(e,n,s,l,c,r,i)),Me(e,s,!1),r&&e.patches_&&se("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Pt(e,t,r,n,s,a,i){if(ce(s)){const l=a&&t&&t.type_!==3&&!Qe(t.assigned_,n)?a.concat(n):void 0,c=Le(e,s,l);if(tr(r,n,c),ce(c))e.canAutoFreeze_=!1;else return}else i&&r.add(s);if(ne(s)&&!Ge(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Le(e,s),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Me(e,s)}}function Me(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&it(t,r)}function jn(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:rr(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,a=lt;r&&(s=[n],a=Re);const{revoke:i,proxy:l}=Proxy.revocable(s,a);return n.draft_=l,n.revoke_=i,l}var lt={get(e,t){if(t===k)return e;const r=ee(e);if(!Qe(r,t))return Cn(e,r,t);const n=r[t];return e.finalized_||!ne(n)?n:n===We(e.base_,t)?(Ye(e),e.copy_[t]=rt(n,e)):n},has(e,t){return t in ee(e)},ownKeys(e){return Reflect.ownKeys(ee(e))},set(e,t,r){const n=nr(ee(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const s=We(ee(e),t),a=s==null?void 0:s[k];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Tn(r,s)&&(r!==void 0||Qe(e.base_,t)))return!0;Ye(e),tt(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return We(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Ye(e),tt(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=ee(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){G(11)},getPrototypeOf(e){return le(e.base_)},setPrototypeOf(){G(12)}},Re={};we(lt,(e,t)=>{Re[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Re.deleteProperty=function(e,t){return Re.set.call(this,e,t,void 0)};Re.set=function(e,t,r){return lt.set.call(this,e[0],t,r,e[0])};function We(e,t){const r=e[k];return(r?ee(r):e)[t]}function Cn(e,t,r){var s;const n=nr(t,r);return n?"value"in n?n.value:(s=n.get)==null?void 0:s.call(e.draft_):void 0}function nr(e,t){if(!(t in e))return;let r=le(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=le(r)}}function tt(e){e.modified_||(e.modified_=!0,e.parent_&&tt(e.parent_))}function Ye(e){e.copy_||(e.copy_=qe(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Dn=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const i=this;return function(c=a,...u){return i.produce(c,g=>r.call(this,g,...u))}}typeof r!="function"&&G(6),n!==void 0&&typeof n!="function"&&G(7);let s;if(ne(t)){const a=At(this),i=rt(t,void 0);let l=!0;try{s=r(i),l=!1}finally{l?Je(a):et(a)}return Rt(a,n),Tt(s,a)}else if(!t||typeof t!="object"){if(s=r(t),s===void 0&&(s=t),s===Jt&&(s=void 0),this.autoFreeze_&&it(s,!0),n){const a=[],i=[];se("Patches").generateReplacementPatches_(t,s,a,i),n(a,i)}return s}else G(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...l)=>this.produceWithPatches(i,c=>t(c,...l));let n,s;return[this.produce(t,r,(i,l)=>{n=i,s=l}),n,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ne(e)||G(8),ce(e)&&(e=wn(e));const t=At(this),r=rt(e,void 0);return r[k].isManual_=!0,et(t),r}finishDraft(e,t){const r=e&&e[k];(!r||!r.isManual_)&&G(9);const{scope_:n}=r;return Rt(n,t),Tt(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}r>-1&&(t=t.slice(r+1));const n=se("Patches").applyPatches_;return ce(e)?n(e,t):this.produce(e,s=>n(s,t))}};function rt(e,t){const r=Be(e)?se("MapSet").proxyMap_(e,t):Fe(e)?se("MapSet").proxySet_(e,t):jn(e,t);return(t?t.scope_:rr()).drafts_.push(r),r}function wn(e){return ce(e)||G(10,e),sr(e)}function sr(e){if(!ne(e)||Ge(e))return e;const t=e[k];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=qe(e,t.scope_.immer_.useStrictShallowCopy_)}else r=qe(e,!0);return we(r,(n,s)=>{tr(r,n,sr(s))}),t&&(t.finalized_=!1),r}var U=new Dn,Ln=U.produce;U.produceWithPatches.bind(U);U.setAutoFreeze.bind(U);U.setUseStrictShallowCopy.bind(U);U.applyPatches.bind(U);U.createDraft.bind(U);U.finishDraft.bind(U);const Mn=e=>(t,r,n)=>(n.setState=(s,a,...i)=>{const l=typeof s=="function"?Ln(s):s;return t(l,a,...i)},e(n.setState,r,n)),Nn=Mn,yt=e=>Symbol.iterator in e,Ot=e=>"entries"in e,It=(e,t)=>{const r=e instanceof Map?e:new Map(e.entries()),n=t instanceof Map?t:new Map(t.entries());if(r.size!==n.size)return!1;for(const[s,a]of r)if(!n.has(s)||!Object.is(a,n.get(s)))return!1;return!0},kn=(e,t)=>{const r=e[Symbol.iterator](),n=t[Symbol.iterator]();let s=r.next(),a=n.next();for(;!s.done&&!a.done;){if(!Object.is(s.value,a.value))return!1;s=r.next(),a=n.next()}return!!s.done&&!!a.done};function Un(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null||Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?!1:yt(e)&&yt(t)?Ot(e)&&Ot(t)?It(e,t):kn(e,t):It({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)})}function Vn(e){const t=fe.useRef(void 0);return r=>{const n=e(r);return Un(t.current,n)?t.current:t.current=n}}const jt={isVisible:!1},Bn=(...[e,t])=>({overlay:{isVisible:jt.isVisible,setIsVisible:r=>e(n=>{n.overlay.isVisible=r}),reset:()=>e(()=>({overlay:{...t().overlay,...jt}}))}}),Ct={isActive:!1,isPaused:!1,start:ge,cancel:ge,toggleActive:ge,pause:ge,resume:ge,invert:!1,direction:Er.FORWARD,scrollRef:void 0},Fn=(...[e,t])=>({autoScroll:{...Ct,reset:()=>e(r=>{r.autoScroll={...t().autoScroll,...Ct}}),setIsActive:r=>e(n=>{n.autoScroll.isActive=r}),setIsPaused:r=>e(n=>{n.autoScroll.isPaused=r}),setStart:r=>e(n=>{n.autoScroll.start=r}),setCancel:r=>e(n=>{n.autoScroll.cancel=r}),setToggleActive:r=>e(n=>{n.autoScroll.toggleActive=r}),setPause:r=>e(n=>{n.autoScroll.pause=r}),setResume:r=>e(n=>{n.autoScroll.resume=r}),setInvert:r=>e(n=>{n.autoScroll.invert=r}),setDirection:r=>e(n=>{n.autoScroll.direction=r}),setScrollRef:r=>e(n=>{if(!r){n.autoScroll.scrollRef=void 0;return}const s=_.createRef();s.current=r,n.autoScroll.scrollRef=s})}}),Dt={isMaximized:!1,isDragging:!1},Gn=(...[e,t])=>({progressBar:{...Dt,setIsMaximized:r=>e(n=>{n.progressBar.isMaximized=r}),setIsDragging:r=>e(n=>{n.progressBar.isDragging=r}),reset:()=>e(()=>({progressBar:{...t().progressBar,...Dt}}))}}),wt={showPreview:!1},Hn=(...[e,t])=>({tapZone:{...wt,setShowPreview:r=>e(n=>{n.tapZone.showPreview=r}),reset:()=>e(()=>({tapZone:{...t().tapZone,...wt}}))}}),Lt={totalPages:0,currentPageIndex:0,pageToScrollToIndex:null,pageUrls:[],pageLoadStates:[{url:"",loaded:!1}],pages:[{name:"1",primary:{index:0,alt:"Page #1",url:"".concat(K.getBaseUrl())}}],transitionPageMode:be.NONE,retryFailedPagesKeyPrefix:""},zn=(...[e,t])=>({pages:{...Lt,reset:()=>e(()=>({pages:{...t().pages,...Lt}})),setCurrentPageIndex:r=>e(n=>{n.pages.currentPageIndex=r}),setPageToScrollToIndex:r=>e(n=>{n.pages.pageToScrollToIndex=r}),setTotalPages:r=>e(n=>{n.pages.totalPages=r}),setPageUrls:r=>e(n=>{n.pages.pageUrls=r}),setPageLoadStates:r=>e(n=>{if(typeof r=="function"){n.pages.pageLoadStates=r(t().pages.pageLoadStates);return}n.pages.pageLoadStates=r}),setPages:r=>e(n=>{n.pages.pages=r}),setTransitionPageMode:r=>e(n=>{n.pages.transitionPageMode=r}),setRetryFailedPagesKeyPrefix:r=>e(n=>{n.pages.retryFailedPagesKeyPrefix=r})}}),Mt={chapters:{chapters:[],isCurrentChapterReady:!1,visibleChapters:{leading:0,trailing:0,lastLeadingChapterSourceOrder:99999,lastTrailingChapterSourceOrder:-1,isLeadingChapterPreloadMode:!0,isTrailingChapterPreloadMode:!0,scrollIntoView:!1,resumeMode:void 0}}},$n=(...[e,t])=>({chapters:{...Mt.chapters,reset:()=>e(()=>({chapters:{...t().chapters,...Mt.chapters}})),setReaderStateChapters:r=>e(n=>{if(typeof r=="function"){n.chapters={...t().chapters,...r(t().chapters)};return}n.chapters={...t().chapters,...r}})}}),Oe={manga:void 0,scrollbar:{xSize:0,ySize:0}},X=Rn()(Nn((e,t,r)=>({...Oe,reset:()=>e(n=>{n.manga=Oe.manga,n.scrollbar={...t().scrollbar,...Oe.scrollbar},t().overlay.reset(),t().autoScroll.reset(),t().pages.reset(),t().chapters.reset(),n.settings={...t().settings,...pt},t().progressBar.reset(),t().tapZone.reset()}),setManga:n=>e(s=>{s.manga=n}),scrollbar:{...Oe.scrollbar,setXSize:n=>e(s=>{s.scrollbar.xSize=n}),setYSize:n=>e(s=>{s.scrollbar.ySize=n})},settings:{...pt,setSettings:n=>e(s=>{s.settings={...t().settings,...n}})},...Bn(e,t,r),...Fn(e,t,r),...zn(e,t,r),...$n(e,t,r),...Gn(e,t,r),...Hn(e,t,r)}))),J=e=>X(Vn(e)),Ie=()=>X.getState(),Wn=J,Ka=()=>X.getState().scrollbar,Ze=J,Yn=()=>X.getState().settings,Xa=J,Qa=()=>X.getState().overlay,qa=J,Ja=()=>X.getState().autoScroll,eo=J,to=()=>X.getState().pages,ro=J,Zn=()=>X.getState().chapters,no=J,Kn=J,so=()=>X.getState().tapZone,Xn=e=>Object.keys(e).map(t=>{const r=t,n=e[r];switch(r){case"brightness":case"contrast":case"saturate":return n.enabled?"".concat(r,"(").concat(n.value/100,")"):"";case"hue":return n.enabled?"hue-rotate(".concat(n.value,"deg)"):"";case"rgba":return"";case"sepia":case"grayscale":case"invert":return n?"".concat(r,"(").concat(Number(n),")"):"";default:throw new Error('Unexpected "CustomFilter" ('.concat(r,")"))}}).join(" "),Qn=({pageIndex:e,pagesIndex:t,isPrimaryPage:r,display:n,doublePage:s=!1,position:a,marginTop:i,shouldLoad:l,readingMode:c,customFilter:u,pageScaleMode:g,shouldStretchPage:d,readerWidth:f,onLoad:h,onError:b,setRef:S,readerNavBarWidth:v,isLoaded:E,...O})=>{const{src:T}=O,P=Ne.useIsTabletWidth(),C=Wn(Y=>Y.scrollbar),I=_.useCallback(()=>h==null?void 0:h(t,T,r),[h,t,T,r]),w=_.useCallback(()=>b==null?void 0:b(e,T),[b,e,T]),M=_.useCallback(Y=>S==null?void 0:S(t,Y),[t,S]);return!n&&!l?null:o.jsx(Jr,{...O,onLoad:I,onError:w,shouldLoad:l,shouldDecode:!0,ref:M,spinnerStyle:{backgroundColor:"background.paper",...es(c,d,g,f,v+C.ySize,C.xSize,s,P),...x(!n,{display:"none"}),...Nt(s,a)},imgStyle:{...rs(c,d,g,s,f,v+C.ySize,C.xSize),filter:Xn(u),objectFit:"contain",objectPosition:a,userSelect:"none",...Nt(s,a),...x(i!==void 0,{mt:"".concat(i,"px")}),display:"block",...x(!n,{display:"none"}),...x(!E,{margin:"unset"})},hideImgStyle:{visibility:"hidden",minWidth:0,minHeight:0,width:0,height:0}})},qn=_.memo(Qn),Jn=(e,t,r,n)=>{if(qt(r,e)){const s=r.value;return t?s/100/2:s/100}return t?.5:1},es=(e,t,r,n,s,a,i,l)=>{const u=T=>"calc(".concat(T," - ").concat(s,"px)"),g=(T,P)=>u("".concat(Te(P!=null?P:T,Math.min(T,P!=null?P:9e3),T),"vw")),d=bn(n,r),f=u("".concat(Math.min(100,d!=null?d:9e3),"vw")),h="calc(100vh - ".concat(a,"px)"),b=l?f:g(40,d),S=l?h:"85vh",E={...{[j.SINGLE_PAGE]:{minWidth:b,minHeight:S},[j.DOUBLE_PAGE]:{minWidth:l?"50vw":g(35,d?d/2:void 0),minHeight:S},[j.CONTINUOUS_VERTICAL]:{minWidth:b,minHeight:"100vh"},[j.CONTINUOUS_HORIZONTAL]:{minWidth:b,minHeight:S},[j.WEBTOON]:{minWidth:b,minHeight:"100vh"}}[e],height:"unset"},O=i?"calc(".concat(u("".concat(d!=null?d:100,"vw"))," / 2)"):f;switch(r){case N.WIDTH:return{...E,...x(t,{minWidth:O})};case N.HEIGHT:return{...E,...x(t,{minHeight:h,...x(Ce(e),{minHeight:"100vh"})})};case N.SCREEN:return{...E,...x(t,{minWidth:O,minHeight:h,...x(Ce(e),{minHeight:"100vh"})})};case N.ORIGINAL:return{...E,...x(Ce(e),{height:void 0})};default:throw new Error('Unexpected "PageScaleMode" ('.concat(r,")"))}},ts=(e,t,r,n,s,a)=>{const i="calc((100vw - ".concat(s,"px) * ").concat(e,")"),l="calc(100vh - ".concat(a,"px)");switch(n){case N.WIDTH:return{minWidth:0,...x(q(t),{minWidth:"unset"}),...x(r,{minWidth:i}),maxWidth:i};case N.HEIGHT:return{minHeight:0,...x(q(t),{minHeight:"unset"}),...x(r,{minHeight:l}),maxHeight:l};case N.SCREEN:return{minWidth:0,minHeight:0,...x(q(t),{minWidth:"unset",minHeight:"unset"}),...x(r,{minWidth:i,minHeight:l,...x(t===j.CONTINUOUS_HORIZONTAL,{minWidth:"unset",minHeight:l}),...x(Ce(t),{minWidth:i,minHeight:"unset"})}),maxWidth:i,maxHeight:l};case N.ORIGINAL:return{};default:throw new Error('Unexpected "PageScaleMode" ('.concat(n,")"))}},rs=(e,t,r,n,s,a,i)=>{const l=Jn(r,n,s);return ts(l,e,t,r,a,i)},Nt=(e,t)=>({m:"auto",...x(e,{...x(t==="right",{mr:"unset "}),...x(t==="left",{ml:"unset "})})}),nt=(e,t)=>({index:t,alt:"Page #".concat(t+1),url:"".concat(K.getBaseUrl()).concat(e)}),ns=(e,t)=>({name:"".concat(t+1),primary:nt(e,t)}),ao=e=>e.map(ns),ss=(e,t,r,n,s)=>{if(!n||s)return Number.MAX_SAFE_INTEGER;const a=Math.abs(t-e),i=r-a;return t<e?i-1:i},Ae=({primary:{index:e,alt:t,url:r}},n,s,a,i,l,c,u,g,d,f,h,b,S,v,E,O,T,P,C,I,w)=>o.jsx(qn,{setRef:w,pageIndex:e,pagesIndex:n,isPrimaryPage:s,src:r,alt:t,display:g,priority:ss(d,e,f,u,i),position:P,onLoad:l,onError:c,doublePage:C,shouldLoad:u,retryKeyPrefix:T,marginTop:I,isLoaded:a,readingMode:h,customFilter:b,pageScaleMode:S,shouldStretchPage:v,readerWidth:E,readerNavBarWidth:O},r),ar=(e,t)=>{const{top:r,bottom:n,left:s,right:a}=e.getBoundingClientRect(),i={top:0,bottom:0,left:0,right:0,...t},l=s>=i.left&&s<=window.innerWidth,c=a>=i.right&&a<=window.innerWidth,u=s<=0&&a>=window.innerWidth,g=r>=i.top&&r<=window.innerHeight,d=n>=i.bottom&&n<=window.innerHeight,f=r<=0&&n>=window.innerHeight;return{isLeftInViewport:l,isRightInViewport:c,isFillingWidthViewportCompletely:u,isTopInViewport:g,isBottomInViewport:d,isFillingHeightViewportCompletely:f}},oo=(e,t,r)=>{const{isLeftInViewport:n,isRightInViewport:s,isFillingWidthViewportCompletely:a,isTopInViewport:i,isBottomInViewport:l,isFillingHeightViewportCompletely:c}=ar(e,r),u=n||s||a,g=i||l||c;switch(t){case De.X:return u;case De.Y:return g;default:throw new Error('unexpected "type" ('.concat(t,")"))}},io=(e,t,r)=>{const{isLeftInViewport:n,isRightInViewport:s,isBottomInViewport:a}=ar(e);switch(t){case De.X:return r===W.LTR?s:n;case De.Y:return a;default:throw new Error('unexpected "type" ('.concat(t,")"))}},lo=(e,t,r,n)=>{const s=[],a=t.map((i,l)=>l+t.slice(0,l).filter(({isSpread:c})=>c).length);return e.forEach((i,l)=>{var w;const u=!(a[l]%2),g=(u?1:-1)*(r?-1:1),d=l+g,f=l<d,h=l===0,b=l===e.length-1,S=f&&!b,v=t[l].isSpread,E=!!((w=t[d])!=null&&w.isSpread),P=!(v||E)&&!(h&&r);if(!f&&P){const M=s[s.length-1];s[s.length-1]={...M,secondary:nt(i,l)};return}const C="-",I="".concat(l+1).concat(S&&P?"".concat(C).concat(d+1):"");s.push({name:n===W.LTR?I:en(I,C),primary:nt(i,l)})}),s},as=e=>e.height/e.width<1,os=0,is=1,ls=(e,t,r,n)=>e?n:t||r?Te(is,os,n):0,cs=2,ds=(e,t,r,n,s,a,i,l)=>{if(!a&&!i&&!l)return[];const c=Xt(e,t).pagesIndex,u=ls(a,i,l,n),g=r<=e&&!i?1:-1,d=Math.max(0,c-Math.min(cs,u)*g),f=q(s)?e:d,h=c+u*g,b=Math.max(1,Math.abs(h-f)+Number(a));return Array(b).fill(1).map((S,v)=>f+v*g)},co=(e,t,r)=>[be.BOTH,e].includes(t)||q(r),us=(e,t)=>e!==be.NONE||q(t),uo=(e,t,r)=>{const n=Ft[r];return t==="ltr"?e===te.PREVIOUS?ie("start","end",n):ie("start","end",n):e===te.PREVIOUS?ie("end","start",n):ie("end","start",n)},go=(e,t,r)=>{const n=Ft[r];return t==="ltr"?ie(0,e.scrollWidth,n):ie(-e.scrollWidth,0,n)},or=(e,t)=>t===void 0||t.url!==e,gs=(e,t,r)=>e===$.START?0:e===$.END?r:Te(t,0,r),pe=e=>F.getFromCache(e,Rr,"CHAPTER_READER_FIELDS"),hs=(e,t,r,n,s,a,i)=>{if(!(!!n.isRead&&!!s))return[];const c=[e,...r][s-1];if(!c)return[];const g=(i?F.addDuplicates([c],t):[c]).map(({id:d})=>pe(d)).filter(d=>d!==null).filter(d=>F.isDeletable(d,a));return g.length?F.getIds(g):[]},ir=(e,t,r=te.NEXT)=>{const n=(e+1)/t;return r===te.PREVIOUS?n<.75:n>.25},fs=(e,t,r,n,s)=>{const a=pe(e.id);if(!a||!t)return[];if(!(!!s&&a.isDownloaded&&ir(n,a.pageCount)))return[];const c=pe(t.id);return c!=null&&c.isDownloaded?F.getNonRead(r).map(g=>pe(g.id)).filter(g=>!!g).slice(-s).filter(g=>!g.isDownloaded).map(g=>g.id).filter(g=>!F.isDownloading(g)):[]},ho=(e,t,r,n)=>(s,a,i=!0)=>{if(s>e.length-1)return;const l=e[s],{index:c}=i?l.primary:l.secondary;if(n===j.DOUBLE_PAGE){const u=new Image;u.onload=()=>{const g=as(u);g&&t(d=>{const f=d[c];return f===void 0||f.url!==a||f.isSpread===g?d:d.toSpliced(c,1,{url:a,isSpread:g})})},u.crossOrigin="anonymous",u.src=a}r(u=>{const g=u[c];return or(a,g)||g.loaded?u:u.toSpliced(c,1,{url:g.url,loaded:!0})})},fo=(e,t)=>{if(e)return t?$.END:$.START},_o=e=>(t,r)=>{e(n=>{const s=n[t];return or(r,s)?n:n.toSpliced(t,1,{...s,loaded:!1,error:!0})})},_s=(e,t,r,n,s,a)=>{const{leading:i,trailing:l,lastLeadingChapterSourceOrder:c,lastTrailingChapterSourceOrder:u}=t.visibleChapters,g=e&&r<c,d=!e&&r>u;return{...t,visibleChapters:{...t.visibleChapters,leading:i+Number(g),trailing:l+Number(d),lastLeadingChapterSourceOrder:g?r:c,lastTrailingChapterSourceOrder:d?r:u,isLeadingChapterPreloadMode:s!==void 0?s:t.visibleChapters.isLeadingChapterPreloadMode,isTrailingChapterPreloadMode:a!==void 0?a:t.visibleChapters.isTrailingChapterPreloadMode,scrollIntoView:n,resumeMode:e?$.END:$.START}}},mo=(e,t,r,n,s,a,i,l)=>{if(n){if(s)return Te(e,0,t.pageCount-1);if(l.scrollIntoView&&l.resumeMode!==void 0)return gs(l.resumeMode,0,t.pageCount-1);if(a)return Math.max(0,t.pageCount-1);if(i)return 0}return t.sourceOrder<r.sourceOrder?Math.max(t.pageCount-1,0):0},po=(e,t,r,n,s,a)=>e&&s!==void 0?s:t?a:r?$.END:n?$.START:$.START,xo=(e,t,r)=>{const n=!!t[e+1],a=e+1>=t.length-1&&r.isLeadingChapterPreloadMode,i=n&&!a,l=!!t[e-1],u=e-1<=0&&r.isTrailingChapterPreloadMode;return{previous:i,next:l&&!u}},ms={ltr:"rtl",rtl:"ltr"},ps={ltr:W.LTR,rtl:W.RTL},Z=class Z{static getOrCreateChapterUpdateQueue(t){return Z.chapterUpdateQueues.has(t)||Z.chapterUpdateQueues.set(t,new ct(1)),Z.chapterUpdateQueues.get(t)}static navigateToChapter(t,r){Ar.navigate(F.getReaderUrl(t),{replace:!0,state:r})}static downloadAhead(t,r,n,s,a){const i="".concat(t.id,"_").concat(r==null?void 0:r.id,"_").concat(s,"_").concat(a);Z.downloadAheadQueue.enqueue(i,async()=>{const l=fs(t,r,n,s,a);if(l.length)try{await F.download(l)}catch(c){}})}static preloadChapter(t,r,n,s,a,i,l){if(!n)return;const c=l===te.PREVIOUS,u=l===te.NEXT;!(c&&s<=n.sourceOrder||u&&a>=n.sourceOrder)&&ir(t,r,l)&&i(f=>_s(c,f,n.sourceOrder,!1,c?!0:void 0,u?!0:void 0))}static useUpdateChapter(){const{settings:{deleteChaptersWhileReading:t,deleteChaptersWithBookmark:r,updateProgressAfterReading:n}}=Tr();return _.useCallback(s=>{const{manga:a}=Ie(),{currentChapter:i,mangaChapters:l,chapters:c}=Zn(),{shouldSkipDupChapters:u}=Yn();if(!a||!i||!l)return;const g=F.getNextChapters(i,c,{offset:te.PREVIOUS}),d=async()=>{const f=F.getIds(u?F.addDuplicates([i],l):[i]),h=hs(i,l,g,s,t,r,u);(h.length||f.some(S=>{const v=pe(S);return v?s.isRead!==void 0&&s.isRead!==v.isRead||s.lastPageRead!==void 0&&s.lastPageRead!==v.lastPageRead||s.isBookmarked!==void 0&&s.isBookmarked!==v.isBookmarked:!1}))&&await K.updateChapters(f,{...s,chapterIdsToDelete:h,trackProgressMangaId:n&&s.isRead&&a.trackRecords.totalCount?a.id:void 0},{errorPolicy:"all"}).response.catch(Cr())};Z.getOrCreateChapterUpdateQueue(i.id).enqueue("".concat(i.id),d)},[t,r,n])}static useGetThemeDirection(){const{direction:t}=ot(),r=Ze(n=>n.settings.readingDirection.value);return ps[t]===r?t:ms[t]}static updateSetting(t,r,n=!0,s=!1,a){const{manga:i}=Ie();if(!i||i.id===mt.id)return;const l=dt(t,a!==void 0?[a==null?void 0:a.toString()]:void 0),{cache:c}=K.graphQLClient.client;if(s||xe.includes(t)){const g=c.writeFragment({fragment:Pr,data:{__typename:"GlobalMetaType",key:l,value:JSON.stringify(r)}});c.modify({fields:{metas(d,{readField:f}){return{...d,nodes:ut(l,d==null?void 0:d.nodes,f,()=>g)}}}})}else{const g=c.writeFragment({fragment:yr,data:{__typename:"MangaMetaType",mangaId:i.id,key:l,value:JSON.stringify(r)}});c.modify({id:c.identify({__typename:"MangaType",id:i.id}),fields:{meta(d,{readField:f}){return ut(l,d,f,()=>g)}}})}n&&ln(i,t,r,s,a).catch(g=>gt(ft("reader.settings.error.label.failed_to_save_settings"),"error",ht(g)))}static deleteSetting(t,r=!1,n){const{manga:s}=Ie();if(!s||s.id===mt.id)return;const a=dt(t,n!==void 0?[n]:void 0),{cache:i}=K.graphQLClient.client,l=r||xe.includes(t);l?i.evict({id:i.identify({__typename:"GlobalMetaType",key:a})}):i.evict({id:i.identify({__typename:"MangaMetaType",mangaId:s.id,key:a})}),(l?()=>K.deleteGlobalMeta(a).response:()=>K.deleteMangaMeta(s.id,a).response)().catch(u=>gt(ft("reader.settings.error.label.failed_to_save_settings"),"error",ht(u)))}static useOverlayMode(){const t=Ne.useIsTouchDevice(),r=Ze(c=>c.settings.overlayMode),n=r===B.AUTO,s=r===B.DESKTOP,a=r===B.MOBILE,i=s||n&&!t,l=a||n&&t;return{mode:i?B.DESKTOP:B.MOBILE,isDesktop:i,isMobile:l}}static useExit(){const t=Ze(a=>a.settings.exitMode),r=Or(),n=Ir(),s=_.useCallback(()=>{const{manga:a}=Ie();return a?n(jr.manga.path(a.id)):()=>{}},[]);switch(t){case Se.PREVIOUS:return r;case Se.MANGA:return s;default:throw new Error('Unexpected "exitMode" ('.concat(t,")"))}}};He(Z,"downloadAheadQueue",new ct(1)),He(Z,"chapterUpdateQueues",new Map);let st=Z;const xs=({i18nKey:e,value:t})=>{const{t:r}=m();return o.jsx(p,{sx:{flexDirection:"row",gap:.25},children:o.jsx(Wt,{t:r,i18nKey:e,values:{value:t},components:[o.jsx(R,{variant:"caption",sx:{fontSize:"x-small",opacity:.75}})]})})},bs=({value:e,values:t,defaultValue:r,setValue:n,valueToDisplayData:s,isDefaultable:a,onDefault:i})=>{const{t:l}=m();return o.jsxs(p,{sx:{flexDirection:"row",flexWrap:"wrap",gap:1},children:[a&&o.jsx(re,{onClick:i,variant:e===void 0?"contained":"outlined",children:l("global.label.default")},"default"),t.map(c=>{const u=e===void 0&&c===r,g=s[c].isTitleString?s[c].title:l(s[c].title);return o.jsx(ke,{title:u?l("reader.settings.active_setting"):"",children:o.jsx(re,{onClick:()=>n(c),variant:c===e?"contained":"outlined",startIcon:s[c].icon,children:u?o.jsx(xs,{i18nKey:"global.label.footnote",value:g}):g})},c)})]})},V=({label:e,description:t,...r})=>o.jsxs(p,{children:[o.jsx(R,{children:e}),t&&o.jsx(R,{variant:"body2",color:"textDisabled",children:t}),o.jsx(bs,{...r})]}),lr=({readingMode:e,setReadingMode:t,...r})=>{const{t:n}=m();return o.jsx(V,{...r,label:n("reader.settings.label.reading_mode"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:Ht,setValue:t,valueToDisplayData:Gt})},Ss={[W.LTR]:{title:"reader.settings.reading_direction.ltr",icon:o.jsx(wr,{})},[W.RTL]:{title:"reader.settings.reading_direction.rtl",icon:o.jsx(Dr,{})}},vs=Object.values(W).filter(e=>typeof e=="number"),Es=({readingDirection:e,setReadingDirection:t,...r})=>{const{t:n}=m();return o.jsx(V,{...r,label:n("reader.settings.label.reading_direction"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:vs,setValue:t,valueToDisplayData:Ss})},Rs={[oe.EDGE]:{title:"reader.settings.tap_zones.edge",icon:null},[oe.KINDLE]:{title:"reader.settings.tap_zones.kindle",icon:null},[oe.L_SHAPE]:{title:"reader.settings.tap_zones.l_shape",icon:null},[oe.RIGHT_LEFT]:{title:"reader.settings.tap_zones.right_left",icon:null},[oe.DISABLED]:{title:"global.label.disabled",icon:null}},As=Object.values(oe).filter(e=>typeof e=="number"),Ts=({tapZoneLayout:e,setTapZoneLayout:t,...r})=>{const{t:n}=m();return o.jsx(V,{...r,label:n("reader.settings.tap_zones.title"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:As,setValue:t,valueToDisplayData:Rs})};var cr=(e=>(e[e.NONE=0]="NONE",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.BOTH=3]="BOTH",e))(cr||{});const Ps={0:{title:"global.label.none",icon:null},1:{title:"global.label.horizontal",icon:null},2:{title:"global.label.vertical",icon:null},3:{title:"global.label.both",icon:null}},ys=Object.values(cr).filter(e=>typeof e=="number"),Os={0:{vertical:!1,horizontal:!1},1:{vertical:!1,horizontal:!0},2:{vertical:!0,horizontal:!1},3:{vertical:!0,horizontal:!0}},Is=({vertical:e,horizontal:t})=>e&&t?3:e?2:t?1:0,js=({tapZoneInvertMode:e,setTapZoneInvertMode:t,...r})=>{const{t:n}=m(),s=Is(e.value);return o.jsx(V,{...r,label:n("reader.settings.tap_zones.invert"),value:e.isDefault?void 0:s,defaultValue:e.isDefault?s:void 0,values:ys,setValue:a=>t(Os[a]),valueToDisplayData:Ps})},Cs=({pageScaleMode:e,setPageScaleMode:t,...r})=>{const{t:n}=m();return o.jsx(V,{...r,label:n("reader.settings.page_scale.title"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:Mr,setValue:t,valueToDisplayData:Lr})},Ds=({pageScaleMode:e,shouldStretchPage:t,setShouldStretchPage:r})=>{const{t:n}=m();return Nr[e]?o.jsx(Q,{children:o.jsx(re,{onClick:()=>r(!t),variant:t?"contained":"outlined",children:n("reader.settings.page_scale.stretch")})}):null},kt=de(o.jsx("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8m-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91"})),Pe=({asIconButton:e,...t})=>{const{t:r}=m();return e?o.jsx(ke,{title:r("global.button.reset"),children:o.jsx(zt,{color:"inherit",...t,children:o.jsx(kt,{})})}):o.jsx(re,{startIcon:o.jsx(kt,{}),...t,children:r("global.button.reset")})},z=({label:e,value:t,onDefault:r,slotProps:n})=>{var s,a,i;return o.jsxs(p,{sx:{flexDirection:"row",gap:2,alignItems:"center"},children:[o.jsxs(p,{sx:{flexBasis:"25%"},children:[o.jsx(R,{...n==null?void 0:n.label,sx:{...(s=n==null?void 0:n.label)==null?void 0:s.sx},children:e}),o.jsx(R,{...n==null?void 0:n.value,sx:{...(a=n==null?void 0:n.value)==null?void 0:a.sx},children:t})]}),o.jsx(rn,{...n==null?void 0:n.slider,sx:{flexBasis:"75%",...(i=n==null?void 0:n.slider)==null?void 0:i.sx}}),r&&o.jsx(Pe,{asIconButton:!0,onClick:r})]})},ws=({pageGap:e,readingMode:t,isDefaultable:r,onDefault:n,updateSetting:s})=>{const{t:a}=m();return t.value!==j.WEBTOON&&q(t.value)?o.jsx(z,{label:a("reader.settings.label.page_gap"),value:a("global.value",{value:e.value,unit:a("global.unit.px")}),onDefault:r?n:void 0,slotProps:{slider:{defaultValue:A.pageGap,value:e.value,step:ze.step,min:ze.min,max:ze.max,onChange:(l,c)=>{s(c,!1)},onChangeCommitted:(l,c)=>{s(c,!0)}}}}):null},Ls=({readerWidth:e,pageScaleMode:t,isDefaultable:r,onDefault:n,updateSetting:s,setTransparent:a})=>{const{t:i}=m();return Qt(t)?o.jsxs(p,{children:[o.jsxs(p,{sx:{flexDirection:"row",justifyContent:"space-between"},children:[o.jsx(y,{label:i("reader.settings.label.limit_reader_width"),checked:e.enabled,onChange:(l,c)=>s("readerWidth",{...e,enabled:c},!0)}),r&&o.jsx(Pe,{onClick:n,variant:"outlined"})]}),e.enabled&&o.jsx(z,{label:i("reader.settings.label.reader_width"),value:i("global.value",{value:e.value,unit:"%"}),slotProps:{slider:{defaultValue:A.readerWidth.value,value:e.value,step:1,min:10,max:100,onChange:(l,c)=>{a==null||a(!0),s("readerWidth",{...e,value:c},!1)},onChangeCommitted:(l,c)=>{a==null||a(!1),s("readerWidth",{...e,value:c},!0)}}}})]}):null},Ms=({areDefaultSettings:e})=>{const{t}=m();return!Ne.useIsTouchDevice()||e?null:o.jsx(p,{sx:{alignItems:"end"},children:o.jsx(R,{variant:"caption",children:t("reader.settings.default_setting_footnote")})})},Ns=({profile:e,title:t,updateSetting:r,isSeriesMode:n,...s})=>{const{settings:a}=on(e),i=_.useMemo(()=>({...a,readingMode:{value:e,isDefault:!0}}),[a,e]);return o.jsxs(p,{sx:{gap:2},children:[n?o.jsx(R,{children:t}):o.jsx(nn,{component:"div",id:"".concat(e,"-settings"),children:t}),o.jsx(p,{sx:{px:+!n*2},children:o.jsx(ur,{...s,setShowPreview:()=>{},settings:i,updateSetting:(l,c,u)=>r(l,c,u,!0,e)})})]})},dr=({profiles:e=Ht,readingMode:t,...r})=>{const{updateSetting:n,isSeriesMode:s}=r,{t:a}=m();return o.jsxs(p,{sx:{gap:2,pb:+!s*2},children:[t!==void 0&&o.jsx(p,{sx:{pt:2,px:2},children:o.jsx(lr,{readingMode:t,setReadingMode:i=>n("readingMode",i)})}),e.map(i=>o.jsx(Ns,{profile:i,title:a(Gt[i].title),...r},i))]})},ur=({setShowPreview:e,settings:t,updateSetting:r,isDefaultable:n,onDefault:s,isSeriesMode:a,setTransparent:i})=>{const{t:l}=m();return o.jsxs(p,{sx:{gap:2},children:[o.jsx(Ms,{areDefaultSettings:!n}),a&&o.jsxs(o.Fragment,{children:[o.jsx(R,{children:l("reader.settings.source_series")}),o.jsx(lr,{readingMode:t.readingMode,setReadingMode:c=>r("readingMode",c),isDefaultable:n,onDefault:()=>s==null?void 0:s("readingMode")})]}),o.jsx(ws,{pageGap:t.pageGap,readingMode:t.readingMode,isDefaultable:n,onDefault:()=>s==null?void 0:s("pageGap"),updateSetting:(...c)=>r("pageGap",...c)}),o.jsx(Es,{readingDirection:t.readingDirection,setReadingDirection:c=>r("readingDirection",c),isDefaultable:n,onDefault:()=>s==null?void 0:s("readingDirection")}),o.jsx(Ts,{tapZoneLayout:t.tapZoneLayout,setTapZoneLayout:c=>{e(!0),r("tapZoneLayout",c)},isDefaultable:n,onDefault:()=>{e(!0),s==null||s("tapZoneLayout")}}),o.jsx(js,{tapZoneInvertMode:t.tapZoneInvertMode,setTapZoneInvertMode:c=>{e(!0),r("tapZoneInvertMode",c)},isDefaultable:n,onDefault:()=>{e(!0),s==null||s("tapZoneInvertMode")}}),o.jsx(Cs,{pageScaleMode:t.pageScaleMode,setPageScaleMode:c=>r("pageScaleMode",c),isDefaultable:n,onDefault:()=>s==null?void 0:s("pageScaleMode")}),o.jsx(Ds,{pageScaleMode:t.pageScaleMode.value,shouldStretchPage:t.shouldStretchPage.value,setShouldStretchPage:c=>r("shouldStretchPage",c)}),o.jsx(Ls,{readerWidth:t.readerWidth.value,pageScaleMode:t.pageScaleMode.value,isDefaultable:n,onDefault:()=>s==null?void 0:s("readerWidth"),updateSetting:(...c)=>r(...c),setTransparent:i}),a&&o.jsxs(o.Fragment,{children:[o.jsx(kr,{}),o.jsx(dr,{profiles:[t.readingMode.value],updateSetting:r,isSeriesMode:a,setTransparent:i})]})]})},ks=()=>o.jsx($t,{children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:o.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 15h16"})})}),Us=()=>o.jsx($t,{children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:o.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 15h16M7 15v-5m10 5v-5M4 9h16"})})}),Vs={[ve.HIDDEN]:{title:"global.label.hidden",icon:o.jsx(ks,{})},[ve.STANDARD]:{title:"global.label.standard",icon:o.jsx(Us,{})}},Bs=Object.values(ve).filter(e=>typeof e=="number"),Fs=({overlayMode:e,progressBarType:t,setProgressBarType:r})=>{const{t:n}=m();return e!==B.DESKTOP?null:o.jsx(V,{label:n("reader.settings.progress_bar.style"),value:t,values:Bs,setValue:r,valueToDisplayData:Vs})},Gs=({overlayMode:e,progressBarType:t,progressBarSize:r,setProgressBarSize:n,onDefault:s})=>{const{t:a}=m();return e===B.DESKTOP&&t===ve.STANDARD?o.jsx(z,{label:a("reader.settings.progress_bar.size"),value:a("global.value",{value:r,unit:a("global.unit.px")}),onDefault:s,slotProps:{slider:{defaultValue:A.progressBarSize,value:r,step:je.step,min:je.min,max:je.max,onChange:(l,c)=>{n(c,!1)},onChangeCommitted:(l,c)=>{n(c,!0)}}}}):null},Hs=de(o.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"})),Ut=de(o.jsx("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"})),gr=de([o.jsx("path",{d:"M19.03 3.56c-1.67-1.39-3.74-2.3-6.03-2.51v2.01c1.73.19 3.31.88 4.61 1.92zM11 3.06V1.05c-2.29.2-4.36 1.12-6.03 2.51l1.42 1.42C7.69 3.94 9.27 3.25 11 3.06M4.98 6.39 3.56 4.97C2.17 6.64 1.26 8.71 1.05 11h2.01c.19-1.73.88-3.31 1.92-4.61M20.94 11h2.01c-.21-2.29-1.12-4.36-2.51-6.03l-1.42 1.42c1.04 1.3 1.73 2.88 1.92 4.61M7 12l3.44 1.56L12 17l1.56-3.44L17 12l-3.44-1.56L12 7l-1.56 3.44z"},"0"),o.jsx("path",{d:"M12 21c-3.11 0-5.85-1.59-7.46-4H7v-2H1v6h2v-2.7c1.99 2.84 5.27 4.7 9 4.7 4.87 0 9-3.17 10.44-7.56l-1.96-.45C19.25 18.48 15.92 21 12 21"},"1")]),Vt={[H.AUTO]:{title:"global.label.auto",icon:o.jsx(gr,{})},[H.BOTTOM]:{title:"global.label.bottom",icon:o.jsx(Ut,{sx:{transform:"rotate(90deg)"}})},[H.LEFT]:{title:"global.label.left",icon:o.jsx(Hs,{})},[H.RIGHT]:{title:"global.label.right",icon:o.jsx(Ut,{})}},zs=Object.values(H).filter(e=>typeof e=="number"),$s=Object.values(Ur),Ws=({progressBarPosition:e,progressBarPositionAutoVertical:t,updateSetting:r})=>{const{t:n}=m(),s=e===H.AUTO;return o.jsxs(o.Fragment,{children:[o.jsx(V,{label:n("reader.settings.progress_bar.position"),value:e,values:zs,setValue:a=>r("progressBarPosition",a),valueToDisplayData:Vt}),s&&o.jsx(V,{label:n("reader.settings.progress_bar.auto_vertical_position.title"),value:t,values:$s,setValue:a=>r("progressBarPositionAutoVertical",a),valueToDisplayData:Vt})]})},Ys=de(o.jsx("path",{d:"M15.5 1h-8C6.12 1 5 2.12 5 3.5v17C5 21.88 6.12 23 7.5 23h8c1.38 0 2.5-1.12 2.5-2.5v-17C18 2.12 16.88 1 15.5 1m-4 21c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m4.5-4H7V4h9z"})),Zs=de(o.jsx("path",{d:"M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2zM4 6h16v10H4z"})),Ks={[B.AUTO]:{title:"global.label.auto",icon:o.jsx(gr,{})},[B.DESKTOP]:{title:"global.label.desktop",icon:o.jsx(Zs,{})},[B.MOBILE]:{title:"global.label.mobile",icon:o.jsx(Ys,{})}},Xs=Object.values(B).filter(e=>typeof e=="number"),Qs=({overlayMode:e,setOverlayMode:t})=>{const{t:r}=m();return o.jsx(V,{label:r("reader.settings.overlay_mode"),value:e,values:Xs,setValue:t,valueToDisplayData:Ks})},qs={[_e.THEME]:{title:"settings.appearance.theme.title",icon:null},[_e.BLACK]:{title:"global.colors.black",icon:null},[_e.GRAY]:{title:"global.colors.gray",icon:null},[_e.WHITE]:{title:"global.colors.white",icon:null}},Js=Object.values(_e).filter(e=>typeof e=="number"),ea=({backgroundColor:e,updateSetting:t})=>{const{t:r}=m();return o.jsx(V,{label:r("reader.settings.background_color"),value:e,values:Js,setValue:t,valueToDisplayData:qs})},ta=({overlayMode:e,settings:t,updateSetting:r,onDefault:n})=>{const{t:s}=m();return o.jsxs(p,{sx:{gap:2},children:[o.jsx(Qs,{overlayMode:t.overlayMode,setOverlayMode:a=>r("overlayMode",a)}),o.jsx(ea,{backgroundColor:t.backgroundColor,updateSetting:a=>r("backgroundColor",a)}),o.jsx(Fs,{overlayMode:e,progressBarType:t.progressBarType,setProgressBarType:a=>r("progressBarType",a)}),o.jsx(Gs,{overlayMode:e,progressBarType:t.progressBarType,progressBarSize:t.progressBarSize,setProgressBarSize:(...a)=>r("progressBarSize",...a),onDefault:()=>n==null?void 0:n("progressBarSize")}),o.jsx(Ws,{progressBarPosition:t.progressBarPosition,progressBarPositionAutoVertical:t.progressBarPositionAutoVertical,updateSetting:r}),(t.progressBarType===ve.HIDDEN||e===B.MOBILE)&&o.jsx(y,{label:s("reader.settings.label.show_page_number"),checked:t.shouldShowPageNumber,onChange:(a,i)=>r("shouldShowPageNumber",i)})]})},ra=({brightness:e,updateSetting:t})=>{const{t:r}=m();return o.jsxs(p,{children:[o.jsx(y,{label:r("reader.settings.custom_filter.brightness"),checked:e.enabled,onChange:(n,s)=>t("brightness",{...e,enabled:s},!0)}),e.enabled&&o.jsx(z,{label:r("reader.settings.custom_filter.brightness"),value:e.value,onDefault:()=>t("brightness",{...e,value:A.customFilter.brightness.value},!0),slotProps:{slider:{defaultValue:A.customFilter.brightness.value,value:e.value,step:L.brightness.step,min:L.brightness.min,max:L.brightness.max,onChange:(n,s)=>{t("brightness",{...e,value:s},!1)},onChangeCommitted:(n,s)=>{t("brightness",{...e,value:s},!0)}}}})]})},na=({contrast:e,updateSetting:t})=>{const{t:r}=m();return o.jsxs(p,{children:[o.jsx(y,{label:r("reader.settings.custom_filter.contrast"),checked:e.enabled,onChange:(n,s)=>t("contrast",{...e,enabled:s},!0)}),e.enabled&&o.jsx(z,{label:r("reader.settings.custom_filter.contrast"),value:e.value,onDefault:()=>t("contrast",{...e,value:A.customFilter.contrast.value},!0),slotProps:{slider:{defaultValue:A.customFilter.contrast.value,value:e.value,step:L.contrast.step,min:L.contrast.min,max:L.contrast.max,onChange:(n,s)=>{t("contrast",{...e,value:s},!1)},onChangeCommitted:(n,s)=>{t("contrast",{...e,value:s},!0)}}}})]})},sa=({saturate:e,updateSetting:t})=>{const{t:r}=m();return o.jsxs(p,{children:[o.jsx(y,{label:r("reader.settings.custom_filter.saturate"),checked:e.enabled,onChange:(n,s)=>t("saturate",{...e,enabled:s},!0)}),e.enabled&&o.jsx(z,{label:r("reader.settings.custom_filter.saturate"),value:e.value,onDefault:()=>t("saturate",{...e,value:A.customFilter.saturate.value},!0),slotProps:{slider:{defaultValue:A.customFilter.saturate.value,value:e.value,step:L.saturate.step,min:L.saturate.min,max:L.saturate.max,onChange:(n,s)=>{t("saturate",{...e,value:s},!1)},onChangeCommitted:(n,s)=>{t("saturate",{...e,value:s},!0)}}}})]})},aa=({hue:e,updateSetting:t})=>{const{t:r}=m();return o.jsxs(p,{children:[o.jsx(y,{label:r("reader.settings.custom_filter.hue"),checked:e.enabled,onChange:(n,s)=>t("hue",{...e,enabled:s},!0)}),e.enabled&&o.jsx(z,{label:r("reader.settings.custom_filter.hue"),value:e.value,onDefault:()=>t("hue",{...e,value:A.customFilter.hue.value},!0),slotProps:{slider:{defaultValue:A.customFilter.hue.value,value:e.value,step:L.hue.step,min:L.hue.min,max:L.hue.max,onChange:(n,s)=>{t("hue",{...e,value:s},!1)},onChangeCommitted:(n,s)=>{t("hue",{...e,value:s},!0)}}}})]})},oa={red:"reader.settings.custom_filter.rgba.red",green:"reader.settings.custom_filter.rgba.green",blue:"reader.settings.custom_filter.rgba.blue",alpha:"reader.settings.custom_filter.rgba.alpha"},ia=({rgba:e,updateSetting:t})=>{const{t:r}=m();return o.jsxs(p,{children:[o.jsx(y,{label:r("reader.settings.custom_filter.rgba.title"),checked:e.enabled,onChange:(n,s)=>t("rgba",{...e,enabled:s},!0)}),e.enabled&&o.jsxs(p,{sx:{gap:1},children:[Object.entries(e.value).map(([n,s])=>n==="blendMode"?null:o.jsx(z,{label:r(oa[n]),value:s,onDefault:()=>t("rgba",{...e,value:{...e.value,[n]:A.customFilter.rgba.value[n]}},!0),slotProps:{slider:{value:s,defaultValue:A.customFilter.rgba.value[n],step:L.rgba[n].step,min:L.rgba[n].min,max:L.rgba[n].max,onChange:(a,i)=>{t("rgba",{...e,value:{...e.value,[n]:i}},!1)},onChangeCommitted:(a,i)=>{t("rgba",{...e,value:{...e.value,[n]:i}},!0)}}}},n)),o.jsx(V,{label:r("reader.settings.custom_filter.rgba.blend_mode.title"),value:e.value.blendMode,values:Br,setValue:n=>t("rgba",{...e,value:{...e.value,blendMode:n}},!0),valueToDisplayData:Vr})]})]})},la=({sepia:e,updateSetting:t})=>{const{t:r}=m();return o.jsx(p,{children:o.jsx(y,{label:r("reader.settings.custom_filter.sepia"),checked:e,onChange:(n,s)=>t(s)})})},ca=({grayscale:e,updateSetting:t})=>{const{t:r}=m();return o.jsx(p,{children:o.jsx(y,{label:r("reader.settings.custom_filter.grayscale"),checked:e,onChange:(n,s)=>t(s)})})},da=({invert:e,updateSetting:t})=>{const{t:r}=m();return o.jsx(p,{children:o.jsx(y,{label:r("reader.settings.custom_filter.invert"),checked:e,onChange:(n,s)=>t(s)})})},ua=({settings:{customFilter:e},updateSetting:t,onDefault:r,setTransparent:n})=>{const s=(a,i)=>{t("customFilter",a,i),n==null||n(i===void 0?!1:!i)};return o.jsxs(p,{sx:{gap:2},children:[o.jsx(ra,{brightness:e.brightness,updateSetting:(a,i,l)=>s({...e,[a]:i},l)}),o.jsx(na,{contrast:e.contrast,updateSetting:(a,i,l)=>s({...e,[a]:i},l)}),o.jsx(sa,{saturate:e.saturate,updateSetting:(a,i,l)=>s({...e,[a]:i},l)}),o.jsx(aa,{hue:e.hue,updateSetting:(a,i,l)=>s({...e,[a]:i},l)}),o.jsx(ia,{rgba:e.rgba,updateSetting:(a,i,l)=>s({...e,[a]:i},l)}),o.jsx(la,{sepia:e.sepia,updateSetting:a=>s({...e,sepia:a})}),o.jsx(ca,{grayscale:e.grayscale,updateSetting:a=>s({...e,grayscale:a})}),o.jsx(da,{invert:e.invert,updateSetting:a=>s({...e,invert:a})}),o.jsx(p,{sx:{alignItems:"end"},children:o.jsx(Pe,{onClick:()=>r==null?void 0:r("customFilter"),variant:"outlined"})})]})},ga={[Se.PREVIOUS]:{title:"global.label.previous",icon:null},[Se.MANGA]:{title:"manga.title_one",icon:null}},ha=Object.values(Se).filter(e=>typeof e=="number"),fa=({exitMode:e,setExitMode:t})=>{const{t:r}=m();return o.jsx(V,{label:r("reader.settings.exit_mode"),value:e,values:ha,setValue:t,valueToDisplayData:ga})},_a=({autoScroll:e,setAutoScroll:t})=>{const{t:r}=m();return o.jsxs(o.Fragment,{children:[o.jsx(y,{label:r("reader.settings.auto_scroll.smooth"),checked:e.smooth,onChange:(n,s)=>t({...e,smooth:s},!0)}),o.jsx(z,{label:r("reader.settings.auto_scroll.speed"),value:r("global.time.seconds.value",{count:e.value}),onDefault:()=>t({...e,value:A.autoScroll.value},!0),slotProps:{slider:{defaultValue:A.customFilter.saturate.value,value:e.value,...je,onChange:(n,s)=>{t({...e,value:s},!1)},onChangeCommitted:(n,s)=>{t({...e,value:s},!0)}}}})]})},ma={[me.TINY]:{title:"global.label.tiny",icon:null},[me.SMALL]:{title:"global.label.small",icon:null},[me.MEDIUM]:{title:"global.label.medium",icon:null},[me.LARGE]:{title:"global.label.large",icon:null}},pa=Object.values(me).filter(e=>typeof e=="number"),xa=({scrollAmount:e,setScrollAmount:t})=>{const{t:r}=m();return o.jsxs(o.Fragment,{children:[o.jsx(V,{label:r("reader.settings.scroll_amount"),value:e,values:pa,setValue:n=>t(n,!0),valueToDisplayData:ma}),o.jsx(z,{label:r("reader.settings.label.custom_scroll_amount"),value:r("global.value",{value:e,unit:"%"}),onDefault:()=>t(A.scrollAmount,!0),slotProps:{slider:{defaultValue:A.scrollAmount,value:e,...Fr,onChange:(n,s)=>{t(s,!1)},onChangeCommitted:(n,s)=>{t(s,!0)}}}})]})},ba=({settings:e,updateSetting:t,onDefault:r,isDefaultable:n})=>{const{t:s}=m();return o.jsxs(p,{sx:{gap:2},children:[o.jsx(fa,{exitMode:e.exitMode,setExitMode:a=>t("exitMode",a)}),o.jsx(xa,{scrollAmount:e.scrollAmount,setScrollAmount:(a,i)=>t("scrollAmount",a,i)}),o.jsx(y,{label:s("reader.settings.label.skip_dup_chapters"),checked:e.shouldSkipDupChapters,onChange:(a,i)=>t("shouldSkipDupChapters",i)}),o.jsx(y,{label:o.jsxs(Q,{children:[o.jsx(R,{children:s("reader.settings.label.skip_filtered_chapters")}),n&&o.jsx(R,{variant:"body2",color:"textDisabled",children:s("reader.settings.label.unchangeable_in_reader")})]}),checked:e.shouldSkipFilteredChapters,onChange:(a,i)=>t("shouldSkipFilteredChapters",i),disabled:n}),xn(e.readingMode.value)&&o.jsx(y,{label:s("reader.settings.label.offset_double_spread"),checked:e.shouldOffsetDoubleSpreads.value,onChange:(a,i)=>t("shouldOffsetDoubleSpreads",i)}),o.jsx(y,{label:o.jsxs(Q,{children:[o.jsx(R,{children:s("reader.settings.infinite_scroll.title")}),o.jsx(R,{variant:"body2",color:"textDisabled",children:s("reader.settings.infinite_scroll.description")})]}),checked:e.shouldUseInfiniteScroll,onChange:(a,i)=>t("shouldUseInfiniteScroll",i)}),o.jsx(y,{label:o.jsxs(Q,{children:[o.jsx(R,{children:s("reader.settings.preview.reading_mode.title")}),o.jsx(R,{variant:"body2",color:"textDisabled",children:s("reader.settings.preview.reading_mode.description")})]}),checked:e.shouldShowReadingModePreview,onChange:(a,i)=>t("shouldShowReadingModePreview",i)}),o.jsx(y,{label:o.jsxs(Q,{children:[o.jsx(R,{children:s("reader.settings.preview.tap_zones.title")}),o.jsx(R,{variant:"body2",color:"textDisabled",children:s("reader.settings.preview.tap_zones.description")})]}),checked:e.shouldShowTapZoneLayoutPreview,onChange:(a,i)=>t("shouldShowTapZoneLayoutPreview",i)}),o.jsx(y,{label:o.jsxs(Q,{children:[o.jsx(R,{children:s("reader.settings.auto_webtoon_mode.title")}),o.jsx(R,{variant:"body2",color:"textDisabled",children:s("reader.settings.auto_webtoon_mode.description")})]}),checked:e.shouldUseAutoWebtoonMode,onChange:(a,i)=>t("shouldUseAutoWebtoonMode",i)}),o.jsx(y,{label:s("reader.settings.show_transition_page"),checked:e.shouldShowTransitionPage,onChange:(a,i)=>t("shouldShowTransitionPage",i)}),o.jsx(y,{label:s("reader.settings.chapter_transition.warning.missing_chapter"),checked:e.shouldInformAboutMissingChapter,onChange:(a,i)=>t("shouldInformAboutMissingChapter",i)}),o.jsx(y,{label:s("reader.settings.chapter_transition.warning.scanlator_change"),checked:e.shouldInformAboutScanlatorChange,onChange:(a,i)=>t("shouldInformAboutScanlatorChange",i)}),o.jsx(_a,{autoScroll:e.autoScroll,setAutoScroll:(...a)=>t("autoScroll",...a)}),o.jsx(z,{label:s("reader.settings.image_preload_amount"),value:e.imagePreLoadAmount,onDefault:()=>r==null?void 0:r("imagePreLoadAmount"),slotProps:{slider:{defaultValue:A.imagePreLoadAmount,value:e.imagePreLoadAmount,step:$e.step,min:$e.min,max:$e.max,onChange:(a,i)=>{t("imagePreLoadAmount",i,!1)},onChangeCommitted:(a,i)=>{t("imagePreLoadAmount",i,!0)}}}})]})},Sa=Gr(R)(({theme:e})=>({display:"inline-block",padding:"0.2em 0.4em",fontSize:"0.85em",lineHeight:"1.4",color:e.palette.text.primary,backgroundColor:e.palette.background.paper,border:"1px solid ".concat(e.palette.divider),borderRadius:"3px",boxShadow:"inset 0 -1px 0 ".concat(e.palette.divider),fontFamily:"monospace, monospace"})),hr=({keys:e,removeKey:t})=>{const{t:r}=m();return o.jsx(p,{sx:{flexDirection:"row",flexWrap:"wrap",gap:1},children:e.map((n,s)=>o.jsxs(_.Fragment,{children:[o.jsx(ke,{title:r("global.button.delete"),hidden:!t,children:o.jsx(p,{sx:{flexDirection:"row",flexWrap:"wrap",gap:.5,cursor:t?"pointer":void 0},onClick:()=>t==null?void 0:t(n),children:n.split("+").map((a,i,l)=>o.jsxs(_.Fragment,{children:[o.jsx(Sa,{children:a}),i===l.length-1?"":"+"]},a))})}),s===e.length-1?"":","]},n))})},va=({onClose:e,onCreate:t,existingKeys:r})=>{const{t:n}=m(),[s,{start:a,stop:i,resetKeys:l}]=Hr(),c=[[...s].join("+")],u=c.some(g=>r.map(d=>d.toLowerCase()).includes(g.toLowerCase()));return _.useEffect(()=>(a(),()=>{i()}),[]),o.jsxs(zr,{open:!0,onClose:e,fullWidth:!0,children:[o.jsx($r,{children:n("hotkeys.create.dialog.title")}),o.jsxs(Wr,{children:[o.jsx(p,{sx:{flexDirection:"row",gap:1},children:o.jsx(Wt,{i18nKey:"hotkeys.create.dialog.label",components:{Keys:s.size?o.jsx(hr,{keys:c}):o.jsx(R,{children:n("hotkeys.create.dialog.placeholder")})},children:"Recorded keys:"})}),u&&o.jsx(R,{color:"error",children:n("hotkeys.create.error.exists")})]}),o.jsx(Yr,{children:o.jsxs(p,{direction:"row",sx:{justifyContent:"space-between",width:"100%"},children:[o.jsx(re,{onClick:l,children:n("global.button.reset")}),o.jsxs(p,{direction:"row",children:[o.jsx(re,{onClick:e,children:n("global.button.cancel")}),o.jsx(re,{disabled:u,onClick:()=>{e(),t(c)},children:n("global.button.create")})]})]})})]})},Ea={[D.PREVIOUS_PAGE]:"reader.settings.hotkey.previous_page",[D.NEXT_PAGE]:"reader.settings.hotkey.next_page",[D.SCROLL_BACKWARD]:"reader.settings.hotkey.scroll_backward",[D.SCROLL_FORWARD]:"reader.settings.hotkey.scroll_forward",[D.PREVIOUS_CHAPTER]:"reader.settings.hotkey.previous_chapter",[D.NEXT_CHAPTER]:"reader.settings.hotkey.next_chapter",[D.TOGGLE_MENU]:"reader.settings.hotkey.menu",[D.CYCLE_SCALE_TYPE]:"reader.settings.hotkey.scale_type",[D.STRETCH_IMAGE]:"reader.settings.hotkey.stretch_image",[D.OFFSET_SPREAD_PAGES]:"reader.settings.hotkey.offset_spread_pages",[D.CYCLE_READING_MODE]:"reader.settings.hotkey.reading_mode",[D.CYCLE_READING_DIRECTION]:"reader.settings.hotkey.reading_direction",[D.TOGGLE_AUTO_SCROLL]:"reader.settings.hotkey.auto_scroll",[D.AUTO_SCROLL_SPEED_INCREASE]:"reader.settings.hotkey.auto_scroll_speed_increase",[D.AUTO_SCROLL_SPEED_DECREASE]:"reader.settings.hotkey.auto_scroll_speed_decrease",[D.EXIT_READER]:"reader.button.exit"},Ra=({hotkey:e,keys:t,existingKeys:r,updateSetting:n})=>{const{t:s}=m(),a=Zr({popupId:"reader-setting-record-hotkey",variant:"dialog"});return o.jsxs(o.Fragment,{children:[o.jsxs(p,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[o.jsx(R,{sx:{flexGrow:1},children:s(Ea[e])}),o.jsx(hr,{keys:t,removeKey:i=>n(t.filter(l=>l!==i))}),o.jsx(ke,{title:s("global.button.add"),children:o.jsx(zt,{...Kr(a),color:"inherit",children:o.jsx(sn,{})})}),o.jsx(Pe,{asIconButton:!0,onClick:()=>n(A.hotkeys[e])})]}),a.isOpen&&o.jsx(va,{onClose:a.close,onCreate:i=>n([...t,...i]),existingKeys:r})]})},Aa=({settings:e,updateSetting:t,onDefault:r})=>{const{t:n}=m();return o.jsxs(p,{sx:{gap:2},children:[o.jsx(p,{sx:{alignItems:"end"},children:o.jsx(R,{variant:"caption",children:n("hotkeys.info.delete")})}),Xr.map(s=>o.jsx(Ra,{hotkey:s,keys:e.hotkeys[s],existingKeys:Object.values(e.hotkeys).flat(),updateSetting:a=>t("hotkeys",{...e.hotkeys,[s]:a})},s)),o.jsx(p,{sx:{alignItems:"end"},children:o.jsx(Pe,{onClick:()=>r==null?void 0:r("hotkeys"),variant:"outlined"})})]})},Ta=(e,t,r)=>_.memo(_.forwardRef((n,s)=>{const a=t.reduce((c,u)=>({...c,...u(n)}),{}),i=Object.fromEntries(Object.entries(a).filter(([c])=>r.includes(c))),l={...n,...i};return o.jsx(e,{...l,ref:s})})),Pa=({activeTab:e,setActiveTab:t,areDefaultSettings:r,settings:n,updateSetting:s,deleteSetting:a,mode:i,setTransparent:l})=>{const{t:c}=m(),u=Ne.useIsTouchDevice(),g=Kn(d=>d.tapZone.setShowPreview);return o.jsxs(o.Fragment,{children:[o.jsx(Qr,{value:e,onChange:(d,f)=>t(f),sx:{...x(!!r,{zIndex:2}),...x(!r,{backgroundColor:"background.paper",backgroundImage:"var(--Paper-overlay)"})},children:Object.values(_t).map(({id:d,label:f,supportsTouchDevices:h})=>!h&&u?null:o.jsx(tn,{value:d,label:c(f),sx:{flexGrow:1,maxWidth:"unset",textTransform:"none"}},d))}),o.jsx(Q,{sx:{p:r?void 0:2,overflowX:"hidden"},children:Object.values(_t).map(({id:d,supportsTouchDevices:f})=>{if(!f&&u)return null;switch(d){case he.LAYOUT:return r?o.jsx(ae,{index:d,currentIndex:e,children:o.jsx(dr,{readingMode:n.readingMode,updateSetting:(...h)=>s(...h)})},d):o.jsx(ae,{index:d,currentIndex:e,children:o.jsx(ur,{settings:n,updateSetting:(...h)=>s(...h),setShowPreview:g,isDefaultable:!r,onDefault:(...h)=>a==null?void 0:a(...h),isSeriesMode:!0,setTransparent:l})},d);case he.GENERAL:return o.jsx(ae,{index:d,currentIndex:e,sx:{p:r?2:void 0},children:o.jsx(ta,{overlayMode:i,settings:n,updateSetting:(...h)=>s(...h),isDefaultable:!r,onDefault:(...h)=>a==null?void 0:a(...h)})},d);case he.FILTER:return o.jsx(ae,{index:d,currentIndex:e,sx:{p:r?2:void 0},children:o.jsx(ua,{settings:n,updateSetting:(...h)=>s(...h),isDefaultable:!0,onDefault:(...h)=>a==null?void 0:a(...h),setTransparent:l})},d);case he.BEHAVIOUR:return o.jsx(ae,{index:d,currentIndex:e,sx:{p:r?2:void 0},children:o.jsx(ba,{settings:n,updateSetting:(...h)=>s(...h),isDefaultable:!r,onDefault:(...h)=>a==null?void 0:a(...h)})},d);case he.HOTKEYS:return o.jsx(ae,{index:d,currentIndex:e,sx:{p:r?2:void 0},children:o.jsx(Aa,{settings:n,updateSetting:(...h)=>s(...h),isDefaultable:!0,onDefault:(...h)=>a==null?void 0:a(...h)})},d);default:throw new Error('Unexpected "ReaderSettingTab" ('.concat(d,")"))}})})]})},bo=Ta(Pa,[st.useOverlayMode],["mode"]);export{Ie as $,qa as A,J as B,ro as C,Xa as D,Ms as E,lr as F,Es as G,_a as H,Kn as I,go as J,uo as K,ao as L,co as M,Ce as N,gs as O,Ka as P,Lt as Q,bo as R,xs as S,lo as T,Ya as U,ho as V,_o as W,qt as X,xo as Y,Qt as Z,$a as _,st as a,po as a0,mo as a1,Ja as a2,Ba as a3,Wa as a4,Zt as a5,Mt as a6,Fa as a7,Ze as b,Wn as c,eo as d,no as e,za as f,Xt as g,Qa as h,q as i,Zn as j,Yn as k,to as l,Ga as m,Xe as n,us as o,so as p,oo as q,io as r,_s as s,fo as t,on as u,pe as v,Ta as w,Ha as x,Za as y,xn as z};
