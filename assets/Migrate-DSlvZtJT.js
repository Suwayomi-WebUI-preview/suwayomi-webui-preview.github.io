var E=Object.freeze,T=Object.defineProperty;var G=(t,o)=>E(T(t,"raw",{value:E(o||t.slice())}));import{u as _,c as m,N as k,z as P,d as b,G as q,a as c,aY as v,j as p,g as A,E as K,h as M}from"./index-Zl59rTnr.js";import{M as O}from"./MangaGrid-sXgrtb3t.js";import{G as Q}from"./GridLayouts-DL3UBwkf.js";import"./index-DQrhUqKj.js";import"./index-D03_UwGI.js";import"./Chip-DIc23AWH.js";import"./useManageMangaLibraryState-CawoFeDt.js";import"./MenuItem-DWrnvo_k.js";import"./CardContent-RtU3w6b_.js";import"./Avatar-922Wk_ln.js";import"./TextField-lew-bJf8.js";import"./InputAdornment-C6brfzM8.js";import"./SpinnerImage-DiQGN4Ou.js";import"./Collapse-NT65VyrV.js";import"./Link-DNDUF647.js";import"./ListPreference-B4Yqea6O.js";import"./Checkbox-STjbDH5e.js";import"./SwitchBase-B5dQFXOZ.js";import"./NumberSetting-D95Za2Yx.js";import"./Info-CBdRtVcr.js";import"./dayjs.min-ByUHsGI2.js";import"./language-CcP_OM1B.js";import"./useMobilePicker-BrirqG1O.js";import"./SelectSetting-DVozOvvZ.js";import"./Select-BndaAxxl.js";import"./CheckboxInput-DqA77Hjg.js";import"./metadataServerSettings-Bu9SBxLq.js";import"./metadata-3dsaWhfv.js";import"./Mangas-D6kqk8_N.js";import"./Chapters-BDtuZBKt.js";import"./ThreeStateCheckboxInput-wO9QFGNa.js";import"./Delete-BgE5pKr0.js";import"./Sync-B5XFkS26.js";import"./PlayArrow-CEADbSL0.js";import"./StyledFab--ltFOeG8.js";import"./ViewModule-BKQF3aZo.js";var C;const wr=()=>{var x;const{t}=_(),{setTitle:o,setAction:L}=m.useContext(k),{sourceId:a}=P(),[u,j]=b("migrateGridLayout",q.List),S=c.graphQLClient.client.cache.readFragment({id:c.graphQLClient.client.cache.identify({__typename:"SourceType",id:a}),fragment:v(C||(C=G(["\n            fragment MigratableSource on SourceType {\n                id\n                name\n            }\n        "])))}),[e,w]=m.useState(S!==null?!0:void 0),{data:s,loading:d,error:r,refetch:I}=c.useGetSource(a,{skip:!!e,notifyOnNetworkStatusChange:!0}),{sourceId:g,name:i}={sourceId:a,name:a,...S,...s==null?void 0:s.source},{data:l,loading:y,error:f,refetch:N}=c.useGetMigratableSourceMangas(g,{skip:!e,notifyOnNetworkStatusChange:!0});if(m.useEffect(()=>{var n;return o((n=i!=null?i:g)!=null?n:t("migrate.title")),L(p.jsx(Q,{gridLayout:u,onChange:j})),()=>{o(""),L(null)}},[t,i,g,u]),m.useEffect(()=>{d||e||w(!!s||!!(r!=null&&r.message.includes("The field at path '/source' was declared as a non null type")))},[d,r]),d||!r&&!e||y)return p.jsx(A,{});const h=r&&e===!1;if(h||f){const n=h?r:f;return p.jsx(K,{message:t("global.error.label.failed_to_load_data"),messageExtra:n.message,retry:()=>{h&&I().catch(M()),f&&N().catch(M())}})}return p.jsx(O,{hasNextPage:!1,loadMore:()=>{},isLoading:y,mangas:(x=l==null?void 0:l.mangas.nodes)!=null?x:[],gridLayout:u,mode:"migrate.search"})};export{wr as Migrate};
