import{j as e,f as p,s as I,v as E,u as k,at as L,o as D,p as O,q as B,c4 as b,aC as N,w as M,B as P,ak as _,aE as $,r as V,cR as G,i as R,g as w,k as H,N as q,m as J}from"./index-VxLoqdF2.js";import{S as U}from"./Switch-CCMwVZLE.js";import{C as F,F as W}from"./Checkbox-CjJa6CQI.js";import{L as X}from"./ListPreference-Bu4dRGWs.js";import{F as Y}from"./FormGroup-B7b-bcM6.js";import{E as z}from"./EmptyViewAbsoluteCentered-BBm6NvMy.js";import{u as K}from"./useAppTitle-_XKroqPH.js";import"./SwitchBase-DhK57wAx.js";function y(t){return JSON.parse(JSON.stringify(t))}function Q(t){return t==="Switch"?U:F}const Z=t=>t.type==="CheckBoxPreference"?{title:t.CheckBoxTitle,defaultValue:t.CheckBoxDefault,currentValue:t.CheckBoxCheckBoxCurrentValue}:{title:t.SwitchPreferenceTitle,defaultValue:t.SwitchPreferenceDefault,currentValue:t.SwitchPreferenceCurrentValue};function A(t){const{title:i,defaultValue:g,currentValue:n,summary:f,updateValue:x,twoStateType:u}={...t,...Z(t)},[r,s]=p.useState(n!=null?n:g);p.useEffect(()=>{s(n!=null?n:g)},[n]);const a=p.useMemo(()=>Q(u),[u]);return e.jsxs(I,{children:[e.jsx(E,{primary:i,secondary:f}),e.jsx(a,{edge:"end",checked:r,onChange:()=>{x(u==="Switch"?"switchState":"checkBoxState",!n),s(!n)}})]})}function v(t){return e.jsx(A,{...t,twoStateType:"Checkbox"})}function ee(t){return e.jsx(A,{...t,twoStateType:"Switch"})}function te(t){const{i18n:i,_:g}=k(),{EditTextPreferenceTitle:n,summary:f,dialogTitle:x,dialogMessage:u,EditTextPreferenceCurrentValue:r,updateValue:s}=t,[a,d]=p.useState(r!=null?r:""),[C,h]=p.useState(!1),l=()=>{h(!1),d(r!=null?r:"")},m=()=>{h(!1),s("editTextState",a)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{onClick:()=>h(!0),children:e.jsx(E,{primary:n,secondary:f})}),e.jsxs(D,{open:C,onClose:l,children:[e.jsx(O,{children:x}),e.jsxs(B,{children:[e.jsx(b,{children:u}),e.jsx(N,{autoFocus:!0,margin:"dense",id:"name",type:"text",fullWidth:!0,value:a,onChange:S=>d(S.target.value)})]}),e.jsxs(M,{children:[e.jsx(P,{onClick:l,color:"primary",children:i._({id:"dEgA5A"})}),e.jsx(P,{onClick:m,color:"primary",children:i._({id:"aP3N/0"})})]})]})]})}function ne(t){const{i18n:i,_:g}=k(),{selectedValues:n,open:f,onClose:x,values:u,title:r}=t,[s,a]=_.useState(n);_.useEffect(()=>{f||a(n)},[n,f]);const d=()=>{x(null)},C=()=>{x(s)},h=(l,m)=>{const{checked:S}=l.target,c=s.some(o=>m===o);if(S){if(!c){const o=y(s);o.push(m),a(o)}}else if(c){const o=y(s),j=o.indexOf(m);o.splice(j,1),a(o)}};return e.jsxs(D,{sx:{"& .MuiDialog-paper":{width:"80%",maxHeight:435}},maxWidth:"xs",open:f,onClose:d,children:[e.jsx(O,{children:r}),e.jsx(B,{dividers:!0,children:e.jsx(Y,{children:u.map(l=>e.jsx(W,{control:e.jsx(F,{checked:s.some(m=>l===m),onChange:m=>h(m,l)}),label:l},l))})}),e.jsxs(M,{children:[e.jsx(P,{autoFocus:!0,onClick:d,children:i._({id:"dEgA5A"})}),e.jsx(P,{onClick:C,children:i._({id:"aP3N/0"})})]})]})}function re(t){const{MultiSelectListPreferenceTitle:i,summary:g,MultiSelectListPreferenceCurrentValue:n,MultiSelectListPreferenceDefault:f,updateValue:x,entryValues:u,entries:r}=t,[s,a]=p.useState(n!=null?n:f),[d,C]=p.useState(!1);p.useEffect(()=>{a(n)},[n]);const h=c=>{var o;return(o=c==null?void 0:c.map(j=>{const T=u.indexOf(j);return r[T]}))!=null?o:[]},l=c=>{var o;return(o=c==null?void 0:c.map(j=>{const T=r.indexOf(j);return u[T]}))!=null?o:[]},m=()=>g,S=c=>{c!==null&&(x("multiSelectState",l(c)),a(c)),C(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{onClick:()=>C(!0),children:e.jsx(E,{primary:i,secondary:m()})}),e.jsx(ne,{title:i!=null?i:"",open:d,onClose:S,selectedValues:h(s),values:r})]})}function se(t){switch(t){case"CheckBoxPreference":return v;case"SwitchPreference":return ee;case"ListPreference":return X;case"EditTextPreference":return te;case"MultiSelectListPreference":return re;default:throw new Error('Unexpected preference type "'.concat(t,'"'))}}function xe(){var a;const{i18n:t,_:i}=k();K(t._({id:"YGe4HA"}));const{sourceId:g}=$(),{data:n,loading:f,error:x,refetch:u}=V.useGetSource(G,g,{notifyOnNetworkStatusChange:!0}),r=(a=n==null?void 0:n.source.preferences)!=null?a:[],s=d=>(C,h)=>{V.setSourcePreferences(g,{position:d,[C]:h}).response.catch(l=>J(t._({id:"cBoXe4"}),"error",w(l)))};return f?e.jsx(R,{}):x?e.jsx(z,{message:t._({id:"6m5aox"}),messageExtra:w(x),retry:()=>u().catch(H("SourceConfigure::refetch"))}):e.jsx(q,{sx:{padding:0},children:r.map((d,C)=>{const h=y(d);return p.createElement(se(d.type),{...h,updateValue:s(C)})})})}export{xe as SourceConfigure};
