import{j as e,b as u,r as j,T as x,ay as A,u as m,l as C,cS as T,H as I,B as v,a as y,d as P,S as _,C as B,I as M,A as N,L as w,x as b,m as D,g as L,aE as U,f as $,n as G,i as R,k as S}from"./index-yIGLLw12.js";import{u as z}from"./useAppTitle-CXDTsiAG.js";import{E as H}from"./EmptyViewAbsoluteCentered-CRFgOMi0.js";import{a as J}from"./Asserts-xItX73wb.js";import{S as F}from"./SpinnerImage-BMR_dHOp.js";import{M as O}from"./Metadata-Bzi9HDH8.js";import{I as V,b as h,u as X,a as q,g as Q,t as W}from"./Extensions.utils-eVnsoMzB.js";import{M as Y}from"./MUI.util-CEodEA2f.js";import{L as Z}from"./ListCardContent-CRU7ms8V.js";import{S as K}from"./StyledGroupItemWrapper-H3ts_kIq.js";import{C as ee}from"./Card-C-77ywk9.js";import{C as te}from"./CardActionArea-ddyhAnd3.js";import{S as se}from"./Switch-TBYSyjJ2.js";import"./Refresh-mEWZwT5a.js";import"./Image-BP6aIEFx.js";import"./Strings-CAV0u705.js";import"./SwitchBase-DVOVqUFS.js";const re=({name:r,pkgName:a,iconUrl:o,repo:t})=>e.jsxs(u,{sx:{alignItems:"center"},children:[e.jsx(F,{alt:r,src:j.getValidImgUrlFor(o),ignoreQueue:!0}),e.jsx(x,{variant:"h5",component:"h2",children:r}),e.jsx(x,{variant:"body2",color:"textSecondary",children:a.replace("eu.kanade.tachiyomi.extension.","")}),t&&e.jsx(x,{variant:"body2",color:"textSecondary",children:t})]}),f=({addDivider:r=!0,...a})=>{var o;return e.jsxs(e.Fragment,{children:[e.jsx(O,{...a,stackProps:{...a.stackProps,sx:{...(o=a.stackProps)==null?void 0:o.sx,flexDirection:"column-reverse",alignItems:"center",flexGrow:1,flexBasis:0}},titleProps:{...a.titleProps,variant:"body2"}}),r&&e.jsx(A,{orientation:"vertical",sx:{height:"25px"}})]})},ae=({versionName:r,lang:a,isNsfw:o})=>{const{i18n:t,_:n}=m();return e.jsxs(u,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(f,{title:t._({id:"eE0JZ4"}),value:r}),e.jsx(f,{title:t._({id:"vXIe7J"}),value:C(a)}),o&&e.jsx(f,{title:t._({id:"+2LYJm"}),value:"18+",valueProps:{color:"error"}})]})},E=({pkgName:r,isInstalled:a,isObsolete:o,hasUpdate:t})=>{const n=T(),{i18n:s,_:l}=m(),i=Q(a,o,t);return e.jsx(I,{sx:{px:1,flexGrow:1,flexBasis:0},children:e.jsx(v,{sx:{width:"100%",color:i===q.OBSOLETE?"red":"inherit"},variant:"outlined",size:"large",onClick:async()=>{const d=t&&!o?h.UPDATE:h.UNINSTALL;try{await X(r,o,d),d===h.UNINSTALL&&n()}catch(p){}},children:s._(V[i])})})},oe=r=>{const{id:a,isConfigurable:o}=r,{i18n:t,_:n}=m(),{isEnabled:s}=y(r),l=P(r,i=>D(t._({id:"cBoXe4"}),"error",L(i)));return e.jsx(K,{sx:{px:0},children:e.jsx(ee,{children:e.jsx(te,{onClick:()=>l("isEnabled",!s),children:e.jsxs(Z,{children:[e.jsx(x,{variant:"h6",component:"h3",sx:{flexGrow:1},children:W(_.getLanguage(r))}),o&&e.jsx(B,{title:t._({id:"Tz0i8g"}),children:e.jsx(M,{component:w,to:N.sources.childRoutes.configure.path(a),color:"inherit",onClick:i=>i.stopPropagation(),...Y.preventRippleProp(),children:e.jsx(b,{})})}),e.jsx(se,{checked:s})]})})})},a)},Le=()=>{var p;const{i18n:r,_:a}=m(),{pkgName:o}=U();z(r._({id:"zCIAAD"}));const t=j.useGetExtension(o),n=j.useGetSourceList(),{extension:s}=(p=t.data)!=null?p:{},l=$.useMemo(()=>{var c;return(c=n.data)!=null&&c.sources?n.data.sources.nodes.filter(g=>g.extension.pkgName===(s==null?void 0:s.pkgName)).sort((g,k)=>G(_.getLanguage(g),_.getLanguage(k))):[]},[s==null?void 0:s.pkgName,n.data]),i=t.loading||n.loading,d=t.error||n.error;return i?e.jsx(R,{}):d?e.jsx(H,{message:r._({id:"6m5aox"}),messageExtra:L(t.error),retry:()=>{t.error&&t.refetch().catch(S("ExtensionInfo::extension::refetch")),n.error&&n.refetch().catch(S("ExtensionInfo::sources::refetch"))}}):(J(s),e.jsxs(u,{sx:{gap:2},children:[e.jsx(re,{...s}),e.jsx(ae,{...s}),e.jsxs(u,{sx:{flexDirection:"row"},children:[e.jsx(E,{...s,isInstalled:!0,hasUpdate:!1}),s.hasUpdate&&e.jsx(E,{...s})]}),e.jsx(I,{sx:{px:1},children:l.map(c=>e.jsx(oe,{...c},c.id))})]}))};export{Le as ExtensionInfo};
