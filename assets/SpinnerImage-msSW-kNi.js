import{c as M,j as s,f as t,u as $,b as C,G as T,aw as H,aH as U,B as _,r as G,b9 as q}from"./index-BvpVa5sx.js";import{R as A}from"./Refresh-Dd4VKPQm.js";const Q=M(s.jsx("path",{d:"M21 5v6.59l-3-3.01-4 4.01-4-4-4 4-3-3.01V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2m-3 6.42 3 3.01V19c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-6.58l3 2.99 4-4 4 4z"})),J=M(s.jsx("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"})),N=(n,f,{ignoreInitialObserve:l=!1,root:h,rootMargin:d,threshold:u}={})=>{const[x,r]=t.useState(()=>{});return t.useLayoutEffect(()=>{const p=n instanceof HTMLElement?n:n==null?void 0:n.current;if(!p)return()=>{};let o=!0;const c=new IntersectionObserver((...m)=>{if(l&&o){o=!1;return}f(...m)},{root:h,rootMargin:d,threshold:u});return c.observe(p),r(()=>()=>c.disconnect()),()=>c.disconnect()},[n,f,l,h,d,u]),x},Y=({ref:n,...f})=>{const{shouldLoad:l=!0,shouldDecode:h,useFetchApi:d,disableCors:u,ignoreQueue:x,src:r,alt:p,onLoad:o,onError:c,spinnerStyle:{small:m,...v}={},imgStyle:g,hideImgStyle:R,priority:O,retryKeyPrefix:w}=f,{t:V}=$(),E=t.useRef(null),y=!r.length,[j,z]=t.useState(),[L,B]=t.useState(0),[I,P]=t.useState(),[b,D]=t.useState(!1),[F,K]=t.useState(!1),S=(e,i=!1,a=!1)=>{P(e),D(i),i&&!e&&!a&&(c==null||c()),!e&&!i&&!a&&(o==null||o())};return N(E,t.useCallback(e=>K(e[0].isIntersecting),[])),t.useEffect(()=>{if(y||!l)return()=>{};let e={response:Promise.resolve(""),cleanup:q,abortRequest:q,fromCache:!1};return(async()=>{try{e=await G.requestImage(r,{priority:O,shouldDecode:h,useFetchApi:d,disableCors:u,ignoreQueue:x}),e.fromCache||S(!0);const a=await e.response;e.fromCache||S(!1),z(a)}catch(a){const k=a instanceof Error&&(a.name==="AbortError"||a.message==="Component was unmounted");S(!1,!k,k)}})().catch(()=>{}),()=>{e.cleanup(),e.abortRequest(new Error("Component was unmounted"))}},[r,L,w,y,l]),s.jsxs(s.Fragment,{children:[y?s.jsx(C,{ref:n,sx:{height:"100%",alignItems:"center",justifyContent:"center",background:e=>e.palette.background.default,...v},children:s.jsx(J,{fontSize:"large"})}):s.jsx(T,{component:"img",sx:[...Array.isArray(g)?g!=null?g:[]:[g],H(!j||I||b,{...R,...H(!R,{display:"none"})})],ref:n,crossOrigin:u?void 0:"anonymous",src:j,alt:p,draggable:!1},"".concat(r,"_").concat(L,"_").concat(w)),(!!I||r&&!j||b)&&s.jsx(C,{ref:E,sx:{height:"100%",justifyContent:"center",alignItems:"center",...v},children:s.jsxs(C,{sx:{height:"100%",alignItems:"center",justifyContent:"center"},children:[F&&!!I&&s.jsx(U,{thickness:5}),b&&I===!1&&s.jsxs(s.Fragment,{children:[s.jsx(Q,{}),s.jsx(_,{startIcon:!m&&s.jsx(A,{}),onClick:e=>{e.stopPropagation(),e.preventDefault(),B(i=>(i+1)%100)},size:m?"small":"large",children:m?s.jsx(A,{}):V("global.button.retry")})]})]})})]})};export{Y as S,N as u};
