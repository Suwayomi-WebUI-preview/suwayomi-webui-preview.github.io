import{r as qe,i as He,j as r,u as z,p as Ne,c as j,K as Ge,aA as Ye,aB as Ze,g as De,az as Ie,h as _e,S as w,T as ee,ca as Xe,b5 as et,aC as tt,b as ie,m as y,bj as Oe,Q as Ee,z as rt,O as Me,s as nt,B as R,cb as Le,cc as st,bE as at,cd as it,ce as ot,I as pe,f as me,cf as ct,cg as lt,M as dt,ch as _,N as ut,d as ht,k as fe,aO as ge,as as ne,_ as se,Y as q,ci as Ce}from"./index-Je3UZ9Jv.js";import{S as be}from"./Select-BpKHkFRL.js";import{N as pt}from"./NumberSetting-COYBiu1s.js";import{b as mt}from"./language-BoUf7COd.js";import{T as ft}from"./Trans-Cv2F9IKU.js";import{L as Be}from"./Link-DxnfGKAJ.js";import{T as xe}from"./TextField-CfdcWX22.js";import{d as gt}from"./CheckCircle-BHr5_nx1.js";import{d as Ct}from"./Delete-BrRpAAnj.js";import{d as bt}from"./Edit-Cql3-T3S.js";import{C as xt}from"./Card-BXUBJcWT.js";import{C as jt}from"./CardActionArea-BXsNniyT.js";import{S as At}from"./Switch-CPfx0TSY.js";import"./Info-eEEGs9dj.js";import"./InputAdornment-DqHabHpM.js";import"./SwitchBase-Do1dSKAy.js";var ce={},wt=He;Object.defineProperty(ce,"__esModule",{value:!0});var Re=ce.default=void 0,vt=wt(qe()),Tt=r;Re=ce.default=(0,vt.default)((0,Tt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddCircle");class B extends Error{constructor(t,n){super(t+" at position "+n),this.position=n}}const H=92,ae=47,St=42,je=123,G=125,Ae=91,Y=93,yt=40,kt=41,Nt=32,le=10,We=9,Pe=13,Dt=8,It=12,te=34,we=43,ve=45,Fe=39,Qe=48,Ve=57,O=44,Z=46,_t=58,Ot=59,Et=65,Mt=97,Lt=69,Bt=101,Rt=70,Wt=102,Pt=160,Ft=8192,Qt=8202,Vt=8239,Ut=8287,Kt=12288,Jt=8220,zt=8221,$t=8216,qt=8217,Ht=96,Gt=180;function Yt(e){return e>=Qe&&e<=Ve||e>=Et&&e<=Rt||e>=Mt&&e<=Wt}function E(e){return e>=Qe&&e<=Ve}function Zt(e){return e>=32&&e<=1114111}function W(e){return Xt.test(e)}const Xt=/^[,:[\]/{}()\n+]$/;function er(e){return W(e)&&e!=="/"}function Te(e){return tr.test(e)||e&&X(e.charCodeAt(0))}const tr=/^[[{\w-]$/;function rr(e){return e===le||e===Pe||e===We||e===Dt||e===It}function P(e){return e===Nt||e===le||e===We||e===Pe}function nr(e){return e===Pt||e>=Ft&&e<=Qt||e===Vt||e===Ut||e===Kt}function X(e){return Ue(e)||oe(e)}function Ue(e){return e===te||e===Jt||e===zt}function Se(e){return e===te}function oe(e){return e===Fe||e===$t||e===qt||e===Ht||e===Gt}function ye(e){return e===Fe}function K(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.lastIndexOf(t);return i!==-1?e.substring(0,i)+(n?"":e.substring(i+1)):e}function A(e,t){let n=e.length;if(!P(e.charCodeAt(n-1)))return e+t;for(;P(e.charCodeAt(n-1));)n--;return e.substring(0,n)+t+e.substring(n)}function sr(e,t,n){return e.substring(0,t)+e.substring(t+n)}function ar(e){return/[,\n][ \t\r]*$/.test(e)}function ir(e){return/^\w+$/.test(e)}const or={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},cr={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"};function lr(e){let t=0,n="";p()||Je();const m=c(O);for(m&&o(),Te(e[t])&&ar(n)?(m||(n=A(n,",")),F()):m&&(n=K(n,","));e.charCodeAt(t)===G||e.charCodeAt(t)===Y;)t++,o();if(t>=e.length)return n;ue();function p(){o();const s=T()||g()||S()||re()||x()||k();return o(),s}function o(){const s=t;let a=l();do a=b(),a&&(a=l());while(a);return t>s}function l(){let s="",a;for(;(a=P(e.charCodeAt(t)))||nr(e.charCodeAt(t));)a?s+=e[t]:s+=" ",t++;return s.length>0?(n+=s,!0):!1}function b(){if(e.charCodeAt(t)===ae&&e.charCodeAt(t+1)===St){for(;t<e.length&&!dr(e,t);)t++;return t+=2,!0}if(e.charCodeAt(t)===ae&&e.charCodeAt(t+1)===ae){for(;t<e.length&&e.charCodeAt(t)!==le;)t++;return!0}return!1}function c(s){return e.charCodeAt(t)===s?(n+=e[t],t++,!0):!1}function u(s){return e.charCodeAt(t)===s?(t++,!0):!1}function h(){return u(H)}function M(){return o(),e.charCodeAt(t)===Z&&e.charCodeAt(t+1)===Z&&e.charCodeAt(t+2)===Z?(t+=3,o(),u(O),!0):!1}function T(){if(e.charCodeAt(t)===je){n+="{",t++,o(),u(O)&&o();let s=!0;for(;t<e.length&&e.charCodeAt(t)!==G;){let a;if(s?(a=!0,s=!1):(a=c(O),a||(n=A(n,",")),o()),M(),!(S()||k())){e.charCodeAt(t)===G||e.charCodeAt(t)===je||e.charCodeAt(t)===Y||e.charCodeAt(t)===Ae||e[t]===void 0?n=K(n,","):ze();break}o();const V=c(_t),L=t>=e.length;V||(Te(e[t])||L?n=A(n,":"):he()),p()||(V||L?n+="null":he())}return e.charCodeAt(t)===G?(n+="}",t++):n=A(n,"}"),!0}return!1}function g(){if(e.charCodeAt(t)===Ae){n+="[",t++,o(),u(O)&&o();let s=!0;for(;t<e.length&&e.charCodeAt(t)!==Y;)if(s?s=!1:c(O)||(n=A(n,",")),M(),!p()){n=K(n,",");break}return e.charCodeAt(t)===Y?(n+="]",t++):n=A(n,"]"),!0}return!1}function F(){let s=!0,a=!0;for(;a;)s?s=!1:c(O)||(n=A(n,",")),a=p();a||(n=K(n,",")),n="[\n".concat(n,"\n]")}function S(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=e.charCodeAt(t)===H;if(a&&(t++,a=!0),X(e.charCodeAt(t))){const D=Se(e.charCodeAt(t))?Se:ye(e.charCodeAt(t))?ye:oe(e.charCodeAt(t))?oe:Ue,V=t,L=n.length;let d='"';for(t++;;){if(t>=e.length){const f=v(t-1);return!s&&W(e.charAt(f))?(t=V,n=n.substring(0,L),S(!0)):(d=A(d,'"'),n+=d,!0)}else if(D(e.charCodeAt(t))){const f=t,I=d.length;if(d+='"',t++,n+=d,o(),s||t>=e.length||W(e.charAt(t))||X(e.charCodeAt(t))||E(e.charCodeAt(t)))return $(),!0;if(W(e.charAt(v(f-1))))return t=V,n=n.substring(0,L),S(!0);n=n.substring(0,L),t=f+1,d=d.substring(0,I)+"\\"+d.substring(I)}else{if(s&&W(e[t]))return d=A(d,'"'),n+=d,$(),!0;if(e.charCodeAt(t)===H){const f=e.charAt(t+1);if(cr[f]!==void 0)d+=e.slice(t,t+2),t+=2;else if(f==="u"){let U=2;for(;U<6&&Yt(e.charCodeAt(t+U));)U++;U===6?(d+=e.slice(t,t+6),t+=6):t+U>=e.length?t=e.length:$e()}else d+=f,t+=2}else{const f=e.charAt(t),I=e.charCodeAt(t);I===te&&e.charCodeAt(t-1)!==H?(d+="\\"+f,t++):rr(I)?(d+=or[f],t++):(Zt(I)||de(f),d+=f,t++)}}a&&h()}}return!1}function $(){let s=!1;for(o();e.charCodeAt(t)===we;){s=!0,t++,o(),n=K(n,'"',!0);const a=n.length;S()?n=sr(n,a,1):n=A(n,'"')}return s}function re(){const s=t;if(e.charCodeAt(t)===ve){if(t++,N())return Q(s),!0;if(!E(e.charCodeAt(t)))return t=s,!1}for(;E(e.charCodeAt(t));)t++;if(e.charCodeAt(t)===Z){if(t++,N())return Q(s),!0;if(!E(e.charCodeAt(t)))return t=s,!1;for(;E(e.charCodeAt(t));)t++}if(e.charCodeAt(t)===Bt||e.charCodeAt(t)===Lt){if(t++,(e.charCodeAt(t)===ve||e.charCodeAt(t)===we)&&t++,N())return Q(s),!0;if(!E(e.charCodeAt(t)))return t=s,!1;for(;E(e.charCodeAt(t));)t++}if(!N())return t=s,!1;if(t>s){const a=e.slice(s,t),D=/^0\d/.test(a);return n+=D?'"'.concat(a,'"'):a,!0}return!1}function x(){return C("true","true")||C("false","false")||C("null","null")||C("True","true")||C("False","false")||C("None","null")}function C(s,a){return e.slice(t,t+s.length)===s?(n+=a,t+=s.length,!0):!1}function k(){const s=t;for(;t<e.length&&!er(e[t])&&!X(e.charCodeAt(t));)t++;if(t>s){if(e.charCodeAt(t)===yt&&ir(e.slice(s,t).trim()))return t++,p(),e.charCodeAt(t)===kt&&(t++,e.charCodeAt(t)===Ot&&t++),!0;{for(;P(e.charCodeAt(t-1))&&t>0;)t--;const a=e.slice(s,t);return n+=a==="undefined"?"null":JSON.stringify(a),e.charCodeAt(t)===te&&t++,!0}}}function v(s){let a=s;for(;a>0&&P(e.charCodeAt(a));)a--;return a}function N(){return t>=e.length||W(e[t])||P(e.charCodeAt(t))}function Q(s){n+=e.slice(s,t)+"0"}function de(s){throw new B("Invalid character "+JSON.stringify(s),t)}function ue(){throw new B("Unexpected character "+JSON.stringify(e[t]),t)}function Je(){throw new B("Unexpected end of json string",e.length)}function ze(){throw new B("Object key expected",t)}function he(){throw new B("Colon expected",t)}function $e(){const s=e.slice(t,t+6);throw new B('Invalid unicode character "'.concat(s,'"'),t)}}function dr(e,t){return e[t]==="*"&&e[t+1]==="/"}const ur={id:"",isCustom:!0,getName:()=>"",muiTheme:{palette:{primary:{main:"#1976d2"},secondary:{main:"#9c27b0"}}}},J={create:{title:"settings.appearance.theme.create.title",button:"global.button.ok",action:"settings.appearance.theme.create.action",success:"settings.appearance.theme.create.success",failure:"settings.appearance.theme.create.failure"},edit:{title:"settings.appearance.theme.edit.title",button:"global.button.save",action:"settings.appearance.theme.edit.action",success:"settings.appearance.theme.edit.success",failure:"settings.appearance.theme.edit.failure"}},Ke=({bindDialogProps:e,mode:t,appTheme:n=ur})=>{const{t:i}=z(),{settings:{customThemes:m},request:{loading:p,error:o,refetch:l}}=Ne(),b=Oe(x=>{throw x}),[c,u]=j.useState(n),[h,M]=j.useState(!1),[T,g]=j.useState(!1),[F,S]=j.useState(!1),[$,re]=j.useState(t==="create");return r.jsxs(Ge,{...e,fullWidth:!0,maxWidth:"md",children:[r.jsx(Ye,{children:i(J[t].title)}),r.jsxs(Ze,{children:[p&&r.jsx(De,{}),o&&r.jsx(Ie,{message:i("global.error.label.failed_to_load_data"),messageExtra:o.message,retry:()=>l().catch(_e())}),!o&&r.jsxs(w,{sx:{gap:2},children:[r.jsx(ee,{children:r.jsxs(ft,{i18nKey:"settings.appearance.theme.create.dialog.info.creating_theme",children:["Create a custom theme with the"," ",r.jsx(Be,{href:"https://zenoo.github.io/mui-theme-creator/",target:"_blank",rel:"noreferrer",children:"MUI Theme Creator"})," ",', copy everything after "themeOptions" from "',"{",'" to "',"}",'" and paste it into the "theme" text field.']})}),r.jsx(ee,{children:i("settings.appearance.theme.create.dialog.info.theme_mode_lock")}),r.jsx(xe,{disabled:t==="edit",label:i("settings.appearance.theme.create.dialog.theme_name"),value:c.getName(),error:h,helperText:h&&i("settings.appearance.theme.create.dialog.error.invalid_name"),onChange:x=>{const C=x.target.value.trim(),k=C.length<=16,v=Xe(C,m);M(!k||!v),u({...c,id:x.target.value,getName:()=>x.target.value})}}),r.jsx(xe,{label:i("settings.appearance.theme.title"),multiline:!0,error:T,helperText:T&&i("settings.appearance.theme.create.dialog.error.invalid_json"),defaultValue:JSON.stringify(c.muiTheme,null,2),onChange:x=>{const C="invalid",k=(()=>{try{return lr(x.target.value)}catch(ue){return C}})(),v=et(k),N=k===C||!v,Q=JSON.stringify(v)!==JSON.stringify(n.muiTheme);re(t==="create"?!0:Q),g(N),!N&&JSON.stringify(v)!==JSON.stringify(c.muiTheme)&&u({...c,muiTheme:v})}})]})]}),r.jsxs(tt,{children:[r.jsx(ie,{autoFocus:!0,onClick:e.onClose,color:"primary",children:i("global.button.cancel")}),r.jsx(ie,{disabled:T||h||F||!$||!c.id.length,onClick:x=>{y(i(J[t].action,{theme:c.getName()}),"info"),S(!0),b("customThemes",{...m,[c.id]:c}).then(()=>{y(i(J[t].success,{theme:c.getName()}),"success"),e.onClose(x)}).catch(()=>y(i(J[t].failure,{theme:c.getName()}),"error")).finally(()=>S(!1))},color:"primary",children:i(J[t].button)})]})]})},hr=()=>{const{t:e}=z(),t=Ee({variant:"popover",popupId:"theme-creation-dialog"});return r.jsxs(r.Fragment,{children:[r.jsxs(w,{sx:{alignItems:"center",gap:1},children:[r.jsx(ie,{sx:{minWidth:"150px",maxWidth:"150px",height:"225px"},variant:"contained",size:"large",...rt(t),children:r.jsx(Re,{})}),r.jsx(ee,{children:e("settings.appearance.theme.create.title")})]}),t.isOpen&&r.jsx(Ke,{bindDialogProps:Me(t),mode:"create"})]})},ke=nt(R)(()=>({width:"15px",height:"20px"})),pr=({theme:e,onDelete:t})=>{const{getName:n}=e,{t:i}=z(),{themeMode:m,setAppTheme:p,appTheme:o,pureBlackMode:l}=j.useContext(Le),b=Ee({variant:"popover",popupId:"theme-edit-dialog-".concat(e.id)}),c=e.id===o,u=j.useMemo(()=>st(m,e,l),[e,m,l]);return r.jsxs(r.Fragment,{children:[r.jsxs(w,{sx:{justifyContent:"center",alignItems:"center",minWidth:"150px",maxWidth:"150px",gap:1},children:[r.jsx(at,{theme:u,children:r.jsxs(xt,{sx:{width:"100%",height:"225px",position:"relative"},children:[r.jsx(R,{sx:{position:"absolute",top:0,right:0,bottom:0,left:0,border:"4px solid",borderColor:c?u.palette.primary.light:u.palette.background.paper,zIndex:1,pointerEvents:"none",borderRadius:1}}),r.jsx(jt,{sx:{height:"100%",backgroundColor:"background.default"},onClick:()=>{if(!it(e.muiTheme)){p(e.id);return}y(i("settings.appearance.theme.select.fonts.loading"),"info"),ot(e.muiTheme).then(()=>p(e.id)).catch(()=>y(i("settings.appearance.theme.select.fonts.error"),"error"))},children:r.jsxs(w,{sx:{height:"100%",m:0},children:[r.jsxs(w,{sx:{height:"100%",gap:2,p:2},children:[r.jsxs(w,{sx:{maxHeight:"20px",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[r.jsx(R,{sx:{width:"65%",height:"20px",backgroundColor:"primary.dark",borderRadius:1}}),r.jsxs(w,{sx:{height:"100%",alignItems:"center",gap:1},children:[c&&r.jsx(gt,{sx:{visibility:c?"visible":"hidden",color:"primary.light"}}),!c&&e.isCustom&&r.jsx(pe,{onClick:h=>{h.preventDefault(),h.stopPropagation(),t()},component:"div",size:"small",children:r.jsx(me,{title:i("global.button.delete"),children:r.jsx(Ct,{})})}),e.isCustom&&r.jsx(pe,{onClick:h=>{h.preventDefault(),h.stopPropagation(),b.open()},component:"div",size:"small",children:r.jsx(me,{title:i("global.button.edit"),children:r.jsx(bt,{})})})]})]}),r.jsx(R,{sx:{width:"55%",height:"65%",backgroundColor:"background.paper",p:1,borderRadius:1},children:r.jsxs(w,{sx:{width:"max-content",flexDirection:"row",overflow:"hidden",borderRadius:1},children:[r.jsx(ke,{sx:{backgroundColor:"primary.main"}}),r.jsx(ke,{sx:{backgroundColor:"secondary.main"}})]})})]}),r.jsxs(w,{sx:{height:"25%",backgroundColor:u.palette.background.paper,alignItems:"center",flexDirection:"row",gap:2,p:2},children:[r.jsx(R,{sx:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"primary.main"}}),r.jsx(R,{sx:{flexGrow:1,height:"20px",borderRadius:1,backgroundColor:"primary.light"}})]})]})})]})}),r.jsx(ee,{children:n()})]}),r.jsx(Ke,{bindDialogProps:Me(b),mode:"edit",appTheme:e})]})},mr=()=>{const{t:e}=z(),{settings:{customThemes:t},request:{loading:n,error:i,refetch:m}}=Ne(),p=j.useMemo(()=>[...ct,...Object.values(t).map(l=>({...l,getName:()=>l.id}))],[t]),o=Oe(l=>{throw l});return n?r.jsx(De,{}):i?r.jsx(Ie,{message:e("global.error.label.failed_to_load_data"),messageExtra:i.message,retry:()=>m().catch(_e())}):r.jsxs(w,{sx:{flexDirection:"row",flexWrap:"no-wrap",overflowX:"auto",gap:1,mx:2},children:[r.jsx(hr,{}),p.map(l=>r.jsx(pr,{theme:l,onDelete:()=>{y(e("settings.appearance.theme.delete.action",{theme:l.getName()}),"info"),o("customThemes",Object.fromEntries(Object.entries(t).filter(([b])=>b!==l.id))).then(()=>y(e("settings.appearance.theme.delete.success",{theme:l.getName()}),"success")).catch(()=>y(e("settings.appearance.theme.delete.failure",{theme:l.getName()}),"error"))}},l.id))]})},_r=()=>{var T;const{t:e,i18n:t}=z(),{themeMode:n,setThemeMode:i,pureBlackMode:m,setPureBlackMode:p,appTheme:o}=j.useContext(Le),l=((T=lt(o).muiTheme.palette)==null?void 0:T.mode)==="dark"||dt.getThemeMode()===_.DARK,{setTitle:b,setAction:c}=j.useContext(ut);j.useEffect(()=>(b(e("settings.appearance.title")),c(null),()=>{b(""),c(null)}),[e]);const u=300,[h,M]=ht("ItemWidth",u);return r.jsxs(fe,{subheader:r.jsx(ge,{component:"div",id:"appearance-theme",children:e("settings.appearance.theme.title")}),children:[r.jsxs(ne,{children:[r.jsx(se,{primary:e("settings.appearance.theme.device_theme")}),r.jsxs(be,{value:n,onChange:g=>i(g.target.value),children:[r.jsx(q,{value:_.SYSTEM,children:"System"},_.SYSTEM),r.jsx(q,{value:_.DARK,children:"Dark"},_.DARK),r.jsx(q,{value:_.LIGHT,children:"Light"},_.LIGHT)]})]}),r.jsx(mr,{}),l&&r.jsxs(ne,{children:[r.jsx(se,{primary:e("settings.appearance.theme.pure_black_mode")}),r.jsx(At,{checked:m,onChange:(g,F)=>p(F)})]}),r.jsxs(fe,{subheader:r.jsx(ge,{component:"div",id:"appearance-theme",children:e("global.label.display")}),children:[r.jsxs(ne,{children:[r.jsx(se,{primary:e("global.language.label.language"),secondary:r.jsxs(r.Fragment,{children:[r.jsxs("span",{children:[e("settings.label.language_description")," "]}),r.jsx(Be,{href:"https://hosted.weblate.org/projects/suwayomi/suwayomi-webui",target:"_blank",rel:"noreferrer",children:e("global.language.title.weblate")})]})}),r.jsx(be,{value:Ce.includes(t.language)?t.language:"en",onChange:({target:{value:g}})=>t.changeLanguage(g),children:Ce.map(g=>r.jsx(q,{value:g,children:mt(g)},g))})]}),r.jsx(pt,{settingTitle:e("settings.label.manga_item_width"),settingValue:"px: ".concat(h),value:h,defaultValue:u,minValue:100,maxValue:1e3,stepSize:10,valueUnit:"px",showSlider:!0,handleUpdate:M})]})]})};export{_r as Appearance};
