!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}var n=["id","mode","searchParams"],t=["id"];function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",l=t.toStringTag||"@@toStringTag";function a(t,r,i,l){var a=r&&r.prototype instanceof c?r:c,s=Object.create(a.prototype);return o(s,"_invoke",function(t,r,o){var i,l,a,c=0,s=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return i=n,l=0,a=e,f.n=t,u}};function m(t,r){for(l=t,a=r,n=0;!d&&c&&!o&&n<s.length;n++){var o,i=s[n],m=f.p,v=i[2];t>3?(o=v===r)&&(a=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=m&&((o=t<2&&m<i[1])?(l=0,f.v=r,f.n=i[1]):m<v&&(o=t<3||i[0]>r||r>v)&&(i[4]=t,i[5]=r,f.n=v,l=0))}if(o||t>1)return u;throw d=!0,r}return function(o,s,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&m(s,v),l=s,a=v;(n=l<2?e:a)||!d;){i||(l?l<3?(l>1&&(f.n=-1),m(l,a)):f.n=a:f.v=a);try{if(c=2,i){if(l||(o="next"),n=i[o]){if(!(n=n.call(i,a)))throw TypeError("iterator result is not an object");if(!n.done)return n;a=n.value,l<2&&(l=0)}else 1===l&&(n=i.return)&&n.call(i),l<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((n=(d=f.n<0)?a:t.call(r,f))!==u)break}catch(n){i=e,l=1,a=n}finally{c=1}}return{value:n,done:d}}}(t,i,l),!0),s}var u={};function c(){}function s(){}function d(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(o(n={},i,function(){return this}),n),m=d.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,l,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=d,o(m,"constructor",d),o(d,"constructor",s),s.displayName="GeneratorFunction",o(d,l,"GeneratorFunction"),o(m),o(m,l,"Generator"),o(m,i,function(){return this}),o(m,"toString",function(){return"[object Generator]"}),(r=function(){return{w:a,m:v}})()}function o(e,n,t,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,n,t,r){function l(n,t){o(e,n,function(e){return this._invoke(n,t,e)})}n?i?i(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(l("next",0),l("throw",1),l("return",2))},o(e,n,t,r)}function i(e,n,t,r,o,i,l){try{var a=e[i](l),u=a.value}catch(e){return void t(e)}a.done?n(u):Promise.resolve(u).then(r,o)}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach(function(n){c(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function c(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var o=r.call(n,t||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function s(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,l,a=[],u=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=i.call(t)).done)&&(a.push(r.value),a.length!==n);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,n)||f(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,n){if(e){if("string"==typeof e)return m(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?m(e,n):void 0}}function m(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}System.register(["./index-legacy-CRNBsRAD.js","./EmptyViewAbsoluteCentered-legacy-BOhfrj6H.js","./Asserts-legacy-DW7YtAIt.js","./useAppTitle-legacy-kPomSzM6.js","./Delete-legacy-DOkRolCi.js","./Select-legacy-CWsKK8oW.js","./use-resize-observer-legacy-D69LEIab.js"],function(e,o){"use strict";var a,f,m,v,p,h,g,b,y,x,j,w,S,T,O,P,D,A,C,_,I,E,k,L,G,U,F,N,W,M,B,R,K,z,H,J,Q,V,$,q,X;return{setters:[function(e){a=e.bE,f=e.bF,m=e.bG,v=e.bH,p=e.bI,h=e.bJ,g=e.bK,b=e.bL,y=e.aN,x=e.bM,j=e.u,w=e.ap,S=e.j,T=e.b,O=e.b9,P=e.bN,D=e.C,A=e.I,C=e.au,_=e.T,I=e.B,E=e.bj,k=e.f,L=e.bO,G=e.bf,U=e.bg,F=e.bP,N=e.aA,W=e.bQ,M=e.r,B=e.i,R=e.g,K=e.k,z=e.bR,H=e.m},function(e){J=e.E},function(e){Q=e.a},function(e){V=e.u},function(e){$=e.D},function(e){q=e.S},function(e){X=e.u}],execute:function(){var o=0,Y=function(e){return e.replace(m,"")},Z=function(e){return Y(e.toLowerCase().trim())===a},ee=function(e,n,t){var r;return null!==(r=null==t?void 0:t.slice(0,n).some(function(n){return n.name===e}))&&void 0!==r&&r},ne=function(e){var n;return null!==(n=null==e?void 0:e.some(function(n,t){return ee(n.name,t,e)}))&&void 0!==n&&n},te=function(e,n,t){return t.slice(0,n).some(function(n){return n.mimeType===e})},re=function(e){return""!==e&&!!e.match(/^https?:\/\/.+/)},oe=function(e,n,t){return null==e||e>=n&&e<=t},ie=function(e){return oe(e?y(e).seconds.inWholeSeconds:null,b.min,b.max)},le=function(e){return oe(e?y(e).seconds.inWholeSeconds:null,x.min,x.max)},ae=function(e){return oe(e,g.min,g.max)},ue=function(e){return e.some(function(n,t){var r=n.mimeType,o=n.compressionLevel,i=n.target,l=n.callTimeout,a=n.connectTimeout,u=n.headers,c=n.searchParams,s=n.mode;return function(e,n){return""===e&&""===n}(r,i)||function(e,n,t){return!(Z(t)&&!e||n!==f.URL||re(e))}(i,s,r)||!ae(o)||!ie(l)||!le(a)||te(r,t,e)||ne(u)||ne(c)})},ce=function(e){return e.map(function(e){var n;return u({id:null!==(n=e.id)&&void 0!==n?n:o++},e)})},se=function(e){return e.map(function(e){var n,t,r,i,l,a;return u(u({id:null!==(n=e.id)&&void 0!==n?n:o++},e),{},{mode:(l=Y(e.target),a=Y(l),a===v?f.DISABLED:re(a)?f.URL:f.IMAGE),headers:e.headers?ce(e.headers):null,searchParams:ce((t=e.target,i=p.asUrl(t),d((null!==(r=null==i?void 0:i.searchParams)&&void 0!==r?r:[]).entries()).map(function(e){var n,t=s(e,2),r=t[0],o=t[1];return{name:String(r),value:null!==(n=h(o))&&void 0!==n?n:o}})))})})},de=function(e){return e.map(function(e){return u(u({},e),{},{mimeType:Y(e.mimeType),target:Y(e.target)})})},fe=function(e){return e.filter(function(e){var n=e.mimeType,t=e.target;return!!n&&!!t}).map(function(e){e.id,e.mode,e.searchParams;var r,o,i,c=l(e,n);return u(u({},c),{},{mimeType:(i=c.mimeType,Z(i)?a:"".concat(m).concat(i)),target:re(c.target)?c.target:"".concat(m).concat(c.target),headers:null!==(r=null===(o=c.headers)||void 0===o?void 0:o.map(function(e){e.id;return l(e,t)}))&&void 0!==r?r:null})})},me=function(e){var n=e.some(function(e){var n=e.mimeType;return Z(n)});return[].concat(d(n?[]:[{id:-1,mode:f.IMAGE,mimeType:a,target:"",compressionLevel:null,headers:null,callTimeout:null,connectTimeout:null}]),d(e))},ve=function(e){return null==e?void 0:e.filter(function(e){return""!==e.name})},pe=function(e){var n=e.id,t=e.name,r=e.value,o=e.onChange,i=e.isDuplicate,l=j().t,a=w();return S.jsxs(T,{sx:{gap:1,flexDirection:"row",flexWrap:"nowrap",alignItems:"center"},children:[S.jsxs(T,{sx:c({flexDirection:"row",gap:2},a.breakpoints.down("md"),{flexDirection:"column",width:"100%"}),children:[S.jsx(O,{autoFocus:!0,sx:{width:P},label:l("download.settings.conversion.headers.name"),value:t,error:i,helperText:i&&l("global.error.label.invalid_input"),onChange:function(e){return o({id:n,name:e.target.value,value:r})}}),S.jsx(O,{sx:{width:P},label:l("download.settings.conversion.headers.value"),value:r,onChange:function(e){return o({id:n,name:t,value:e.target.value})}})]}),S.jsx(D,{disabled:!1,title:l("chapter.action.download.delete.label.action"),children:S.jsx(A,{onClick:function(){o(null)},children:S.jsx($,{})})})]})},he=function(e){var n=e.title,t=e.open,r=e.items,o=e.onChange,i=j().t;return S.jsx(C,{in:t,children:S.jsxs(T,{sx:{justifyContent:"start",gap:2,pt:2},children:[S.jsx(_,{children:n}),null==r?void 0:r.map(function(e,n){return S.jsx(pe,u(u({},e),{},{isDuplicate:ee(e.name,n,r),onChange:function(e){o(null==e?null==r?void 0:r.toSpliced(n,1):(null!=r?r:[]).toSpliced(n,1,e))}}),e.id)}),S.jsx(I,{onClick:function(){return o([].concat(d(null!=r?r:[]),d(ce([{name:"",value:""}]))))},variant:"contained",sx:{width:"fit-content"},children:i("global.button.add")})]})})},ge=function(e){var n=e.shouldAutoFocus,t=e.isDefault,r=e.isDuplicate,o=e.label,i=e.value,l=e.onUpdate,a=e.mode,u=j().t,c=a===f.IMAGE,s=!i.length||re(i),d=!r&&(c||s);return S.jsx(O,{sx:{width:P},autoFocus:n,label:o,value:i,disabled:t,error:!d,helperText:!d&&u("global.error.label.invalid_input"),slotProps:{input:{startAdornment:S.jsx(E,{position:"start",children:c?m:null})}},onChange:function(e){return l(e.target.value.trim())}})},be=function(e){var n,t,r=e.conversion,o=e.conversion,i=o.mode,l=o.mimeType,a=o.target,m=o.compressionLevel,h=o.headers,C=o.searchParams,_=o.callTimeout,W=o.connectTimeout,M=e.onChange,B=e.isDuplicate,R=j().t,K=w(),z=X(),H=z.ref,J=z.height,Q=s(k.useState(!0),2),V=Q[0],Y=Q[1],ee=s(k.useState(!0),2),ne=ee[0],te=ee[1],oe=i===f.DISABLED,ue=i===f.IMAGE,se=i===f.URL,de=ie(_),fe=le(W),me=ae(m),ve=Z(l)&&!B,pe=ve&&!a&&null==m;return S.jsxs(T,{children:[S.jsxs(T,{sx:{gap:1,flexDirection:"row",flexWrap:"nowrap",alignItems:"center",pt:1},children:[S.jsxs(T,{sx:c({gap:1,flexDirection:"row",alignItems:"baseline",flexWrap:"wrap"},K.breakpoints.down("md"),{flexDirection:"column",width:"100%"}),children:[S.jsx(ge,{mode:f.IMAGE,shouldAutoFocus:!0,isDefault:ve,isDuplicate:B,label:R("download.settings.conversion.mime_type"),value:l,onUpdate:function(e){M(u(u({},r),{},{mimeType:e}))}}),S.jsx(L,{sx:c({},K.breakpoints.up("md"),{mx:1}),children:"â†’"}),S.jsxs(G,{sx:{minWidth:"100px"},children:[S.jsx(U,{id:"image-conversion-target-mode-label",children:R("download.settings.conversion.target_modes.title")}),S.jsx(q,{ref:H,id:"image-conversion-target-mode",labelId:"image-conversion-target-mode-label",label:R("download.settings.conversion.target_modes.title"),value:i,onChange:function(e){se||(Y(!0),te(!0)),M(u(u({},r),{},{mode:e.target.value,target:e.target.value===f.DISABLED?v:"",headers:se?h:null,searchParams:se?C:null}))},children:F.map(function(e){var n=s(e,2),t=n[0],r=n[1].text;return S.jsx(N,{value:t,children:R(r)},t)})})]}),!oe&&S.jsx(ge,{mode:i,shouldAutoFocus:!1,isDefault:!1,isDuplicate:!1,label:R("download.settings.conversion.target"),value:a,onUpdate:function(e){var n,t,o,i,l,a;M(u(u({},r),{},{target:e,searchParams:ue?null:(n=e,t=C,l=p.asUrl(n),a=d(null!==(o=null==l||null===(i=l.searchParams)||void 0===i?void 0:i.entries())&&void 0!==o?o:[]).map(function(e){var n=s(e,2);return{name:n[0],value:n[1]}}).map(function(e){var n=null==t?void 0:t.find(function(n){return n.name===e.name});return u({id:null==n?void 0:n.id},e)}),ce(a))}))}}),oe?null:ue?S.jsx(O,{sx:{width:P},label:R("download.settings.conversion.compression_level"),value:null!=m?m:"",type:"number",error:!me,helperText:me?"":R("global.error.label.invalid_input"),slotProps:{input:{inputProps:g}},onChange:function(e){M(u(u({},r),{},{compressionLevel:e.target.value?Number(e.target.value):null}))}}):S.jsxs(S.Fragment,{children:[S.jsx(O,{sx:{width:P},label:R("download.settings.conversion.call_timeout"),value:_?y(_).seconds.inWholeSeconds:"",type:"number",error:!de,helperText:de?"":R("global.error.label.invalid_input"),slotProps:{input:{inputProps:b,endAdornment:S.jsx(E,{position:"end",children:R("global.date.label.second_other")})}},onChange:function(e){M(u(u({},r),{},{callTimeout:e.target.value?y(Number(e.target.value)).seconds.toISOString():null}))}}),S.jsx(O,{sx:{width:P},label:R("download.settings.conversion.connect_timeout"),value:W?y(W).seconds.inWholeSeconds:"",type:"number",error:!fe,helperText:fe?"":R("global.error.label.invalid_input"),slotProps:{input:{inputProps:x,endAdornment:S.jsx(E,{position:"end",children:R("global.date.label.second_other")})}},onChange:function(e){M(u(u({},r),{},{connectTimeout:e.target.value?y(Number(e.target.value)).seconds.toISOString():null}))}}),S.jsx(I,{disabled:!re(a),onClick:function(){return Y(!V)},variant:V?"outlined":"contained",sx:{height:J},children:R("download.settings.conversion.search_params.button",{count:null!==(n=null==C?void 0:C.length)&&void 0!==n?n:0})}),S.jsx(I,{onClick:function(){return te(!ne)},variant:ne?"outlined":"contained",sx:{height:J},children:R("download.settings.conversion.headers.button",{count:null!==(t=null==h?void 0:h.length)&&void 0!==t?t:0})})]})]}),S.jsx(D,{disabled:pe,title:R("chapter.action.download.delete.label.action"),children:S.jsx(A,{disabled:pe,onClick:function(){M(null)},children:S.jsx($,{})})})]}),S.jsx(he,{title:R("download.settings.conversion.search_params.title"),open:se&&!V,items:C,onChange:function(e){var n,t,o=null!==(n=null==a?void 0:a.split("?")[0])&&void 0!==n?n:"",i=Object.fromEntries(null!==(t=null==e?void 0:e.map(function(e){return[e.name,e.value]}))&&void 0!==t?t:[]);M(u(u({},r),{},{target:p.addParams(o,i),searchParams:e}))}}),S.jsx(he,{title:R("download.settings.conversion.headers.title"),open:se&&!ne,items:h,onChange:function(e){return M(u(u({},r),{},{headers:e}))}})]})};e("ImageProcessingSetting",function(e){var n,t,o=e.type,l=j().t;V(l(W[o]));var a=M.useGetServerSettings({notifyOnNetworkStatusChange:!0}),u=a.data,f=a.loading,m=a.error,p=a.refetch,h=s(M.useUpdateServerSettings(),1)[0];if(f)return S.jsx(B,{});if(m)return S.jsx(J,{message:l("global.error.label.failed_to_load_data"),messageExtra:R(m),retry:function(){return p().catch(K())}});var g=z[o];Q(null==u||null===(n=u.settings)||void 0===n?void 0:n[g]);var b=null==u||null===(t=u.settings)||void 0===t?void 0:t[g],y=s(k.useState(de(me(se(b)))),2),x=y[0],w=y[1],O=ue(x),P=function(e,n){return e.length!==n.length||e.some(function(e,t){var r,o,i=e.mimeType,l=e.target,a=e.compressionLevel,u=e.callTimeout,c=e.connectTimeout,s=e.headers,d=n[t],f=ve(s),m=ve(d.headers);return Y(i)!==d.mimeType||Y(l)!==d.target||a!==d.compressionLevel||u!==d.callTimeout||c!==d.connectTimeout||(null!==(r=null==f?void 0:f.length)&&void 0!==r?r:0)!==(null!==(o=null==m?void 0:m.length)&&void 0!==o?o:0)||!(null==f||!f.some(function(e,n){var t,r;return e.name!==(null==m||null===(t=m[n])||void 0===t?void 0:t.name)||e.value!==(null==m||null===(r=m[n])||void 0===r?void 0:r.value)}))})}(de(me(se(b))),x),D=function(e){var n=h({variables:{input:{settings:c({},g,e)}}});return n.catch(function(e){return H(l("global.error.label.failed_to_save_changes"),"error",R(e))}),n},A=function(){var e,n=(e=r().m(function e(){return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,D(fe(x));case 1:e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}),function(){var n=this,t=arguments;return new Promise(function(r,o){var l=e.apply(n,t);function a(e){i(l,r,o,a,u,"next",e)}function u(e){i(l,r,o,a,u,"throw",e)}a(void 0)})});return function(){return n.apply(this,arguments)}}();return S.jsxs(T,{sx:{p:2,gap:5},children:[S.jsx(_,{children:l("download.settings.conversion.description",{value:v})}),S.jsx(T,{sx:{flexDirection:"column",gap:5},children:x.map(function(e,n){var t=e.mimeType,r=te(t,n,x);return S.jsx(be,{conversion:e,isDuplicate:r,onChange:function(e){w(function(t){return me(t.toSpliced.apply(t,[n,1].concat(d(e?[e]:[]))))})}},e.id)})}),S.jsxs(T,{direction:"row",sx:{gap:1},children:[S.jsx(I,{variant:"outlined",onClick:function(){w(function(e){return[].concat(d(e),d(se([{mimeType:"",target:"",compressionLevel:null,headers:null,callTimeout:null,connectTimeout:null}])))})},children:l("global.button.add")}),S.jsx(I,{variant:"contained",disabled:O||!P,onClick:A,children:l("global.button.save")})]})]})})}}})}();
