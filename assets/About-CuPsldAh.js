import{r as M,i as N,j as e,aN as c,S as J,T as K,b as Q,a7 as X,R as b,u as Y,c as L,N as Z,a as g,g as ee,h as W,aO as R,o as m,ay as x,a4 as l,aP as re,az as P,aI as k}from"./index-B75kYtqP.js";import{E as te}from"./EmptyViewAbsoluteCentered-Dv2qmjMZ.js";import{d as ae}from"./Refresh-BM2loQZ8.js";import{d as se}from"./Download-yfqKuc1p.js";import{L as y}from"./ListSubheader-D7gBvlM2.js";var I={},oe=N;Object.defineProperty(I,"__esModule",{value:!0});var O=I.default=void 0,ne=oe(M()),ie=e;O=I.default=(0,ne.default)((0,ie.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"OpenInNew");var _={},le=N;Object.defineProperty(_,"__esModule",{value:!0});var V=_.default=void 0,de=le(M()),ue=e;V=_.default=(0,de.default)((0,ue.jsx)("path",{d:"M18.32 4.26C16.84 3.05 15.01 2.25 13 2.05v2.02c1.46.18 2.79.76 3.9 1.62zM19.93 11h2.02c-.2-2.01-1-3.84-2.21-5.32L18.31 7.1c.86 1.11 1.44 2.44 1.62 3.9m-1.62 5.9 1.43 1.43c1.21-1.48 2.01-3.32 2.21-5.32h-2.02c-.18 1.45-.76 2.78-1.62 3.89M13 19.93v2.02c2.01-.2 3.84-1 5.32-2.21l-1.43-1.43c-1.1.86-2.43 1.44-3.89 1.62M13 12V7h-2v5H7l5 5 5-5zm-2 7.93v2.02c-5.05-.5-9-4.76-9-9.95s3.95-9.45 9-9.95v2.02C7.05 4.56 4 7.92 4 12s3.05 7.44 7 7.93"}),"Downloading");const ce=(r,s,t,o=!1)=>t===c.Downloading?e.jsx(V,{}):r?e.jsx(X,{size:15}):!s||t===c.Error?e.jsx(ae,{}):o?e.jsx(O,{}):e.jsx(se,{}),pe=(r,s,t,o,p=0)=>o===c.Downloading?b("global.update.label.updating",{progress:p}):o===c.Error?b("global.update.label.update_failure"):r?b("global.update.label.checking"):t?b("global.update.label.check_failure"):s?b("global.update.label.available"):b("global.update.label.up_to_date"),T=({version:r,isCheckingForUpdate:s,isUpdateAvailable:t,updateCheckError:o,checkForUpdate:p,triggerUpdate:n,updateState:d,progress:h,downloadAsLink:j,url:f})=>{const v=d===c.Downloading,i=()=>{if(v)return;if(!t||o||d===c.Error){p();return}t&&(n==null||n())};return e.jsxs(J,{sx:{alignItems:"start"},children:[e.jsx(K,{component:"span",variant:"body2",children:r}),e.jsx(Q,{sx:{marginTop:"5px",backgroundColor:"transparent",pointerEvents:v?"none":"unset"},size:"small",variant:"outlined",startIcon:ce(s,t,d,j),onClick:i,...f&&t?{href:f,target:"_blank"}:void 0,children:pe(s,t,o,d,h)})]})};function ve(){var E,F,S;const{t:r}=Y(),{setTitle:s,setAction:t}=L.useContext(Z);L.useLayoutEffect(()=>(s(r("settings.about.title")),t(null),()=>{s(""),t(null)}),[r]);const{data:o,loading:p,error:n,refetch:d}=g.useGetAbout({notifyOnNetworkStatusChange:!0}),{data:h,loading:j,refetch:f,error:v}=g.useCheckForServerUpdate({notifyOnNetworkStatusChange:!0}),{data:i,loading:C,refetch:$,error:q}=g.useCheckForWebUIUpdate({notifyOnNetworkStatusChange:!0}),z=q||(i==null?void 0:i.checkForWebUIUpdate.tag)==="",{data:U}=g.useGetWebUIUpdateStatus(),{state:A,progress:B}=(E=U==null?void 0:U.getWebUIUpdateStatus)!=null?E:{state:c.Idle,progress:0};if(p)return e.jsx(ee,{});if(n)return e.jsx(te,{message:r("global.error.label.failed_to_load_data"),messageExtra:n.message,retry:()=>d().catch(W())});const{aboutServer:a,aboutWebUI:w}=o,u=(F=h==null?void 0:h.checkForServerUpdates)==null?void 0:F.find(G=>G.channel===a.buildType),D=!!(u!=null&&u.tag)&&u.tag!==R(a),H=!!(i!=null&&i.checkForWebUIUpdate.updateAvailable);return e.jsxs(m,{sx:{pt:0},children:[e.jsxs(m,{sx:{padding:0},subheader:e.jsx(y,{component:"div",id:"about-server-info",children:r("settings.server.title.server")}),children:[e.jsx(x,{children:e.jsx(l,{primary:r("settings.server.title.server"),secondary:"".concat(a.name," ").concat(a.buildType)})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.server.label.version"),secondary:e.jsx(T,{version:R(a),isCheckingForUpdate:j,isUpdateAvailable:D,updateCheckError:v,checkForUpdate:f,downloadAsLink:!0,url:(S=u==null?void 0:u.url)!=null?S:""})})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.server.label.build_time"),secondary:re(a)})})]}),e.jsx(P,{}),e.jsxs(m,{sx:{padding:0},subheader:e.jsx(y,{component:"div",id:"about-webui-info",children:r("settings.webui.title.webui")}),children:[e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.webui.label.channel"),secondary:w.channel.toLocaleUpperCase()})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.webui.label.version"),secondary:e.jsx(T,{version:w.tag,isCheckingForUpdate:C,isUpdateAvailable:H,updateCheckError:z,checkForUpdate:$,triggerUpdate:()=>g.updateWebUI().response.catch(W()),progress:B,updateState:A})})})]}),e.jsx(P,{}),e.jsxs(m,{subheader:e.jsx(y,{component:"div",id:"about-links",children:r("global.label.links")}),children:[e.jsx(k,{to:a.github,target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("settings.about.server.label.github"),secondary:a.github})}),e.jsx(k,{to:"https://github.com/Suwayomi/Suwayomi-WebUI",target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("settings.about.webui.label.github"),secondary:"https://github.com/Suwayomi/Suwayomi-WebUI"})}),e.jsx(k,{to:a.discord,target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("global.label.discord"),secondary:a.discord})})]})]})}export{ve as About};
