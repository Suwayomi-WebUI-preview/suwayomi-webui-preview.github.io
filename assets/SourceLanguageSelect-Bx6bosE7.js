import{u as O,f as r,t as l,S as q,n as C,j as e,C as _,I as w,o as D,p as U,q as A,s as L,v as y,G as P,r as W,aK as H,w as K,B as I,aO as V,m as G,g as Q}from"./index-BjiAJMwJ.js";import{F as R}from"./FilterList-DFoEpdXX.js";import{q as z}from"./index-CPnX4x-s.js";import{t as J}from"./Extensions.utils-C5zR9A4A.js";import{L as N}from"./ListCardAvatar-CVC1ul2y.js";import{S as k}from"./Switch-gDa4_ZJb.js";import{L as X}from"./ListItemAvatar-PtaiXlBL.js";const oe=({selectedLanguages:x,setSelectedLanguages:E,languages:p,sources:c})=>{const{t:n}=O(),[d,m]=r.useState({}),[o,g]=r.useState(l(x)),[T,h]=r.useState(!1),v=r.useMemo(()=>q.groupByLanguage(c),[c]),u=r.useMemo(()=>l([...o.toSorted(C),...p.toSorted(C)]),[p,o]),S=()=>{h(!1),m({}),g(l(x))},B=()=>{h(!1),Promise.all(Object.entries(d).map(([t,s])=>V(c.find(i=>i.id===t),"isEnabled",s))).catch(t=>G(n("global.error.label.failed_to_save_changes"),"error",Q(t))),m({}),E(l(o))},F=(t,s)=>{g(s?[...o,t]:o.toSpliced(o.indexOf(t),1))};return e.jsxs(e.Fragment,{children:[e.jsx(_,{title:n("settings.title"),children:e.jsx(w,{onClick:()=>h(!0),"aria-label":"display more actions",edge:"end",color:"inherit",children:e.jsx(R,{})})}),e.jsxs(D,{fullWidth:!0,maxWidth:"xs",open:T,onClose:S,children:[e.jsx(U,{children:n("global.language.title.enabled_languages")}),e.jsx(A,{dividers:!0,sx:{padding:0},children:e.jsx(z,{style:{height:u.length*54,minHeight:"25vh",maxHeight:"50vh"},data:u,increaseViewportBy:400,computeItemKey:t=>u[t],itemContent:(t,s)=>{var f;const i=(f=v[s])!=null?f:[],j=o.includes(s);return e.jsxs(e.Fragment,{children:[e.jsxs(L,{children:[e.jsx(y,{primary:J(s)}),e.jsx(k,{checked:j,onChange:a=>F(s,a.target.checked)})]}),j&&!!i.length&&e.jsx(P,{sx:{ml:1},children:i.map(a=>{var b;return e.jsxs(L,{children:[e.jsx(X,{sx:{minWidth:32,mr:1},children:e.jsx(N,{iconUrl:W.getValidImgUrlFor(a.iconUrl),alt:a.name,slots:{avatarProps:{sx:{width:32,height:32}},spinnerImageProps:{ignoreQueue:!0}}})}),e.jsx(y,{primary:a.name}),e.jsx(k,{checked:(b=d[a.id])!=null?b:H(a).isEnabled,onChange:M=>m({...d,[a.id]:M.target.checked})})]},a.id)})})]})}})}),e.jsxs(K,{children:[e.jsx(I,{autoFocus:!0,onClick:S,color:"primary",children:n("global.button.cancel")}),e.jsx(I,{onClick:B,color:"primary",children:n("global.button.ok")})]})]})]})};export{oe as S};
