import{u as N,a as d,c as S,j as t,v as j,an as f,V as U,bg as c,bh as g,bi as I,N as V,X as F,x as R,h as W,E as P,k as C,b7 as y,n as A}from"./index-C2-i4E1A.js";import{N as B}from"./NumberSetting-CtN6oQPs.js";import{u as M,g as D}from"./usePersistedValue-dhzSL-jt.js";import{S as x}from"./Switch-DsXMuWOo.js";import{T as H}from"./TextSetting-kckxz8uR.js";import{S as m}from"./SelectSetting-pBuy0-0n.js";import"./Info-CIHHO5Zo.js";import"./TextField-70nHlBBv.js";import"./InputAdornment-DukL3TX2.js";import"./SwitchBase-CoFzMnLY.js";import"./PasswordTextField-BH8n_7M3.js";import"./Select-_IpmtYgR.js";const L=23,K=1,Y=23,q=({disabled:e=!1,updateCheckInterval:r})=>{const{t:l}=N(),b=!!r,[p]=d.useUpdateServerSettings(),[i,h]=M("lastUpdateCheckInterval",L,r,D),u=S.useCallback(n=>{h(n===0?i:n),p({variables:{input:{settings:{webUIUpdateCheckInterval:n}}}})},[i]),w=n=>{u(n?i:0)};return t.jsxs(j,{children:[t.jsxs(f,{disabled:e,children:[t.jsx(U,{primary:l("settings.webui.auto_update.label.title")}),t.jsx(x,{disabled:e,edge:"end",checked:b,onChange:n=>w(n.target.checked)})]}),t.jsx(B,{settingTitle:l("settings.webui.auto_update.label.interval"),settingValue:l("library.settings.global_update.auto_update.interval.label.value",{hours:i}),value:i,minValue:K,maxValue:Y,defaultValue:L,showSlider:!0,valueUnit:l("global.time.hour_short"),handleUpdate:u,disabled:e||!b})]})},X=Object.values(c),G={[c.Webui]:{text:"settings.webui.title.webui",description:"settings.webui.flavor.option.webui.label.description",disclaimer:"settings.webui.flavor.label.info"},[c.Vui]:{text:"settings.webui.flavor.option.vui.label.title",description:"settings.webui.flavor.option.vui.label.description",disclaimer:"settings.webui.flavor.label.info"},[c.Custom]:{text:"settings.webui.flavor.option.custom.label.title",description:"settings.webui.flavor.option.custom.label.description"}},Q=X.map(e=>[e,G[e]]),z=Object.values(g),J={[g.Bundled]:{text:"settings.webui.channel.option.bundled.label.title",description:"settings.webui.channel.option.bundled.label.description",disclaimer:"settings.webui.flavor.label.info"},[g.Stable]:{text:"settings.webui.channel.option.stable.label.title",description:"settings.webui.channel.option.stable.label.description",disclaimer:"settings.webui.flavor.label.info"},[g.Preview]:{text:"settings.webui.channel.option.preview.label.title",description:"settings.webui.channel.option.preview.label.description",disclaimer:"settings.webui.channel.option.preview.label.disclaimer"}},Z=z.map(e=>[e,J[e]]),$=Object.values(I),ee={[I.Browser]:{text:"settings.webui.interface.option.label.browser",description:"settings.webui.interface.label.description"},[I.Electron]:{text:"settings.webui.interface.option.label.electron",description:"settings.webui.interface.label.description"}},te=$.map(e=>[e,ee[e]]),ae=e=>({webUIFlavor:e.webUIFlavor,initialOpenInBrowserEnabled:e.initialOpenInBrowserEnabled,webUIInterface:e.webUIInterface,electronPath:e.electronPath,webUIChannel:e.webUIChannel,webUIUpdateCheckInterval:e.webUIUpdateCheckInterval}),we=()=>{const{t:e}=N(),{setTitle:r,setAction:l}=S.useContext(V);F("settings"),S.useEffect(()=>(r(e("settings.webui.title.settings")),l(null),()=>{r(""),l(null)}),[e]);const{settings:{webUIInformAvailableUpdate:b},loading:p,request:{error:i,refetch:h}}=R(),u=y(()=>A(e("global.error.label.failed_to_save_changes"),"error")),{data:w,loading:n,error:v,refetch:T}=d.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[k]=d.useUpdateServerSettings(),o=(a,O)=>{a==="webUIChannel"&&d.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),k({variables:{input:{settings:{[a]:O}}}}).catch(()=>A(e("global.error.label.failed_to_save_changes"),"error"))};if(p||n)return t.jsx(W,{});const E=i!=null?i:v;if(E)return t.jsx(P,{message:e("global.error.label.failed_to_load_data"),messageExtra:E.message,retry:()=>{i&&h().catch(C()),v&&T().catch(C())}});const s=ae(w.settings),_=s.webUIFlavor===c.Webui;return t.jsxs(j,{children:[t.jsx(m,{settingName:e("settings.webui.flavor.label.title"),value:s.webUIFlavor,values:Q,handleChange:a=>o("webUIFlavor",a)}),t.jsxs(f,{children:[t.jsx(U,{primary:e("settings.webui.label.initial_open_browser")}),t.jsx(x,{edge:"end",checked:s.initialOpenInBrowserEnabled,onChange:a=>o("initialOpenInBrowserEnabled",a.target.checked)})]}),t.jsx(m,{settingName:e("settings.webui.interface.label.title"),value:s.webUIInterface,values:te,handleChange:a=>o("webUIInterface",a)}),t.jsx(H,{settingName:e("settings.webui.electron_path.label.title"),dialogDescription:e("settings.webui.electron_path.label.description"),value:s.electronPath,handleChange:a=>o("electronPath",a)}),t.jsx(m,{settingName:e("settings.webui.channel.label.title"),value:s.webUIChannel,values:Z,handleChange:a=>o("webUIChannel",a),disabled:!_}),t.jsx(q,{disabled:!_,updateCheckInterval:s.webUIUpdateCheckInterval}),!s.webUIUpdateCheckInterval&&t.jsxs(f,{children:[t.jsx(U,{primary:e("global.update.settings.inform.label.title"),secondary:e("global.update.settings.inform.label.description")}),t.jsx(x,{edge:"end",checked:b,onChange:a=>u("webUIInformAvailableUpdate",a.target.checked)})]})]})};export{we as WebUISettings};
