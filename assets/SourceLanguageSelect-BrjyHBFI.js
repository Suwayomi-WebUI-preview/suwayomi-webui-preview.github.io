import{u as T,f as r,t as d,S as M,n as b,j as e,C as A,I as F,o as O,p as P,q as U,s as k,r as q,v as L,ak as w,w as D,B as y,al as V,m as W,g as H}from"./index-BQabjUKA.js";import{F as K}from"./FilterList-DT1DizAO.js";import{Y as X}from"./index-C3ZnnLMW.js";import{t as Y}from"./Extensions.utils-pmrdphC4.js";import{L as $}from"./ListCardAvatar-HJw4zMeZ.js";import{V as z}from"./Virtuoso.util-yOuHC2f3.js";import{L as G}from"./ListItemAvatar-DTCrJsgn.js";import{C as N}from"./Checkbox-D-q8QTIa.js";import{S as Q}from"./Switch-o-FWjids.js";const ie=({selectedLanguages:x,setSelectedLanguages:E,languages:S,sources:u})=>{const{i18n:c,_:R}=T(),[m,g]=r.useState({}),[n,p]=r.useState(d(x)),[I,h]=r.useState(!1),l=r.useMemo(()=>M.groupByLanguage(u),[u]),s=r.useMemo(()=>d([...n.toSorted(b),...S.toSorted(b)]),[S,n]),C=r.useMemo(()=>Object.values(s.map(t=>l[t])).flat(),[s,l]),j=r.useMemo(()=>s.map(t=>{var o,i;return n.includes(t)&&(i=(o=l[t])==null?void 0:o.length)!=null?i:0}),[l,s]),v=z.useCreateGroupedComputeItemKey(j,r.useCallback(t=>s[t],[s]),r.useCallback(t=>C[t].id,[l,s])),f=()=>{h(!1),g({}),p(d(x))},_=()=>{h(!1),Promise.all(Object.entries(m).map(([t,a])=>V(u.find(o=>o.id===t),"isEnabled",a))).catch(t=>W(c._({id:"cBoXe4"}),"error",H(t))),g({}),E(d(n))},B=(t,a)=>{p(a?[...n,t]:n.toSpliced(n.indexOf(t),1))};return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:c._({id:"Tz0i8g"}),children:e.jsx(F,{onClick:()=>h(!0),"aria-label":"display more actions",edge:"end",color:"inherit",children:e.jsx(K,{})})}),e.jsxs(O,{fullWidth:!0,maxWidth:"xs",open:I,onClose:f,children:[e.jsx(P,{children:c._({id:"tEL3Xq"})}),e.jsx(U,{dividers:!0,sx:{padding:0},children:e.jsx(X,{style:{height:s.length*54,minHeight:"25vh",maxHeight:"50vh"},groupCounts:j,increaseViewportBy:400,computeItemKey:v,groupContent:t=>{const a=s[t],o=n.includes(a);return e.jsxs(k,{sx:{backgroundColor:"background.paper",backgroundImage:"var(--Paper-overlay)"},children:[e.jsx(L,{primary:Y(a)}),e.jsx(Q,{checked:o,onChange:i=>B(a,i.target.checked)})]})},itemContent:t=>{var o;const a=C[t];return e.jsxs(k,{sx:{pl:3},children:[e.jsx(G,{sx:{minWidth:32,mr:1},children:e.jsx($,{iconUrl:q.getValidImgUrlFor(a.iconUrl),alt:a.name,slots:{avatarProps:{sx:{width:32,height:32}},spinnerImageProps:{ignoreQueue:!0}}})}),e.jsx(L,{primary:a.name}),e.jsx(N,{checked:(o=m[a.id])!=null?o:w(a).isEnabled,onChange:i=>g({...m,[a.id]:i.target.checked})})]})}})}),e.jsxs(D,{children:[e.jsx(y,{autoFocus:!0,onClick:f,color:"primary",children:c._({id:"dEgA5A"})}),e.jsx(y,{onClick:_,color:"primary",children:c._({id:"aP3N/0"})})]})]})]})};export{ie as S};
