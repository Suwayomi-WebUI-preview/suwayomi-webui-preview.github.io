!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n,r){var a;return a=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,n||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(n,"string"),(n="symbol"==t(a)?a:a+"")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o,i,l=[],u=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(l.push(r.value),l.length!==e);u=!0);}catch(t){c=!0,a=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}System.register(["./index-legacy-C182Zjs5.js","./DownloadStateIndicator-legacy-C5B56kf7.js","./UpdateChecker-legacy-BwGAX2LP.js","./StyledGroupItemWrapper-legacy-rUt3b9tQ.js","./Mangas-legacy-Dhmn8NVZ.js","./SpinnerImage-legacy-CokuUiiP.js","./index-legacy-l-VZQp6Y.js","./CardContent-legacy-B9USkQSr.js","./Avatar-legacy-RWMcaqfa.js","./Progress-legacy-BaaV90s2.js","./Chapters-legacy-CPNqsu3R.js","./metadataServerSettings-legacy-CM9xljxS.js","./metadata-legacy-Bu0EDDj_.js"],(function(t,a){"use strict";var o,i,l,u,c,s,d,f,g,p,y,m,h,b,v,j,x,S,w,C,D,I,A,T,M,O;return{setters:[function(t){o=t.u,i=t.a7,l=t.c,u=t.N,c=t.a,s=t.j,d=t.E,f=t.T,g=t.g,p=t.L,y=t.B,m=t.f,h=t.I,b=t.q,v=t.t},function(t){j=t.D},function(t){x=t.U},function(t){S=t.S,w=t.a,C=t.b},function(t){D=t.M},function(t){I=t.S},function(t){A=t.C,T=t.a},function(t){M=t.C},function(t){O=t.A},null,null,null,null],execute:function(){function a(t,e){return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}var P=function(t){if(!t.length)return[];var e=new Map;return t.forEach((function(t){var n,r=function(t){var e=new Date;if(a(e,t))return v("global.date.label.today");var n=new Date;return n.setDate(e.getDate()-1),a(n,t)?v("global.date.label.yesterday"):t.toLocaleDateString()}(function(t){var e=new Date(0);return e.setUTCSeconds(t),e}(Number(t.fetchedAt)));e.set(r,(null!==(n=e.get(r))&&void 0!==n?n:0)+1)})),r(e.entries())};t("Updates",(function(){var t,r,a=o().t,v=i(),U=l.useContext(u),k=U.setTitle,E=U.setAction,L=c.useGetRecentlyUpdatedChapters(void 0,{fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!0}),F=L.data,R=L.loading,G=L.fetchMore,N=!(null==F||!F.chapters.pageInfo.hasNextPage),_=null==F?void 0:F.chapters.pageInfo.endCursor,q=null!==(t=null==F?void 0:F.chapters.nodes)&&void 0!==t?t:[],B=l.useMemo((function(){return P(q)}),[q]),H=l.useMemo((function(){return B.map((function(t){return t[1]}))}),[B]),Y=c.useGetDownloadStatus().data,z=null!==(r=null==Y?void 0:Y.downloadStatus.queue)&&void 0!==r?r:[],Q=l.useRef(null),W=n(l.useState(0),2),$=W[0],J=W[1];l.useLayoutEffect((function(){var t,e;J(null!==(t=null===(e=Q.current)||void 0===e?void 0:e.clientHeight)&&void 0!==t?t:0)}),[Q.current]);var K=c.useGetLastGlobalUpdateTimestamp({fetchPolicy:"cache-only"}).data,V=null==K?void 0:K.lastUpdateTimestamp.timestamp;l.useEffect((function(){return k(a("updates.title")),E(s.jsx(x,{})),function(){k(""),E(null)}}),[a,V]);var X=l.useCallback((function(){N&&G({variables:{offset:q.length}})}),[N,_]);return R||0!==q.length?s.jsxs(s.Fragment,{children:[s.jsx(f,{ref:Q,sx:{marginLeft:"10px",paddingTop:function(t){return e({},t.breakpoints.up("sm"),{paddingTop:"6px"})}},children:a("library.settings.global_update.label.last_update",{date:V?new Date(+V).toLocaleString():"-"})}),s.jsx(S,{heightToSubtract:$,style:{height:"undefined"},components:{Footer:function(){return R?s.jsx(g,{usePadding:!0}):null}},overscan:.5*window.innerHeight,endReached:X,groupCounts:H,groupContent:function(t){return s.jsx(w,{variant:"h5",isFirstItem:0===t,children:B[t][0]})},itemContent:function(t){var e=q[t],n=e.manga,r=function(t){var e=t.sourceOrder,n=t.manga.id;return z.find((function(t){return e===t.chapter.sourceOrder&&n===t.chapter.manga.id}))}(e);return s.jsx(C,{isLastItem:t===q.length-1,children:s.jsx(A,{children:s.jsx(T,{component:p,to:"/manga/".concat(e.manga.id,"/chapter/").concat(e.sourceOrder),state:v.state,sx:{color:function(t){return t.palette.text[e.isRead?"disabled":"primary"]}},children:s.jsxs(M,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:2},children:[s.jsxs(y,{sx:{display:"flex"},children:[s.jsx(p,{to:"/manga/".concat(e.manga.id),style:{textDecoration:"none"},children:s.jsx(O,{variant:"rounded",sx:{width:56,height:56,flex:"0 0 auto",marginRight:2,background:"transparent"},children:s.jsx(I,{imgStyle:{objectFit:"cover",width:"100%",height:"100%",imageRendering:"pixelated"},spinnerStyle:{small:!0},alt:n.title,src:D.getThumbnailUrl(n)})})}),s.jsxs(y,{sx:{display:"flex",flexDirection:"column"},children:[s.jsx(f,{variant:"h5",component:"h2",children:n.title}),s.jsx(f,{variant:"caption",display:"block",gutterBottom:!0,children:e.name})]})]}),r&&s.jsx(j,{download:r}),null==r&&!e.isDownloaded&&s.jsx(m,{title:a("chapter.action.download.add.label.action"),children:s.jsx(h,{onClick:function(t){t.stopPropagation(),t.preventDefault(),function(t){c.addChapterToDownloadQueue(t.id)}(e)},size:"large",children:s.jsx(b,{})})})]})})})},t)}})]}):s.jsx(d,{message:a("updates.error.label.no_updates_available")})}))}}}))}();
