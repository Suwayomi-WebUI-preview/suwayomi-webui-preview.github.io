!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}var n=["disabled","children"];function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function l(t,o,a,i){var l=o&&o.prototype instanceof c?o:c,u=Object.create(l.prototype);return r(u,"_invoke",function(t,r,o){var a,i,l,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(n,t){return a=n,i=0,l=e,f.n=t,s}};function g(t,r){for(i=t,l=r,n=0;!d&&c&&!o&&n<u.length;n++){var o,a=u[n],g=f.p,h=a[2];t>3?(o=h===r)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=g&&((o=t<2&&g<a[1])?(i=0,f.v=r,f.n=a[1]):g<h&&(o=t<3||a[0]>r||r>h)&&(a[4]=t,a[5]=r,f.n=h,i=0))}if(o||t>1)return s;throw d=!0,r}return function(o,u,h){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&g(u,h),i=u,l=h;(n=i<2?e:l)||!d;){a||(i?i<3?(i>1&&(f.n=-1),g(i,l)):f.n=l:f.v=l);try{if(c=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((n=(d=f.n<0)?l:t.call(r,f))!==s)break}catch(n){a=e,i=1,l=n}finally{c=1}}return{value:n,done:d}}}(t,a,i),!0),u}var s={};function c(){}function u(){}function d(){}n=Object.getPrototypeOf;var f=[][a]?n(n([][a]())):(r(n={},a,function(){return this}),n),g=d.prototype=c.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e}return u.prototype=d,r(g,"constructor",d),r(d,"constructor",u),u.displayName="GeneratorFunction",r(d,i,"GeneratorFunction"),r(g),r(g,i,"Generator"),r(g,a,function(){return this}),r(g,"toString",function(){return"[object Generator]"}),(t=function(){return{w:l,m:h}})()}function r(e,n,t,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}r=function(e,n,t,o){function i(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},r(e,n,t,o)}function o(e,n,t,r,o,a,i){try{var l=e[a](i),s=l.value}catch(e){return void t(e)}l.done?n(s):Promise.resolve(s).then(r,o)}function a(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var i=e.apply(n,t);function l(e){o(i,r,a,l,s,"next",e)}function s(e){o(i,r,a,l,s,"throw",e)}l(void 0)})}}function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=a.call(t)).done)&&(l.push(r.value),l.length!==n);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,n)||s(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,n){if(e){if("string"==typeof e)return c(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function u(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?u(Object(t),!0).forEach(function(n){f(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function f(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var o=r.call(n,t||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}System.register(["./index-legacy-sjOfbtFF.js","./PushPin-legacy-vf8xWLJd.js","./PushPinOutlined-legacy-DOsAA7n5.js","./SourceMangas-legacy-oOOxin67.js","./MUI.util-legacy-D9xMlHDR.js","./ListCardAvatar-legacy-D--qO1vQ.js","./ListCardContent-legacy-jdF1dlLe.js","./Card-legacy-DemWpYBI.js","./CardActionArea-legacy-C6uLww4Y.js","./EmptyViewAbsoluteCentered-legacy-CFTaRwxg.js","./Extensions.utils-legacy-Jf-JuiRA.js","./useAppAction-legacy-t9O8zQbm.js","./StyledGroupHeader-legacy-DnlHzcSp.js","./Virtuoso.util-legacy-r16iPVRv.js","./StyledGroupItemWrapper-legacy-CJIIE2-i.js","./SourceLanguageSelect-legacy-CwajoduE.js","./file-selector-legacy-POg7DV-z.js","./Add-legacy-D4bNfstB.js","./AppbarSearch-legacy-SfDnJk7k.js","./FilterList-legacy-C-IsGZah.js","./index-legacy-CQct-co_.js","./Switch-legacy-CyJ4xuXG.js","./use-window-event-legacy-Dk5Kugt3.js","./Tabs-legacy-DkkjrxuT.js","./TabsWrapper-legacy-3Lofdk0z.js","./TabsMenu-legacy-BWxMYgUL.js","./SortRadioInput-legacy-BgYDBrfB.js","./Chip-legacy-DvziFdC4.js","./useAppTitle-legacy-b2N_Hbfp.js","./Virtuoso.constants-legacy-D12OcMfg.js","./IconWebView-legacy-DAsz3bvl.js","./GridLayouts-legacy-BuixxFtD.js","./Checkbox-legacy-DHFkyI2c.js","./SwitchBase-legacy-pAgJuHX3.js","./ListPreference-legacy-DPyMm7ro.js","./FormGroup-legacy-CHWyIMD7.js","./Delete-legacy-CMTFZAqe.js","./CheckboxInput-legacy-BuA0RDNR.js","./ExpandMore-legacy-BRbUf9kb.js","./useDebounce-legacy-BCKq-Jbk.js","./ThreeStateCheckboxInput-legacy-DEtaKaVP.js","./StyledFab-legacy-BLmB1KA_.js","./BaseMangaGrid-legacy-BirhXb8N.js","./MangaGrid-legacy-DxcU_tvW.js","./useManageMangaLibraryState-legacy-C-vKwzcf.js","./Chapters-legacy-9GYqLjpQ.js","./DateHelper-legacy-CqzSar8U.js","./Asserts-legacy-CVL1QnTb.js","./Mangas-legacy-CQ18HeGj.js","./Download-legacy-BRofq8Hw.js","./ContinueReadingTooltip-legacy-DiVN76N1.js","./Trackers-legacy-DfsJOIZ_.js","./AvatarSpinner-legacy-Gcoz4cnV.js","./SpinnerImage-legacy-Bc1-kbQL.js","./Refresh-legacy-BxrI2uO5.js","./CheckCircle-legacy-xuYE1ZVq.js","./Metadata-legacy-Cyg5q0cB.js","./Link-legacy-B-4r33Y8.js","./NumberSetting-legacy-CzlhEXRe.js","./Slider-legacy-Bj3dxcYf.js","./useMobilePicker-legacy-h7x5MzVl.js","./SelectSetting-legacy-CYfMhN4J.js","./Select-legacy-AVkkcxGs.js","./Sync-legacy-CRP3yAci.js","./use-merged-ref-legacy-D0lD73JJ.js","./PlayArrow-legacy-i9TgNh26.js","./useAppTitleAndAction-legacy-l3YwxsCW.js","./Strings-legacy-CzJ32ydF.js","./ListItemAvatar-legacy-CDeeutui.js"],function(e,r){"use strict";var o,s,c,u,f,g,h,p,j,x,y,m,v,b,S,w,C,E,O,I,k,T,A,_,L,M,P,U,N,R,G,D,F,H,B,V,z,K,W,Q,q,X,J,Y,$,Z,ee,ne,te,re,oe,ae,ie,le,se,ce,ue,de,fe,ge,he,pe,je,xe,ye,me,ve,be,Se,we,Ce,Ee,Oe,Ie,ke,Te,Ae,_e,Le,Me,Pe,Ue,Ne,Re,Ge,De,Fe,He,Be,Ve,ze;return{setters:[function(e){o=e.c,s=e.j,c=e.u,u=e.a,f=e.S,g=e.A,h=e.L,p=e.r,j=e.b,x=e.T,y=e.l,m=e.B,v=e.C,b=e.I,S=e.d,w=e.m,C=e.g,E=e.e,O=e.f,I=e.D,k=e.h,T=e.i,A=e.k,_=e.t,L=e.n,M=e.o,P=e.p,U=e.q,N=e.s,R=e.v,G=e.w,D=e.x,F=e.y,H=e.z,B=e.E,V=e.F,z=e.G,K=e.H,W=e.J,Q=e.K,q=e.M,X=e.N,J=e.O,Y=e.P,$=e.Q},function(e){Z=e.P},function(e){ee=e.P},function(e){ne=e.SourceContentType},function(e){te=e.M},function(e){re=e.L},function(e){oe=e.L},function(e){ae=e.C},function(e){ie=e.C},function(e){le=e.E},function(e){se=e.i,ce=e.t,ue=e.g,de=e.I,fe=e.a,ge=e.E,he=e.b,pe=e.c,je=e.u,xe=e.d,ye=e.e,me=e.f,ve=e.h,be=e.j,Se=e.k},function(e){we=e.u},function(e){Ce=e.S,Ee=e.a},function(e){Oe=e.V},function(e){Ie=e.S},function(e){ke=e.S},function(e){Te=e.f},function(e){Ae=e.A},function(e){_e=e.A},function(e){Le=e.F},function(e){Me=e.q},function(e){Pe=e.S},function(e){Ue=e.u},function(e){Ne=e.T,Re=e.a},function(e){Ge=e.T},function(e){De=e.T},function(e){Fe=e.A,He=e.a},function(e){Be=e.C},function(e){Ve=e.u},function(e){ze=e.G},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){e("Browse",function(){var e=c().t;Ve(e("global.label.browse"));var n=O.useRef(null),t=l(O.useState(0),2),r=t[0],o=t[1];Y(n,O.useCallback(function(){return o(n.current.offsetHeight)},[n.current]));var a=l(F(B.TAB,H,{}),2),i=a[0],u=a[1],d=null!=i?i:$.SOURCES;i||u(d,"replaceIn");return s.jsxs(Ge,{children:[s.jsxs(De,{ref:n,sx:{zIndex:ze},variant:"fullWidth",value:d,onChange:function(e,n){return u(n,"replaceIn")},children:[s.jsx(Ne,{value:$.SOURCES,sx:{textTransform:"none"},label:e("source.title_other")}),s.jsx(Ne,{value:$.EXTENSIONS,sx:{textTransform:"none"},label:e("extension.title_other")}),s.jsx(Ne,{value:$.MIGRATE,sx:{textTransform:"none"},label:e("migrate.title")})]}),s.jsx(Re,{index:$.SOURCE_DEPRECATED,currentIndex:d,children:s.jsx(We,{tabsMenuHeight:r})}),s.jsx(Re,{index:$.SOURCES,currentIndex:d,children:s.jsx(We,{tabsMenuHeight:r})}),s.jsx(Re,{index:$.EXTENSIONS,currentIndex:d,children:s.jsx(Ze,{tabsMenuHeight:r})}),s.jsx(Re,{index:$.MIGRATE,currentIndex:d,children:s.jsx(rn,{tabsMenuHeight:r})})]})});var r=o(s.jsx("path",{d:"M19.3 16.9c.4-.7.7-1.5.7-2.4 0-2.5-2-4.5-4.5-4.5S11 12 11 14.5s2 4.5 4.5 4.5c.9 0 1.7-.3 2.4-.7l3.2 3.2 1.4-1.4zm-3.8.1c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5M12 20v2C6.48 22 2 17.52 2 12S6.48 2 12 2c4.84 0 8.87 3.44 9.8 8h-2.07c-.64-2.46-2.4-4.47-4.73-5.41V5c0 1.1-.9 2-2 2h-2v2c0 .55-.45 1-1 1H8v2h2v3H9l-4.79-4.79C4.08 10.79 4 11.38 4 12c0 4.41 3.59 8 8 8"})),Ke=function(e){var n=c().t,t=e.source,r=e.showSourceRepo,o=e.showLanguage,a=t.id,i=t.name,l=t.lang,E=t.iconUrl,O=t.supportsLatest,I=t.isNsfw,k=t.extension.repo,T=u(t).isPinned,A=f.isLocalSource(t)?n("source.local_source.title"):i,_=S(t,function(e){return w(n("global.error.label.failed_to_save_changes"),"error",C(e))});return s.jsx(ae,{children:s.jsx(ie,{component:h,to:g.sources.childRoutes.browse.path(a),state:{contentType:ne.POPULAR,clearCache:!0},children:s.jsxs(oe,{children:[s.jsx(re,{iconUrl:p.getValidImgUrlFor(E),alt:A,slots:{spinnerImageProps:{ignoreQueue:!0}}}),s.jsxs(j,{sx:{justifyContent:"center",flexGrow:1,flexShrink:1,wordBreak:"break-word"},children:[s.jsx(x,{variant:"h6",component:"h3",children:A}),s.jsxs(x,{variant:"caption",children:[o&&y(l),I&&s.jsx(x,{variant:"caption",color:"error",children:" 18+"})]}),r&&s.jsx(x,{variant:"caption",children:k})]}),O&&s.jsx(m,d(d({},te.preventRippleProp()),{},{variant:"outlined",component:h,to:g.sources.childRoutes.browse.path(a),state:{contentType:ne.LATEST,clearCache:!0},children:n("global.button.latest")})),s.jsx(v,{title:n(T?"source.pin.remove":"source.pin.add"),children:s.jsx(b,d(d({},te.preventRippleProp()),{},{onClick:function(e){e.preventDefault(),_("isPinned",!T)},color:T?"primary":"inherit",children:T?s.jsx(Z,{}):s.jsx(ee,{})}))})]})})})};function We(e){var n=e.tabsMenuHeight,t=c().t,o=f.useLanguages(),a=o.languages,i=o.setLanguages,u=E().settings,d=u.showNsfw,h=u.lastUsedSourceId,j=p.useGetSourceList({notifyOnNetworkStatusChange:!0}),y=j.data,m=j.loading,S=j.error,w=j.refetch,_=null==y?void 0:y.sources.nodes,L=O.useMemo(function(){return f.filter(null!=_?_:[],{showNsfw:d,languages:a,keepLocalSource:!0,enabled:!0})},[_,a]),M=O.useMemo(function(){var e=f.getLastUsedSource(h,L),n=Object.entries(f.groupByLanguage(L));return e?[[I.LAST_USED_SOURCE,[e]]].concat(n):n},[L]),P=O.useMemo(function(){return f.getLanguages(null!=_?_:[])},[_]),U=O.useMemo(function(){return f.areFromMultipleRepos(L)},[L]),N=O.useMemo(function(){return M.map(function(e){return l(e,2)[1]}).flat(1)},[M]),R=O.useMemo(function(){return M.map(function(e){return e[1].length})},[M]),G=Oe.useCreateGroupedComputeItemKey(R,O.useCallback(function(e){return M[e][0]},[M]),O.useCallback(function(e,n){return"".concat(M[n][0],"_").concat(N[e].id)},[N])),D=k();return we(s.jsxs(s.Fragment,{children:[s.jsx(v,{title:t("search.title.global_search"),children:s.jsx(b,{onClick:function(){return D(g.sources.childRoutes.searchAll.path())},color:"inherit",children:s.jsx(r,{})})}),s.jsx(ke,{selectedLanguages:a,setSelectedLanguages:i,languages:P,sources:null!=_?_:[]})]}),[t,a,P,_]),m?s.jsx(T,{}):S?s.jsx(le,{message:t("global.error.label.failed_to_load_data"),messageExtra:C(S),retry:function(){return w().catch(A())}}):0===(null==_?void 0:_.length)?s.jsx(le,{message:t("source.error.label.no_sources_found")}):s.jsx(Ce,{persistKey:"sources",heightToSubtract:n,overscan:.5*window.innerHeight,groupCounts:R,computeItemKey:G,groupContent:function(e){var n=l(M[e],1)[0];return s.jsx(Ee,{isFirstItem:!e,children:s.jsx(x,{variant:"h5",component:"h2",children:ce(n)})})},itemContent:function(e,n){var t=M[n][0],r=N[e];return s.jsx(Ie,{children:s.jsx(Ke,{source:r,showSourceRepo:U,showLanguage:se(t)})})}})}function Qe(e){var n=c().t,t=e.selectedLanguages,r=e.setSelectedLanguages,o=e.languages,a=l(O.useState(_(t)),2),u=a[0],d=a[1],f=l(O.useState(!1),2),g=f[0],h=f[1],p=O.useMemo(function(){return _([].concat(i(u.toSorted(L)),i(o.toSorted(L))))},[o,u]),j=function(){h(!1),d(_(t))};return s.jsxs(s.Fragment,{children:[s.jsx(v,{title:n("settings.title"),children:s.jsx(b,{onClick:function(){return h(!0)},"aria-label":"display more actions",edge:"end",color:"inherit",children:s.jsx(Le,{})})}),s.jsxs(M,{fullWidth:!0,maxWidth:"xs",open:g,onClose:j,children:[s.jsx(P,{children:n("global.language.title.enabled_languages")}),s.jsx(U,{dividers:!0,sx:{padding:0},children:s.jsx(Me,{style:{height:54*p.length,minHeight:"25vh",maxHeight:"50vh"},data:p,increaseViewportBy:400,computeItemKey:function(e){return p[e]},itemContent:function(e,n){return s.jsxs(N,{children:[s.jsx(R,{primary:ce(n)}),s.jsx(Pe,{checked:u.includes(n),onChange:function(e){return function(e,n){d(n?[].concat(i(u),[e]):u.toSpliced(u.indexOf(e),1))}(n,e.target.checked)}})]})}})}),s.jsxs(G,{children:[s.jsx(m,{autoFocus:!0,onClick:j,color:"primary",children:n("global.button.cancel")}),s.jsx(m,{onClick:function(){h(!1),r(_(u))},color:"primary",children:n("global.button.ok")})]})]})]})}var qe=function(e){var t=e.disabled,r=e.children,o=function(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}(e,n);return t?r:s.jsx(ie,d(d({component:h},o),{},{children:r}))};function Xe(e){var n=c().t,r=e.extension,o=r.name,i=r.lang,u=r.versionName,f=r.isInstalled,h=r.hasUpdate,S=r.isObsolete,w=r.pkgName,C=r.iconUrl,E=r.isNsfw,I=r.repo,k=e.handleUpdate,T=e.showSourceRepo,_=e.forcedState,L=l(O.useState(ue(f,S,h)),2),M=L[0],P=L[1],U=null!=_?_:M;O.useEffect(function(){P(ue(f,S,h))},[ue(f,S,h)]);var N=function(){var e=a(t().m(function e(n){var r,o;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=xe[n],o=pe[n],e.p=1,P(o),e.n=2,je(w,S,n);case 2:P(r),k(),e.n=4;break;case 3:e.p=3,e.v,P(ue(f,S,h));case 4:return e.a(2)}},e,null,[[1,3]])}));return function(n){return e.apply(this,arguments)}}();return s.jsx(ae,{children:s.jsx(qe,{disabled:!f,to:g.extension.childRoutes.info.path(w),children:s.jsxs(oe,{children:[s.jsx(re,{iconUrl:p.getValidImgUrlFor(C),alt:o,slots:{spinnerImageProps:{ignoreQueue:!0}}}),s.jsxs(j,{sx:{justifyContent:"center",flexGrow:1,flexShrink:1,wordBreak:"break-word"},children:[s.jsx(x,{variant:"h6",component:"h3",children:o}),s.jsxs(x,{variant:"caption",children:[f?"".concat(y(i)," "):"",u,E&&s.jsx(x,{variant:"caption",color:"error",children:" 18+"})]}),T&&s.jsx(x,{variant:"caption",children:I})]}),f&&s.jsx(v,{title:n("settings.title"),children:s.jsx(b,d(d({color:"inherit"},te.preventRippleProp()),{},{children:s.jsx(D,{})}))}),s.jsx(m,{variant:"outlined",sx:{color:U===fe.OBSOLETE?"red":"inherit",flexShrink:0},onClick:function(e){e.preventDefault(),function(){switch(U){case he.INSTALL:case he.UPDATE:case he.UNINSTALL:N(U).catch(A());break;case ge.OBSOLETE:N(he.UNINSTALL).catch(A())}}()},children:n(de[U])})]})})})}var Je=0,Ye=1,$e=function(e){var n=e.groupName,t=e.isFirstItem,r=e.groupExtensionIds,o=e.isUpdateGroup,a=e.updatingExtensionIds,i=e.setUpdatingExtensionIds,l=e.handleExtensionUpdate,u=c().t;return s.jsxs(Ee,{isFirstItem:t,sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",pr:1},children:[s.jsx(x,{variant:"h5",component:"h2",children:ce(n)}),o&&s.jsx(m,{disabled:!!a.length,variant:"contained",onClick:function(){i(r),p.updateExtensions(r,{update:!0}).response.then(function(){return l()}).catch(function(e){return w(u(Se[he.UPDATE],{count:r.length}),"error",C(e))}).finally(function(){return i([])})},children:u("extension.action.label.update_all")})]},n)};function Ze(e){var n,r,o=e.tabsMenuHeight,i=c().t,u=p.useGetServerSettings({notifyOnNetworkStatusChange:!0}),d=u.data,f=u.loading,y=u.error,S=u.refetch,I=l(p.useExtensionListFetch(),2),k=I[0],_=I[1],L=_.data,M=_.loading,P=_.error,U=E().settings,N=U.extensionLanguages,R=U.showNsfw,G=V(function(e){return w(i("global.error.label.failed_to_save_changes"),"error",C(e))}),D=l(F(B.QUERY,H),1)[0],z=l(O.useState([]),2),K=z[0],W=z[1],Q=l(O.useState({}),2),q=Q[0],X=Q[1],J=f||M,Y=null!=y?y:P,$=!(null==d||!d.settings.extensionRepos.length),Z=(null!==(n=null==d?void 0:d.settings.extensionRepos.length)&&void 0!==n?n:0)>1,ee=null==L||null===(r=L.fetchExtensions)||void 0===r?void 0:r.extensions,ne=O.useMemo(function(){return ye(null!=ee?ee:[])},[ee]),te=O.useMemo(function(){return me(null!=ee?ee:[],{selectedLanguages:N,showNsfw:R,query:D})},[ee,N,R,D]),re=O.useMemo(function(){return ve(te)},[te]),oe=O.useMemo(function(){return re.map(function(e){return e[Ye].length})},[re]),ae=O.useMemo(function(){return re.map(function(e){return l(e,2)[1]}).flat(1)},[re]),ie=Oe.useCreateGroupedComputeItemKey(oe,O.useCallback(function(e){return re[e][Je]},[re]),O.useCallback(function(e){return ae[e].pkgName},[ae])),se=O.useCallback(function(){return X({})},[]),ce=function(e){e.name.toLowerCase().endsWith("apk")?(w(i("extension.label.installing_file"),"info"),p.installExternalExtension(e).response.then(function(){se(),w(i("extension.label.installed_successfully"),"success")}).catch(function(e){return w(i("extension.label.installation_failed"),"error",C(e))})):w(i("global.error.label.invalid_file_type"),"error")};return O.useEffect(function(){k()},[q]),we(s.jsxs(s.Fragment,{children:[s.jsx(_e,{}),s.jsx(v,{title:i("extension.action.label.install_external"),children:s.jsx(b,{onClick:function(){var e=document.createElement("input");e.style.display="none",e.type="file",e.onchange=function(){var n,t=null===(n=e.files)||void 0===n?void 0:n[0];t&&ce(t)},document.documentElement.appendChild(e),e.click(),document.documentElement.removeChild(e)},color:"inherit",children:s.jsx(Ae,{})})}),s.jsx(Qe,{selectedLanguages:N,setSelectedLanguages:function(e){return G("extensionLanguages",e)},languages:ne})]}),[i,N,ne]),Ue("drop",function(){var e=a(t().m(function e(n){var r;return t().w(function(e){for(;;)switch(e.n){case 0:return n.preventDefault(),e.n=1,Te(n);case 1:r=e.v,ce(r[0]);case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()),Ue("dragover",function(e){e.preventDefault()}),J?s.jsx(T,{}):Y?s.jsx(le,{message:i("global.error.label.failed_to_load_data"),messageExtra:C(Y),retry:function(){y&&S().catch(A()),P&&k().catch(A())}}):!(null!=ee&&ee.length||$)?s.jsxs(j,{sx:{alignItems:"center",justifyContent:"center",rowGap:"10px",paddingTop:"20px"},children:[s.jsx(x,{children:i("extension.label.add_repository_info")}),s.jsx(m,{component:h,variant:"contained",to:g.settings.childRoutes.browse.path,children:i("settings.title")})]}):s.jsx(Ce,{persistKey:"extensions",heightToSubtract:o,overscan:.5*window.innerHeight,groupCounts:oe,groupContent:function(e){var n=l(re[e],2),t=n[0],r=n[1],o=t===be.UPDATE_PENDING;return s.jsx($e,{groupName:t,isFirstItem:0===e,groupExtensionIds:r.map(function(e){return e.pkgName}),isUpdateGroup:o,updatingExtensionIds:K,setUpdatingExtensionIds:W,handleExtensionUpdate:se})},computeItemKey:ie,itemContent:function(e){var n=ae[e];return s.jsx(Ie,{children:s.jsx(Xe,{extension:n,handleUpdate:se,showSourceRepo:Z,forcedState:K.includes(n.pkgName)?ge.UPDATING:void 0})})}})}var en=o(s.jsx("path",{d:"M14.94 4.66h-4.72l2.36-2.36zm-4.69 14.71h4.66l-2.33 2.33zM6.1 6.27 1.6 17.73h1.84l.92-2.45h5.11l.92 2.45h1.84L7.74 6.27zm-1.13 7.37 1.94-5.18 1.94 5.18zm10.76 2.5h6.12v1.59h-8.53v-1.29l5.92-8.56h-5.88v-1.6h8.3v1.26z"})),nn=o(s.jsx("path",{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4zm-6 4h-4v-4h4z"})),tn=function(e){var n=e.id,t=e.name,r=e.lang,o=e.iconUrl,a=e.mangaCount,i=c().t,l=0===Number(n)?i("source.local_source.title"):t;return s.jsx(ae,{children:s.jsx(ie,{component:h,to:g.migrate.path(n),children:s.jsxs(oe,{sx:{justifyContent:"space-between"},children:[s.jsxs(z,{sx:{display:"flex",gap:1},children:[s.jsx(re,{iconUrl:p.getValidImgUrlFor(o),alt:l,slots:{spinnerImageProps:{ignoreQueue:!0}}}),s.jsxs(z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[s.jsx(x,{variant:"h6",component:"h3",children:l}),s.jsx(x,{variant:"caption",sx:{display:"block"},children:ce(r)})]})]}),s.jsx(Be,{sx:{borderRadius:1},size:"small",label:a})]})})})},rn=function(e){var n=e.tabsMenuHeight,t=c().t,r=K().appBarHeight,o=E().settings.migrateSortSettings,a=V(function(e){return w(t("global.error.label.failed_to_save_changes"),"error",C(e))}),i=o.sortBy,l=o.sortOrder,u=p.useGetMigratableSources({notifyOnNetworkStatusChange:!0}),f=u.data,g=u.loading,h=u.error,x=u.refetch,y=O.useMemo(function(){return function(e,n){var t=n.sortBy,r=n.sortOrder;if(!e)return[];var o={};e.forEach(function(e){var n,t=e.sourceId,r=e.source,a=null!==(n=o[t])&&void 0!==n?n:d({},d({id:t,name:t,lang:"unknown",iconUrl:null,mangaCount:0},r));o[t]=d(d({},a),{},{mangaCount:a.mangaCount+1})});var a=Object.values(o).toSorted(function(e,n){switch(t){case X.SOURCE_NAME:return e.name.localeCompare(n.name);case X.MANGA_COUNT:return e.mangaCount-n.mangaCount;default:throw new Error('Unexpected "sortBy" "'.concat(t,'"'))}});switch(r){case J.ASC:return a;case J.DESC:return a.toReversed();default:throw new Error('Unexpected "sortOrder" "'.concat(r,'"'))}}(null==f?void 0:f.mangas.nodes,o)},[null==f?void 0:f.mangas.nodes,o]);return g?s.jsx(T,{}):h?s.jsx(le,{message:t("global.error.label.failed_to_load_data"),messageExtra:C(h),retry:function(){return x().catch(A())}}):s.jsxs(s.Fragment,{children:[s.jsxs(j,{sx:{position:"sticky",top:"".concat(r+n,"px"),flexDirection:"row",justifyContent:"end",alignItems:"center",gap:1,p:1,backgroundColor:"background.default",zIndex:1},children:[s.jsx(v,{title:t(W[i]),children:s.jsx(b,{color:"inherit",onClick:function(){return a("migrateSortSettings",{sortBy:(i+1)%2,sortOrder:l})},children:i?s.jsx(nn,{}):s.jsx(en,{})})}),s.jsx(v,{title:t(Q[l]),children:s.jsx(b,{color:"inherit",onClick:function(){return a("migrateSortSettings",{sortBy:i,sortOrder:(l+1)%2})},children:l?s.jsx(Fe,{}):s.jsx(He,{})})})]}),s.jsx(q,{sx:{p:0},children:y.map(function(e){return s.jsx(Ie,{children:s.jsx(tn,d({},e))},e.id)})})]})}}}})}();
