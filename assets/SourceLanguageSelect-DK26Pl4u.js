import{u as T,f as a,t as d,S as M,n as L,j as t,C as A,I as F,o as P,p as U,q,H as w,s as b,r as D,v as k,ai as O,w as V,B as y,aj as H,m as W,g as K}from"./index-ChwTeEsl.js";import{F as X}from"./FilterList-BKThoK6_.js";import{Y}from"./index-CdVEoZjK.js";import{t as $}from"./Extensions.utils-CZCtfd9B.js";import{L as z}from"./ListCardAvatar-fTgEzJiS.js";import{V as G}from"./Virtuoso.util-BDhKlK0O.js";import{L as N}from"./ListItemAvatar-Dpw96wsl.js";import{C as Q}from"./Checkbox-17FoHUyn.js";import{S as R}from"./Switch-DkB8E2KP.js";const ce=({selectedLanguages:S,setSelectedLanguages:E,languages:i,sources:u})=>{const{i18n:c,_:J}=T(),[m,p]=a.useState({}),[o,g]=a.useState(d(S)),[I,h]=a.useState(!1),l=a.useMemo(()=>M.groupByLanguage(u),[u]),r=a.useMemo(()=>d([...o.filter(e=>i.includes(e)).toSorted(L),...i.toSorted(L)]),[i,o]),x=a.useMemo(()=>r.map(e=>{var s;return(s=l[e])!=null?s:[]}).flat(),[r,l]),j=a.useMemo(()=>r.map(e=>o.filter(n=>i.includes(n)).includes(e)?l[e].length:0),[l,r,i]),_=G.useCreateGroupedComputeItemKey(j,a.useCallback(e=>r[e],[r]),a.useCallback(e=>x[e].id,[x])),f=()=>{h(!1),p({}),g(d(S))},B=()=>{h(!1),Promise.all(Object.entries(m).map(([e,s])=>H(u.find(n=>n.id===e),"isEnabled",s))).catch(e=>W(c._({id:"cBoXe4"}),"error",K(e))),p({}),E(d(o))},v=(e,s)=>{g(s?[...o,e]:o.toSpliced(o.indexOf(e),1))};return t.jsxs(t.Fragment,{children:[t.jsx(A,{title:c._({id:"Tz0i8g"}),children:t.jsx(F,{onClick:()=>h(!0),"aria-label":"display more actions",edge:"end",color:"inherit",children:t.jsx(X,{})})}),t.jsxs(P,{fullWidth:!0,maxWidth:"xs",open:I,onClose:f,children:[t.jsx(U,{children:c._({id:"tEL3Xq"})}),t.jsxs(q,{dividers:!0,sx:{padding:0},children:[!i.length&&t.jsx(w,{sx:{p:1},children:c._({id:"rCC0ts"})}),t.jsx(Y,{style:{height:r.length*54,minHeight:"25vh",maxHeight:"50vh"},groupCounts:j,increaseViewportBy:400,computeItemKey:_,groupContent:e=>{const s=r[e],n=o.includes(s);return t.jsxs(b,{sx:{backgroundColor:"background.paper",backgroundImage:"var(--Paper-overlay)"},children:[t.jsx(k,{primary:$(s)}),t.jsx(R,{checked:n,onChange:C=>v(s,C.target.checked)})]})},itemContent:e=>{var n;const s=x[e];return t.jsxs(b,{sx:{pl:3},children:[t.jsx(N,{sx:{minWidth:32,mr:1},children:t.jsx(z,{iconUrl:D.getValidImgUrlFor(s.iconUrl),alt:s.name,slots:{avatarProps:{sx:{width:32,height:32}},spinnerImageProps:{ignoreQueue:!0}}})}),t.jsx(k,{primary:s.name}),t.jsx(Q,{checked:(n=m[s.id])!=null?n:O(s).isEnabled,onChange:C=>p({...m,[s.id]:C.target.checked})})]})}})]}),t.jsxs(V,{children:[t.jsx(y,{autoFocus:!0,onClick:f,color:"primary",children:c._({id:"dEgA5A"})}),t.jsx(y,{onClick:B,color:"primary",children:c._({id:"aP3N/0"})})]})]})]})};export{ce as S};
