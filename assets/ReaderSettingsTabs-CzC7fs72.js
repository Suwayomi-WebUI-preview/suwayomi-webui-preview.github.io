var Sr=Object.defineProperty;var Er=(e,t,r)=>t in e?Sr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var We=(e,t,r)=>Er(e,typeof t!="symbol"?t+"":t,r);import{r as Z,f as S,W as ct,dQ as P,V as Rr,dR as fe,dS as yr,dI as Tr,dT as Zt,dU as Ar,dV as Pr,bW as Ir,j as a,G as X,aw as y,dc as _e,dC as z,dv as Re,dx as G,ap as dt,d1 as $,dW as M,de as C,ay as ce,df as Or,b9 as ie,R as Ve,dD as we,c7 as Le,db as Kt,dd as ge,dX as Cr,dY as ft,dZ as jr,e as Dr,d_ as _t,d$ as wr,e0 as pt,cr as Lr,m as mt,g as xt,av as vt,e1 as U,br as Mr,h as Nr,A as kr,e2 as pe,k as Ur,u as x,b,T as A,B as ee,C as Be,dp as Xt,dq as Jt,e3 as Vr,e4 as Br,d6 as se,dm as Fr,dn as Gr,dl as Hr,c as ae,I as Qt,e5 as Ye,aV as zr,dr as qt,d2 as me,du as je,e6 as $r,e7 as de,e8 as w,e9 as Wr,ea as Yr,eb as Zr,d8 as ue,ec as Ze,a4 as Kr,ed as Xr,o as Jr,p as Qr,q as qr,w as en,a6 as tn,a7 as rn,dE as D,ee as nn,ef as bt,d0 as le}from"./index-DpQS0-BK.js";import{T as sn}from"./TabsMenu-CHbPJAx5.js";import{C as B}from"./Chapters-qI8dly1s.js";import{a as on,G as St,F as Et}from"./Mangas-B_Y03hJu.js";import{S as an}from"./SpinnerImage-g716mscF.js";import{r as ln}from"./Strings-CAV0u705.js";import{T as cn,a as ne}from"./Tabs-BJKzMg_s.js";import{T as er}from"./Trans-Cje5GFNH.js";import{S as dn}from"./Slider-CKGdXbuV.js";import{C as O}from"./CheckboxInput-3xspjhj_.js";import{L as un}from"./ListSubheader-azspbEVI.js";import{A as gn}from"./Add-BUB6GX28.js";const tr=(e,t,r)=>{var l;const s=Pr(),n=s===Ir,o=Object.keys((l=r.meta)!=null?l:{}).filter(c=>{var g;return n?((g=c.match(/_/g))==null?void 0:g.length)===1:c.startsWith("".concat(Ar,"_").concat(s,"_"))}).map(c=>Zt(c));return Object.fromEntries(Object.entries(t).map(([c,g])=>{if(fe.includes(c))return[c,g];const d=e==="manga"&&!o.includes(c);return[c,{value:g,isDefault:d}]}))},qe=e=>({...e,tapZoneInvertMode:JSON.stringify(e.tapZoneInvertMode),customFilter:JSON.stringify(e.customFilter),readerWidth:JSON.stringify(e.readerWidth),hotkeys:JSON.stringify(e.hotkeys),autoScroll:JSON.stringify(e.autoScroll)}),Rt=tr("global",P,{meta:qe(P)}),rr=(e,t,r=P,s,n)=>Rr(e,t,r,n!==void 0?[n.toString()]:void 0,s);function nr(e,t,r=P,s,n){const o=rr(e,t,r,s,n);return tr(e,o,t)}const hn=(e,t,r,s)=>nr("manga",{...e,meta:ct(e.meta,n=>!fe.includes(Zt(n)))},t,r,s),ta=(e,t)=>hn(e,t),ra=e=>{const t=Z.useGetGlobalMeta({notifyOnNetworkStatusChange:!0}),{data:r,loading:s}=t,n=S.useMemo(()=>ct(r==null?void 0:r.metas.nodes),[r==null?void 0:r.metas.nodes]),o=S.useMemo(()=>({meta:n}),[n]),i=rr("global",o,void 0,S.useEffect,e),l=S.useMemo(()=>i,[o,e]);return S.useMemo(()=>({metadata:n,settings:l,loading:s,request:t}),[n,l,s,t])},fn=e=>{const t=Z.useGetGlobalMeta({notifyOnNetworkStatusChange:!0}),{data:r,loading:s}=t,n=S.useMemo(()=>ct(r==null?void 0:r.metas.nodes),[r==null?void 0:r.metas.nodes]),o=S.useMemo(()=>({meta:n}),[n]),i=nr("global",o,void 0,S.useEffect,e),l=S.useMemo(()=>i,[o,e]);return S.useMemo(()=>({metadata:n,settings:l,loading:s,request:t}),[n,l,s,t])},_n=async(e,t,r,s=!1,n)=>s||fe.includes(t)?yr([[t,qe({[t]:r})[t]]],n!==void 0?[n==null?void 0:n.toString()]:void 0):Tr(e,[[t,qe({[t]:r})[t]]],n!==void 0?[n==null?void 0:n.toString()]:void 0),yt=e=>e===z.END?Number.MAX_SAFE_INTEGER:-1,pn=({currentPageIndex:e,pages:t,transitionPageMode:r,imageRefs:s,createPage:n,slots:o,readingMode:i,imagePreLoadAmount:l,isCurrentChapter:c,isPreviousChapter:g,isNextChapter:u,customFilter:d,pageScaleMode:f,shouldStretchPage:h,readerWidth:v,readerNavBarWidth:p,resumeMode:m,handleAsInitialRender:_,ref:R})=>{var L,j,V,W;const E=S.useRef(yt(m));_&&(E.current=yt(m));const T=S.useMemo(()=>ys(e,t,E.current,l,i,c,g,u),[e,t,l,i,c,g,u]);S.useEffect(()=>{c&&(E.current=e)},[T,c]);const I=S.useCallback(($e,Ae)=>{s.current[$e]=Ae},[s]);return a.jsx(X,{ref:R,...o==null?void 0:o.boxProps,sx:[{width:"fit-content",height:"fit-content"},...Array.isArray((L=o==null?void 0:o.boxProps)==null?void 0:L.sx)?(V=(j=o==null?void 0:o.boxProps)==null?void 0:j.sx)!=null?V:[]:[(W=o==null?void 0:o.boxProps)==null?void 0:W.sx],y(!J(i)&&Ts(r,i),{visibility:"hidden",width:0,height:0,m:0,p:0})],children:t.map(($e,Ae)=>n($e,Ae,T.includes(Ae),[_e.NONE,_e.BOTH].includes(r),I,i,d,f,h,v,p))})},Fe=S.memo(pn),mn=({onLoad:e,onError:t,pageLoadStates:r,retryFailedPagesKeyPrefix:s,isPreloadMode:n,...o})=>{const{currentPageIndex:i,totalPages:l}=o;return a.jsx(Fe,{...o,createPage:(c,g,u,d,f,...h)=>Ee(c,g,!0,r[c.primary.index].loaded,n,e,t,u,d&&u&&i===c.primary.index,i,l,...h,r[c.primary.index].error?s:void 0),slots:{boxProps:{sx:{margin:"auto"}}}})},xn=S.memo(mn),sr=(e,t)=>{const r=t.findIndex(({primary:n,secondary:o})=>[n.index,o==null?void 0:o.index].includes(e));return{...t[Re(r,0,t.length-1)],pagesIndex:r}},et=e=>{var t,r;return(r=(t=e.secondary)==null?void 0:t.index)!=null?r:e.primary.index},na=(e,t,r)=>{switch(e){case"previous":return et(r[Math.max(0,t-1)]);case"next":return et(r[Math.min(r.length-1,t+1)]);default:throw new Error('Unexpected offset "'.concat(e,'"'))}},sa=(e,t,r,s,n,o)=>{const i=s?e.clientX:e.clientY,{paddingTop:l,paddingBottom:c,paddingLeft:g,paddingRight:u}=getComputedStyle(t),d=t.getBoundingClientRect(),f=s?parseFloat(g)+parseFloat(u):parseFloat(l)+parseFloat(c),h=s?d.left:d.top,p=(s?d.width:d.height)-f,m=i-h-f/2,_=r.length-+!n,R=p/_,E=Math.floor(m/R),T=(E+(n?1:.5))*R,I=m<=T?E:E+1,L=Math.max(0,I),j=Math.min(L,r.length-1),V=o(j,r.length-1-j);return r[V]},oa=e=>{const t=e===G.BOTTOM,r=e===G.LEFT,s=e===G.RIGHT;return{isBottom:t,isLeft:r,isRight:s,isHorizontal:t,isVertical:r||s}},Tt=(e,t,r)=>{const s=r===$.LTR;return e==="first"?t==="ltr"?s?"right":"left":s?"left":"right":t==="ltr"?s?"left":"right":s?"right":"left"},vn=({onLoad:e,onError:t,pageLoadStates:r,retryFailedPagesKeyPrefix:s,isPreloadMode:n,...o})=>{const{currentPageIndex:i,pages:l,totalPages:c,readingDirection:g,pageScaleMode:u}=o,{direction:d}=dt(),f=S.useMemo(()=>sr(i,l),[i,l]),h=g===$.LTR;return a.jsx(Fe,{...o,createPage:(v,p,m,_,R,...E)=>{const{primary:T,secondary:I}=v,L=et(f),j=!!I,V=f.primary.index===T.index,W=!!I&&L===I.index;return a.jsxs(S.Fragment,{children:[Ee(v,p,!0,r[T.index].loaded,n,e,t,m,_&&V&&m,f.primary.index,c,...E,r[T.index].error?s:void 0,j?Tt("first",d,g):void 0,j),j&&Ee({...v,primary:{...v.secondary}},p,!1,r[I.index].loaded,n,e,t,m,_&&W&&m,L,c,...E,r[I.index].error?s:void 0,Tt("second",d,g),!0)]},"".concat(T.url,"_").concat(I==null?void 0:I.url))},slots:{boxProps:{sx:{...y(u===M.ORIGINAL,{margin:"auto"}),width:"100%",minWidth:"fit-content",height:"100%",minHeight:"fit-content",display:"flex",flexDirection:"row",flexWrap:"nowrap",...y(d==="ltr",{flexDirection:h?"row":"row-reverse"}),...y(d==="rtl",{flexDirection:h?"row-reverse":"row"})}}}})},bn=S.memo(vn),Sn=({onLoad:e,onError:t,pageLoadStates:r,retryFailedPagesKeyPrefix:s,isPreloadMode:n,...o})=>{const{currentPageIndex:i,totalPages:l,readingMode:c,pageGap:g}=o,d=c===C.WEBTOON?0:g;return a.jsx(Fe,{...o,createPage:(f,h,v,p,m,..._)=>Ee(f,h,!0,r[f.primary.index].loaded,n,e,t,v,!n,i,l,..._,r[f.primary.index].error?s:void 0,void 0,void 0,f.primary.index!==0?d:0,m),slots:{boxProps:{sx:{margin:"auto"}}}})},En=S.memo(Sn),Rn=({onLoad:e,onError:t,pageLoadStates:r,retryFailedPagesKeyPrefix:s,isPreloadMode:n,...o})=>{const{currentPageIndex:i,totalPages:l,pageGap:c,readingDirection:g}=o,{direction:u}=dt(),d=g===$.LTR;return a.jsx(Fe,{...o,createPage:(f,h,v,p,m,..._)=>Ee(f,h,!0,r[f.primary.index].loaded,n,e,t,v,!n,i,l,..._,r[f.primary.index].error?s:void 0,void 0,void 0,void 0,m),slots:{boxProps:{sx:{my:"auto",display:"flex",flexWrap:"nowrap",alignItems:"center",gap:"".concat(c,"px"),...y(u==="ltr",{flexDirection:d?"row":"row-reverse",justifyContent:d?"flex-start":"flex-end"}),...y(u==="rtl",{flexDirection:d?"row-reverse":"row",justifyContent:d?"flex-end":"flex-start"})}}}})},yn=S.memo(Rn),Tn=e=>e===C.DOUBLE_PAGE,ut=e=>[M.WIDTH,M.SCREEN].includes(e),aa=e=>ut(e),ia=e=>[M.HEIGHT,M.SCREEN].includes(e),or=(e,t)=>!!(e!=null&&e.enabled)&&ut(t),An=(e,t)=>{if(or(e,t))return e==null?void 0:e.value},J=e=>[C.CONTINUOUS_VERTICAL,C.CONTINUOUS_HORIZONTAL,C.WEBTOON].includes(e),De=e=>[C.CONTINUOUS_VERTICAL,C.WEBTOON].includes(e),la=(e,t,r)=>t&&r.isDefault&&on.isLongStripType(e),ca=e=>{switch(e){case C.SINGLE_PAGE:return xn;case C.DOUBLE_PAGE:return bn;case C.CONTINUOUS_VERTICAL:case C.WEBTOON:return En;case C.CONTINUOUS_HORIZONTAL:return yn;default:throw new Error('Unexpected "ReadingMode" ('.concat(e,")"))}},da=(e,t,r=0,s=0)=>e!==G.AUTO?e:window.innerHeight-r>window.innerWidth-s?t:G.BOTTOM,At=e=>{let t;const r=new Set,s=(g,u)=>{const d=typeof g=="function"?g(t):g;if(!Object.is(d,t)){const f=t;t=(u!=null?u:typeof d!="object"||d===null)?d:Object.assign({},t,d),r.forEach(h=>h(t,f))}},n=()=>t,l={setState:s,getState:n,getInitialState:()=>c,subscribe:g=>(r.add(g),()=>r.delete(g))},c=t=e(s,n,l);return l},Pn=e=>e?At(e):At,In=e=>e;function On(e,t=In){const r=ce.useSyncExternalStore(e.subscribe,ce.useCallback(()=>t(e.getState()),[e,t]),ce.useCallback(()=>t(e.getInitialState()),[e,t]));return ce.useDebugValue(r),r}const Pt=e=>{const t=Pn(e),r=s=>On(t,s);return Object.assign(r,t),r},Cn=e=>e?Pt(e):Pt,It={BASE_URL:"./",DEV:!1,LEGACY:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SERVER_URL_DEFAULT:"http://localhost:4567"},xe=new Map,Pe=e=>{const t=xe.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([r,s])=>[r,s.getState()])):{}},jn=(e,t,r)=>{if(e===void 0)return{type:"untracked",connection:t.connect(r)};const s=xe.get(r.name);if(s)return{type:"tracked",store:e,...s};const n={connection:t.connect(r),stores:{}};return xe.set(r.name,n),{type:"tracked",store:e,...n}},Dn=(e,t)=>{if(t===void 0)return;const r=xe.get(e);r&&(delete r.stores[t],Object.keys(r.stores).length===0&&xe.delete(e))},wn=e=>{var t,r;if(!e)return;const s=e.split("\n"),n=s.findIndex(i=>i.includes("api.setState"));if(n<0)return;const o=((t=s[n+1])==null?void 0:t.trim())||"";return(r=/.+ (.+) .+/.exec(o))==null?void 0:r[1]},Ln=(e,t={})=>(r,s,n)=>{const{enabled:o,anonymousActionType:i,store:l,...c}=t;let g;try{g=(o!=null?o:(It?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(p){}if(!g)return e(r,s,n);const{connection:u,...d}=jn(l,g,c);let f=!0;n.setState=(p,m,_)=>{const R=r(p,m);if(!f)return R;const E=_===void 0?{type:i||wn(new Error().stack)||"anonymous"}:typeof _=="string"?{type:_}:_;return l===void 0?(u==null||u.send(E,s()),R):(u==null||u.send({...E,type:"".concat(l,"/").concat(E.type)},{...Pe(c.name),[l]:n.getState()}),R)},n.devtools={cleanup:()=>{u&&typeof u.unsubscribe=="function"&&u.unsubscribe(),Dn(c.name,l)}};const h=(...p)=>{const m=f;f=!1,r(...p),f=m},v=e(n.setState,s,n);if(d.type==="untracked"?u==null||u.init(v):(d.stores[d.store]=n,u==null||u.init(Object.fromEntries(Object.entries(d.stores).map(([p,m])=>[p,p===d.store?v:m.getState()])))),n.dispatchFromDevtools&&typeof n.dispatch=="function"){let p=!1;const m=n.dispatch;n.dispatch=(..._)=>{(It?"production":void 0)!=="production"&&_[0].type==="__setState"&&!p&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),p=!0),m(..._)}}return u.subscribe(p=>{var m;switch(p.type){case"ACTION":if(typeof p.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Ke(p.payload,_=>{if(_.type==="__setState"){if(l===void 0){h(_.state);return}Object.keys(_.state).length!==1&&console.error('\n                    [zustand devtools middleware] Unsupported __setState action format.\n                    When using \'store\' option in devtools(), the \'state\' should have only one key, which is a value of \'store\' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }\n                    ');const R=_.state[l];if(R==null)return;JSON.stringify(n.getState())!==JSON.stringify(R)&&h(R);return}n.dispatchFromDevtools&&typeof n.dispatch=="function"&&n.dispatch(_)});case"DISPATCH":switch(p.payload.type){case"RESET":return h(v),l===void 0?u==null?void 0:u.init(n.getState()):u==null?void 0:u.init(Pe(c.name));case"COMMIT":if(l===void 0){u==null||u.init(n.getState());return}return u==null?void 0:u.init(Pe(c.name));case"ROLLBACK":return Ke(p.state,_=>{if(l===void 0){h(_),u==null||u.init(n.getState());return}h(_[l]),u==null||u.init(Pe(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Ke(p.state,_=>{if(l===void 0){h(_);return}JSON.stringify(n.getState())!==JSON.stringify(_[l])&&h(_[l])});case"IMPORT_STATE":{const{nextLiftedState:_}=p.payload,R=(m=_.computedStates.slice(-1)[0])==null?void 0:m.state;if(!R)return;h(l===void 0?R:R[l]),u==null||u.send(null,_);return}case"PAUSE_RECORDING":return f=!f}return}}),v},Mn=Ln,Ke=(e,t)=>{let r;try{r=JSON.parse(e)}catch(s){console.error("[zustand devtools middleware] Could not parse the received json",s)}r!==void 0&&t(r)};var ar=Symbol.for("immer-nothing"),Ot=Symbol.for("immer-draftable"),N=Symbol.for("immer-state");function F(e,...t){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var ve=Object.getPrototypeOf;function oe(e){return!!e&&!!e[N]}function te(e){var t;return e?ir(e)||Array.isArray(e)||!!e[Ot]||!!((t=e.constructor)!=null&&t[Ot])||ye(e)||He(e):!1}var Nn=Object.prototype.constructor.toString(),Ct=new WeakMap;function ir(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let s=Ct.get(r);return s===void 0&&(s=Function.toString.call(r),Ct.set(r,s)),s===Nn}function Me(e,t,r=!0){Ge(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)}):e.forEach((s,n)=>t(n,s,e))}function Ge(e){const t=e[N];return t?t.type_:Array.isArray(e)?1:ye(e)?2:He(e)?3:0}function tt(e,t){return Ge(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function lr(e,t,r){const s=Ge(e);s===2?e.set(t,r):s===3?e.add(r):e[t]=r}function kn(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function ye(e){return e instanceof Map}function He(e){return e instanceof Set}function q(e){return e.copy_||e.base_}function rt(e,t){if(ye(e))return new Map(e);if(He(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=ir(e);if(t===!0||t==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(e);delete s[N];let n=Reflect.ownKeys(s);for(let o=0;o<n.length;o++){const i=n[o],l=s[i];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(s[i]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[i]})}return Object.create(ve(e),s)}else{const s=ve(e);if(s!==null&&r)return{...e};const n=Object.create(s);return Object.assign(n,e)}}function gt(e,t=!1){return ze(e)||oe(e)||!te(e)||(Ge(e)>1&&Object.defineProperties(e,{set:Ie,add:Ie,clear:Ie,delete:Ie}),Object.freeze(e),t&&Object.values(e).forEach(r=>gt(r,!0))),e}function Un(){F(2)}var Ie={value:Un};function ze(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Vn={};function re(e){const t=Vn[e];return t||F(0,e),t}var be;function cr(){return be}function Bn(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function jt(e,t){t&&(re("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function nt(e){st(e),e.drafts_.forEach(Fn),e.drafts_=null}function st(e){e===be&&(be=e.parent_)}function Dt(e){return be=Bn(be,e)}function Fn(e){const t=e[N];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function wt(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[N].modified_&&(nt(t),F(4)),te(e)&&(e=Ne(t,e),t.parent_||ke(t,e)),t.patches_&&re("Patches").generateReplacementPatches_(r[N].base_,e,t.patches_,t.inversePatches_)):e=Ne(t,r,[]),nt(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==ar?e:void 0}function Ne(e,t,r){if(ze(t))return t;const s=e.immer_.shouldUseStrictIteration(),n=t[N];if(!n)return Me(t,(o,i)=>Lt(e,n,t,o,i,r),s),t;if(n.scope_!==e)return t;if(!n.modified_)return ke(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const o=n.copy_;let i=o,l=!1;n.type_===3&&(i=new Set(o),o.clear(),l=!0),Me(i,(c,g)=>Lt(e,n,o,c,g,r,l),s),ke(e,o,!1),r&&e.patches_&&re("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Lt(e,t,r,s,n,o,i){if(n==null||typeof n!="object"&&!i)return;const l=ze(n);if(!(l&&!i)){if(oe(n)){const c=o&&t&&t.type_!==3&&!tt(t.assigned_,s)?o.concat(s):void 0,g=Ne(e,n,c);if(lr(r,s,g),oe(g))e.canAutoFreeze_=!1;else return}else i&&r.add(n);if(te(n)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[s]===n&&l)return;Ne(e,n),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&(ye(r)?r.has(s):Object.prototype.propertyIsEnumerable.call(r,s))&&ke(e,n)}}}function ke(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&gt(t,r)}function Gn(e,t){const r=Array.isArray(e),s={type_:r?1:0,scope_:t?t.scope_:cr(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,o=ht;r&&(n=[s],o=Se);const{revoke:i,proxy:l}=Proxy.revocable(n,o);return s.draft_=l,s.revoke_=i,l}var ht={get(e,t){if(t===N)return e;const r=q(e);if(!tt(r,t))return Hn(e,r,t);const s=r[t];return e.finalized_||!te(s)?s:s===Xe(e.base_,t)?(Je(e),e.copy_[t]=at(s,e)):s},has(e,t){return t in q(e)},ownKeys(e){return Reflect.ownKeys(q(e))},set(e,t,r){const s=dr(q(e),t);if(s!=null&&s.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const n=Xe(q(e),t),o=n==null?void 0:n[N];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(kn(r,n)&&(r!==void 0||tt(e.base_,t)))return!0;Je(e),ot(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Xe(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Je(e),ot(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=q(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:r[t]}},defineProperty(){F(11)},getPrototypeOf(e){return ve(e.base_)},setPrototypeOf(){F(12)}},Se={};Me(ht,(e,t)=>{Se[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Se.deleteProperty=function(e,t){return Se.set.call(this,e,t,void 0)};Se.set=function(e,t,r){return ht.set.call(this,e[0],t,r,e[0])};function Xe(e,t){const r=e[N];return(r?q(r):e)[t]}function Hn(e,t,r){var n;const s=dr(t,r);return s?"value"in s?s.value:(n=s.get)==null?void 0:n.call(e.draft_):void 0}function dr(e,t){if(!(t in e))return;let r=ve(e);for(;r;){const s=Object.getOwnPropertyDescriptor(r,t);if(s)return s;r=ve(r)}}function ot(e){e.modified_||(e.modified_=!0,e.parent_&&ot(e.parent_))}function Je(e){e.copy_||(e.copy_=rt(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var zn=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,s)=>{if(typeof t=="function"&&typeof r!="function"){const o=r;r=t;const i=this;return function(c=o,...g){return i.produce(c,u=>r.call(this,u,...g))}}typeof r!="function"&&F(6),s!==void 0&&typeof s!="function"&&F(7);let n;if(te(t)){const o=Dt(this),i=at(t,void 0);let l=!0;try{n=r(i),l=!1}finally{l?nt(o):st(o)}return jt(o,s),wt(n,o)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===ar&&(n=void 0),this.autoFreeze_&&gt(n,!0),s){const o=[],i=[];re("Patches").generateReplacementPatches_(t,n,o,i),s(o,i)}return n}else F(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...l)=>this.produceWithPatches(i,c=>t(c,...l));let s,n;return[this.produce(t,r,(i,l)=>{s=i,n=l}),s,n]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){te(e)||F(8),oe(e)&&(e=$n(e));const t=Dt(this),r=at(e,void 0);return r[N].isManual_=!0,st(t),r}finishDraft(e,t){const r=e&&e[N];(!r||!r.isManual_)&&F(9);const{scope_:s}=r;return jt(s,t),wt(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const s=re("Patches").applyPatches_;return oe(e)?s(e,t):this.produce(e,n=>s(n,t))}};function at(e,t){const r=ye(e)?re("MapSet").proxyMap_(e,t):He(e)?re("MapSet").proxySet_(e,t):Gn(e,t);return(t?t.scope_:cr()).drafts_.push(r),r}function $n(e){return oe(e)||F(10,e),ur(e)}function ur(e){if(!te(e)||ze(e))return e;const t=e[N];let r,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=rt(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else r=rt(e,!0);return Me(r,(n,o)=>{lr(r,n,ur(o))},s),t&&(t.finalized_=!1),r}var Wn=new zn,Yn=Wn.produce;const Zn=e=>(t,r,s)=>(s.setState=(n,o,...i)=>{const l=typeof n=="function"?Yn(n):n;return t(l,o,...i)},e(s.setState,r,s)),Kn=Zn,Mt=e=>Symbol.iterator in e,Nt=e=>"entries"in e,kt=(e,t)=>{const r=e instanceof Map?e:new Map(e.entries()),s=t instanceof Map?t:new Map(t.entries());if(r.size!==s.size)return!1;for(const[n,o]of r)if(!s.has(n)||!Object.is(o,s.get(n)))return!1;return!0},Xn=(e,t)=>{const r=e[Symbol.iterator](),s=t[Symbol.iterator]();let n=r.next(),o=s.next();for(;!n.done&&!o.done;){if(!Object.is(n.value,o.value))return!1;n=r.next(),o=s.next()}return!!n.done&&!!o.done};function Jn(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null||Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?!1:Mt(e)&&Mt(t)?Nt(e)&&Nt(t)?kt(e,t):Xn(e,t):kt({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)})}function Qn(e){const t=ce.useRef(void 0);return r=>{const s=e(r);return Jn(t.current,s)?t.current:t.current=s}}const Ut={isVisible:!1},qn=(...[e,t,r])=>({overlay:{isVisible:Ut.isVisible,setIsVisible:s=>t(n=>{n.overlay.isVisible=s},void 0,e("setIsVisible")),reset:()=>({overlay:{...r().overlay,...Ut}})}}),Vt={isActive:!1,isPaused:!1,start:ie,cancel:ie,toggleActive:ie,pause:ie,resume:ie,invert:!1,direction:Or.FORWARD,scrollRef:void 0},es=(...[e,t,r])=>({autoScroll:{...Vt,reset:()=>({autoScroll:{...r().autoScroll,...Vt}}),setIsActive:s=>t(n=>{n.autoScroll.isActive=s},void 0,e("setIsActive")),setIsPaused:s=>t(n=>{n.autoScroll.isPaused=s},void 0,e("setIsPaused")),setStart:s=>t(n=>{n.autoScroll.start=s},void 0,e("setStart")),setCancel:s=>t(n=>{n.autoScroll.cancel=s},void 0,e("setCancel")),setToggleActive:s=>t(n=>{n.autoScroll.toggleActive=s},void 0,e("setToggleActive")),setPause:s=>t(n=>{n.autoScroll.pause=s},void 0,e("setPause")),setResume:s=>t(n=>{n.autoScroll.resume=s},void 0,e("setResume")),setInvert:s=>t(n=>{n.autoScroll.invert=s},void 0,e("setInvert")),setDirection:s=>t(n=>{n.autoScroll.direction=s},void 0,e("setDirection")),setScrollRef:s=>t(n=>{if(!s){n.autoScroll.scrollRef=void 0;return}const o=S.createRef();o.current=s,n.autoScroll.scrollRef=o},void 0,e("setScrollRef"))}}),Bt={isMaximized:!1,isDragging:!1},ts=(...[e,t,r])=>({progressBar:{...Bt,setIsMaximized:s=>t(n=>{n.progressBar.isMaximized=s},void 0,e("setIsMaximized")),setIsDragging:s=>t(n=>{n.progressBar.isDragging=s},void 0,e("setIsDragging")),reset:()=>({progressBar:{...r().progressBar,...Bt}})}}),Ft={showPreview:!1},rs=(...[e,t,r])=>({tapZone:{...Ft,setShowPreview:s=>t(n=>{n.tapZone.showPreview=s},void 0,e("setShowPreview")),reset:()=>({tapZone:{...r().tapZone,...Ft}})}}),Gt={totalPages:0,currentPageIndex:0,pageToScrollToIndex:null,pageUrls:[],pageLoadStates:[{url:"",loaded:!1}],pages:[{name:"1",primary:{index:0,alt:"Page #1",url:"".concat(Z.getBaseUrl())}}],transitionPageMode:_e.NONE,retryFailedPagesKeyPrefix:""},ns=(...[e,t,r])=>({pages:{...Gt,reset:()=>({pages:{...r().pages,...Gt}}),setCurrentPageIndex:s=>t(n=>{n.pages.currentPageIndex=s},void 0,e("setCurrentPageIndex")),setPageToScrollToIndex:s=>t(n=>{n.pages.pageToScrollToIndex=s},void 0,e("setPageToScrollToIndex")),setTotalPages:s=>t(n=>{n.pages.totalPages=s},void 0,e("setTotalPages")),setPageUrls:s=>t(n=>{n.pages.pageUrls=s},void 0,e("setPageUrls")),setPageLoadStates:s=>t(n=>{if(typeof s=="function"){n.pages.pageLoadStates=s(r().pages.pageLoadStates);return}n.pages.pageLoadStates=s},void 0,e("setPageLoadStates")),setPages:s=>t(n=>{n.pages.pages=s},void 0,e("setPages")),setTransitionPageMode:s=>t(n=>{n.pages.transitionPageMode=s},void 0,e("setTransitionPageMode")),setRetryFailedPagesKeyPrefix:s=>t(n=>{n.pages.retryFailedPagesKeyPrefix=s},void 0,e("setRetryFailedPagesKeyPrefix"))}}),Ht={chapters:{mangaChapters:void 0,chapters:[],chapterForDuplicatesHandling:void 0,initialChapter:void 0,currentChapter:void 0,nextChapter:void 0,previousChapter:void 0,isCurrentChapterReady:!1,visibleChapters:{leading:0,trailing:0,lastLeadingChapterSourceOrder:99999,lastTrailingChapterSourceOrder:-1,isLeadingChapterPreloadMode:!0,isTrailingChapterPreloadMode:!0,scrollIntoView:!1,resumeMode:void 0}}},ss=(...[e,t,r])=>({chapters:{...Ht.chapters,reset:()=>({chapters:{...r().chapters,...Ht.chapters}}),setReaderStateChapters:s=>t(n=>{if(typeof s=="function"){n.chapters={...r().chapters,...s(r().chapters)};return}n.chapters={...r().chapters,...s}},void 0,e("setReaderStateChapters"))}});class Ue{static createActionName(...t){const r=t.slice(0,-1),s=t.slice(-1)[0];return"".concat(r.join(":"),"/").concat(s)}static createActionNameCreator(t,r=Ue.createActionName){return(...s)=>r(t,...s)}}const os=["scrollRef"],Oe={manga:void 0,scrollbar:{xSize:0,ySize:0}},K=Cn()(Mn(Kn((e,t,r)=>{const s=Ue.createActionNameCreator("reader"),n=o=>Ue.createActionNameCreator(o,s);return{...Oe,reset:()=>e(()=>({...t(),...Oe,scrollbar:{...t().scrollbar,...Oe.scrollbar},settings:{...t().settings,...Rt},...t().overlay.reset(),...t().autoScroll.reset(),...t().pages.reset(),...t().chapters.reset(),...t().progressBar.reset(),...t().tapZone.reset()}),void 0,s("reset")),setManga:o=>e(i=>{i.manga=o},void 0,s("setManga")),scrollbar:{...Oe.scrollbar,setXSize:o=>e(i=>{i.scrollbar.xSize=o},void 0,s("scrollbar","setXSize")),setYSize:o=>e(i=>{i.scrollbar.ySize=o},void 0,s("scrollbar","setYSize"))},settings:{...Rt,setSettings:o=>e(i=>{i.settings={...t().settings,...o}},void 0,s("settings","setSettings"))},...qn(n("overlay"),e,t,r),...es(n("autoScroll"),e,t,r),...ns(n("pages"),e,t,r),...ss(n("chapters"),e,t,r),...ts(n("progressBar"),e,t,r),...rs(n("tapZone"),e,t,r)}}),{name:"ReaderStore",anonymousActionType:"reader/action",serialize:{replacer:(e,t)=>os.includes(e)?null:t}})),Q=e=>K(Qn(e)),Ce=()=>K.getState(),as=Q,ua=()=>K.getState().scrollbar,Qe=Q,is=()=>K.getState().settings,ga=Q,ha=()=>K.getState().overlay,fa=Q,_a=()=>K.getState().autoScroll,pa=Q,ma=()=>K.getState().pages,xa=Q,ls=()=>K.getState().chapters,va=Q,cs=Q,ba=()=>K.getState().tapZone,ds=e=>Object.keys(e).map(t=>{const r=t,s=e[r];switch(r){case"brightness":case"contrast":case"saturate":return s.enabled?"".concat(r,"(").concat(s.value/100,")"):"";case"hue":return s.enabled?"hue-rotate(".concat(s.value,"deg)"):"";case"rgba":return"";case"sepia":case"grayscale":case"invert":return s?"".concat(r,"(").concat(Number(s),")"):"";default:throw new Error('Unexpected "CustomFilter" ('.concat(r,")"))}}).join(" "),us=({pageIndex:e,pagesIndex:t,isPrimaryPage:r,display:s,doublePage:n=!1,position:o,marginTop:i,shouldLoad:l,readingMode:c,customFilter:g,pageScaleMode:u,shouldStretchPage:d,readerWidth:f,onLoad:h,onError:v,setRef:p,readerNavBarWidth:m,isLoaded:_,...R})=>{const{src:E}=R,T=Ve.useIsTabletWidth(),I=as(W=>W.scrollbar),L=S.useCallback(()=>h==null?void 0:h(t,E,r),[h,t,E,r]),j=S.useCallback(()=>v==null?void 0:v(e,E),[v,e,E]),V=S.useCallback(W=>p==null?void 0:p(t,W),[t,p]);return!s&&!l?null:a.jsx(an,{...R,onLoad:L,onError:j,shouldLoad:l,shouldDecode:!0,ref:V,spinnerStyle:{backgroundColor:"background.paper",...fs(c,d,u,f,m+I.ySize,I.xSize,n,T),...y(!s,{display:"none"}),...zt(n,o)},imgStyle:{...ps(c,d,u,n,f,m+I.ySize,I.xSize),filter:ds(g),objectFit:"contain",objectPosition:o,userSelect:"none",...zt(n,o),...y(i!==void 0,{mt:"".concat(i,"px")}),display:"block",...y(!s,{display:"none"}),...y(!_,{margin:"unset"})},hideImgStyle:{visibility:"hidden",minWidth:0,minHeight:0,width:0,height:0}})},gs=S.memo(us),hs=(e,t,r,s)=>{if(or(r,e)){const n=r.value;return t?n/100/2:n/100}return t?.5:1},fs=(e,t,r,s,n,o,i,l)=>{const g=E=>"calc(".concat(E," - ").concat(n,"px)"),u=(E,T)=>g("".concat(Re(T!=null?T:E,Math.min(E,T!=null?T:9e3),E),"vw")),d=An(s,r),f=g("".concat(Math.min(100,d!=null?d:9e3),"vw")),h="calc(100vh - ".concat(o,"px)"),v=l?f:u(40,d),p=l?h:"85vh",_={...{[C.SINGLE_PAGE]:{minWidth:v,minHeight:p},[C.DOUBLE_PAGE]:{minWidth:l?"50vw":u(35,d?d/2:void 0),minHeight:p},[C.CONTINUOUS_VERTICAL]:{minWidth:v,minHeight:"100vh"},[C.CONTINUOUS_HORIZONTAL]:{minWidth:v,minHeight:p},[C.WEBTOON]:{minWidth:v,minHeight:"100vh"}}[e],height:"unset"},R=i?"calc(".concat(g("".concat(d!=null?d:100,"vw"))," / 2)"):f;switch(r){case M.WIDTH:return{..._,...y(t,{minWidth:R})};case M.HEIGHT:return{..._,...y(t,{minHeight:h,...y(De(e),{minHeight:"100vh"})})};case M.SCREEN:return{..._,...y(t,{minWidth:R,minHeight:h,...y(De(e),{minHeight:"100vh"})})};case M.ORIGINAL:return{..._,...y(De(e),{height:void 0})};default:throw new Error('Unexpected "PageScaleMode" ('.concat(r,")"))}},_s=(e,t,r,s,n,o)=>{const i="calc((100vw - ".concat(n,"px) * ").concat(e,")"),l="calc(100vh - ".concat(o,"px)");switch(s){case M.WIDTH:return{minWidth:0,...y(J(t),{minWidth:"unset"}),...y(r,{minWidth:i}),maxWidth:i};case M.HEIGHT:return{minHeight:0,...y(J(t),{minHeight:"unset"}),...y(r,{minHeight:l}),maxHeight:l};case M.SCREEN:return{minWidth:0,minHeight:0,...y(J(t),{minWidth:"unset",minHeight:"unset"}),...y(r,{minWidth:i,minHeight:l,...y(t===C.CONTINUOUS_HORIZONTAL,{minWidth:"unset",minHeight:l}),...y(De(t),{minWidth:i,minHeight:"unset"})}),maxWidth:i,maxHeight:l};case M.ORIGINAL:return{};default:throw new Error('Unexpected "PageScaleMode" ('.concat(s,")"))}},ps=(e,t,r,s,n,o,i)=>{const l=hs(r,s,n);return _s(l,e,t,r,o,i)},zt=(e,t)=>({m:"auto",...y(e,{...y(t==="right",{mr:"unset "}),...y(t==="left",{ml:"unset "})})}),it=(e,t)=>({index:t,alt:"Page #".concat(t+1),url:"".concat(Z.getBaseUrl()).concat(e)}),ms=(e,t)=>({name:"".concat(t+1),primary:it(e,t)}),Sa=e=>e.map(ms),xs=(e,t,r,s,n)=>{if(!s||n)return Number.MAX_SAFE_INTEGER;const o=Math.abs(t-e),i=r-o;return t<e?i-1:i},Ee=({primary:{index:e,alt:t,url:r}},s,n,o,i,l,c,g,u,d,f,h,v,p,m,_,R,E,T,I,L,j)=>a.jsx(gs,{setRef:j,pageIndex:e,pagesIndex:s,isPrimaryPage:n,src:r,alt:t,display:u,priority:xs(d,e,f,g,i),position:T,onLoad:l,onError:c,doublePage:I,shouldLoad:g,retryKeyPrefix:E,marginTop:L,isLoaded:o,readingMode:h,customFilter:v,pageScaleMode:p,shouldStretchPage:m,readerWidth:_,readerNavBarWidth:R},r),gr=(e,{truncateValues:t,thresholds:r}={truncateValues:!1,thresholds:{}})=>{const{top:s,bottom:n,left:o,right:i}=e.getBoundingClientRect(),l=E=>t?Math.trunc(E):E,c=l(s),g=l(n),u=l(o),d=l(i),f={top:0,bottom:0,left:0,right:0,...r},h=u>=f.left&&u<=window.innerWidth,v=d>=f.right&&d<=window.innerWidth,p=u<=0&&d>=window.innerWidth,m=c>=f.top&&c<=window.innerHeight,_=g>=f.bottom&&g<=window.innerHeight,R=c<=0&&g>=window.innerHeight;return{isLeftInViewport:h,isRightInViewport:v,isFillingWidthViewportCompletely:p,isTopInViewport:m,isBottomInViewport:_,isFillingHeightViewportCompletely:R}},Ea=(e,t,r)=>{const{isLeftInViewport:s,isRightInViewport:n,isFillingWidthViewportCompletely:o,isTopInViewport:i,isBottomInViewport:l,isFillingHeightViewportCompletely:c}=gr(e,r),g=s||n||o,u=i||l||c;switch(t){case we.X:return g;case we.Y:return u;default:throw new Error('unexpected "type" ('.concat(t,")"))}},Ra=(e,t,r)=>{const{isLeftInViewport:s,isRightInViewport:n,isBottomInViewport:o}=gr(e);switch(t){case we.X:return r===$.LTR?n:s;case we.Y:return o;default:throw new Error('unexpected "type" ('.concat(t,")"))}},ya=(e,t,r,s)=>{const n=[],o=t.map((i,l)=>l+t.slice(0,l).filter(({isSpread:c})=>c).length);return e.forEach((i,l)=>{var j;const g=!(o[l]%2),u=(g?1:-1)*(r?-1:1),d=l+u,f=l<d,h=l===0,v=l===e.length-1,p=f&&!v,m=t[l].isSpread,_=!!((j=t[d])!=null&&j.isSpread),T=!(m||_)&&!(h&&r);if(!f&&T){const V=n[n.length-1];n[n.length-1]={...V,secondary:it(i,l)};return}const I="-",L="".concat(l+1).concat(p&&T?"".concat(I).concat(d+1):"");n.push({name:s===$.LTR?L:ln(L,I),primary:it(i,l)})}),n},vs=e=>e.height/e.width<1,bs=0,Ss=1,Es=(e,t,r,s)=>e?s:t||r?Re(Ss,bs,s):0,Rs=2,ys=(e,t,r,s,n,o,i,l)=>{if(!o&&!i&&!l)return[];const c=sr(e,t).pagesIndex,g=Es(o,i,l,s),u=r<=e&&!i?1:-1,d=Math.max(0,c-Math.min(Rs,g)*u),f=J(n)?e:d,h=c+g*u,v=Math.max(1,Math.abs(h-f)+Number(o));return Array(v).fill(1).map((p,m)=>f+m*u)},Ta=(e,t,r)=>[_e.BOTH,e].includes(t)||J(r),Ts=(e,t)=>e!==_e.NONE||J(t),Aa=(e,t)=>{const r=Kt[t];return e==="ltr"?Le("start","end",r):Le("end","start",r)},Pa=(e,t,r)=>{const s=Kt[r];return t==="ltr"?Le(0,e.scrollWidth,s):Le(-e.scrollWidth,0,s)},hr=(e,t)=>t===void 0||t.url!==e,As=(e,t,r)=>e===z.START?0:e===z.END?r:Re(t,0,r),he=e=>B.getFromCache(e,Cr,"CHAPTER_READER_FIELDS"),Ps=(e,t,r,s,n,o,i)=>{if(!(!!s.isRead&&!!n))return[];const c=[e,...r][n-1];if(!c)return[];const u=(i?B.addDuplicates([c],t):[c]).map(({id:d})=>he(d)).filter(d=>d!==null).filter(d=>B.isDeletable(d,o));return u.length?B.getIds(u):[]},fr=(e,t,r=ge.NEXT)=>{const s=(e+1)/t;return r===ge.PREVIOUS?s<.75:s>.25},Is=(e,t,r,s,n)=>{const o=he(e.id);if(!o||!t)return[];if(!(!!n&&o.isDownloaded&&fr(s,o.pageCount)))return[];const c=he(t.id);return c!=null&&c.isDownloaded?B.getNonRead(r).map(u=>he(u.id)).filter(u=>!!u).slice(-n).filter(u=>!u.isDownloaded).map(u=>u.id).filter(u=>!B.isDownloading(u)):[]},Ia=(e,t,r,s)=>(n,o,i=!0)=>{if(n>e.length-1)return;const l=e[n],{index:c}=i?l.primary:l.secondary;if(s===C.DOUBLE_PAGE){const g=new Image;g.onload=()=>{const u=vs(g);u&&t(d=>{const f=d[c];return f===void 0||f.url!==o||f.isSpread===u?d:d.toSpliced(c,1,{url:o,isSpread:u})})},g.crossOrigin="anonymous",g.src=o}r(g=>{const u=g[c];return hr(o,u)||u.loaded?g:g.toSpliced(c,1,{url:u.url,loaded:!0})})},Oa=(e,t)=>{if(e)return t?z.END:z.START},Ca=e=>(t,r)=>{e(s=>{const n=s[t];return hr(r,n)?s:s.toSpliced(t,1,{...n,loaded:!1,error:!0})})},Os=(e,t,r,s,n,o)=>{const{leading:i,trailing:l,lastLeadingChapterSourceOrder:c,lastTrailingChapterSourceOrder:g}=t.visibleChapters,u=e&&r<c,d=!e&&r>g;return{...t,visibleChapters:{...t.visibleChapters,leading:i+Number(u),trailing:l+Number(d),lastLeadingChapterSourceOrder:u?r:c,lastTrailingChapterSourceOrder:d?r:g,isLeadingChapterPreloadMode:n!==void 0?n:t.visibleChapters.isLeadingChapterPreloadMode,isTrailingChapterPreloadMode:o!==void 0?o:t.visibleChapters.isTrailingChapterPreloadMode,scrollIntoView:s,resumeMode:e?z.END:z.START}}},ja=(e,t,r,s,n,o,i,l)=>{if(s){if(n)return Re(e,0,t.pageCount-1);if(l.scrollIntoView&&l.resumeMode!==void 0)return As(l.resumeMode,0,t.pageCount-1);if(o)return Math.max(0,t.pageCount-1);if(i)return 0}return t.sourceOrder<r.sourceOrder?Math.max(t.pageCount-1,0):0},Da=(e,t,r,s,n,o)=>e&&n!==void 0?n:t?o:r?z.END:s?z.START:z.START,wa=(e,t,r)=>{const s=!!t[e+1],o=e+1>=t.length-1&&r.isLeadingChapterPreloadMode,i=s&&!o,l=!!t[e-1],g=e-1<=0&&r.isTrailingChapterPreloadMode;return{previous:i,next:l&&!g}},Cs={ltr:"rtl",rtl:"ltr"},js={ltr:$.LTR,rtl:$.RTL},Y=class Y{static getOrCreateChapterUpdateQueue(t){return Y.chapterUpdateQueues.has(t)||Y.chapterUpdateQueues.set(t,new ft(1)),Y.chapterUpdateQueues.get(t)}static navigateToChapter(t,r){jr.navigate(B.getReaderUrl(t),{replace:!0,state:r})}static downloadAhead(t,r,s,n,o){const i="".concat(t.id,"_").concat(r==null?void 0:r.id,"_").concat(n,"_").concat(o);Y.downloadAheadQueue.enqueue(i,async()=>{const l=Is(t,r,s,n,o);if(l.length)try{await B.download(l)}catch(c){}})}static preloadChapter(t,r,s,n,o,i,l){if(!s)return;const c=l===ge.PREVIOUS,g=l===ge.NEXT;!(c&&n<=s.sourceOrder||g&&o>=s.sourceOrder)&&fr(t,r,l)&&i(f=>Os(c,f,s.sourceOrder,!1,c?!0:void 0,g?!0:void 0))}static useUpdateChapter(){const{settings:{deleteChaptersWhileReading:t,deleteChaptersWithBookmark:r,updateProgressAfterReading:s}}=Dr();return S.useCallback(n=>{const{manga:o}=Ce(),{currentChapter:i,mangaChapters:l,chapters:c}=ls(),{shouldSkipDupChapters:g}=is();if(!o||!i||!l)return;const u=B.getNextChapters(i,c,{offset:ge.PREVIOUS}),d=async()=>{const f=B.getIds(g?B.addDuplicates([i],l):[i]),h=Ps(i,l,u,n,t,r,g);(h.length||f.some(p=>{const m=he(p);return m?n.isRead!==void 0&&n.isRead!==m.isRead||n.lastPageRead!==void 0&&n.lastPageRead!==m.lastPageRead||n.isBookmarked!==void 0&&n.isBookmarked!==m.isBookmarked:!1}))&&await Z.updateChapters(f,{...n,chapterIdsToDelete:h,trackProgressMangaId:s&&n.isRead&&o.trackRecords.totalCount?o.id:void 0},{errorPolicy:"all"}).response.catch(Ur())};Y.getOrCreateChapterUpdateQueue(i.id).enqueue("".concat(i.id),d)},[t,r,s])}static useGetThemeDirection(){const{direction:t}=dt(),r=Qe(s=>s.settings.readingDirection.value);return js[t]===r?t:Cs[t]}static updateSetting(t,r,s=!0,n=!1,o){const{manga:i}=Ce(),l=i!=null?i:n?St:i;if(!l||l.id===Et.id)return;const c=_t(t,o!==void 0?[o==null?void 0:o.toString()]:void 0),{cache:g}=Z.graphQLClient.client;if(n||fe.includes(t)){const d=g.writeFragment({fragment:wr,data:{__typename:"GlobalMetaType",key:c,value:JSON.stringify(r)}});g.modify({fields:{metas(f,{readField:h}){return{...f,nodes:pt(c,f==null?void 0:f.nodes,h,()=>d)}}}})}else{const d=g.writeFragment({fragment:Lr,data:{__typename:"MangaMetaType",mangaId:l.id,key:c,value:JSON.stringify(r)}});g.modify({id:g.identify({__typename:"MangaType",id:l.id}),fields:{meta(f,{readField:h}){return pt(c,f,h,()=>d)}}})}s&&_n(l,t,r,n,o).catch(d=>mt(vt("reader.settings.error.label.failed_to_save_settings"),"error",xt(d)))}static deleteSetting(t,r=!1,s){const{manga:n}=Ce(),o=n!=null?n:r?St:n;if(!o||o.id===Et.id)return;const i=_t(t,s!==void 0?[s]:void 0),{cache:l}=Z.graphQLClient.client,c=r||fe.includes(t);c?l.evict({id:l.identify({__typename:"GlobalMetaType",key:i})}):l.evict({id:l.identify({__typename:"MangaMetaType",mangaId:o.id,key:i})}),(c?()=>Z.deleteGlobalMeta(i).response:()=>Z.deleteMangaMeta(o.id,i).response)().catch(u=>mt(vt("reader.settings.error.label.failed_to_save_settings"),"error",xt(u)))}static useOverlayMode(){const t=Ve.useIsTouchDevice(),r=Qe(c=>c.settings.overlayMode),s=r===U.AUTO,n=r===U.DESKTOP,o=r===U.MOBILE,i=n||s&&!t,l=o||s&&t;return{mode:i?U.DESKTOP:U.MOBILE,isDesktop:i,isMobile:l}}static useExit(){const t=Qe(o=>o.settings.exitMode),r=Mr(),s=Nr(),n=S.useCallback(()=>{const{manga:o}=Ce();return o?s(kr.manga.path(o.id)):()=>{}},[]);switch(t){case pe.PREVIOUS:return r;case pe.MANGA:return n;default:throw new Error('Unexpected "exitMode" ('.concat(t,")"))}}};We(Y,"downloadAheadQueue",new ft(1)),We(Y,"chapterUpdateQueues",new Map);let lt=Y;const Ds=({i18nKey:e,value:t})=>{const{t:r}=x();return a.jsx(b,{sx:{flexDirection:"row",gap:.25},children:a.jsx(er,{t:r,i18nKey:e,values:{value:t},components:[a.jsx(A,{variant:"caption",sx:{fontSize:"x-small",opacity:.75}})]})})},ws=({value:e,values:t,defaultValue:r,setValue:s,valueToDisplayData:n,isDefaultable:o,onDefault:i})=>{const{t:l}=x();return a.jsxs(b,{sx:{flexDirection:"row",flexWrap:"wrap",gap:1},children:[o&&a.jsx(ee,{onClick:i,variant:e===void 0?"contained":"outlined",children:l("global.label.default")},"default"),t.map(c=>{const g=e===void 0&&c===r,u=n[c].isTitleString?n[c].title:l(n[c].title);return a.jsx(Be,{title:g?l("reader.settings.active_setting"):"",children:a.jsx(ee,{onClick:()=>s(c),variant:c===e?"contained":"outlined",startIcon:n[c].icon,children:g?a.jsx(Ds,{i18nKey:"global.label.footnote",value:u}):u})},c)})]})},k=({label:e,description:t,...r})=>a.jsxs(b,{children:[a.jsx(A,{children:e}),t&&a.jsx(A,{variant:"body2",color:"textDisabled",children:t}),a.jsx(ws,{...r})]}),_r=({readingMode:e,setReadingMode:t,...r})=>{const{t:s}=x();return a.jsx(k,{...r,label:s("reader.settings.label.reading_mode"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:Jt,setValue:t,valueToDisplayData:Xt})},Ls={[$.LTR]:{title:"reader.settings.reading_direction.ltr",icon:a.jsx(Br,{})},[$.RTL]:{title:"reader.settings.reading_direction.rtl",icon:a.jsx(Vr,{})}},Ms=Object.values($).filter(e=>typeof e=="number"),Ns=({readingDirection:e,setReadingDirection:t,...r})=>{const{t:s}=x();return a.jsx(k,{...r,label:s("reader.settings.label.reading_direction"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:Ms,setValue:t,valueToDisplayData:Ls})},ks={[se.EDGE]:{title:"reader.settings.tap_zones.edge",icon:null},[se.KINDLE]:{title:"reader.settings.tap_zones.kindle",icon:null},[se.L_SHAPE]:{title:"reader.settings.tap_zones.l_shape",icon:null},[se.RIGHT_LEFT]:{title:"reader.settings.tap_zones.right_left",icon:null},[se.DISABLED]:{title:"global.label.disabled",icon:null}},Us=Object.values(se).filter(e=>typeof e=="number"),Vs=({tapZoneLayout:e,setTapZoneLayout:t,...r})=>{const{t:s}=x();return a.jsx(k,{...r,label:s("reader.settings.tap_zones.title"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:Us,setValue:t,valueToDisplayData:ks})};var pr=(e=>(e[e.NONE=0]="NONE",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.BOTH=3]="BOTH",e))(pr||{});const Bs={0:{title:"global.label.none",icon:null},1:{title:"global.label.horizontal",icon:null},2:{title:"global.label.vertical",icon:null},3:{title:"global.label.both",icon:null}},Fs=Object.values(pr).filter(e=>typeof e=="number"),Gs={0:{vertical:!1,horizontal:!1},1:{vertical:!1,horizontal:!0},2:{vertical:!0,horizontal:!1},3:{vertical:!0,horizontal:!0}},Hs=({vertical:e,horizontal:t})=>e&&t?3:e?2:t?1:0,zs=({tapZoneInvertMode:e,setTapZoneInvertMode:t,...r})=>{const{t:s}=x(),n=Hs(e.value);return a.jsx(k,{...r,label:s("reader.settings.tap_zones.invert"),value:e.isDefault?void 0:n,defaultValue:e.isDefault?n:void 0,values:Fs,setValue:o=>t(Gs[o]),valueToDisplayData:Bs})},$s=({pageScaleMode:e,setPageScaleMode:t,...r})=>{const{t:s}=x();return a.jsx(k,{...r,label:s("reader.settings.page_scale.title"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:Gr,setValue:t,valueToDisplayData:Fr})},Ws=({pageScaleMode:e,shouldStretchPage:t,setShouldStretchPage:r})=>{const{t:s}=x();return Hr[e]?a.jsx(X,{children:a.jsx(ee,{onClick:()=>r(!t),variant:t?"contained":"outlined",children:s("reader.settings.page_scale.stretch")})}):null},$t=ae(a.jsx("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8m-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91"})),Te=({asIconButton:e,...t})=>{const{t:r}=x();return e?a.jsx(Be,{title:r("global.button.reset"),children:a.jsx(Qt,{color:"inherit",...t,children:a.jsx($t,{})})}):a.jsx(ee,{startIcon:a.jsx($t,{}),...t,children:r("global.button.reset")})},H=({label:e,value:t,onDefault:r,slotProps:s})=>{var n,o,i;return a.jsxs(b,{sx:{flexDirection:"row",gap:2,alignItems:"center"},children:[a.jsxs(b,{sx:{flexBasis:"25%"},children:[a.jsx(A,{...s==null?void 0:s.label,sx:{...(n=s==null?void 0:s.label)==null?void 0:n.sx},children:e}),a.jsx(A,{...s==null?void 0:s.value,sx:{...(o=s==null?void 0:s.value)==null?void 0:o.sx},children:t})]}),a.jsx(dn,{...s==null?void 0:s.slider,sx:{flexBasis:"75%",...(i=s==null?void 0:s.slider)==null?void 0:i.sx}}),r&&a.jsx(Te,{asIconButton:!0,onClick:r})]})},Ys=({pageGap:e,readingMode:t,isDefaultable:r,onDefault:s,updateSetting:n})=>{const{t:o}=x();return t.value!==C.WEBTOON&&J(t.value)?a.jsx(H,{label:o("reader.settings.label.page_gap"),value:o("global.value",{value:e.value,unit:o("global.unit.px")}),onDefault:r?s:void 0,slotProps:{slider:{defaultValue:P.pageGap,value:e.value,step:Ye.step,min:Ye.min,max:Ye.max,onChange:(l,c)=>{n(c,!1)},onChangeCommitted:(l,c)=>{n(c,!0)}}}}):null},Zs=({readerWidth:e,pageScaleMode:t,isDefaultable:r,onDefault:s,updateSetting:n,setTransparent:o})=>{const{t:i}=x();return ut(t)?a.jsxs(b,{children:[a.jsxs(b,{sx:{flexDirection:"row",justifyContent:"space-between"},children:[a.jsx(O,{label:i("reader.settings.label.limit_reader_width"),checked:e.enabled,onChange:(l,c)=>n("readerWidth",{...e,enabled:c},!0)}),r&&a.jsx(Te,{onClick:s,variant:"outlined"})]}),e.enabled&&a.jsx(H,{label:i("reader.settings.label.reader_width"),value:i("global.value",{value:e.value,unit:"%"}),slotProps:{slider:{defaultValue:P.readerWidth.value,value:e.value,step:1,min:10,max:100,onChange:(l,c)=>{o==null||o(!0),n("readerWidth",{...e,value:c},!1)},onChangeCommitted:(l,c)=>{o==null||o(!1),n("readerWidth",{...e,value:c},!0)}}}})]}):null},Ks=({areDefaultSettings:e})=>{const{t}=x();return!Ve.useIsTouchDevice()||e?null:a.jsx(b,{sx:{alignItems:"end"},children:a.jsx(A,{variant:"caption",children:t("reader.settings.default_setting_footnote")})})},Xs=({profile:e,title:t,updateSetting:r,isSeriesMode:s,...n})=>{const{settings:o}=fn(e),i=S.useMemo(()=>({...o,readingMode:{value:e,isDefault:!0}}),[o,e]);return a.jsxs(b,{sx:{gap:2},children:[s?a.jsx(A,{children:t}):a.jsx(un,{component:"div",id:"".concat(e,"-settings"),children:t}),a.jsx(b,{sx:{px:+!s*2},children:a.jsx(xr,{...n,setShowPreview:()=>{},settings:i,updateSetting:(l,c,g)=>r(l,c,g,!0,e)})})]})},mr=({profiles:e=Jt,readingMode:t,...r})=>{const{updateSetting:s,isSeriesMode:n}=r,{t:o}=x();return a.jsxs(b,{sx:{gap:2,pb:+!n*2},children:[t!==void 0&&a.jsx(b,{sx:{pt:2,px:2},children:a.jsx(_r,{readingMode:t,setReadingMode:i=>s("readingMode",i)})}),e.map(i=>a.jsx(Xs,{profile:i,title:o(Xt[i].title),...r},i))]})},xr=({setShowPreview:e,settings:t,updateSetting:r,isDefaultable:s,onDefault:n,isSeriesMode:o,setTransparent:i})=>{const{t:l}=x();return a.jsxs(b,{sx:{gap:2},children:[a.jsx(Ks,{areDefaultSettings:!s}),o&&a.jsxs(a.Fragment,{children:[a.jsx(A,{children:l("reader.settings.source_series")}),a.jsx(_r,{readingMode:t.readingMode,setReadingMode:c=>r("readingMode",c),isDefaultable:s,onDefault:()=>n==null?void 0:n("readingMode")})]}),a.jsx(Ys,{pageGap:t.pageGap,readingMode:t.readingMode,isDefaultable:s,onDefault:()=>n==null?void 0:n("pageGap"),updateSetting:(...c)=>r("pageGap",...c)}),a.jsx(Ns,{readingDirection:t.readingDirection,setReadingDirection:c=>r("readingDirection",c),isDefaultable:s,onDefault:()=>n==null?void 0:n("readingDirection")}),a.jsx(Vs,{tapZoneLayout:t.tapZoneLayout,setTapZoneLayout:c=>{e(!0),r("tapZoneLayout",c)},isDefaultable:s,onDefault:()=>{e(!0),n==null||n("tapZoneLayout")}}),a.jsx(zs,{tapZoneInvertMode:t.tapZoneInvertMode,setTapZoneInvertMode:c=>{e(!0),r("tapZoneInvertMode",c)},isDefaultable:s,onDefault:()=>{e(!0),n==null||n("tapZoneInvertMode")}}),a.jsx($s,{pageScaleMode:t.pageScaleMode,setPageScaleMode:c=>r("pageScaleMode",c),isDefaultable:s,onDefault:()=>n==null?void 0:n("pageScaleMode")}),a.jsx(Ws,{pageScaleMode:t.pageScaleMode.value,shouldStretchPage:t.shouldStretchPage.value,setShouldStretchPage:c=>r("shouldStretchPage",c)}),a.jsx(Zs,{readerWidth:t.readerWidth.value,pageScaleMode:t.pageScaleMode.value,isDefaultable:s,onDefault:()=>n==null?void 0:n("readerWidth"),updateSetting:(...c)=>r(...c),setTransparent:i}),o&&a.jsxs(a.Fragment,{children:[a.jsx(zr,{}),a.jsx(mr,{profiles:[t.readingMode.value],updateSetting:r,isSeriesMode:o,setTransparent:i})]})]})},Js=()=>a.jsx(qt,{children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:a.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 15h16"})})}),Qs=()=>a.jsx(qt,{children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:a.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 15h16M7 15v-5m10 5v-5M4 9h16"})})}),qs={[me.HIDDEN]:{title:"global.label.hidden",icon:a.jsx(Js,{})},[me.STANDARD]:{title:"global.label.standard",icon:a.jsx(Qs,{})}},eo=Object.values(me).filter(e=>typeof e=="number"),to=({overlayMode:e,progressBarType:t,setProgressBarType:r})=>{const{t:s}=x();return e!==U.DESKTOP?null:a.jsx(k,{label:s("reader.settings.progress_bar.style"),value:t,values:eo,setValue:r,valueToDisplayData:qs})},ro=({overlayMode:e,progressBarType:t,progressBarSize:r,setProgressBarSize:s,onDefault:n})=>{const{t:o}=x();return e===U.DESKTOP&&t===me.STANDARD?a.jsx(H,{label:o("reader.settings.progress_bar.size"),value:o("global.value",{value:r,unit:o("global.unit.px")}),onDefault:n,slotProps:{slider:{defaultValue:P.progressBarSize,value:r,step:je.step,min:je.min,max:je.max,onChange:(l,c)=>{s(c,!1)},onChangeCommitted:(l,c)=>{s(c,!0)}}}}):null},no=ae(a.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"})),Wt=ae(a.jsx("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"})),vr=ae([a.jsx("path",{d:"M19.03 3.56c-1.67-1.39-3.74-2.3-6.03-2.51v2.01c1.73.19 3.31.88 4.61 1.92zM11 3.06V1.05c-2.29.2-4.36 1.12-6.03 2.51l1.42 1.42C7.69 3.94 9.27 3.25 11 3.06M4.98 6.39 3.56 4.97C2.17 6.64 1.26 8.71 1.05 11h2.01c.19-1.73.88-3.31 1.92-4.61M20.94 11h2.01c-.21-2.29-1.12-4.36-2.51-6.03l-1.42 1.42c1.04 1.3 1.73 2.88 1.92 4.61M7 12l3.44 1.56L12 17l1.56-3.44L17 12l-3.44-1.56L12 7l-1.56 3.44z"},"0"),a.jsx("path",{d:"M12 21c-3.11 0-5.85-1.59-7.46-4H7v-2H1v6h2v-2.7c1.99 2.84 5.27 4.7 9 4.7 4.87 0 9-3.17 10.44-7.56l-1.96-.45C19.25 18.48 15.92 21 12 21"},"1")]),Yt={[G.AUTO]:{title:"global.label.auto",icon:a.jsx(vr,{})},[G.BOTTOM]:{title:"global.label.bottom",icon:a.jsx(Wt,{sx:{transform:"rotate(90deg)"}})},[G.LEFT]:{title:"global.label.left",icon:a.jsx(no,{})},[G.RIGHT]:{title:"global.label.right",icon:a.jsx(Wt,{})}},so=Object.values(G).filter(e=>typeof e=="number"),oo=Object.values($r),ao=({progressBarPosition:e,progressBarPositionAutoVertical:t,updateSetting:r})=>{const{t:s}=x(),n=e===G.AUTO;return a.jsxs(a.Fragment,{children:[a.jsx(k,{label:s("reader.settings.progress_bar.position"),value:e,values:so,setValue:o=>r("progressBarPosition",o),valueToDisplayData:Yt}),n&&a.jsx(k,{label:s("reader.settings.progress_bar.auto_vertical_position.title"),value:t,values:oo,setValue:o=>r("progressBarPositionAutoVertical",o),valueToDisplayData:Yt})]})},io=ae(a.jsx("path",{d:"M15.5 1h-8C6.12 1 5 2.12 5 3.5v17C5 21.88 6.12 23 7.5 23h8c1.38 0 2.5-1.12 2.5-2.5v-17C18 2.12 16.88 1 15.5 1m-4 21c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m4.5-4H7V4h9z"})),lo=ae(a.jsx("path",{d:"M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2zM4 6h16v10H4z"})),co={[U.AUTO]:{title:"global.label.auto",icon:a.jsx(vr,{})},[U.DESKTOP]:{title:"global.label.desktop",icon:a.jsx(lo,{})},[U.MOBILE]:{title:"global.label.mobile",icon:a.jsx(io,{})}},uo=Object.values(U).filter(e=>typeof e=="number"),go=({overlayMode:e,setOverlayMode:t})=>{const{t:r}=x();return a.jsx(k,{label:r("reader.settings.overlay_mode"),value:e,values:uo,setValue:t,valueToDisplayData:co})},ho={[de.THEME]:{title:"settings.appearance.theme.title",icon:null},[de.BLACK]:{title:"global.colors.black",icon:null},[de.GRAY]:{title:"global.colors.gray",icon:null},[de.WHITE]:{title:"global.colors.white",icon:null}},fo=Object.values(de).filter(e=>typeof e=="number"),_o=({backgroundColor:e,updateSetting:t})=>{const{t:r}=x();return a.jsx(k,{label:r("reader.settings.background_color"),value:e,values:fo,setValue:t,valueToDisplayData:ho})},po=({overlayMode:e,settings:t,updateSetting:r,onDefault:s})=>{const{t:n}=x();return a.jsxs(b,{sx:{gap:2},children:[a.jsx(go,{overlayMode:t.overlayMode,setOverlayMode:o=>r("overlayMode",o)}),a.jsx(_o,{backgroundColor:t.backgroundColor,updateSetting:o=>r("backgroundColor",o)}),a.jsx(to,{overlayMode:e,progressBarType:t.progressBarType,setProgressBarType:o=>r("progressBarType",o)}),a.jsx(ro,{overlayMode:e,progressBarType:t.progressBarType,progressBarSize:t.progressBarSize,setProgressBarSize:(...o)=>r("progressBarSize",...o),onDefault:()=>s==null?void 0:s("progressBarSize")}),a.jsx(ao,{progressBarPosition:t.progressBarPosition,progressBarPositionAutoVertical:t.progressBarPositionAutoVertical,updateSetting:r}),(t.progressBarType===me.HIDDEN||e===U.MOBILE)&&a.jsx(O,{label:n("reader.settings.label.show_page_number"),checked:t.shouldShowPageNumber,onChange:(o,i)=>r("shouldShowPageNumber",i)})]})},mo=({brightness:e,updateSetting:t})=>{const{t:r}=x();return a.jsxs(b,{children:[a.jsx(O,{label:r("reader.settings.custom_filter.brightness"),checked:e.enabled,onChange:(s,n)=>t("brightness",{...e,enabled:n},!0)}),e.enabled&&a.jsx(H,{label:r("reader.settings.custom_filter.brightness"),value:e.value,onDefault:()=>t("brightness",{...e,value:P.customFilter.brightness.value},!0),slotProps:{slider:{defaultValue:P.customFilter.brightness.value,value:e.value,step:w.brightness.step,min:w.brightness.min,max:w.brightness.max,onChange:(s,n)=>{t("brightness",{...e,value:n},!1)},onChangeCommitted:(s,n)=>{t("brightness",{...e,value:n},!0)}}}})]})},xo=({contrast:e,updateSetting:t})=>{const{t:r}=x();return a.jsxs(b,{children:[a.jsx(O,{label:r("reader.settings.custom_filter.contrast"),checked:e.enabled,onChange:(s,n)=>t("contrast",{...e,enabled:n},!0)}),e.enabled&&a.jsx(H,{label:r("reader.settings.custom_filter.contrast"),value:e.value,onDefault:()=>t("contrast",{...e,value:P.customFilter.contrast.value},!0),slotProps:{slider:{defaultValue:P.customFilter.contrast.value,value:e.value,step:w.contrast.step,min:w.contrast.min,max:w.contrast.max,onChange:(s,n)=>{t("contrast",{...e,value:n},!1)},onChangeCommitted:(s,n)=>{t("contrast",{...e,value:n},!0)}}}})]})},vo=({saturate:e,updateSetting:t})=>{const{t:r}=x();return a.jsxs(b,{children:[a.jsx(O,{label:r("reader.settings.custom_filter.saturate"),checked:e.enabled,onChange:(s,n)=>t("saturate",{...e,enabled:n},!0)}),e.enabled&&a.jsx(H,{label:r("reader.settings.custom_filter.saturate"),value:e.value,onDefault:()=>t("saturate",{...e,value:P.customFilter.saturate.value},!0),slotProps:{slider:{defaultValue:P.customFilter.saturate.value,value:e.value,step:w.saturate.step,min:w.saturate.min,max:w.saturate.max,onChange:(s,n)=>{t("saturate",{...e,value:n},!1)},onChangeCommitted:(s,n)=>{t("saturate",{...e,value:n},!0)}}}})]})},bo=({hue:e,updateSetting:t})=>{const{t:r}=x();return a.jsxs(b,{children:[a.jsx(O,{label:r("reader.settings.custom_filter.hue"),checked:e.enabled,onChange:(s,n)=>t("hue",{...e,enabled:n},!0)}),e.enabled&&a.jsx(H,{label:r("reader.settings.custom_filter.hue"),value:e.value,onDefault:()=>t("hue",{...e,value:P.customFilter.hue.value},!0),slotProps:{slider:{defaultValue:P.customFilter.hue.value,value:e.value,step:w.hue.step,min:w.hue.min,max:w.hue.max,onChange:(s,n)=>{t("hue",{...e,value:n},!1)},onChangeCommitted:(s,n)=>{t("hue",{...e,value:n},!0)}}}})]})},So={red:"reader.settings.custom_filter.rgba.red",green:"reader.settings.custom_filter.rgba.green",blue:"reader.settings.custom_filter.rgba.blue",alpha:"reader.settings.custom_filter.rgba.alpha"},Eo=({rgba:e,updateSetting:t})=>{const{t:r}=x();return a.jsxs(b,{children:[a.jsx(O,{label:r("reader.settings.custom_filter.rgba.title"),checked:e.enabled,onChange:(s,n)=>t("rgba",{...e,enabled:n},!0)}),e.enabled&&a.jsxs(b,{sx:{gap:1},children:[Object.entries(e.value).map(([s,n])=>s==="blendMode"?null:a.jsx(H,{label:r(So[s]),value:n,onDefault:()=>t("rgba",{...e,value:{...e.value,[s]:P.customFilter.rgba.value[s]}},!0),slotProps:{slider:{value:n,defaultValue:P.customFilter.rgba.value[s],step:w.rgba[s].step,min:w.rgba[s].min,max:w.rgba[s].max,onChange:(o,i)=>{t("rgba",{...e,value:{...e.value,[s]:i}},!1)},onChangeCommitted:(o,i)=>{t("rgba",{...e,value:{...e.value,[s]:i}},!0)}}}},s)),a.jsx(k,{label:r("reader.settings.custom_filter.rgba.blend_mode.title"),value:e.value.blendMode,values:Yr,setValue:s=>t("rgba",{...e,value:{...e.value,blendMode:s}},!0),valueToDisplayData:Wr})]})]})},Ro=({sepia:e,updateSetting:t})=>{const{t:r}=x();return a.jsx(b,{children:a.jsx(O,{label:r("reader.settings.custom_filter.sepia"),checked:e,onChange:(s,n)=>t(n)})})},yo=({grayscale:e,updateSetting:t})=>{const{t:r}=x();return a.jsx(b,{children:a.jsx(O,{label:r("reader.settings.custom_filter.grayscale"),checked:e,onChange:(s,n)=>t(n)})})},To=({invert:e,updateSetting:t})=>{const{t:r}=x();return a.jsx(b,{children:a.jsx(O,{label:r("reader.settings.custom_filter.invert"),checked:e,onChange:(s,n)=>t(n)})})},Ao=({settings:{customFilter:e},updateSetting:t,onDefault:r,setTransparent:s})=>{const n=(o,i)=>{t("customFilter",o,i),s==null||s(i===void 0?!1:!i)};return a.jsxs(b,{sx:{gap:2},children:[a.jsx(mo,{brightness:e.brightness,updateSetting:(o,i,l)=>n({...e,[o]:i},l)}),a.jsx(xo,{contrast:e.contrast,updateSetting:(o,i,l)=>n({...e,[o]:i},l)}),a.jsx(vo,{saturate:e.saturate,updateSetting:(o,i,l)=>n({...e,[o]:i},l)}),a.jsx(bo,{hue:e.hue,updateSetting:(o,i,l)=>n({...e,[o]:i},l)}),a.jsx(Eo,{rgba:e.rgba,updateSetting:(o,i,l)=>n({...e,[o]:i},l)}),a.jsx(Ro,{sepia:e.sepia,updateSetting:o=>n({...e,sepia:o})}),a.jsx(yo,{grayscale:e.grayscale,updateSetting:o=>n({...e,grayscale:o})}),a.jsx(To,{invert:e.invert,updateSetting:o=>n({...e,invert:o})}),a.jsx(b,{sx:{alignItems:"end"},children:a.jsx(Te,{onClick:()=>r==null?void 0:r("customFilter"),variant:"outlined"})})]})},Po={[pe.PREVIOUS]:{title:"global.label.previous",icon:null},[pe.MANGA]:{title:"manga.title_one",icon:null}},Io=Object.values(pe).filter(e=>typeof e=="number"),Oo=({exitMode:e,setExitMode:t})=>{const{t:r}=x();return a.jsx(k,{label:r("reader.settings.exit_mode"),value:e,values:Io,setValue:t,valueToDisplayData:Po})},Co=({autoScroll:e,setAutoScroll:t})=>{const{t:r}=x();return a.jsxs(a.Fragment,{children:[a.jsx(O,{label:r("reader.settings.auto_scroll.smooth"),checked:e.smooth,onChange:(s,n)=>t({...e,smooth:n},!0)}),a.jsx(H,{label:r("reader.settings.auto_scroll.speed"),value:r("global.time.seconds.value",{count:e.value}),onDefault:()=>t({...e,value:P.autoScroll.value},!0),slotProps:{slider:{defaultValue:P.customFilter.saturate.value,value:e.value,...je,onChange:(s,n)=>{t({...e,value:n},!1)},onChangeCommitted:(s,n)=>{t({...e,value:n},!0)}}}})]})},jo={[ue.TINY]:{title:"global.label.tiny",icon:null},[ue.SMALL]:{title:"global.label.small",icon:null},[ue.MEDIUM]:{title:"global.label.medium",icon:null},[ue.LARGE]:{title:"global.label.large",icon:null}},Do=Object.values(ue).filter(e=>typeof e=="number"),wo=({scrollAmount:e,setScrollAmount:t})=>{const{t:r}=x();return a.jsxs(a.Fragment,{children:[a.jsx(k,{label:r("reader.settings.scroll_amount"),value:e,values:Do,setValue:s=>t(s,!0),valueToDisplayData:jo}),a.jsx(H,{label:r("reader.settings.label.custom_scroll_amount"),value:r("global.value",{value:e,unit:"%"}),onDefault:()=>t(P.scrollAmount,!0),slotProps:{slider:{defaultValue:P.scrollAmount,value:e,...Zr,onChange:(s,n)=>{t(n,!1)},onChangeCommitted:(s,n)=>{t(n,!0)}}}})]})},Lo=({settings:e,updateSetting:t,onDefault:r,isDefaultable:s})=>{const{t:n}=x();return a.jsxs(b,{sx:{gap:2},children:[a.jsx(Oo,{exitMode:e.exitMode,setExitMode:o=>t("exitMode",o)}),a.jsx(wo,{scrollAmount:e.scrollAmount,setScrollAmount:(o,i)=>t("scrollAmount",o,i)}),a.jsx(O,{label:n("reader.settings.label.skip_dup_chapters"),checked:e.shouldSkipDupChapters,onChange:(o,i)=>t("shouldSkipDupChapters",i)}),a.jsx(O,{label:a.jsxs(X,{children:[a.jsx(A,{children:n("reader.settings.label.skip_filtered_chapters")}),s&&a.jsx(A,{variant:"body2",color:"textDisabled",children:n("reader.settings.label.unchangeable_in_reader")})]}),checked:e.shouldSkipFilteredChapters,onChange:(o,i)=>t("shouldSkipFilteredChapters",i),disabled:s}),Tn(e.readingMode.value)&&a.jsx(O,{label:n("reader.settings.label.offset_double_spread"),checked:e.shouldOffsetDoubleSpreads.value,onChange:(o,i)=>t("shouldOffsetDoubleSpreads",i)}),a.jsx(O,{label:a.jsxs(X,{children:[a.jsx(A,{children:n("reader.settings.infinite_scroll.title")}),a.jsx(A,{variant:"body2",color:"textDisabled",children:n("reader.settings.infinite_scroll.description")})]}),checked:e.shouldUseInfiniteScroll,onChange:(o,i)=>t("shouldUseInfiniteScroll",i)}),a.jsx(O,{label:a.jsxs(X,{children:[a.jsx(A,{children:n("reader.settings.preview.reading_mode.title")}),a.jsx(A,{variant:"body2",color:"textDisabled",children:n("reader.settings.preview.reading_mode.description")})]}),checked:e.shouldShowReadingModePreview,onChange:(o,i)=>t("shouldShowReadingModePreview",i)}),a.jsx(O,{label:a.jsxs(X,{children:[a.jsx(A,{children:n("reader.settings.preview.tap_zones.title")}),a.jsx(A,{variant:"body2",color:"textDisabled",children:n("reader.settings.preview.tap_zones.description")})]}),checked:e.shouldShowTapZoneLayoutPreview,onChange:(o,i)=>t("shouldShowTapZoneLayoutPreview",i)}),a.jsx(O,{label:a.jsxs(X,{children:[a.jsx(A,{children:n("reader.settings.auto_webtoon_mode.title")}),a.jsx(A,{variant:"body2",color:"textDisabled",children:n("reader.settings.auto_webtoon_mode.description")})]}),checked:e.shouldUseAutoWebtoonMode,onChange:(o,i)=>t("shouldUseAutoWebtoonMode",i)}),a.jsx(O,{label:n("reader.settings.show_transition_page"),checked:e.shouldShowTransitionPage,onChange:(o,i)=>t("shouldShowTransitionPage",i)}),a.jsx(O,{label:n("reader.settings.chapter_transition.warning.missing_chapter"),checked:e.shouldInformAboutMissingChapter,onChange:(o,i)=>t("shouldInformAboutMissingChapter",i)}),a.jsx(O,{label:n("reader.settings.chapter_transition.warning.scanlator_change"),checked:e.shouldInformAboutScanlatorChange,onChange:(o,i)=>t("shouldInformAboutScanlatorChange",i)}),a.jsx(Co,{autoScroll:e.autoScroll,setAutoScroll:(...o)=>t("autoScroll",...o)}),a.jsx(H,{label:n("reader.settings.image_preload_amount"),value:e.imagePreLoadAmount,onDefault:()=>r==null?void 0:r("imagePreLoadAmount"),slotProps:{slider:{defaultValue:P.imagePreLoadAmount,value:e.imagePreLoadAmount,step:Ze.step,min:Ze.min,max:Ze.max,onChange:(o,i)=>{t("imagePreLoadAmount",i,!1)},onChangeCommitted:(o,i)=>{t("imagePreLoadAmount",i,!0)}}}})]})},Mo=Kr(A)(({theme:e})=>({display:"inline-block",padding:"0.2em 0.4em",fontSize:"0.85em",lineHeight:"1.4",color:e.palette.text.primary,backgroundColor:e.palette.background.paper,border:"1px solid ".concat(e.palette.divider),borderRadius:"3px",boxShadow:"inset 0 -1px 0 ".concat(e.palette.divider),fontFamily:"monospace, monospace"})),br=({keys:e,removeKey:t})=>{const{t:r}=x();return a.jsx(b,{sx:{flexDirection:"row",flexWrap:"wrap",gap:1},children:e.map((s,n)=>a.jsxs(S.Fragment,{children:[a.jsx(Be,{title:r("global.button.delete"),hidden:!t,children:a.jsx(b,{sx:{flexDirection:"row",flexWrap:"wrap",gap:.5,cursor:t?"pointer":void 0},onClick:()=>t==null?void 0:t(s),children:s.split("+").map((o,i,l)=>a.jsxs(S.Fragment,{children:[a.jsx(Mo,{children:o}),i===l.length-1?"":"+"]},o))})}),n===e.length-1?"":","]},s))})},No=({onClose:e,onCreate:t,existingKeys:r})=>{const{t:s}=x(),[n,{start:o,stop:i,resetKeys:l}]=Xr(),c=[[...n].join("+")],g=c.some(u=>r.map(d=>d.toLowerCase()).includes(u.toLowerCase()));return S.useEffect(()=>(o(),()=>{i()}),[]),a.jsxs(Jr,{open:!0,onClose:e,fullWidth:!0,children:[a.jsx(Qr,{children:s("hotkeys.create.dialog.title")}),a.jsxs(qr,{children:[a.jsx(b,{sx:{flexDirection:"row",gap:1},children:a.jsx(er,{i18nKey:"hotkeys.create.dialog.label",components:{Keys:n.size?a.jsx(br,{keys:c}):a.jsx(A,{children:s("hotkeys.create.dialog.placeholder")})},children:"Recorded keys:"})}),g&&a.jsx(A,{color:"error",children:s("hotkeys.create.error.exists")})]}),a.jsx(en,{children:a.jsxs(b,{direction:"row",sx:{justifyContent:"space-between",width:"100%"},children:[a.jsx(ee,{onClick:l,children:s("global.button.reset")}),a.jsxs(b,{direction:"row",children:[a.jsx(ee,{onClick:e,children:s("global.button.cancel")}),a.jsx(ee,{disabled:g,onClick:()=>{e(),t(c)},children:s("global.button.create")})]})]})})]})},ko={[D.PREVIOUS_PAGE]:"reader.settings.hotkey.previous_page",[D.NEXT_PAGE]:"reader.settings.hotkey.next_page",[D.SCROLL_BACKWARD]:"reader.settings.hotkey.scroll_backward",[D.SCROLL_FORWARD]:"reader.settings.hotkey.scroll_forward",[D.PREVIOUS_CHAPTER]:"reader.settings.hotkey.previous_chapter",[D.NEXT_CHAPTER]:"reader.settings.hotkey.next_chapter",[D.TOGGLE_MENU]:"reader.settings.hotkey.menu",[D.CYCLE_SCALE_TYPE]:"reader.settings.hotkey.scale_type",[D.STRETCH_IMAGE]:"reader.settings.hotkey.stretch_image",[D.OFFSET_SPREAD_PAGES]:"reader.settings.hotkey.offset_spread_pages",[D.CYCLE_READING_MODE]:"reader.settings.hotkey.reading_mode",[D.CYCLE_READING_DIRECTION]:"reader.settings.hotkey.reading_direction",[D.TOGGLE_AUTO_SCROLL]:"reader.settings.hotkey.auto_scroll",[D.AUTO_SCROLL_SPEED_INCREASE]:"reader.settings.hotkey.auto_scroll_speed_increase",[D.AUTO_SCROLL_SPEED_DECREASE]:"reader.settings.hotkey.auto_scroll_speed_decrease",[D.EXIT_READER]:"reader.button.exit"},Uo=({hotkey:e,keys:t,existingKeys:r,updateSetting:s})=>{const{t:n}=x(),o=tn({popupId:"reader-setting-record-hotkey",variant:"dialog"});return a.jsxs(a.Fragment,{children:[a.jsxs(b,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[a.jsx(A,{sx:{flexGrow:1},children:n(ko[e])}),a.jsx(br,{keys:t,removeKey:i=>s(t.filter(l=>l!==i))}),a.jsx(Be,{title:n("global.button.add"),children:a.jsx(Qt,{...rn(o),color:"inherit",children:a.jsx(gn,{})})}),a.jsx(Te,{asIconButton:!0,onClick:()=>s(P.hotkeys[e])})]}),o.isOpen&&a.jsx(No,{onClose:o.close,onCreate:i=>s([...t,...i]),existingKeys:r})]})},Vo=({settings:e,updateSetting:t,onDefault:r})=>{const{t:s}=x();return a.jsxs(b,{sx:{gap:2},children:[a.jsx(b,{sx:{alignItems:"end"},children:a.jsx(A,{variant:"caption",children:s("hotkeys.info.delete")})}),nn.map(n=>a.jsx(Uo,{hotkey:n,keys:e.hotkeys[n],existingKeys:Object.values(e.hotkeys).flat(),updateSetting:o=>t("hotkeys",{...e.hotkeys,[n]:o})},n)),a.jsx(b,{sx:{alignItems:"end"},children:a.jsx(Te,{onClick:()=>r==null?void 0:r("hotkeys"),variant:"outlined"})})]})},Bo=(e,t,r)=>S.memo(({ref:s,...n})=>{const o=t.reduce((c,g)=>({...c,...g(n)}),{}),i=Object.fromEntries(Object.entries(o).filter(([c])=>r.includes(c))),l={...n,...i};return a.jsx(e,{...l,ref:s})}),Fo=({activeTab:e,setActiveTab:t,areDefaultSettings:r,settings:s,updateSetting:n,deleteSetting:o,mode:i,setTransparent:l})=>{const{t:c}=x(),g=Ve.useIsTouchDevice(),u=cs(d=>d.tapZone.setShowPreview);return a.jsxs(a.Fragment,{children:[a.jsx(sn,{value:e,onChange:(d,f)=>t(f),sx:{...y(!!r,{zIndex:2}),...y(!r,{backgroundColor:"background.paper",backgroundImage:"var(--Paper-overlay)"})},children:Object.values(bt).map(({id:d,label:f,supportsTouchDevices:h})=>!h&&g?null:a.jsx(cn,{value:d,label:c(f),sx:{flexGrow:1,maxWidth:"unset",textTransform:"none"}},d))}),a.jsx(X,{sx:{p:r?void 0:2,overflowX:"hidden"},children:Object.values(bt).map(({id:d,supportsTouchDevices:f})=>{if(!f&&g)return null;switch(d){case le.LAYOUT:return r?a.jsx(ne,{index:d,currentIndex:e,children:a.jsx(mr,{readingMode:s.readingMode,updateSetting:(...h)=>n(...h)})},d):a.jsx(ne,{index:d,currentIndex:e,children:a.jsx(xr,{settings:s,updateSetting:(...h)=>n(...h),setShowPreview:u,isDefaultable:!r,onDefault:(...h)=>o==null?void 0:o(...h),isSeriesMode:!0,setTransparent:l})},d);case le.GENERAL:return a.jsx(ne,{index:d,currentIndex:e,sx:{p:r?2:void 0},children:a.jsx(po,{overlayMode:i,settings:s,updateSetting:(...h)=>n(...h),isDefaultable:!r,onDefault:(...h)=>o==null?void 0:o(...h)})},d);case le.FILTER:return a.jsx(ne,{index:d,currentIndex:e,sx:{p:r?2:void 0},children:a.jsx(Ao,{settings:s,updateSetting:(...h)=>n(...h),isDefaultable:!0,onDefault:(...h)=>o==null?void 0:o(...h),setTransparent:l})},d);case le.BEHAVIOUR:return a.jsx(ne,{index:d,currentIndex:e,sx:{p:r?2:void 0},children:a.jsx(Lo,{settings:s,updateSetting:(...h)=>n(...h),isDefaultable:!r,onDefault:(...h)=>o==null?void 0:o(...h)})},d);case le.HOTKEYS:return a.jsx(ne,{index:d,currentIndex:e,sx:{p:r?2:void 0},children:a.jsx(Vo,{settings:s,updateSetting:(...h)=>n(...h),isDefaultable:!0,onDefault:(...h)=>o==null?void 0:o(...h)})},d);default:throw new Error('Unexpected "ReaderSettingTab" ('.concat(d,")"))}})})]})},La=Bo(Fo,[lt.useOverlayMode],["mode"]);export{ia as $,fa as A,Q as B,xa as C,ga as D,Ks as E,_r as F,Ns as G,Co as H,cs as I,Pa as J,Aa as K,Sa as L,Ta as M,De as N,Ce as O,As as P,ua as Q,La as R,Ds as S,Gt as T,ya as U,ca as V,Ia as W,Ca as X,or as Y,wa as Z,aa as _,lt as a,Da as a0,ja as a1,_a as a2,ta as a3,la as a4,rr as a5,Ht as a6,ra as a7,Qe as b,as as c,pa as d,va as e,oa as f,sr as g,ha as h,J as i,ls as j,is as k,ma as l,na as m,et as n,Ts as o,ba as p,Ea as q,Ra as r,Os as s,Oa as t,fn as u,he as v,Bo as w,sa as x,da as y,Tn as z};
