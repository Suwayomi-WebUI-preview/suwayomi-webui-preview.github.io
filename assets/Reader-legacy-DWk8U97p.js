!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}var n=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function t(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function r(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(n){i(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function i(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var i=r.call(n,t||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function a(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,a,o,u=[],l=!0,c=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=a.call(t)).done)&&(u.push(r.value),u.length!==n);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(c)throw i}}return u}}(e,n)||u(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,n){if(e){if("string"==typeof e)return l(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,n):void 0}}function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}System.register(["./index-legacy-B2qy92BH.js","./ReaderSettingsOptions-legacy-B42lx27K.js","./Select-legacy-B4PCHe5S.js","./CustomIconButton-legacy-BaOBjcug.js","./Chapters-legacy-DTTb_G2Q.js","./Collapse-legacy-K3P7W8-C.js","./TextField-legacy-AxgEb0s0.js","./useDebounce-legacy-BWcInHo7.js","./EmptyViewAbsoluteCentered-legacy-Dzg0qcd2.js","./NumberSetting-legacy-BPaHZb3G.js","./Info-legacy-CZIy40kS.js","./InputAdornment-legacy-BqaWUKlh.js","./SpinnerImage-legacy-DnnSYddF.js","./Refresh-legacy-DQ6hehM2.js","./Switch-legacy-DJyqO5_d.js","./SwitchBase-legacy-Chlmjqql.js"],(function(e,t){"use strict";var u,l,c,s,d,f,p,g,v,h,m,x,y,w,b,C,j,E,R,k,P,S,L,O,T,D,N,I,_,A,W,M,z,H,V,X,B,F,Y,U,K,G,q,J,Z,$,Q,ee,ne,te,re,ie,ae;return{setters:[function(e){u=e.c,l=e.v,c=e.j,s=e.B,d=e.r,f=e.i,p=e.H,g=e.ap,v=e.aq,h=e.ar,m=e.as,x=e.at,y=e.C,w=e.u,b=e.k,C=e.au,j=e.e,E=e.av,R=e.aw,k=e.ax,P=e.f,S=e.I,L=e.T,O=e.ay,T=e.a4,D=e.az,N=e.a2,I=e.aA,_=e.a5,A=e.a,W=e.aB,M=e.aC,z=e.l,H=e.N,V=e.m,X=e.h,B=e.M,F=e.a7,Y=e.aD,U=e.aE},function(e){K=e.P,G=e.R,q=e.u,J=e.g,Z=e.c},function(e){$=e.S},function(e){Q=e.C},function(e){ee=e.D,ne=e.C},function(e){te=e.C},function(e){re=e.a},function(e){ie=e.u},function(e){ae=e.E},null,null,null,null,null,null,null],execute:function(){e("Reader",(function(){var e,n,t,l,d,f,p,g,v=w().t,h=j(),m=E(),x=_(),y=x.chapterIndex,b=x.mangaId,C=u.useMemo((function(){return{id:+b,title:"",thumbnailUrl:"",genre:[],inLibraryAt:0,lastReadAt:0,chapters:{totalCount:0},trackRecords:{totalCount:0}}}),[b]),R=A.useGetManga(W,b),k=R.data,P=R.loading,S=R.error,L=R.refetch,O=u.useRef(null),T=Number(b)===(null===(e=O.current)||void 0===e?void 0:e.mangaId)&&Number(y)===(null===(n=O.current)||void 0===n?void 0:n.sourceOrder)&&-1!==(null===(t=O.current)||void 0===t?void 0:t.pageCount),D=null!==(l=null==k?void 0:k.manga)&&void 0!==l?l:C,N=A.useGetChapters(M,{condition:{mangaId:Number(b),sourceOrder:Number(y)}},{notifyOnNetworkStatusChange:!0}),I=N.data,Y=N.loading,K=N.error,G=N.refetch,$=null==I?void 0:I.chapters.nodes[0],Q=u.useRef(!1),te=z().settings.downloadAheadLimit,re=!!te;O.current=O.current&&T?$&&(null===(ue=O.current)||void 0===ue?void 0:ue.pageCount)!==$.pageCount?$:O.current:(Q.current=!1,$||null);var ue;var le=null!==(d=O.current)&&void 0!==d?d:Ke,ce=u.useRef(Ke);ce.current===Ke&&(ce.current=le);le.mangaId!==(null===(f=ce.current)||void 0===f?void 0:f.mangaId)&&(ce.current=Ke);var se=o(A.useGetChapterPagesFetch(le.id),2),de=se[0],fe=se[1],pe=fe.loading,ge=fe.error,ve=function(){Y||de().then((function(){Q.current=!0})).catch(X())};u.useEffect((function(){ve()}),[le.id]);var he=o(u.useState(!1),2),me=he[0],xe=he[1],ye=o(u.useState(0),2),we=ye[0],be=ye[1],Ce=we===le.pageCount-1,je=ie(we,Ce?0:1e3),Ee=o(u.useState(void 0),2),Re=Ee[0],ke=Ee[1],Pe=u.useContext(H),Se=Pe.setOverride,Le=Pe.setTitle,Oe=Pe.readerNavBarWidth,Te=o(u.useState(!1),2),De=Te[0],Ne=Te[1],Ie=A.useGetMangaChapters(M,b,{nextFetchPolicy:"standby"}),_e=Ie.data,Ae=Ie.loading,We=Ie.error,Me=Ie.refetch,ze=null==_e?void 0:_e.chapters.nodes,He=P||Y||Ae||pe||!Q.current&&!K&&!ge,Ve=null!==(p=null!==(g=null!=S?S:K)&&void 0!==g?g:We)&&void 0!==p?p:ge,Xe=q(),Ge=Xe.settings,qe=Xe.loading,Je=o(u.useState(J(D,Ge)),2),Ze=Je[0],$e=Je[1],Qe=z().settings,en=u.useMemo((function(){return Ze.skipDupChapters?ne.removeDuplicates(ce.current,null!=ze?ze:[]):null!=ze?ze:[]}),[ce.current,ze,Ze.skipDupChapters]),nn=u.useMemo((function(){return ne.getNextChapters(le,null!=ze?ze:[],{offset:ee.PREVIOUS,skipDupe:Ze.skipDupChapters,skipDupeChapter:ce.current})}),[le,ce.current,ze,Ze.skipDupChapters]),tn=u.useMemo((function(){return ne.getNextChapters(le,null!=ze?ze:[],{skipDupe:Ze.skipDupChapters,skipDupeChapter:ce.current})}),[le,ce.current,ze,Ze.skipDupChapters]),rn=u.useMemo((function(){return ne.getNextChapter(le,null!=ze?ze:[],{offset:ee.PREVIOUS,skipDupe:Ze.skipDupChapters,skipDupeChapter:ce.current})}),[le,ce.current,ze,Ze.skipDupChapters]),an=u.useMemo((function(){return ne.getNextChapter(le,null!=ze?ze:[],{skipDupe:Ze.skipDupChapters,skipDupeChapter:ce.current})}),[le,ce.current,ze,Ze.skipDupChapters]),on=function(e){if(le!==Ke){!function(){var n,t=Fe(le.id),r=(null!==(n=e.lastPageRead)&&void 0!==n?n:0)/le.pageCount>.25;if(re&&D.inLibrary&&!(null==t||!t.isDownloaded)&&r){var i=an?Fe(an.id):null;if(null==i||!i.isDownloaded)return;var a=ne.getNonRead(tn).map((function(e){return Fe(e.id)})).slice(-te).filter((function(e){return!e.isDownloaded})).map((function(e){return e.id})).filter((function(e){return!ne.isDownloading(e)}));if(!a.length)return;ne.download(a).catch(X())}}();var n=Ze.skipDupChapters?ne.getIds(ne.addDuplicates([le],null!=ze?ze:[le])):[le.id];A.updateChapters(n,r(r({},e),{},{chapterIdsToDelete:function(){if(!(!!e.isRead&&!!Qe.deleteChaptersWhileReading)||!ze)return[];var n=[le].concat(a(nn))[Qe.deleteChaptersWhileReading-1];if(!n)return[];var t=Fe(n.id);return t.isRead&&ne.isDeletable(t,Qe.deleteChaptersWithBookmark)?Ze.skipDupChapters?ne.getIds(ne.addDuplicates([n],ze)):ne.getIds([n]):[]}(),trackProgressMangaId:Qe.updateProgressAfterReading&&e.isRead&&D.trackRecords.totalCount?D.id:void 0}),{errorPolicy:"all"}).response.catch(X())}},un=function(e,n){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];$e(r(r({},Ze),{},i({},e,n))),t&&U(D,[[e,n]]).catch((function(){return V(v("reader.settings.error.label.failed_to_save_settings"),"warning")}))},ln=u.useCallback((function(e){var n=e===ee.NEXT,t=n?an:rn;t?(Ne(!0),be(0),h("/manga/".concat(D.id,"/chapter/").concat(t.sourceOrder),{replace:!0,state:m.state}),Ne(!1)):V(v(n?"reader.error.label.next_chapter_does_not_exist":"reader.error.label.prev_chapter_does_not_exist"),"error")}),[D.id,null==rn?void 0:rn.id,null==an?void 0:an.id]);u.useEffect((function(){!He&&le?(xe(!0),le.lastPageRead===le.pageCount-1?be(0):be(le.lastPageRead)):be(0)}),[le,He]),u.useLayoutEffect((function(){null!=D&&D.title&&le.name!==v("global.label.loading")?Le("".concat(D.title,": ").concat(le.name)):Le(v("reader.title"))}),[v,D,le]),u.useEffect((function(){qe||P||(Z(D,"manga",Ge).catch(X()),$e(J(D,Ge)))}),[qe,P]),u.useLayoutEffect((function(){return Se({status:!0,value:c.jsx(Be,{settings:Ze,setSettingValue:un,manga:D,chapter:le,chapters:en,curPage:we,scrollToPage:ke,openNextChapter:ln,retrievingNextChapter:De})}),function(){return Se({status:!1,value:c.jsx("div",{})})}}),[D,le,Ze,we,y,De,ln,en]),u.useEffect((function(){if(me&&le!==Ke){var e=Fe(le.id);if(je!==(null==e?void 0:e.lastPageRead)){var n=-1!==je,t=je===le.pageCount-1;(n||t)&&on({lastPageRead:n?je:void 0,isRead:!!t||void 0})}}}),[je,re]);var cn=u.useCallback((function(){on({lastPageRead:le.pageCount-1,isRead:!0}),ln(ee.NEXT)}),[le.pageCount,ln,le,D]),sn=u.useCallback((function(){ln(ee.PREVIOUS)}),[ln]),dn=B.useGetScrollbarSize("height");if(He)return c.jsx(s,{sx:{height:"100vh",width:"100vw",display:"grid",placeItems:"center"},children:c.jsx(F,{thickness:5})});if(Ve)return c.jsx(ae,{message:v("global.error.label.failed_to_load_data"),messageExtra:Ve.message,retry:function(){S&&L().catch(X()),K&&G().catch(X()),We&&Me().catch(X()),ge&&ve()}});if(!le.pageCount)return c.jsx(ae,{message:v("reader.error.label.no_pages_found"),retry:ve});var fn=Ue(le.pageCount).map((function(e){return{index:e,src:A.getChapterPageUrl(b,y,e)}})),pn=Ye(Ze.readerType),gn=null!=Re?Re:le.lastPageRead===le.pageCount-1?0:le.lastPageRead,vn=Ze.staticNav?Oe:0;return c.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignContent:"center",alignItems:"center",justifyContent:"center",minWidth:"calc((100vw - (100vw - 100%)) - ".concat(vn,"px)"),minHeight:"calc(100vh - ".concat(dn,"px)"),marginLeft:"".concat(vn,"px")},children:[c.jsx(oe,{settings:Ze,curPage:we,pageCount:le.pageCount}),c.jsx(s,{sx:{alignSelf:"stretch"},children:c.jsx(pn,{pages:fn,pageCount:le.pageCount,setCurPage:be,initialPage:gn,curPage:we,settings:Ze,manga:D,chapter:le,nextChapter:cn,prevChapter:sn},le.id)})]})}));function t(e){var n=e.pages,t=e.curPage,r=e.initialPage,i=e.settings,a=e.setCurPage,o=e.prevChapter,d=e.nextChapter,f=u.useRef(r),p=u.useRef(null),g=u.useRef([]);function v(){var e;t<n.length-1?(null===(e=g.current[t+1])||void 0===e||e.scrollIntoView({inline:"center"}),a((function(e){return e+1}))):i.loadNextOnEnding&&d()}function h(){var e;t>0?(null===(e=g.current[t-1])||void 0===e||e.scrollIntoView({inline:"center"}),a(t-1)):0===t&&o()}var m=u.useRef(0);function x(e){window.scrollBy(m.current-e.pageX,0)}function y(e){var n;m.current=e.pageX,null===(n=p.current)||void 0===n||n.addEventListener("mousemove",x)}function w(){var e;null===(e=p.current)||void 0===e||e.removeEventListener("mousemove",x)}var b=function(){"ContinuesHorizontalLTR"===i.readerType?window.scrollX+window.innerWidth>=document.body.scrollWidth&&d():"ContinuesHorizontalRTL"===i.readerType&&window.scrollX<=window.innerWidth&&d()};return l(g.current[r],u.useCallback((function(e,n){var t=g.current[r];null!=t&&t.offsetHeight&&(t.scrollIntoView({inline:"center"}),n.disconnect())}),[g.current[r],r])),u.useEffect((function(){var e,n;return null===(e=p.current)||void 0===e||e.addEventListener("mousedown",y),null===(n=p.current)||void 0===n||n.addEventListener("mouseup",w),function(){var e,n;null===(e=p.current)||void 0===e||e.removeEventListener("mousedown",y),null===(n=p.current)||void 0===n||n.removeEventListener("mouseup",w)}}),[p]),u.useEffect((function(){return i.loadNextOnEnding&&document.addEventListener("scroll",b),function(){document.removeEventListener("scroll",b)}}),[p,t,o,d]),u.useEffect((function(){var e=function(){if(p.current){var e=function(e){for(var n=0;n<e.children.length;n++){var t=e.children.item(n);if(t){var r=t.getBoundingClientRect(),i=r.left,a=r.right;if(i<=window.innerWidth/2&&a>window.innerWidth/2)return n}}return-1}(p.current);e!==f.current&&(f.current=e,a(e)),("ContinuesHorizontalLTR"===i.readerType?window.innerWidth+window.scrollX>=document.body.scrollWidth-5:window.scrollX<=0)&&(f.current=n.length-1,a(f.current))}};return window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}}),[i.readerType]),c.jsx(s,{ref:p,sx:{display:"flex",flexDirection:"ContinuesHorizontalLTR"===i.readerType?"row":"row-reverse",justifyContent:"ContinuesHorizontalLTR"===i.readerType?"flex-start":"flex-end",width:"auto",height:"auto",overflowX:"visible",userSelect:"none"},onClick:function(e){e.clientX>=.85*window.innerWidth?"ContinuesHorizontalLTR"===i.readerType?v():h():e.clientX<=.15*window.innerWidth&&("ContinuesHorizontalLTR"===i.readerType?h():v())},onWheel:function(e){window.scrollBy({left:"ContinuesHorizontalLTR"===i.readerType?e.deltaY:-1*e.deltaY})},children:n.map((function(e){return c.jsx(K,{index:e.index,src:e.src,onImageLoad:function(){},settings:i,ref:function(n){g.current[e.index]=n}},e.index)}))})}function oe(e){var n=e.settings,t=e.curPage,r=e.pageCount;return c.jsx(s,{sx:{display:n.showPageNumber?"block":"none",position:"fixed",bottom:"50px",padding:"2px",paddingLeft:"4px",paddingRight:"4px",textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.3)",borderRadius:"10px"},children:"".concat(t+1," / ").concat(r)})}function ue(e){var n=e.pages,t=e.settings,r=e.setCurPage,i=e.initialPage,a=e.curPage,o=e.nextChapter,l=e.prevChapter,d=u.useRef(null),f=function(e){r(e),window.scroll({top:0})};function p(){a<n.length-1?f(a+1):t.loadNextOnEnding&&o()}function g(){a>0?f(a-1):l()}function v(){"SingleLTR"===t.readerType?g():"SingleRTL"===t.readerType&&p()}function h(){"SingleLTR"===t.readerType?p():"SingleRTL"===t.readerType&&g()}function m(e){switch(e.key){case"Space":e.preventDefault(),p();break;case"ArrowRight":h();break;case"ArrowLeft":v()}}return u.useEffect((function(){return document.addEventListener("keydown",m),function(){document.removeEventListener("keydown",m)}}),[d,a,t.readerType,l,o]),u.useEffect((function(){setTimeout((function(){f(i)}),0)}),[i]),c.jsx(s,{ref:d,sx:{display:"flex",flexDirection:"column",justifyContent:"center",width:"auto",height:"auto"},onClick:function(e){e.clientX>window.innerWidth/2?h():v()},children:n.map((function(e){var n=e.index,r=e.src;return c.jsx(K,{index:n,onImageLoad:function(){},src:r,settings:t,display:n===a},r)}))})}function le(e){var n=e.pages,t=e.settings,r=e.setCurPage,i=e.initialPage,l=e.curPage,d=e.nextChapter,f=e.prevChapter,p=u.useRef(null),g=u.useRef([]),v=u.useRef([]),h=o(u.useState(Array(n.length).fill(!1)),2),m=h[0],x=h[1],y=o(u.useState(Array(n.length).fill(!1)),2),w=y[0],b=y[1];function C(){var e=function(e){return r(-1===e?n.length-1:e)};if(g.current[n.length-1]&&t.loadNextOnEnding)return l===n.length-1||e(n.length-1),void d();e(g.current.findIndex((function(e,n){return!e&&n>l})))}function j(){var e=function(e){return r(Math.max(e,0))};if(g.current[0])return!l||e(0),void f();e(a(g.current).slice(0,l).findLastIndex((function(e){return!e})))}function E(){"DoubleLTR"===t.readerType?j():C()}function R(){"DoubleLTR"===t.readerType?C():j()}function k(e){switch(e.key){case"Space":e.preventDefault(),C();break;case"ArrowRight":R();break;case"ArrowLeft":E()}}return u.useEffect((function(){return document.addEventListener("keydown",k),function(){document.removeEventListener("keydown",k)}}),[p,l,t.readerType,f,d,w,m]),u.useEffect((function(){r(i)}),[i]),c.jsx(s,{ref:p,onClick:function(e){e.clientX>window.innerWidth/2?R():E()},children:c.jsx(s,{id:"display",sx:{display:"flex",flexDirection:"DoubleLTR"===t.readerType?"row":"row-reverse",justifyContent:"center",width:"auto",height:"auto"},children:n.map((function(e){var n=e.index,r=e.src,i=function(){var e=v.current[l];void 0===e&&(e=Math.max(m.lastIndexOf(!0,l),0),w.slice(0,l).every(Boolean)&&(v.current[l]=e));return e>0?e+1:e}(),a=l-i,o=0===l,u=Number(t.offsetFirstPage)+Number(t.offsetFirstPage&&!a&&!o),s=l+(!((a-u)%2)?1:-1),d=n===l,f=n===s,p=m[l],h=m[s],y=d||f&&!(p||h);return g.current[n]=y,c.jsx(K,{index:n,src:r,onImageLoad:function(){var e=new Image;e.onload=function(){b((function(e){return e.toSpliced(n,1,!0)})),x((function(t){return t.toSpliced(n,1,(r=e).height/r.width<1);var r}))},e.src=r},settings:t,display:y},r)}))})})}var ce=function(){return window.innerHeight+window.scrollY>=document.body.offsetHeight-5};function se(e){var n=e.pages,t=e.settings,r=e.setCurPage,i=e.initialPage,a=e.nextChapter,o=e.prevChapter,d=u.useRef(i),f=u.useRef(null),p=u.useRef([]);u.useEffect((function(){var e=!1,i=function(){if(f.current)if(ce()){if(e)return;e=!0,d.current=n.length-1,r(d.current),t.loadNextOnEnding&&a()}else{e=!1;var i=function(e){for(var n=0;n<e.children.length;n++){var t=e.children.item(n);if(t){var r=t.getBoundingClientRect(),i=r.top,a=r.bottom;if(i<=window.innerHeight&&a>1)return n}}return-1}(f.current);i!==d.current&&(d.current=i,r(i))}};return window.addEventListener("scroll",i),function(){window.removeEventListener("scroll",i)}}),[t.loadNextOnEnding,a]);var g=u.useRef(0),v=u.useRef(!1);function h(e){v.current=!0,window.scrollBy(0,g.current-e.pageY)}function m(e){var n;g.current=e.pageY,null===(n=f.current)||void 0===n||n.addEventListener("mousemove",h)}function x(){var e;null===(e=f.current)||void 0===e||e.removeEventListener("mousemove",h)}u.useEffect((function(){var e,n;return null===(e=f.current)||void 0===e||e.addEventListener("mousedown",m),null===(n=f.current)||void 0===n||n.addEventListener("mouseup",x),function(){var e,n;null===(e=f.current)||void 0===e||e.removeEventListener("mousedown",m),null===(n=f.current)||void 0===n||n.removeEventListener("mouseup",x)}}),[f]);var y=u.useCallback((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95;"down"===e&&ce()?a():"up"===e&&window.scrollY<=0?o():window.scroll({top:window.scrollY+window.innerHeight*n*("up"===e?-1:1),behavior:"smooth"})}),[a,o]);return u.useEffect((function(){var e=function(e){switch(e.key){case"Space":case"ArrowRight":e.preventDefault(),y(e.shiftKey?"up":"down");break;case"ArrowDown":e.preventDefault(),y(e.shiftKey?"up":"down",.25);break;case"ArrowUp":e.preventDefault(),y(e.shiftKey?"down":"up",.25);break;case"ArrowLeft":e.preventDefault(),y(e.shiftKey?"down":"up")}};return document.addEventListener("keydown",e,!1),function(){document.removeEventListener("keydown",e)}}),[y]),l(p.current[i],u.useCallback((function(e,n){var t=p.current[i];null!=t&&t.offsetHeight&&(t.scrollIntoView(),n.disconnect())}),[p.current[i],i])),c.jsx(s,{ref:f,sx:{display:"flex",flexDirection:"column",justifyContent:"center",width:"auto",height:"auto",userSelect:"none"},onClick:function(e){v.current?v.current=!1:y(e.clientX>window.innerWidth/2?"down":"up")},children:n.map((function(e){return c.jsx(K,{index:e.index,src:e.src,onImageLoad:function(){},settings:t,ref:function(n){p.current[e.index]=n}},e.index)}))})}var de={},fe=f;Object.defineProperty(de,"__esModule",{value:!0});var pe=de.default=void 0,ge=fe(d()),ve=c;pe=de.default=(0,ge.default)((0,ve.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var he={},me=f;Object.defineProperty(he,"__esModule",{value:!0});var xe=he.default=void 0,ye=me(d()),we=c;xe=he.default=(0,ye.default)((0,we.jsx)("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"}),"KeyboardArrowLeft");var be={},Ce=f;Object.defineProperty(be,"__esModule",{value:!0});var je=be.default=void 0,Ee=Ce(d()),Re=c;je=be.default=(0,Ee.default)((0,Re.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight");var ke={},Pe=f;Object.defineProperty(ke,"__esModule",{value:!0});var Se=ke.default=void 0,Le=Pe(d()),Oe=c;Se=ke.default=(0,Le.default)((0,Oe.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown");var Te={},De=f;Object.defineProperty(Te,"__esModule",{value:!0});var Ne=Te.default=void 0,Ie=De(d()),_e=c;Ne=Te.default=(0,Ie.default)((0,_e.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");var Ae={entering:{transform:"none"},entered:{transform:"none"}},We=u.forwardRef((function(e,t){var i=p(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},o=e.addEndListener,l=e.appear,s=void 0===l||l,d=e.children,f=e.easing,y=e.in,w=e.onEnter,b=e.onEntered,C=e.onEntering,j=e.onExit,E=e.onExited,R=e.onExiting,k=e.style,P=e.timeout,S=void 0===P?a:P,L=e.TransitionComponent,O=void 0===L?h:L,T=function(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.includes(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}(e,n),D=u.useRef(null),N=g(D,v(d),t),I=function(e){return function(n){if(e){var t=D.current;void 0===n?e(t):e(t,n)}}},_=I(C),A=I((function(e,n){m(e);var t=x({style:k,timeout:S,easing:f},{mode:"enter"});e.style.webkitTransition=i.transitions.create("transform",t),e.style.transition=i.transitions.create("transform",t),w&&w(e,n)})),W=I(b),M=I(R),z=I((function(e){var n=x({style:k,timeout:S,easing:f},{mode:"exit"});e.style.webkitTransition=i.transitions.create("transform",n),e.style.transition=i.transitions.create("transform",n),j&&j(e)})),H=I(E);return c.jsx(O,r(r({appear:s,in:y,nodeRef:D,onEnter:A,onEntered:W,onEntering:_,onExit:z,onExited:H,onExiting:M,addEndListener:function(e){o&&o(D.current,e)},timeout:S},T),{},{children:function(e,n){return u.cloneElement(d,r({style:r(r(r({transform:"scale(0)",visibility:"exited"!==e||y?void 0:"hidden"},Ae[e]),k),d.props.style),ref:N},n))}}))})),Me=y("div")({zIndex:10}),ze=y("div")((function(e){var n=e.theme;return{position:"fixed",top:0,left:0,minWidth:"240px",maxWidth:"400px",height:"100vh",overflowY:"auto",backgroundColor:n.palette.background.default,"& header":{backgroundColor:n.palette.action.hover,display:"flex",alignItems:"center",padding:"".concat(n.spacing(1)," ").concat(n.spacing(3)),transition:"left 2s ease"}}})),He=y("div")((function(e){var n=e.theme;return{margin:"0 ".concat(n.spacing(2))}})),Ve=y("div")({display:"flex",flexWrap:"wrap",alignContent:"center",alignItems:"center",justifyContent:"center"}),Xe=y("div")((function(e){var n=e.theme;return{display:"grid",gridTemplateRows:"auto auto auto",gridTemplateColumns:"0fr 1fr 0fr",gridTemplateAreas:'"pre current next"',gridColumnGap:n.spacing(.5),margin:"".concat(n.spacing(1)," 0"),"& a":{textDecoration:"none",color:"inherit",display:"flex",flexWrap:"wrap",alignContent:"center"}}}));function Be(e){var n,t=w().t,i=b().setReaderNavBarWidth,a=p(),s=C(),d=j(),f=null!==(n=E().state)&&void 0!==n?n:{},g=f.prevDrawerOpen,v=f.prevSettingsCollapseOpen,h=u.useRef(null);l(h,u.useCallback((function(){var e;void 0!==(null===(e=h.current)||void 0===e?void 0:e.offsetWidth)&&i(h.current.offsetWidth)}),[h.current])),u.useLayoutEffect((function(){return function(){return i(0)}}),[h]);var m=e.settings,x=e.setSettingValue,y=e.manga,_=e.chapter,A=e.chapters,W=e.curPage,M=e.scrollToPage,z=e.openNextChapter,H=e.retrievingNextChapter,V=R(),X=u.useMemo((function(){return new Set(A.map((function(e){return e.scanlator}))).size>1}),[A]),B=o(u.useState(m.staticNav||g),2),F=B[0],Y=B[1],U=o(u.useState(!0),2),K=U[0],q=U[1],J=o(u.useState(m.staticNav||g),2),Z=J[0],ne=J[1],ie=o(u.useState(0),2),ae=ie[0],oe=ie[1],ue=o(u.useState(null==v||v),2),le=ue[0],ce=ue[1],se=H,de=function(e){Y(e),ne(e)},fe=function(){var e=window.pageYOffset;Math.abs(e-ae)>20&&(ne(e>ae),oe(e))};return u.useEffect((function(){K&&de(m.staticNav)}),[m.staticNav]),u.useEffect((function(){window.addEventListener("scroll",fe);var e=document.querySelector("#root"),n=document.querySelector("#appMainContainer");return e.style.display="flex",e.style.flexDirection="column",n.style.display="none",function(){e.style.display="block",n.style.display="block",window.removeEventListener("scroll",fe)}}),[fe]),c.jsxs(Me,{children:[c.jsx(k,{direction:s("right","left"),in:F,timeout:200,appear:!1,mountOnEnter:!0,unmountOnExit:!0,children:c.jsxs(ze,{ref:h,children:[c.jsxs("header",{children:[!m.staticNav&&c.jsx(P,{title:t("reader.button.close_menu"),children:c.jsx(S,{edge:"start",color:"inherit","aria-label":"menu",onClick:function(){return de(!1)},size:"large",children:s(c.jsx(xe,{}),c.jsx(je,{}))})}),c.jsx(L,{variant:"h6",component:"h1",sx:{textOverflow:"ellipsis",overflow:"hidden",py:1,flexGrow:1},children:_.name}),c.jsx(P,{title:t("reader.button.exit"),children:c.jsx(S,{edge:"start",color:"inherit","aria-label":"menu",onClick:V,size:"large",sx:{mr:-1},children:c.jsx(pe,{})})})]}),c.jsxs(O,{ContainerComponent:"div",sx:{"& span":{fontWeight:"bold"}},children:[c.jsx(T,{primary:t("reader.settings.title.reader_settings")}),c.jsxs(S,{edge:"start",color:"inherit","aria-label":"menu",disableRipple:!0,disableFocusRipple:!0,onClick:function(){return ce(!le)},size:"large",children:[le&&c.jsx(Ne,{}),!le&&c.jsx(Se,{})]})]}),c.jsx(te,{in:le,timeout:"auto",unmountOnExit:!0,children:c.jsx(G,{setSettingValue:function(e,n,t){q("staticNav"!==e),x(e,n,t)},staticNav:m.staticNav,showPageNumber:m.showPageNumber,loadNextOnEnding:m.loadNextOnEnding,skipDupChapters:m.skipDupChapters,fitPageToWindow:m.fitPageToWindow,scalePage:m.scalePage,readerType:m.readerType,offsetFirstPage:m.offsetFirstPage,readerWidth:m.readerWidth})}),c.jsx(D,{sx:{my:1,mx:2}}),c.jsxs(He,{children:[c.jsxs(Ve,{children:[c.jsx("span",{children:t("reader.page_info.label.currently_on_page")}),c.jsx(re,{size:"small",sx:{mx:.5},disabled:se||-1===_.pageCount,children:c.jsx($,{value:_.pageCount>-1?"".concat(W):"",displayEmpty:!0,onChange:function(e){var n=e.target.value;M(Number(n))},children:Array(Math.max(0,_.pageCount)).fill(1).map((function(e,n){return c.jsx(N,{value:n,children:n+1},"Page#".concat(n))}))})}),c.jsx("span",{children:t("reader.page_info.label.of_max_pages",{maxPages:_.pageCount})})]}),c.jsxs(Xe,{children:[c.jsx(P,{title:t("reader.button.previous_chapter"),children:c.jsx(S,{sx:{gridArea:"pre"},disabled:se||_.sourceOrder<=1,onClick:function(){return z(ee.PREVIOUS)},children:s(c.jsx(xe,{}),c.jsx(je,{}))})}),c.jsx(re,{sx:{gridArea:"current"},size:"small",disabled:se||_.sourceOrder<1,children:c.jsx($,{value:_.sourceOrder>=1?"".concat(_.sourceOrder):"",displayEmpty:!0,onChange:function(e){var n=e.target.value;d("/manga/".concat(y.id,"/chapter/").concat(n),{replace:!0,state:{prevDrawerOpen:F,prevSettingsCollapseOpen:le}})},children:A.map((function(e){var n=e.id,t=e.sourceOrder,r=e.name,i=e.chapterNumber,a=e.scanlator;return c.jsx(N,{value:t,children:"#".concat(i).concat(X&&null!=a?" (".concat(a,")"):""," | ").concat(r)},n)}))})}),c.jsx(P,{title:t("reader.button.next_chapter"),children:c.jsx(S,{sx:{gridArea:"next"},disabled:se||_.sourceOrder<1||_.sourceOrder>=y.chapters.totalCount,onClick:function(){return z(ee.NEXT)},children:s(c.jsx(je,{}),c.jsx(xe,{}))})})]})]})]})}),c.jsx(We,{in:!F,children:c.jsx(I,{in:!Z,children:c.jsx(P,{title:t("reader.button.open_menu"),children:c.jsx(Q,{sx:r({position:"fixed",top:20,left:20,backgroundColor:"rgba(255, 255, 255, 0.75);",color:"black"},a.applyStyles("dark",{backgroundColor:"rgba(0, 0, 0, 0.75);",color:"white"})),size:"large",variant:"contained",onClick:function(){return de(!0)},children:s(c.jsx(je,{}),c.jsx(xe,{}))})})})})]})}var Fe=function(e){return ne.getFromCache(e,Y,"CHAPTER_READER_FIELDS")},Ye=function(e){switch(e){case"ContinuesVertical":case"Webtoon":default:return se;case"SingleVertical":case"SingleRTL":case"SingleLTR":return ue;case"DoubleVertical":case"DoubleRTL":case"DoubleLTR":return le;case"ContinuesHorizontalLTR":case"ContinuesHorizontalRTL":return t}},Ue=function(e){return Array.from({length:e},(function(e,n){return n}))},Ke={pageCount:-1,sourceOrder:-1,chapterCount:0,lastPageRead:0,name:"Loading...",manga:{id:-1}}}}}))}();
