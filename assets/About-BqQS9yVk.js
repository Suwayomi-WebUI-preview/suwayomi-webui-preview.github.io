import{c as z,j as e,bf as u,d as O,T as q,e as H,aB as h,a_ as V,Y as D,bg as G,as as $,u as Y,g as J,k as K,r as p,n as Q,E as X,o as Z,p as W,H as m,b6 as x,aW as l,bh as ee,bi as v,bj as S,b9 as y}from"./index-FX96rGzE.js";const re=z(e.jsx("path",{d:"M18.32 4.26C16.84 3.05 15.01 2.25 13 2.05v2.02c1.46.18 2.79.76 3.9 1.62zM19.93 11h2.02c-.2-2.01-1-3.84-2.21-5.32L18.31 7.1c.86 1.11 1.44 2.44 1.62 3.9m-1.62 5.9 1.43 1.43c1.21-1.48 2.01-3.32 2.21-5.32h-2.02c-.18 1.45-.76 2.78-1.62 3.89M13 19.93v2.02c2.01-.2 3.84-1 5.32-2.21l-1.43-1.43c-1.1.86-2.43 1.44-3.89 1.62M13 12V7h-2v5H7l5 5 5-5zm-2 7.93v2.02c-5.05-.5-9-4.76-9-9.95s3.95-9.45 9-9.95v2.02C7.05 4.56 4 7.92 4 12s3.05 7.44 7 7.93"})),se=(r,a,s,o=!1)=>s===u.Downloading?e.jsx(re,{}):r?e.jsx(V,{size:15}):!a||s===u.Error?e.jsx(D,{}):o?e.jsx(G,{}):e.jsx($,{}),te=(r,a,s,o,b=0)=>o===u.Downloading?h("global.update.label.updating",{progress:b}):o===u.Error?h("global.update.label.update_failure"):r?h("global.update.label.checking"):s?h("global.update.label.check_failure"):a?h("global.update.label.available"):h("global.update.label.up_to_date"),_=({version:r,isCheckingForUpdate:a,isUpdateAvailable:s,updateCheckError:o,checkForUpdate:b,triggerUpdate:n,updateState:c,progress:g,downloadAsLink:k,url:j})=>{const f=c===u.Downloading,i=()=>{if(f)return;if(!s||o||c===u.Error){b();return}s&&(n==null||n())};return e.jsxs(O,{sx:{alignItems:"start"},children:[e.jsx(q,{component:"span",variant:"body2",children:r}),e.jsx(H,{sx:{marginTop:"5px",backgroundColor:"transparent",pointerEvents:f?"none":"unset"},size:"small",variant:"outlined",startIcon:se(a,s,c,k),onClick:i,...j&&s?{href:j,target:"_blank"}:void 0,children:te(a,s,o,c,g)})]})};function oe(){var C,E,F;const{t:r}=Y(),{setTitle:a,setAction:s}=J();K.useLayoutEffect(()=>(a(r("settings.about.title")),s(null),()=>{a(""),s(null)}),[r]);const{data:o,loading:b,error:n,refetch:c}=p.useGetAbout({notifyOnNetworkStatusChange:!0}),{data:g,loading:k,refetch:j,error:f}=p.useCheckForServerUpdate({notifyOnNetworkStatusChange:!0}),{data:i,loading:I,refetch:L,error:T}=p.useCheckForWebUIUpdate({notifyOnNetworkStatusChange:!0}),P=T||(i==null?void 0:i.checkForWebUIUpdate.tag)==="",{data:U}=p.useGetWebUIUpdateStatus(),{state:A,progress:M}=(C=U==null?void 0:U.getWebUIUpdateStatus)!=null?C:{state:u.Idle,progress:0};if(b)return e.jsx(Q,{});if(n)return e.jsx(X,{message:r("global.error.label.failed_to_load_data"),messageExtra:Z(n),retry:()=>c().catch(W())});const{aboutServer:t,aboutWebUI:w}=o,d=(E=g==null?void 0:g.checkForServerUpdates)==null?void 0:E.find(B=>B.channel===t.buildType),N=!!(d!=null&&d.tag)&&d.tag!==t.version,R=!!(i!=null&&i.checkForWebUIUpdate.updateAvailable);return e.jsxs(m,{sx:{pt:0},children:[e.jsxs(m,{sx:{padding:0},subheader:e.jsx(v,{component:"div",id:"about-server-info",children:r("settings.server.title.server")}),children:[e.jsx(x,{children:e.jsx(l,{primary:r("settings.server.title.server"),secondary:"".concat(t.name," (").concat(t.buildType,")")})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.server.label.version"),secondary:e.jsx(_,{version:t.version,isCheckingForUpdate:k,isUpdateAvailable:N,updateCheckError:f,checkForUpdate:j,downloadAsLink:!0,url:(F=d==null?void 0:d.url)!=null?F:""})})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.server.label.build_time"),secondary:ee(Number(t.buildTime)).toString()})})]}),e.jsx(S,{}),e.jsxs(m,{sx:{padding:0},subheader:e.jsx(v,{component:"div",id:"about-webui-info",children:r("settings.webui.title.webui")}),children:[e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.webui.label.channel"),secondary:w.channel.toLocaleUpperCase()})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.webui.label.version"),secondary:e.jsx(_,{version:w.tag,isCheckingForUpdate:I,isUpdateAvailable:R,updateCheckError:P,checkForUpdate:L,triggerUpdate:()=>p.updateWebUI().response.catch(W()),progress:M,updateState:A})})})]}),e.jsx(S,{}),e.jsxs(m,{subheader:e.jsx(v,{component:"div",id:"about-links",children:r("global.label.links")}),children:[e.jsx(y,{to:t.github,target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("settings.about.server.label.github"),secondary:t.github})}),e.jsx(y,{to:"https://github.com/Suwayomi/Suwayomi-WebUI",target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("settings.about.webui.label.github"),secondary:"https://github.com/Suwayomi/Suwayomi-WebUI"})}),e.jsx(y,{to:t.discord,target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("global.label.discord"),secondary:t.discord})})]})]})}export{oe as About};
