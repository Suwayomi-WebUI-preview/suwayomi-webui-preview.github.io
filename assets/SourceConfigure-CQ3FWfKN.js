import{j as e,k as h,b6 as _,aW as P,b7 as G,a9 as D,u as k,bc as L,D as O,v as B,w as M,bE as N,bB as R,b8 as F,e as j,aR as E,bF as A,bC as H,g as W,aX as J,r as V,bG as U,n as q,E as X,o as w,p as $,H as z,t as K}from"./index-FX96rGzE.js";import{L as Q}from"./ListPreference-DKcRPY0h.js";function y(t){return JSON.parse(JSON.stringify(t))}function Y(t){return t==="Switch"?G:D}const Z=t=>t.type==="CheckBoxPreference"?{title:t.CheckBoxTitle,defaultValue:t.CheckBoxDefault,currentValue:t.CheckBoxCheckBoxCurrentValue}:{title:t.SwitchPreferenceTitle,defaultValue:t.SwitchPreferenceDefault,currentValue:t.SwitchPreferenceCurrentValue};function I(t){const{title:a,defaultValue:i,currentValue:n,summary:f,updateValue:g,twoStateType:s}={...t,...Z(t)},[o,u]=h.useState(n!=null?n:i);h.useEffect(()=>{u(n!=null?n:i)},[n]);const x=h.useMemo(()=>Y(s),[s]);return e.jsxs(_,{children:[e.jsx(P,{primary:a,secondary:f}),e.jsx(x,{edge:"end",checked:o,onChange:()=>{g(s==="Switch"?"switchState":"checkBoxState",!n),u(!n)}})]})}function v(t){return e.jsx(I,{...t,twoStateType:"Checkbox"})}function ee(t){return e.jsx(I,{...t,twoStateType:"Switch"})}function te(t){const{t:a}=k(),{EditTextPreferenceTitle:i,summary:n,dialogTitle:f,dialogMessage:g,EditTextPreferenceCurrentValue:s,updateValue:o}=t,[u,x]=h.useState(s!=null?s:""),[C,d]=h.useState(!1),c=()=>{d(!1),x(s!=null?s:"")},l=()=>{d(!1),o("editTextState",u)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{onClick:()=>d(!0),children:e.jsx(P,{primary:i,secondary:n})}),e.jsxs(O,{open:C,onClose:c,children:[e.jsx(B,{children:f}),e.jsxs(M,{children:[e.jsx(N,{children:g}),e.jsx(R,{autoFocus:!0,margin:"dense",id:"name",type:"text",fullWidth:!0,value:u,onChange:m=>x(m.target.value)})]}),e.jsxs(F,{children:[e.jsx(j,{onClick:c,color:"primary",children:a("global.button.cancel")}),e.jsx(j,{onClick:l,color:"primary",children:a("global.button.ok")})]})]})]})}function ne(t){const{t:a}=k(),{selectedValues:i,open:n,onClose:f,values:g,title:s}=t,[o,u]=E.useState(i);E.useEffect(()=>{n||u(i)},[i,n]);const x=()=>{f(null)},C=()=>{f(o)},d=(c,l)=>{const{checked:m}=c.target,p=o.some(r=>l===r);if(m){if(!p){const r=y(o);r.push(l),u(r)}}else if(p){const r=y(o),S=r.indexOf(l);r.splice(S,1),u(r)}};return e.jsxs(O,{sx:{"& .MuiDialog-paper":{width:"80%",maxHeight:435}},maxWidth:"xs",open:n,onClose:x,children:[e.jsx(B,{children:s}),e.jsx(M,{dividers:!0,children:e.jsx(A,{children:g.map(c=>e.jsx(H,{control:e.jsx(D,{checked:o.some(l=>c===l),onChange:l=>d(l,c)}),label:c},c))})}),e.jsxs(F,{children:[e.jsx(j,{autoFocus:!0,onClick:x,children:a("global.button.cancel")}),e.jsx(j,{onClick:C,children:a("global.button.ok")})]})]})}function re(t){const{MultiSelectListPreferenceTitle:a,summary:i,MultiSelectListPreferenceCurrentValue:n,MultiSelectListPreferenceDefault:f,updateValue:g,entryValues:s,entries:o}=t,[u,x]=h.useState(n!=null?n:f),[C,d]=h.useState(!1);h.useEffect(()=>{x(n)},[n]);const c=r=>{var S;return(S=r==null?void 0:r.map(b=>{const T=s.indexOf(b);return o[T]}))!=null?S:[]},l=r=>{var S;return(S=r==null?void 0:r.map(b=>{const T=o.indexOf(b);return s[T]}))!=null?S:[]},m=()=>i,p=r=>{r!==null&&(g("multiSelectState",l(r)),x(r)),d(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{onClick:()=>d(!0),children:e.jsx(P,{primary:a,secondary:m()})}),e.jsx(ne,{title:a!=null?a:"",open:C,onClose:p,selectedValues:c(u),values:o})]})}function se(t){switch(t){case"CheckBoxPreference":return v;case"SwitchPreference":return ee;case"ListPreference":return Q;case"EditTextPreference":return te;case"MultiSelectListPreference":return re;default:throw new Error('Unexpected preference type "'.concat(t,'"'))}}function ce(){var C;const{t}=k(),{setTitle:a,setAction:i}=W();h.useLayoutEffect(()=>(a(t("source.configuration.title")),i(null),()=>{a(""),i(null)}),[t]);const{sourceId:n}=J(),{data:f,loading:g,error:s,refetch:o}=V.useGetSource(U,n,{notifyOnNetworkStatusChange:!0}),u=(C=f==null?void 0:f.source.preferences)!=null?C:[],x=d=>(c,l)=>{V.setSourcePreferences(n,{position:d,[c]:l}).response.catch(m=>K(t("global.error.label.failed_to_save_changes"),"error",w(m)))};return g?e.jsx(q,{}):s?e.jsx(X,{message:t("global.error.label.failed_to_load_data"),messageExtra:w(s),retry:()=>o().catch($())}):e.jsx(z,{sx:{padding:0},children:u.map((d,c)=>{const l=y(d);return h.createElement(se(d.type),{...l,updateValue:x(c)})})})}export{ce as SourceConfigure};
