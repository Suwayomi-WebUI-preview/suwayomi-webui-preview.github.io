import{u as N,r as g,g as j,n as S,k as p,j as t,x as T,aE as U,as as I,d as P,f as R,i as y,l as A,bo as b,t as M,bp as x,bq as h}from"./index-YAtlvmGf.js";import{N as W}from"./NumberSetting-Bxnjr-8f.js";import{u as B,g as D}from"./usePersistedValue-C8YmXGio.js";import{S as E}from"./Switch-dYYnEC4v.js";import{T as H}from"./TextSetting-BEOeKwkt.js";import{S as f}from"./SelectSetting-BwxSN0wH.js";import{E as q}from"./EmptyViewAbsoluteCentered-6ui_Uq2m.js";import"./TextField-mKvu1Dg7.js";import"./useFormControl-BmhXecYK.js";import"./formControlState-Dq1zat_P.js";import"./InputAdornment-tKPrVGyD.js";import"./Slider-BQ2AI3Nb.js";import"./SwitchBase-C2GwZp-q.js";import"./PasswordTextField-nMd54wUF.js";import"./Select-imZ-AwMv.js";const L=23,K=1,Y=23,G=({disabled:e=!1,updateCheckInterval:r})=>{const{t:l}=N(),d=!!r,[w]=g.useUpdateServerSettings(),[i,v]=B("lastUpdateCheckInterval",L,r,D),u=j.useCallback(s=>{v(s===0?i:s),w({variables:{input:{settings:{webUIUpdateCheckInterval:s}}}}).catch(o=>S(l("global.error.label.failed_to_save_changes"),"error",p(o)))},[i]),m=s=>{u(s?i:0)};return t.jsxs(T,{children:[t.jsxs(U,{children:[t.jsx(I,{primary:l("settings.webui.auto_update.label.title")}),t.jsx(E,{disabled:e,edge:"end",checked:d,onChange:s=>m(s.target.checked)})]}),t.jsx(W,{settingTitle:l("settings.webui.auto_update.label.interval"),settingValue:l("library.settings.global_update.auto_update.interval.label.value",{hours:i}),value:i,minValue:K,maxValue:Y,defaultValue:L,showSlider:!0,valueUnit:l("global.time.hour_short"),handleUpdate:u,disabled:e||!d})]})},Q=Object.values(b),X={[b.Webui]:{text:"settings.webui.title.webui",description:"settings.webui.flavor.option.webui.label.description",disclaimer:"settings.webui.flavor.label.info"},[b.Vui]:{text:"settings.webui.flavor.option.vui.label.title",description:"settings.webui.flavor.option.vui.label.description",disclaimer:"settings.webui.flavor.label.info"},[b.Custom]:{text:"settings.webui.flavor.option.custom.label.title",description:"settings.webui.flavor.option.custom.label.description"}},z=Q.map(e=>[e,X[e]]),J=Object.values(h),Z={[h.Bundled]:{text:"settings.webui.channel.option.bundled.label.title",description:"settings.webui.channel.option.bundled.label.description",disclaimer:"settings.webui.flavor.label.info"},[h.Stable]:{text:"settings.webui.channel.option.stable.label.title",description:"settings.webui.channel.option.stable.label.description",disclaimer:"settings.webui.flavor.label.info"},[h.Preview]:{text:"settings.webui.channel.option.preview.label.title",description:"settings.webui.channel.option.preview.label.description",disclaimer:"settings.webui.channel.option.preview.label.disclaimer"}},$=J.map(e=>[e,Z[e]]),ee=Object.values(x),te={[x.Browser]:{text:"settings.webui.interface.option.label.browser",description:"settings.webui.interface.label.description"},[x.Electron]:{text:"settings.webui.interface.option.label.electron",description:"settings.webui.interface.label.description"}},ae=ee.map(e=>[e,te[e]]),ie=e=>({webUIFlavor:e.webUIFlavor,initialOpenInBrowserEnabled:e.initialOpenInBrowserEnabled,webUIInterface:e.webUIInterface,electronPath:e.electronPath,webUIChannel:e.webUIChannel,webUIUpdateCheckInterval:e.webUIUpdateCheckInterval}),Se=()=>{const{t:e}=N(),{setTitle:r,setAction:l}=P();j.useLayoutEffect(()=>(r(e("settings.webui.title.webui")),l(null),()=>{r(""),l(null)}),[e]);const{settings:{webUIInformAvailableUpdate:d},loading:w,request:{error:i,refetch:v}}=R(),u=M(a=>S(e("global.error.label.failed_to_save_changes"),"error",p(a))),{data:m,loading:s,error:o,refetch:O}=g.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[k]=g.useUpdateServerSettings(),c=(a,V)=>{a==="webUIChannel"&&g.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),k({variables:{input:{settings:{[a]:V}}}}).catch(F=>S(e("global.error.label.failed_to_save_changes"),"error",p(F)))};if(w||s)return t.jsx(y,{});const _=i!=null?i:o;if(_)return t.jsx(q,{message:e("global.error.label.failed_to_load_data"),messageExtra:p(_),retry:()=>{i&&v().catch(A()),o&&O().catch(A())}});const n=ie(m.settings),C=n.webUIFlavor===b.Custom;return t.jsxs(T,{sx:{pt:0},children:[t.jsx(f,{settingName:e("settings.webui.flavor.label.title"),value:n.webUIFlavor,values:z,handleChange:a=>c("webUIFlavor",a)}),t.jsxs(U,{children:[t.jsx(I,{primary:e("settings.webui.label.initial_open_browser")}),t.jsx(E,{edge:"end",checked:n.initialOpenInBrowserEnabled,onChange:a=>c("initialOpenInBrowserEnabled",a.target.checked)})]}),t.jsx(f,{settingName:e("settings.webui.interface.label.title"),value:n.webUIInterface,values:ae,handleChange:a=>c("webUIInterface",a)}),t.jsx(H,{settingName:e("settings.webui.electron_path.label.title"),dialogDescription:e("settings.webui.electron_path.label.description"),value:n.electronPath,settingDescription:n.electronPath.length?n.electronPath:e("global.label.default"),handleChange:a=>c("electronPath",a)}),t.jsx(f,{settingName:e("settings.webui.channel.label.title"),value:n.webUIChannel,values:$,handleChange:a=>c("webUIChannel",a),disabled:C}),t.jsx(G,{disabled:C,updateCheckInterval:n.webUIUpdateCheckInterval}),!n.webUIUpdateCheckInterval&&t.jsxs(U,{children:[t.jsx(I,{primary:e("global.update.settings.inform.label.title"),secondary:e("global.update.settings.inform.label.description")}),t.jsx(E,{edge:"end",checked:d,onChange:a=>u("webUIInformAvailableUpdate",a.target.checked)})]})]})};export{Se as WebUISettings};
