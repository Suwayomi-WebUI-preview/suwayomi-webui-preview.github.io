!function(){var t=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],e=["children"];function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e,r){return e=i(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,o()?Reflect.construct(e,r||[],i(t).constructor):e.apply(t,r))}function o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(o=function(){return!!t})()}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function u(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function d(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var l=r&&r.prototype instanceof s?r:s,u=Object.create(l.prototype);return f(u,"_invoke",function(n,r,o){var i,s,l,u=0,c=o||[],d=!1,h={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return i=e,s=0,l=t,h.n=n,a}};function f(n,r){for(s=n,l=r,e=0;!d&&u&&!o&&e<c.length;e++){var o,i=c[e],f=h.p,g=i[2];n>3?(o=g===r)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=f&&((o=n<2&&f<i[1])?(s=0,h.v=r,h.n=i[1]):f<g&&(o=n<3||i[0]>r||r>g)&&(i[4]=n,i[5]=r,h.n=g,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,c,g){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&f(c,g),s=c,l=g;(e=s<2?t:l)||!d;){i||(s?s<3?(s>1&&(h.n=-1),f(s,l)):h.n=l:h.v=l);try{if(u=2,i){if(s||(o="next"),e=i[o]){if(!(e=e.call(i,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,s<2&&(s=0)}else 1===s&&(e=i.return)&&e.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=t}else if((e=(d=h.n<0)?l:n.call(r,h))!==a)break}catch(e){i=t,s=1,l=e}finally{u=1}}return{value:e,done:d}}}(n,o,i),!0),u}var a={};function s(){}function l(){}function u(){}e=Object.getPrototypeOf;var c=[][r]?e(e([][r]())):(f(e={},r,function(){return this}),e),d=u.prototype=s.prototype=Object.create(c);function g(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,f(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=u,f(d,"constructor",u),f(u,"constructor",l),l.displayName="GeneratorFunction",f(u,o,"GeneratorFunction"),f(d),f(d,o,"Generator"),f(d,r,function(){return this}),f(d,"toString",function(){return"[object Generator]"}),(h=function(){return{w:i,m:g}})()}function f(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}f=function(t,e,n,r){function i(e,n){f(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},f(t,e,n,r)}function g(t,e,n,r,o,i,a){try{var s=t[i](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function p(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){g(i,r,o,a,s,"next",t)}function s(t){g(i,r,o,a,s,"throw",t)}a(void 0)})}}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){u=!0,o=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return b(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach(function(e){j(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function j(t,e,n){return(e=w(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}System.register(["./index-legacy-BfcsMgoh.js","./PlayArrow-legacy-Cgv7Un9L.js","./StyledFab-legacy-CvLQaHJR.js","./Chapters-legacy-CXx-ftbd.js","./ContinueReadingTooltip-legacy-7uH5OjpH.js","./useManageMangaLibraryState-legacy-DBEJpFhs.js","./EmptyViewAbsoluteCentered-legacy-dLz43d1r.js","./FilterList-legacy-eXdEeji6.js","./Download-legacy-DWPkgwzb.js","./DoneAll-legacy-gH1cMCWJ.js","./SortRadioInput-legacy-Bnm8IiqQ.js","./ThreeStateCheckboxInput-legacy-WMubqTFI.js","./SelectionFAB-legacy-DPdPf7ks.js","./CheckboxInput-legacy-BrUbdUdh.js","./FormGroup-legacy-C41aRgjX.js","./ListPreference-legacy-hTWXkOyX.js","./ChapterListCard-legacy-C86JN_6_.js","./VirtuosoPersisted-legacy-77Te23Lg.js","./Strings-legacy-CzJ32ydF.js","./IconWebView-legacy-BxXGJm7Z.js","./Mangas-legacy-BuVEee6P.js","./SpinnerImage-legacy-l090QSuY.js","./Sync-legacy-BCu3Wqjb.js","./Trackers-legacy-DfsJOIZ_.js","./Metadata-legacy-C2r5mMzn.js","./Sources-legacy-tgnhyGI8.js","./ExpandMore-legacy-CBAu321l.js","./Link-legacy-D-Iyry0u.js","./Chip-legacy-j7J0nI1L.js","./Refresh-legacy-CgKa8E2T.js","./useAppTitleAndAction-legacy-BXYtw_ap.js","./DateHelper-legacy-7VtktDYa.js","./Asserts-legacy-CFoLakvZ.js","./AvatarSpinner-legacy-Ck_MDSCH.js","./Card-legacy-BE0am6dz.js","./ListCardContent-legacy-C3U2VB2i.js","./CheckCircle-legacy-BCV2IHep.js","./MUI.util-legacy-D9xMlHDR.js","./CardActionArea-legacy-CNvQn746.js","./NumberSetting-legacy-DJMD2-b6.js","./Slider-legacy-Dv4WCZHK.js","./useMobilePicker-legacy-Cd80jU5S.js","./SelectSetting-legacy-JEj51vwC.js","./Select-legacy-CYOB31AM.js","./Checkbox-legacy-4BJBVqs2.js","./SwitchBase-legacy-CtaY9DHp.js","./Tabs-legacy-CfyFoPot.js","./ChapterCardMetadata-legacy-Cw8Ar_5g.js","./Delete-legacy-CzwKgqqi.js","./index-legacy-Cd9AMH_0.js","./Virtuoso.util-legacy-DYslOy7v.js","./use-merged-ref-legacy-pmKxyThz.js","./useAppTitle-legacy-Cwnwu5R-.js","./useAppAction-legacy-D-EoMVxU.js"],function(o,i){"use strict";var l,f,g,v,b,y,w,k,C,_,S,M,L,O,B,I,D,R,E,P,T,V,z,F,A,W,H,q,N,G,U,K,Q,X,Y,J,$,Z,tt,et,nt,rt,ot,it,at,st,lt,ut,ct,dt,ht,ft,gt,pt,mt,vt,bt,yt,xt,jt,wt,kt,Ct,_t,St,Mt,Lt,Ot,Bt,It,Dt,Rt,Et,Pt,Tt,Vt,zt,Ft,At,Wt,Ht,qt,Nt,Gt,Ut,Kt,Qt,Xt,Yt,Jt,$t,Zt,te,ee,ne,re,oe,ie,ae,se,le,ue,ce,de,he,fe,ge,pe,me,ve,be,ye,xe,je,we,ke,Ce,_e,Se,Me;return{setters:[function(t){l=t.b,f=t.c,g=t.j,v=t.u,b=t.L,y=t.i,w=t.k,k=t.n,C=t.q,_=t.S,S=t.B,M=t.a3,L=t.a4,O=t.C,B=t.I,I=t.a5,D=t.a6,R=t.a7,E=t.E,P=t.O,T=t.M,V=t.r,z=t.a8,F=t.e,A=t.g,W=t.f,H=t.a1,q=t.T,N=t.z,G=t.a9,U=t.m,K=t.aa,Q=t.ab,X=t.ac,Y=t.ad,J=t.ae,$=t.af,Z=t.ag,tt=t.ah,et=t.ai,nt=t.aj,rt=t.ak,ot=t.d,it=t.V,at=t.al,st=t.A,lt=t.am,ut=t.an,ct=t.ao,dt=t.ap,ht=t.aq,ft=t.ar,gt=t.a,pt=t.as,mt=t.at,vt=t.au,bt=t.av,yt=t.aw,xt=t.ax,jt=t.ay,wt=t.p,kt=t.az,Ct=t.aA,_t=t.aB,St=t.aC,Mt=t.aD},function(t){Lt=t.P},function(t){Ot=t.S,Bt=t.D},function(t){It=t.C,Dt=t.a},function(t){Rt=t.C,Et=t.a,Pt=t.T,Tt=t.S,Vt=t.L},function(t){zt=t.u,Ft=t.i,At=t.a,Wt=t.f,Ht=t.b,qt=t.c,Nt=t.F,Gt=t.C,Ut=t.d},function(t){Kt=t.E},function(t){Qt=t.F},function(t){Xt=t.D},function(t){Yt=t.D},function(t){Jt=t.S,$t=t.R},function(t){Zt=t.D,te=t.T},function(t){ee=t.O,ne=t.S,re=t.a},function(t){oe=t.C},function(t){ie=t.F},function(t){ae=t.R},function(t){se=t.C,le=t.a,ue=t.I},function(t){ce=t.V},function(t){de=t.b},function(t){he=t.F,fe=t.I},function(t){ge=t.a,pe=t.b,me=t.M},function(t){ve=t.S},function(t){be=t.S},function(t){ye=t.T},function(t){xe=t.M},function(t){je=t.S},function(t){we=t.E,ke=t.a},function(t){Ce=t.L},function(t){_e=t.C},function(t){Se=t.R},function(t){Me=t.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var i=f(g.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}));function Le(t){var e=t.chapter,n=v().t,r=e.sourceOrder,o=e.name,i=e.chapterNumber,a=e.scanlator,s=1===r;return g.jsx(Rt,{chapterNumber:i,name:o,sourceOrder:r,scanlator:a,children:g.jsxs(Ot,{component:b,variant:"extended",color:"primary",to:It.getReaderUrl(e),state:It.getReaderOpenChapterLocationState(e),children:[g.jsx(Lt,{}),n(s?"global.button.start":"global.button.resume")]})})}var Oe=f(g.jsx("path",{d:"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h4v-3c0-2.18-3.57-3.47-6.33-3.87M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 0c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 7c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4m6 5H3v-.99C3.2 16.29 6.3 15 9 15s5.8 1.29 6 2z"}));function Be(t){var e=t.title,n=t.emptyMessage,r=t.items,o=t.getId,i=t.getLabel,a=t.isChecked,s=t.open,u=t.onClose,c=t.slotProps,d=v().t,h=l.useMemo(function(){return r.map(o)},[r]),f=l.useMemo(function(){return r.filter(a).map(o)},[r]),p=zt(r.length,{currentKey:"default",itemIds:h,initialState:{default:f}}),m=p.selectedItemIds,b=p.handleSelection,j=p.handleSelectAll,M=p.reset,L=function(){u(),M()},O=l.useCallback(function(){var t=m.length!==f.length||m.some(function(t){return!f.includes(t)}),e=r.filter(function(t){return m.includes(o(t))});u(t?e:void 0)},[m]);return g.jsxs(y,{sx:{".MuiDialog-paper":{maxHeight:435,width:"80%"}},maxWidth:"xs",open:s,onClose:L,children:[g.jsx(w,{children:e}),g.jsx(k,{dividers:!0,children:g.jsxs(ie,{children:[0===r.length&&g.jsx("span",{children:n}),r.map(function(t){return l.createElement(oe,x(x({},null==c?void 0:c.checkbox),{},{checked:m.includes(o(t)),onChange:function(e,n){return b(o(t),n)},label:i(t),key:o(t)}))})]})}),g.jsx(C,{children:g.jsx(_,{sx:{width:"100%"},children:g.jsxs(_,{direction:"row",sx:{justifyContent:"space-between",alignItems:"end",width:"100%"},children:[g.jsx(S,{onClick:function(){return j(!m.length,r.map(o))},children:d(m.length?"global.button.reset":"global.button.select_all")}),g.jsxs(_,{direction:"row",children:[g.jsx(S,{autoFocus:!0,onClick:L,color:"primary",children:d("global.button.cancel")}),!!r.length&&g.jsx(S,{onClick:O,color:"primary",children:d("global.button.ok")})]})]})})})]})}var Ie=function(t){var e=t.updateOption,n=t.scanlators,r=t.excludedScanlators,o=v().t,i=M({variant:"dialog",popupId:"chapter-list-options-scanlator-filter-dialog"});return n.length?g.jsxs(g.Fragment,{children:[g.jsx(oe,x(x({},L(i)),{},{label:o("global.label.scanlator"),icon:g.jsx(Oe,{}),checkedIcon:g.jsx(Oe,{color:"warning"}),checked:!!r.length})),g.jsx(Be,{title:o("chapter.option.exclude_scanlators"),open:i.isOpen,onClose:function(t){t&&e("excludedScanlators",t),i.close()},items:n,getId:function(t){return t},getLabel:function(t){return t},isChecked:function(t){return r.includes(t)},slotProps:{checkbox:{checkedIcon:g.jsx(Zt,{})}}})]}):null},De={filter:"global.label.filter",sort:"global.label.sort",display:"global.label.display"},Re=function(t){var e=t.open,n=t.onClose,r=t.options,o=t.updateOption,i=t.scanlators,a=t.excludedScanlators,s=v().t;return g.jsx(ee,{open:e,onClose:n,minHeight:150,tabs:["filter","sort","display"],tabTitle:function(t){return s(De[t])},tabContent:function(t){return"filter"===t?g.jsxs(g.Fragment,{children:[g.jsx(te,{label:s("global.filter.label.unread"),checked:r.unread,onChange:function(t){return o("unread",t)}}),g.jsx(te,{label:s("global.filter.label.downloaded"),checked:r.downloaded,onChange:function(t){return o("downloaded",t)}}),g.jsx(te,{label:s("global.filter.label.bookmarked"),checked:r.bookmarked,onChange:function(t){return o("bookmarked",t)}}),g.jsx(Ie,{scanlators:i,excludedScanlators:a,updateOption:o})]}):"sort"===t?Object.entries(Dt).map(function(t){var e=m(t,2),n=e[0],i=e[1];return g.jsx(Jt,{label:s(i),checked:r.sortBy===n,sortDescending:r.reverse,onClick:function(){return n!==r.sortBy?o("sortBy",n):o("reverse",!r.reverse)}},n)}):"display"===t?g.jsxs(ae,{onChange:function(){return o("showChapterNumber",!r.showChapterNumber)},value:r.showChapterNumber,children:[g.jsx($t,{label:s("chapter.option.display.label.source_title"),value:!1}),g.jsx($t,{label:s("chapter.option.display.label.chapter_number"),value:!0})]}):null}})},Ee=function(t){var e=t.mangaId,n=t.options,r=t.updateOption,o=t.chapters,i=t.scanlators,a=t.excludeScanlators,s=v().t,u=m(l.useState(!1),2),c=u[0],d=u[1],h=Ft(n),f=l.useMemo(function(){return o.every(It.isRead)},[o]),p=l.useMemo(function(){return o.every(It.isDownloaded)},[o]);return g.jsxs(g.Fragment,{children:[g.jsx(O,{title:s("chapter.action.mark_as_read.add.label.action.all"),disabled:f,children:g.jsx(B,{disabled:f,onClick:function(){return It.markAsRead(It.getNonRead(o),!0,e)},color:"inherit",children:g.jsx(Yt,{})})}),g.jsx(I,{variant:"popover",popupId:"chapterlist-download-button",children:function(t){return g.jsxs(g.Fragment,{children:[g.jsx(O,{title:s("global.button.download"),disabled:f,children:g.jsx(B,x(x({disabled:p},L(t)),{},{color:"inherit",children:g.jsx(Xt,{})}))}),t.isOpen&&g.jsx(D,x(x({},R(t)),{},{children:g.jsx(Et,{mangaIds:[e],closeMenu:t.close})}))]})}}),g.jsx(O,{title:s("chapter.action.filter_and_sort.label"),children:g.jsx(B,{onClick:function(){return d(!0)},color:"inherit",children:g.jsx(Qt,{color:h?"warning":void 0})})}),g.jsx(Re,{open:c,onClose:function(){return d(!1)},options:n,updateOption:r,scanlators:i,excludedScanlators:a})]})},Pe=H(_,{shouldForwardProp:G(["scrollbarWidth"])})(function(t){var e=t.theme,n=t.scrollbarWidth;return j({padding:e.spacing(1),paddingRight:"calc(".concat(n,"px + ").concat(e.spacing(1),")"),paddingBottom:0},e.breakpoints.down("md"),{paddingRight:e.spacing(1)})}),Te=H(ce,{shouldForwardProp:G(["topOffset"])})(function(t){var e=t.theme,n=t.topOffset;return j({listStyle:"none",padding:0},e.breakpoints.up("md"),{height:"calc(100vh - ".concat(n,"px)"),margin:0})}),Ve=function(t){var e=t.selectedChapters,n=t.firstUnreadChapter,r=t.onFABMenuClose;return e.length?g.jsx(re,{selectedItemsCount:e.length,title:"chapter.title_one",children:function(t){return g.jsx(le,{selectedChapters:e,onClose:function(){null==r||r(),t()}})}}):n?g.jsx(Le,{chapter:n}):null},ze=function(t){var e=t.manga,n=t.isRefreshing,r=v().t,o=E().appBarHeight,i=P.useIsBelowWidth("md"),a=m(l.useState(50),2),s=a[0],u=a[1],c=m(l.useState(null),2),d=c[0],h=c[1];T(d,l.useCallback(function(){var t;return u(null!==(t=null==d?void 0:d.offsetHeight)&&void 0!==t?t:0)},[d]));var f=P.useGetScrollbarSize("width"),p=At(e),b=Ht(e,function(t){return U(r("global.error.label.failed_to_save_changes"),"error",A(t))}),y=V.useGetMangaChapters(z,e.id,{notifyOnNetworkStatusChange:!0}),x=y.data,j=y.loading,w=y.error,k=y.refetch,C=l.useMemo(function(){var t;return null!==(t=null==x?void 0:x.chapters.nodes)&&void 0!==t?t:[]},[null==x?void 0:x.chapters.nodes]),S=l.useMemo(function(){return Wt(C,p)},[C,p]),M=l.useMemo(function(){return It.getIds(S)},[S]),L=l.useMemo(function(){return It.getMissingCount(S)},[S]),O=0===C.length,B=!O&&0===S.length,I=zt(M.length,{itemIds:M,currentKey:"default"}),D=I.areNoItemsSelected,R=I.areAllItemsSelected,H=I.selectedItemIds,G=I.handleSelectAll,K=I.handleSelection,Q=I.clearSelection,X=l.useCallback(function(t,e,n){return K(t,e,{selectRange:n})},[K]);return j||O&&n?g.jsx(_,{sx:{justifyContent:"center",alignItems:"center",position:"relative",flexGrow:1},children:g.jsx(F,{})}):w?g.jsx(_,{sx:{justifyContent:"center",position:"relative",flexGrow:1},children:g.jsx(Kt,{message:r("global.error.label.failed_to_load_data"),messageExtra:A(w),retry:function(){return k().catch(W())}})}):g.jsxs(g.Fragment,{children:[g.jsxs(_,{direction:"column",sx:{position:"relative",flexBasis:"60%"},children:[g.jsxs(Pe,{ref:h,direction:"row",alignItems:"center",justifyContent:"space-between",scrollbarWidth:f,children:[g.jsxs(_,{children:[g.jsx(q,{variant:"h5",component:"h3",children:r("chapter.value",{count:S.length})}),!!L&&g.jsx(q,{variant:"body2",color:"warning",children:"".concat(r("chapter.missing",{count:L}))})]}),g.jsxs(_,{direction:"row",children:[D&&g.jsx(Ee,{mangaId:e.id,options:p,updateOption:b,chapters:S,scanlators:It.getScanlators(C),excludeScanlators:p.excludedScanlators}),!!M.length&&g.jsx(ne,{areAllItemsSelected:R,areNoItemsSelected:D,onChange:function(t){return G(t,t?M:[])}})]})]}),O&&g.jsx(Kt,{message:r("chapter.error.label.no_chapter_found")}),B&&g.jsx(Kt,{message:r("chapter.error.label.no_matches")}),g.jsx(Te,{persistKey:"manga-".concat(e.id,"-chapter-list"),topOffset:o+s,style:{height:"undefined"},components:{Footer:function(){return g.jsx(N,{sx:{paddingBottom:Bt}})}},totalCount:S.length,computeItemKey:function(t){return S[t].id},itemContent:function(t){return g.jsx(se,{index:t,isSortDesc:p.reverse,chapters:S,selected:D?null:H.includes(S[t].id),showChapterNumber:p.showChapterNumber,onSelect:X})},useWindowScroll:i,overscan:.5*window.innerHeight})]}),g.jsx(Ve,{selectedChapters:H.map(function(t){return C.find(function(e){return e.id===t})}).filter(function(t){return null!=t}),firstUnreadChapter:e.firstUnreadChapter,onFABMenuClose:Q})]})},Fe=f(g.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}));function Ae(t){return X("MuiButtonGroup",t)}var We=Q("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),He=H("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[j({},"& .".concat(We.grouped),e.grouped),j({},"& .".concat(We.grouped),e["grouped".concat(tt(n.orientation))]),j({},"& .".concat(We.grouped),e["grouped".concat(tt(n.variant))]),j({},"& .".concat(We.grouped),e["grouped".concat(tt(n.variant)).concat(tt(n.orientation))]),j({},"& .".concat(We.grouped),e["grouped".concat(tt(n.variant)).concat(tt(n.color))]),j({},"& .".concat(We.firstButton),e.firstButton),j({},"& .".concat(We.lastButton),e.lastButton),j({},"& .".concat(We.middleButton),e.middleButton),e.root,e[n.variant],!0===n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth,"vertical"===n.orientation&&e.vertical]}})(nt(function(t){var e=t.theme;return j({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(e.vars||e).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:j(j({flexDirection:"column"},"& .".concat(We.lastButton,",& .").concat(We.middleButton),{borderTopRightRadius:0,borderTopLeftRadius:0}),"& .".concat(We.firstButton,",& .").concat(We.middleButton),{borderBottomRightRadius:0,borderBottomLeftRadius:0})},{props:{orientation:"horizontal"},style:j(j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),{borderTopRightRadius:0,borderBottomRightRadius:0}),"& .".concat(We.lastButton,",& .").concat(We.middleButton),{borderTopLeftRadius:0,borderBottomLeftRadius:0})},{props:{variant:"text",orientation:"horizontal"},style:j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),j({borderRight:e.vars?"1px solid ".concat(e.alpha(e.vars.palette.common.onBackground,.23)):"1px solid ".concat("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"&.".concat(We.disabled),{borderRight:"1px solid ".concat((e.vars||e).palette.action.disabled)}))},{props:{variant:"text",orientation:"vertical"},style:j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),j({borderBottom:e.vars?"1px solid ".concat(e.alpha(e.vars.palette.common.onBackground,.23)):"1px solid ".concat("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"&.".concat(We.disabled),{borderBottom:"1px solid ".concat((e.vars||e).palette.action.disabled)}))}].concat(d(Object.entries(e.palette).filter(rt()).flatMap(function(t){var n=m(t,1)[0];return[{props:{variant:"text",color:n},style:j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),{borderColor:e.alpha((e.vars||e).palette[n].main,.5)})}]})),[{props:{variant:"outlined",orientation:"horizontal"},style:j(j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}}),"& .".concat(We.lastButton,",& .").concat(We.middleButton),{marginLeft:-1})},{props:{variant:"outlined",orientation:"vertical"},style:j(j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}}),"& .".concat(We.lastButton,",& .").concat(We.middleButton),{marginTop:-1})},{props:{variant:"contained",orientation:"horizontal"},style:j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),j({borderRight:"1px solid ".concat((e.vars||e).palette.grey[400])},"&.".concat(We.disabled),{borderRight:"1px solid ".concat((e.vars||e).palette.action.disabled)}))},{props:{variant:"contained",orientation:"vertical"},style:j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),j({borderBottom:"1px solid ".concat((e.vars||e).palette.grey[400])},"&.".concat(We.disabled),{borderBottom:"1px solid ".concat((e.vars||e).palette.action.disabled)}))}],d(Object.entries(e.palette).filter(rt(["dark"])).map(function(t){var n=m(t,1)[0];return{props:{variant:"contained",color:n},style:j({},"& .".concat(We.firstButton,",& .").concat(We.middleButton),{borderColor:(e.vars||e).palette[n].dark})}})))},"& .".concat(We.grouped),{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}})})),qe=l.forwardRef(function(e,n){var r=Y({props:e,name:"MuiButtonGroup"}),o=r.children,i=r.className,a=r.color,s=void 0===a?"primary":a,u=r.component,d=void 0===u?"div":u,h=r.disabled,f=void 0!==h&&h,p=r.disableElevation,m=void 0!==p&&p,v=r.disableFocusRipple,b=void 0!==v&&v,y=r.disableRipple,j=void 0!==y&&y,w=r.fullWidth,k=void 0!==w&&w,C=r.orientation,_=void 0===C?"horizontal":C,S=r.size,M=void 0===S?"medium":S,L=r.variant,O=void 0===L?"outlined":L,B=c(r,t),I=x(x({},r),{},{color:s,component:d,disabled:f,disableElevation:m,disableFocusRipple:b,disableRipple:j,fullWidth:k,orientation:_,size:M,variant:O}),D=function(t){var e=t.classes,n=t.color,r=t.disabled,o=t.disableElevation,i=t.fullWidth,a=t.orientation,s=t.variant,l={root:["root",s,a,i&&"fullWidth",o&&"disableElevation","color".concat(tt(n))],grouped:["grouped","grouped".concat(tt(a)),"grouped".concat(tt(s)),"grouped".concat(tt(s)).concat(tt(a)),"grouped".concat(tt(s)).concat(tt(n)),r&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return et(l,Ae,e)}(I),R=l.useMemo(function(){return{className:D.grouped,color:s,disabled:f,disableElevation:m,disableFocusRipple:b,disableRipple:j,fullWidth:k,size:M,variant:O}},[s,f,m,b,j,k,M,O,D.grouped]),E=function(t){return l.Children.toArray(t).filter(function(t){return l.isValidElement(t)})}(o),P=E.length,T=function(t){var e=0===t,n=t===P-1;return e&&n?"":e?D.firstButton:n?D.lastButton:D.middleButton};return g.jsx(He,x(x({as:d,role:"group",className:J(D.root,i),ref:n,ownerState:I},B),{},{children:g.jsx($.Provider,{value:R,children:E.map(function(t,e){return g.jsx(Z.Provider,{value:T(e),children:t},e)})})}))}),Ne=function(t){var n=t.children,r=c(t,e);return g.jsx(S,x(x({},r),{},{children:g.jsx(_,{direction:"row",sx:{alignItems:"center",justifyContent:"center",gap:1,flexWrap:"wrap"},children:n})}))},Ge=f(g.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})),Ue=function(t){var e,n,r=t.manga,o=v().t,i=ot(),a=V.useGetTrackerList(it),s=null!==(e=null===(n=a.data)||void 0===n?void 0:n.trackers.nodes)&&void 0!==e?e:[],l=r.trackRecords.nodes,u=ye.getLoggedIn(s),c=ye.getLoggedIn(ye.getTrackers(l,s));return g.jsx(I,{variant:"dialog",popupId:"manga-track-modal",children:function(t){return g.jsxs(g.Fragment,{children:[g.jsxs(Ne,x(x({},L(t)),{},{size:"medium",disabled:a.loading||!!a.error,onClick:function(){return e=t.open,void(a.error?U(o("tracking.error.label.could_not_load_track_info"),"error",null===(n=a.error)||void 0===n?void 0:n.toString()):u.length?e():i(st.tracker.path));var e,n},variant:c.length?"contained":"outlined",children:[c.length?g.jsx(Ge,{}):g.jsx(be,{}),c.length?o("manga.button.track.active",{count:c.length}):o("manga.button.track.start")]})),t.isOpen&&g.jsx(y,x(x({},at(t)),{},{maxWidth:"md",fullWidth:!0,scroll:"paper",children:g.jsx(Pt,{manga:r})}))]})}})},Ke=f(g.jsx("path",{d:"M21 11V3h-8l3.29 3.29-10 10L3 13v8h8l-3.29-3.29 10-10z"})),Qe=function(){return u(function t(e,n){s(this,t),this.pixels=e,this.opts=n;var r=n.sigBits,o=function(t,e,n){return(t<<2*r)+(e<<r)+n};this.getColorIndex=o;var i,a,l,u,c,d,h,f,g,p=8-r,m=new Uint32Array(1<<3*r);i=l=c=0,a=u=d=Number.MAX_VALUE;for(var v=e.length/4,b=0;b<v;){var y=4*b;if(b++,h=e[y+0],f=e[y+1],g=e[y+2],0!==e[y+3]){var x=o(h>>=p,f>>=p,g>>=p);void 0===m[x]&&(m[x]=0),m[x]+=1,h>i&&(i=h),h<a&&(a=h),f>l&&(l=f),f<u&&(u=f),g>c&&(c=g),g<d&&(d=g)}}this._colorCount=m.reduce(function(t,e){return e>0?t+1:t},0),this.hist=m,this.rmax=i,this.rmin=a,this.gmax=l,this.gmin=u,this.bmax=c,this.bmin=d},[{key:"colorCount",get:function(){return this._colorCount}}])}();var Xe=function(t){function e(){return s(this,e),r(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(e,t),u(e,[{key:"_getCanvas",value:function(){if(!this._canvas)throw new Error("Canvas is not initialized");return this._canvas}},{key:"_getContext",value:function(){if(!this._context)throw new Error("Context is not initialized");return this._context}},{key:"_getWidth",value:function(){if(!this._width)throw new Error("Width is not initialized");return this._width}},{key:"_getHeight",value:function(){if(!this._height)throw new Error("Height is not initialized");return this._height}},{key:"_initCanvas",value:function(){var t=this.image;if(!t)throw new Error("Image is not initialized");var e=this._canvas=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new ReferenceError("Failed to create canvas context");this._context=n,e.className="@vibrant/canvas",e.style.display="none",this._width=e.width=t.width,this._height=e.height=t.height,n.drawImage(t,0,0),document.body.appendChild(e)}},{key:"load",value:function(t){var e,n,r,o,i,a,s,l=this;if("string"==typeof t)e=document.createElement("img"),n=t,(s=new URL(n,location.href)).protocol===location.protocol&&s.host===location.host&&s.port===location.port||(r=window.location.href,o=n,i=new URL(r),a=new URL(o),i.protocol===a.protocol&&i.hostname===a.hostname&&i.port===a.port)||(e.crossOrigin="anonymous"),e.src=n;else{if(!(t instanceof HTMLImageElement))return Promise.reject(new Error("Cannot load buffer as an image in browser"));e=t,n=t.src}return this.image=e,new Promise(function(t,r){var o=function(){l._initCanvas(),t(l)};e.complete?o():(e.onload=o,e.onerror=function(t){return r(new Error("Fail to load image: ".concat(n)))})})}},{key:"clear",value:function(){this._getContext().clearRect(0,0,this._getWidth(),this._getHeight())}},{key:"update",value:function(t){this._getContext().putImageData(t,0,0)}},{key:"getWidth",value:function(){return this._getWidth()}},{key:"getHeight",value:function(){return this._getHeight()}},{key:"resize",value:function(t,e,n){if(!this.image)throw new Error("Image is not initialized");this._width=this._getCanvas().width=t,this._height=this._getCanvas().height=e,this._getContext().scale(n,n),this._getContext().drawImage(this.image,0,0)}},{key:"getPixelCount",value:function(){return this._getWidth()*this._getHeight()}},{key:"getImageData",value:function(){return this._getContext().getImageData(0,0,this._getWidth(),this._getHeight())}},{key:"remove",value:function(){this._canvas&&this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)}}])}(function(){return u(function t(){s(this,t)},[{key:"scaleDown",value:function(t){var e=this.getWidth(),n=this.getHeight(),r=1;if(t.maxDimension>0){var o=Math.max(e,n);o>t.maxDimension&&(r=t.maxDimension/o)}else r=1/t.quality;r<1&&this.resize(e*r,n*r,r)}}])}());function Ye(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return r.forEach(function(e){if(e)for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];Array.isArray(o)?t[r]=o.slice(0):"object"===n(o)?(t[r]||(t[r]={}),Ye(t[r],o)):t[r]=o}}),t}var Je=function(){return u(function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,t),this._src=e,this._opts=Ye({},rn.DefaultOpts,n)},[{key:"maxColorCount",value:function(t){return this._opts.colorCount=t,this}},{key:"maxDimension",value:function(t){return this._opts.maxDimension=t,this}},{key:"addFilter",value:function(t){return this._opts.filters?this._opts.filters.push(t):this._opts.filters=[t],this}},{key:"removeFilter",value:function(t){if(this._opts.filters){var e=this._opts.filters.indexOf(t);e>0&&this._opts.filters.splice(e)}return this}},{key:"clearFilters",value:function(){return this._opts.filters=[],this}},{key:"quality",value:function(t){return this._opts.quality=t,this}},{key:"useImageClass",value:function(t){return this._opts.ImageClass=t,this}},{key:"useGenerator",value:function(t,e){return this._opts.generators||(this._opts.generators=[]),this._opts.generators.push(e?{name:t,options:e}:t),this}},{key:"useQuantizer",value:function(t,e){return this._opts.quantizer=e?{name:t,options:e}:t,this}},{key:"build",value:function(){return new rn(this._src,this._opts)}},{key:"getPalette",value:function(){return this.build().getPalette()}}])}(),$e=function(){return u(function t(e){s(this,t),this.pipeline=e,this._map={}},[{key:"names",value:function(){return Object.keys(this._map)}},{key:"has",value:function(t){return!!this._map[t]}},{key:"get",value:function(t){return this._map[t]}},{key:"register",value:function(t,e){return this._map[t]=e,this.pipeline}}])}(),Ze=function(){return u(function t(){s(this,t),this.filter=new $e(this),this.quantizer=new $e(this),this.generator=new $e(this)},[{key:"_buildProcessTasks",value:function(t){var e=this,n=t.filters,r=t.quantizer,o=t.generators;return 1===o.length&&"*"===o[0]&&(o=this.generator.names()),{filters:n.map(function(t){return i(e.filter,t)}),quantizer:i(this.quantizer,r),generators:o.map(function(t){return i(e.generator,t)})};function i(t,e){var n,r;return"string"==typeof e?n=e:(n=e.name,r=e.options),{name:n,fn:t.get(n),options:r}}}},{key:"process",value:(e=p(h().m(function t(e,n){var r,o,i,a,s,l,u;return h().w(function(t){for(;;)switch(t.n){case 0:return r=this._buildProcessTasks(n),o=r.filters,i=r.quantizer,a=r.generators,t.n=1,this._filterColors(o,e);case 1:return s=t.v,t.n=2,this._generateColors(i,s);case 2:return l=t.v,t.n=3,this._generatePalettes(a,l);case 3:return u=t.v,t.a(2,{colors:l,palettes:u})}},t,this)})),function(t,n){return e.apply(this,arguments)})},{key:"_filterColors",value:function(t,e){return Promise.resolve(function(t,e){var n;if(e.length>0)for(var r,o,i,a,s,l=t.data,u=l.length/4,c=0;c<u;c++){o=l[0+(r=4*c)],i=l[r+1],a=l[r+2],s=l[r+3];for(var d=0;d<e.length;d++)if(!(null==(n=e[d])?void 0:n.call(e,o,i,a,s))){l[r+3]=0;break}}return t}(e,t.map(function(t){return t.fn})))}},{key:"_generateColors",value:function(t,e){return Promise.resolve(t.fn(e.data,t.options))}},{key:"_generatePalettes",value:(t=p(h().m(function t(e,n){var r;return h().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Promise.all(e.map(function(t){var e=t.fn,r=t.options;return Promise.resolve(e(n,r))}));case 1:return r=t.v,t.a(2,Promise.resolve(r.reduce(function(t,n,r){return t[e[r].name]=n,t},{})))}},t)})),function(e,n){return t.apply(this,arguments)})}]);var t,e}();function tn(t,e,n){var r,o,i;function a(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(0===e)r=o=i=n;else{var s=n<.5?n*(1+e):n+e-n*e,l=2*n-s;r=a(l,s,t+1/3),o=a(l,s,t),i=a(l,s,t-1/3)}return[255*r,255*o,255*i]}var en=function(){function t(e,n){s(this,t),this._rgb=e,this._population=n}return u(t,[{key:"r",get:function(){return this._rgb[0]}},{key:"g",get:function(){return this._rgb[1]}},{key:"b",get:function(){return this._rgb[2]}},{key:"rgb",get:function(){return this._rgb}},{key:"hsl",get:function(){if(!this._hsl){var t=m(this._rgb,3),e=t[0],n=t[1],r=t[2];this._hsl=function(t,e,n){t/=255,e/=255,n/=255;var r=Math.max(t,e,n),o=Math.min(t,e,n),i=0,a=0,s=(r+o)/2;if(r!==o){var l=r-o;switch(a=s>.5?l/(2-r-o):l/(r+o),r){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return[i,a,s]}(e,n,r)}return this._hsl}},{key:"hex",get:function(){if(!this._hex){var t=m(this._rgb,3),e=t[0],n=t[1],r=t[2];this._hex=function(t,e,n){return"#"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1,7)}(e,n,r)}return this._hex}},{key:"population",get:function(){return this._population}},{key:"toJSON",value:function(){return{rgb:this.rgb,population:this.population}}},{key:"getYiq",value:function(){if(!this._yiq){var t=this._rgb;this._yiq=(299*t[0]+587*t[1]+114*t[2])/1e3}return this._yiq}},{key:"titleTextColor",get:function(){return this._titleTextColor||(this._titleTextColor=this.getYiq()<200?"#fff":"#000"),this._titleTextColor}},{key:"bodyTextColor",get:function(){return this._bodyTextColor||(this._bodyTextColor=this.getYiq()<150?"#fff":"#000"),this._bodyTextColor}}],[{key:"applyFilters",value:function(t,e){return e.length>0?t.filter(function(t){for(var n,r=t.r,o=t.g,i=t.b,a=0;a<e.length;a++)if(!(null==(n=e[a])?void 0:n.call(e,r,o,i,255)))return!1;return!0}):t}},{key:"clone",value:function(e){return new t(e._rgb,e._population)}}])}(),nn=function(){function t(e,n){s(this,t),this._src=e,this.opts=Ye({},t.DefaultOpts,n)}return u(t,[{key:"result",get:function(){return this._result}},{key:"_process",value:function(e,n){e.scaleDown(this.opts);var r=function(t,e){var n=t.colorCount,r=t.quantizer,o=t.generators,i=t.filters,a={colorCount:n},s="string"==typeof r?{name:r,options:{}}:r;return s.options=Ye({},a,s.options),Ye({},{quantizer:s,generators:o,filters:i},e)}(this.opts,n);return t._pipeline.process(e.getImageData(),r)}},{key:"getPalette",value:(n=p(h().m(function t(){var e,n,r,o,i;return h().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=new this.opts.ImageClass,t.p=1,t.n=2,e.load(this._src);case 2:return n=t.v,t.n=3,this._process(n,{generators:["default"]});case 3:if(r=t.v,this._result=r,o=r.palettes.default){t.n=4;break}throw new Error("Something went wrong and a palette was not found, please file a bug against our GitHub repo: https://github.com/vibrant-Colors/node-vibrant/");case 4:return e.remove(),t.a(2,o);case 5:return t.p=5,i=t.v,e.remove(),t.a(2,Promise.reject(i))}},t,this,[[1,5]])})),function(){return n.apply(this,arguments)})},{key:"getPalettes",value:(e=p(h().m(function t(){var e,n,r,o,i;return h().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=new this.opts.ImageClass,t.p=1,t.n=2,e.load(this._src);case 2:return n=t.v,t.n=3,this._process(n,{generators:["*"]});case 3:return r=t.v,this._result=r,o=r.palettes,e.remove(),t.a(2,o);case 4:return t.p=4,i=t.v,e.remove(),t.a(2,Promise.reject(i))}},t,this,[[1,4]])})),function(){return e.apply(this,arguments)})}],[{key:"use",value:function(t){this._pipeline=t}},{key:"from",value:function(t){return new Je(t)}}]);var e,n}();nn.DefaultOpts={colorCount:64,quality:5,filters:[]};var rn=nn;rn.DefaultOpts.quantizer="mmcq",rn.DefaultOpts.generators=["default"],rn.DefaultOpts.filters=["default"],rn.DefaultOpts.ImageClass=Xe;var on=function(){function t(e,n,r,o,i,a,l){s(this,t),this.histogram=l,this._volume=-1,this._avg=null,this._count=-1,this.dimension={r1:e,r2:n,g1:r,g2:o,b1:i,b2:a}}return u(t,[{key:"invalidate",value:function(){this._volume=this._count=-1,this._avg=null}},{key:"volume",value:function(){if(this._volume<0){var t=this.dimension,e=t.r1,n=t.r2,r=t.g1,o=t.g2,i=t.b1,a=t.b2;this._volume=(n-e+1)*(o-r+1)*(a-i+1)}return this._volume}},{key:"count",value:function(){if(this._count<0){for(var t=this.histogram,e=t.hist,n=t.getColorIndex,r=this.dimension,o=r.r1,i=r.r2,a=r.g1,s=r.g2,l=r.b1,u=r.b2,c=0,d=o;d<=i;d++)for(var h=a;h<=s;h++)for(var f=l;f<=u;f++){var g=n(d,h,f);e[g]&&(c+=e[g])}this._count=c}return this._count}},{key:"clone",value:function(){var e=this.histogram,n=this.dimension;return new t(n.r1,n.r2,n.g1,n.g2,n.b1,n.b2,e)}},{key:"avg",value:function(){if(!this._avg){var t,e,n,r=this.histogram,o=r.hist,i=r.getColorIndex,a=this.dimension,s=a.r1,l=a.r2,u=a.g1,c=a.g2,d=a.b1,h=a.b2,f=0;t=e=n=0;for(var g=s;g<=l;g++)for(var p=u;p<=c;p++)for(var m=d;m<=h;m++){var v=o[i(g,p,m)];v&&(f+=v,t+=v*(g+.5)*8,e+=v*(p+.5)*8,n+=v*(m+.5)*8)}this._avg=f?[~~(t/f),~~(e/f),~~(n/f)]:[~~(8*(s+l+1)/2),~~(8*(u+c+1)/2),~~(8*(d+h+1)/2)]}return this._avg}},{key:"contains",value:function(t){var e=m(t,3),n=e[0],r=e[1],o=e[2],i=this.dimension,a=i.r1,s=i.r2,l=i.g1,u=i.g2,c=i.b1,d=i.b2;return r>>=3,o>>=3,(n>>=3)>=a&&n<=s&&r>=l&&r<=u&&o>=c&&o<=d}},{key:"split",value:function(){var t=this.histogram,e=t.hist,n=t.getColorIndex,r=this.dimension,o=r.r1,i=r.r2,a=r.g1,s=r.g2,l=r.b1,u=r.b2,c=this.count();if(!c)return[];if(1===c)return[this.clone()];var d,h,f=i-o+1,g=s-a+1,p=u-l+1,m=Math.max(f,g,p),v=null;d=h=0;var b=null;if(m===f){b="r",v=new Uint32Array(i+1);for(var y=o;y<=i;y++){d=0;for(var x=a;x<=s;x++)for(var j=l;j<=u;j++){var w=n(y,x,j);e[w]&&(d+=e[w])}h+=d,v[y]=h}}else if(m===g){b="g",v=new Uint32Array(s+1);for(var k=a;k<=s;k++){d=0;for(var C=o;C<=i;C++)for(var _=l;_<=u;_++){var S=n(C,k,_);e[S]&&(d+=e[S])}h+=d,v[k]=h}}else{b="b",v=new Uint32Array(u+1);for(var M=l;M<=u;M++){d=0;for(var L=o;L<=i;L++)for(var O=a;O<=s;O++){var B=n(L,O,M);e[B]&&(d+=e[B])}h+=d,v[M]=h}}for(var I=-1,D=new Uint32Array(v.length),R=0;R<v.length;R++){var E=v[R];E&&(I<0&&E>h/2&&(I=R),D[R]=h-E)}var P=this;return function(t){var e=t+"1",n=t+"2",r=P.dimension[e],o=P.dimension[n],i=P.clone(),a=P.clone(),s=I-r,l=o-I;for(s<=l?(o=Math.min(o-1,~~(I+l/2)),o=Math.max(0,o)):(o=Math.max(r,~~(I-1-s/2)),o=Math.min(P.dimension[n],o));!v[o];)o++;for(var u=D[o];!u&&v[o-1];)u=D[--o];return i.dimension[n]=o,a.dimension[e]=o+1,[i,a]}(b)}}],[{key:"build",value:function(e){var n=new Qe(e,{sigBits:5});return new t(n.rmin,n.rmax,n.gmin,n.gmax,n.bmin,n.bmax,n)}}])}(),an=function(){return u(function t(e){s(this,t),this._comparator=e,this.contents=[],this._sorted=!1},[{key:"_sort",value:function(){this._sorted||(this.contents.sort(this._comparator),this._sorted=!0)}},{key:"push",value:function(t){this.contents.push(t),this._sorted=!1}},{key:"peek",value:function(t){return this._sort(),t="number"==typeof t?t:this.contents.length-1,this.contents[t]}},{key:"pop",value:function(){return this._sort(),this.contents.pop()}},{key:"size",value:function(){return this.contents.length}},{key:"map",value:function(t){return this._sort(),this.contents.map(t)}}])}();function sn(t,e){for(var n=t.size();t.size()<e;){var r=t.pop();if(!(r&&r.count()>0))break;var o=m(r.split(),2),i=o[0],a=o[1];if(!i)break;if(t.push(i),a&&a.count()>0&&t.push(a),t.size()===n)break;n=t.size()}}var ln={targetDarkLuma:.26,maxDarkLuma:.45,minLightLuma:.55,targetLightLuma:.74,minNormalLuma:.3,targetNormalLuma:.5,maxNormalLuma:.7,targetMutesSaturation:.3,maxMutesSaturation:.4,targetVibrantSaturation:1,minVibrantSaturation:.35,weightSaturation:3,weightLuma:6.5,weightPopulation:.5};function un(t,e,n,r,o,i,a,s,l,u){var c=null,d=0;return e.forEach(function(e){var h=m(e.hsl,3),f=h[1],g=h[2];if(f>=s&&f<=l&&g>=o&&g<=i&&!function(t,e){return t.Vibrant===e||t.DarkVibrant===e||t.LightVibrant===e||t.Muted===e||t.DarkMuted===e||t.LightMuted===e}(t,e)){var p=function(t,e,n,r,o,i,a){function s(t,e){return 1-Math.abs(t-e)}return function(){for(var t=0,e=0,n=0;n<arguments.length;n+=2){var r=n<0||arguments.length<=n?void 0:arguments[n],o=n+1<0||arguments.length<=n+1?void 0:arguments[n+1];r&&o&&(t+=r*o,e+=o)}return t/e}(s(t,e),a.weightSaturation,s(n,r),a.weightLuma,o/i,a.weightPopulation)}(f,a,g,r,e.population,n,u);(null===c||p>d)&&(c=e,d=p)}}),c}var cn=(new Ze).filter.register("default",function(t,e,n,r){return r>=125&&!(t>250&&e>250&&n>250)}).quantizer.register("mmcq",function(t,e){if(0===t.length||e.colorCount<2||e.colorCount>256)throw new Error("Wrong MMCQ parameters");var n=on.build(t);n.histogram.colorCount;var r=new an(function(t,e){return t.count()-e.count()});r.push(n),sn(r,.75*e.colorCount);var o=new an(function(t,e){return t.count()*t.volume()-e.count()*e.volume()});return o.contents=r.contents,sn(o,e.colorCount-o.size()),function(t){var e=[];for(;t.size();){var n=t.pop(),r=n.avg();e.push(new en(r,n.count()))}return e}(o)}).generator.register("default",function(t,e){e=Object.assign({},ln,e);var n=function(t){var e=0;return t.forEach(function(t){e=Math.max(e,t.population)}),e}(t),r=function(t,e,n){var r={Vibrant:null,DarkVibrant:null,LightVibrant:null,Muted:null,DarkMuted:null,LightMuted:null};return r.Vibrant=un(r,t,e,n.targetNormalLuma,n.minNormalLuma,n.maxNormalLuma,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),r.LightVibrant=un(r,t,e,n.targetLightLuma,n.minLightLuma,1,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),r.DarkVibrant=un(r,t,e,n.targetDarkLuma,0,n.maxDarkLuma,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),r.Muted=un(r,t,e,n.targetNormalLuma,n.minNormalLuma,n.maxNormalLuma,n.targetMutesSaturation,0,n.maxMutesSaturation,n),r.LightMuted=un(r,t,e,n.targetLightLuma,n.minLightLuma,1,n.targetMutesSaturation,0,n.maxMutesSaturation,n),r.DarkMuted=un(r,t,e,n.targetDarkLuma,0,n.maxDarkLuma,n.targetMutesSaturation,0,n.maxMutesSaturation,n),r}(t,n,e);return function(t,e,n){if(!t.Vibrant&&!t.DarkVibrant&&!t.LightVibrant){if(!t.DarkVibrant&&t.DarkMuted){var r=m(t.DarkMuted.hsl,3),o=r[0],i=r[1],a=r[2];a=n.targetDarkLuma,t.DarkVibrant=new en(tn(o,i,a),0)}if(!t.LightVibrant&&t.LightMuted){var s=m(t.LightMuted.hsl,3),l=s[0],u=s[1],c=s[2];c=n.targetDarkLuma,t.DarkVibrant=new en(tn(l,u,c),0)}}if(!t.Vibrant&&t.DarkVibrant){var d=m(t.DarkVibrant.hsl,3),h=d[0],f=d[1],g=d[2];g=n.targetNormalLuma,t.Vibrant=new en(tn(h,f,g),0)}else if(!t.Vibrant&&t.LightVibrant){var p=m(t.LightVibrant.hsl,3),v=p[0],b=p[1],y=p[2];y=n.targetNormalLuma,t.Vibrant=new en(tn(v,b,y),0)}if(!t.DarkVibrant&&t.Vibrant){var x=m(t.Vibrant.hsl,3),j=x[0],w=x[1],k=x[2];k=n.targetDarkLuma,t.DarkVibrant=new en(tn(j,w,k),0)}if(!t.LightVibrant&&t.Vibrant){var C=m(t.Vibrant.hsl,3),_=C[0],S=C[1],M=C[2];M=n.targetLightLuma,t.LightVibrant=new en(tn(_,S,M),0)}if(!t.Muted&&t.Vibrant){var L=m(t.Vibrant.hsl,3),O=L[0],B=L[1],I=L[2];I=n.targetMutesSaturation,t.Muted=new en(tn(O,B,I),0)}if(!t.DarkMuted&&t.DarkVibrant){var D=m(t.DarkVibrant.hsl,3),R=D[0],E=D[1],P=D[2];P=n.targetMutesSaturation,t.DarkMuted=new en(tn(R,E,P),0)}if(!t.LightMuted&&t.LightVibrant){var T=m(t.LightVibrant.hsl,3),V=T[0],z=T[1],F=T[2];F=n.targetMutesSaturation,t.LightMuted=new en(tn(V,z,F),0)}}(r,0,e),r});/*! Fast Average Color | © 2025 Denis Seleznev | MIT License | https://github.com/fast-average-color/fast-average-color */function dn(t){var e=t.toString(16);return 1===e.length?"0"+e:e}function hn(t){return"#"+t.map(dn).join("")}function fn(t){return t?(e=t,Array.isArray(e[0])?t:[t]):[];var e}function gn(t,e,n){for(var r=0;r<n.length;r++)if(pn(t,e,n[r]))return!0;return!1}function pn(t,e,n){switch(n.length){case 3:if(function(t,e,n){if(255!==t[e+3])return!0;if(t[e]===n[0]&&t[e+1]===n[1]&&t[e+2]===n[2])return!0;return!1}(t,e,n))return!0;break;case 4:if(function(t,e,n){if(t[e+3]&&n[3])return t[e]===n[0]&&t[e+1]===n[1]&&t[e+2]===n[2]&&t[e+3]===n[3];return t[e+3]===n[3]}(t,e,n))return!0;break;case 5:if(function(t,e,n){var r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=t[e+3],u=mn(l,a,s);if(!a)return u;if(!l&&u)return!0;if(mn(t[e],r,s)&&mn(t[e+1],o,s)&&mn(t[e+2],i,s)&&u)return!0;return!1}(t,e,n))return!0;break;default:return!1}}function mn(t,e,n){return t>=e-n&&t<=e+n}rn.use(cn);function vn(t,e,n){for(var r={},o=n.dominantDivider||24,i=n.ignoredColor,a=n.step,s=[0,0,0,0,0],l=0;l<e;l+=a){var u=t[l],c=t[l+1],d=t[l+2],h=t[l+3];if(!i||!gn(t,l,i)){var f=Math.round(u/o)+","+Math.round(c/o)+","+Math.round(d/o);r[f]?r[f]=[r[f][0]+u*h,r[f][1]+c*h,r[f][2]+d*h,r[f][3]+h,r[f][4]+1]:r[f]=[u*h,c*h,d*h,h,1],s[4]<r[f][4]&&(s=r[f])}}var g=s[0],p=s[1],m=s[2],v=s[3],b=s[4];return v?[Math.round(g/v),Math.round(p/v),Math.round(m/v),Math.round(v/b)]:n.defaultColor}function bn(t,e,n){for(var r=0,o=0,i=0,a=0,s=0,l=n.ignoredColor,u=n.step,c=0;c<e;c+=u){var d=t[c+3],h=t[c]*d,f=t[c+1]*d,g=t[c+2]*d;l&&gn(t,c,l)||(r+=h,o+=f,i+=g,a+=d,s++)}return a?[Math.round(r/a),Math.round(o/a),Math.round(i/a),Math.round(a/s)]:n.defaultColor}function yn(t,e,n){for(var r=0,o=0,i=0,a=0,s=0,l=n.ignoredColor,u=n.step,c=0;c<e;c+=u){var d=t[c],h=t[c+1],f=t[c+2],g=t[c+3];l&&gn(t,c,l)||(r+=d*d*g,o+=h*h*g,i+=f*f*g,a+=g,s++)}return a?[Math.round(Math.sqrt(r/a)),Math.round(Math.sqrt(o/a)),Math.round(Math.sqrt(i/a)),Math.round(a/s)]:n.defaultColor}function xn(t){return jn(t,"defaultColor",[0,0,0,0])}function jn(t,e,n){return void 0===t[e]?n:t[e]}function wn(t){if(Cn(t)){var e=t.naturalWidth,n=t.naturalHeight;return t.naturalWidth||-1===t.src.search(/\.svg(\?|$)/i)||(e=n=100),{width:e,height:n}}return function(t){return"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement}(t)?{width:t.videoWidth,height:t.videoHeight}:Sn(t)?{width:t.codedWidth,height:t.codedHeight}:{width:t.width,height:t.height}}function kn(t){return function(t){return"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement}(t)?"canvas":function(t){return _n&&t instanceof OffscreenCanvas}(t)?"offscreencanvas":Sn(t)?"videoframe":function(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}(t)?"imagebitmap":t.src}function Cn(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement}var _n="undefined"!=typeof OffscreenCanvas;function Sn(t){return"undefined"!=typeof VideoFrame&&t instanceof VideoFrame}var Mn="undefined"==typeof window;function Ln(t){return Error("FastAverageColor: "+t)}function On(t,e){e||console.error(t)}var Bn=function(){function t(){this.canvas=null,this.ctx=null}return t.prototype.getColorAsync=function(t,e){if(!t)return Promise.reject(Ln("call .getColorAsync() without resource"));if("string"==typeof t){if("undefined"==typeof Image)return Promise.reject(Ln("resource as string is not supported in this environment"));var n=new Image;return n.crossOrigin=e&&e.crossOrigin||"",n.src=t,this.bindImageEvents(n,e)}if(Cn(t)&&!t.complete)return this.bindImageEvents(t,e);var r=this.getColor(t,e);return r.error?Promise.reject(r.error):Promise.resolve(r)},t.prototype.getColor=function(t,e){var n=xn(e=e||{});if(!t)return On(i=Ln("call .getColor() without resource"),e.silent),this.prepareResult(n,i);var r=function(t,e){var n,r=jn(e,"left",0),o=jn(e,"top",0),i=jn(e,"width",t.width),a=jn(e,"height",t.height),s=i,l=a;return"precision"===e.mode||(i>a?(n=i/a,s=100,l=Math.round(s/n)):(n=a/i,l=100,s=Math.round(l/n)),(s>i||l>a||s<10||l<10)&&(s=i,l=a)),{srcLeft:r,srcTop:o,srcWidth:i,srcHeight:a,destWidth:s,destHeight:l}}(wn(t),e);if(!(r.srcWidth&&r.srcHeight&&r.destWidth&&r.destHeight))return On(i=Ln('incorrect sizes for resource "'.concat(kn(t),'"')),e.silent),this.prepareResult(n,i);if(!this.canvas&&(this.canvas=Mn?_n?new OffscreenCanvas(1,1):null:document.createElement("canvas"),!this.canvas))return On(i=Ln("OffscreenCanvas is not supported in this browser"),e.silent),this.prepareResult(n,i);if(!this.ctx){if(this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),!this.ctx)return On(i=Ln("Canvas Context 2D is not supported in this browser"),e.silent),this.prepareResult(n);this.ctx.imageSmoothingEnabled=!1}this.canvas.width=r.destWidth,this.canvas.height=r.destHeight;try{this.ctx.clearRect(0,0,r.destWidth,r.destHeight),this.ctx.drawImage(t,r.srcLeft,r.srcTop,r.srcWidth,r.srcHeight,0,0,r.destWidth,r.destHeight);var o=this.ctx.getImageData(0,0,r.destWidth,r.destHeight).data;return this.prepareResult(this.getColorFromArray4(o,e))}catch(a){var i;return On(i=Ln("security error (CORS) for resource ".concat(kn(t),".\nDetails: https://developer.mozilla.org/en/docs/Web/HTML/CORS_enabled_image")),e.silent),e.silent||console.error(a),this.prepareResult(n,i)}},t.prototype.getColorFromArray4=function(t,e){e=e||{};var n=t.length,r=xn(e);if(n<4)return r;var o,i=n-n%4,a=4*(e.step||1);switch(e.algorithm||"sqrt"){case"simple":o=bn;break;case"sqrt":o=yn;break;case"dominant":o=vn;break;default:throw Ln("".concat(e.algorithm," is unknown algorithm"))}return o(t,i,{defaultColor:r,ignoredColor:fn(e.ignoredColor),step:a,dominantDivider:e.dominantDivider})},t.prototype.prepareResult=function(t,e){var n,r=t.slice(0,3),o=[t[0],t[1],t[2],t[3]/255],i=(299*(n=t)[0]+587*n[1]+114*n[2])/1e3<128;return{value:[t[0],t[1],t[2],t[3]],rgb:"rgb("+r.join(",")+")",rgba:"rgba("+o.join(",")+")",hex:hn(r),hexa:hn(t),isDark:i,isLight:!i,error:e}},t.prototype.destroy=function(){this.canvas&&(this.canvas.width=1,this.canvas.height=1,this.canvas=null),this.ctx=null},t.prototype.bindImageEvents=function(t,e){var n=this;return new Promise(function(r,o){var i=function(){l();var i=n.getColor(t,e);i.error?o(i.error):r(i)},a=function(){l(),o(Ln('Error loading image "'.concat(t.src,'"')))},s=function(){l(),o(Ln('Image "'.concat(t.src,'" loading aborted')))},l=function(){t.removeEventListener("load",i),t.removeEventListener("error",a),t.removeEventListener("abort",s)};t.addEventListener("load",i),t.addEventListener("error",a),t.addEventListener("abort",s)})},t}(),In=function(t){var e=t.manga,n=t.mangaDynamicColorSchemes,r=lt(),o=ut().setDynamicColor,i=M({variant:"popover",popupId:"manga-thumbnail-fullscreen"}),a=m(l.useState(!1),2),s=a[0],u=a[1];return l.useLayoutEffect(function(){if(!n)return function(){};var t=new Image;return t.crossOrigin="anonymous",t.src=ge.getThumbnailUrl(e),t.onload=function(){var e=t.width>600&&t.height>600;Promise.all([rn.from(t).getPalette(),(new Bn).getColor(t,{algorithm:"dominant",mode:e?"speed":"precision",ignoredColor:[[255,255,255,255,75],[0,0,0,255,75]]})]).then(function(t){var e=m(t,2),n=e[0],r=e[1];n.Vibrant&&n.DarkVibrant&&n.LightVibrant&&n.LightMuted&&n.Muted&&n.DarkMuted&&o(x(x({},n),{},{average:r}))})},function(){o(null)}},[]),g.jsxs(g.Fragment,{children:[g.jsxs(_,{sx:j(j({position:"relative",borderRadius:1,overflow:"hidden",backgroundColor:"background.paper",width:"150px",maxHeight:"fit-content",aspectRatio:pe,flexShrink:0,flexGrow:0},r.breakpoints.up("lg"),{width:"200px"}),r.breakpoints.up("xl"),{width:"300px"}),children:[g.jsx(ve,{src:ge.getThumbnailUrl(e),alt:"Manga Thumbnail",onLoad:function(){return u(!0)},imgStyle:{width:"100%",height:"100%",objectFit:"cover"}}),s&&g.jsx(_,x(x({},L(i)),{},{sx:{position:"absolute",top:0,bottom:0,width:"100%",justifyContent:"center",alignItems:"center",opacity:0,"&:hover":{background:"rgba(0, 0, 0, 0.4)",cursor:"pointer",opacity:1}},children:g.jsx(Ke,{fontSize:"large",color:"primary"})}))]}),g.jsx(ct,x(x({},dt(i)),{},{sx:{outline:0},children:g.jsx(_,{onClick:function(){return i.close()},sx:{height:"100vh",p:2,outline:0,justifyContent:"center",alignItems:"center"},children:g.jsx(ve,{src:ge.getThumbnailUrl(e),alt:"Manga Thumbnail",imgStyle:{height:"100%",width:"100%",objectFit:"contain"}})})}))]})},Dn=function(t){var e=t.query,n=t.sourceId,r=t.mode,o=t.children,i="source"===r&&void 0!==n?st.sources.childRoutes.browse.path(n,e):"source.global-search"===r?st.sources.childRoutes.searchAll.path(e):st.library.path(void 0,e);return g.jsx(Ce,{component:b,to:i,sx:{textDecoration:"none",color:"inherit"},children:null!=o?o:e})},Rn="35px",En=function(t){var e=t.manga,n=e.description,r=e.genre,o=e.sourceId,i=t.mode,a=m(l.useState(null),2),s=a[0],u=a[1],c=m(l.useState(),2),d=c[0],h=c[1];T(s,l.useCallback(function(){return h(null==s?void 0:s.clientHeight)},[s]));var f=m(ht("isDescriptionGenreCollapsed",!0),2),p=f[0],v=f[1],b=n?Math.min(75,null!=d?d:75):0,y=l.useMemo(function(){return r.filter(Boolean)},[r]);return g.jsxs(g.Fragment,{children:[n&&g.jsxs(_,{sx:{position:"relative"},children:[g.jsx(ft,{collapsedSize:b,in:!p,children:g.jsx(q,{ref:u,sx:{whiteSpace:"pre-line",textAlign:"justify",textJustify:"inter-word",mb:Rn},children:n})}),g.jsx(_,{onClick:function(){return v(!p)},sx:{justifyContent:"flex-start",alignItems:"center",cursor:"pointer",position:"absolute",width:"100%",height:Rn,bottom:0,background:function(t){return"linear-gradient(transparent -15px, ".concat(t.palette.background.default,")")}},children:g.jsx(B,{sx:{color:function(t){return"light"===t.palette.mode?"black":"text"}},children:p?g.jsx(we,{}):g.jsx(ke,{})})})]}),g.jsx(_,{sx:{flexDirection:"row",flexWrap:p?"no-wrap":"wrap",gap:1,overflowX:p?"auto":null},children:y.map(function(t){return g.jsx(Dn,{query:t,sourceId:o,mode:i,children:g.jsx(_e,{label:t,variant:"outlined",onClick:function(){}})},t)})})]})},Pn=H("div")(function(t){var e=t.theme;return j({display:"flex",flexDirection:"column",gap:e.spacing(2),padding:e.spacing(1)},e.breakpoints.up("md"),{flexBasis:"40%",height:"calc(100vh - 64px)",overflowY:"auto"})}),Tn=function(t){var e=t.url,n=t.mangaThumbnailBackdrop,r=t.children;return g.jsxs(_,{sx:{position:"relative"},children:[n&&g.jsxs(g.Fragment,{children:[g.jsx(ve,{spinnerStyle:{display:"none"},imgStyle:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"},src:e,alt:"Manga Thumbnail"}),g.jsx(_,{sx:{"&::before":function(t){return mt(n,{position:"absolute",display:"inline-block",content:'""',top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(to top, ".concat(t.palette.background.default,", transparent 100%, transparent 1px),linear-gradient(to right, ").concat(t.palette.background.default,", transparent 50%, transparent 1px),linear-gradient(to bottom, ").concat(t.palette.background.default,", transparent 50%, transparent 1px),linear-gradient(to left, ").concat(t.palette.background.default,", transparent 50%, transparent 1px)"),backdropFilter:"blur(4.5px) brightness(0.75)"})}}})]}),r]})},Vn=H("div")(function(t){return{display:"flex",paddingBottom:t.theme.spacing(1)}}),zn=H("div")(function(t){return{zIndex:1,marginLeft:t.theme.spacing(1)}}),Fn=function(t){return g.jsx(xe,x({},t))},An=H("div")(function(t){return{display:"flex",gap:t.theme.spacing(1)}}),Wn=function(t){var e=t.url,n=v().t;return g.jsxs(qe,{children:[g.jsx(O,{title:n("global.button.open_browser"),disabled:!e,children:g.jsx(Gt,{size:"medium",disabled:!e,component:Ce,href:null!=e?e:void 0,target:"_blank",rel:"noreferrer",variant:"outlined",children:g.jsx(ue,{})})}),g.jsx(O,{title:n("global.button.open_webview"),disabled:!e,children:g.jsx(Gt,{size:"medium",disabled:!e,component:Ce,href:e?V.getWebviewUrl(e):void 0,target:"_blank",rel:"noreferrer",variant:"outlined",children:g.jsx(fe,{})})})]})};var Hn=function(t,e,n){return null==t?void 0:t.map(function(t){return g.jsx(Dn,{query:t,sourceId:e,mode:n},t)}).reduce(function(t,e){return g.jsxs(g.Fragment,{children:[t,", ",e]})})},qn=function(t){var e,n,r=t.manga,o=t.mode,i=v().t,a=gt().settings,s=a.mangaThumbnailBackdrop,u=a.mangaDynamicColorSchemes;l.useEffect(function(){r.source||U(pt("source.error.label.source_not_found"),"error")},[r.source]);var c,d,f=qt(r),m=f.CategorySelectComponent,b=f.updateLibraryState,y=function(){var t=p(h().m(function t(){return h().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,navigator.clipboard.writeText(r.title);case 1:U(i("global.label.copied_clipboard"),"info"),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();return g.jsxs(g.Fragment,{children:[g.jsxs(Pn,{children:[g.jsxs(Tn,{url:ge.getThumbnailUrl(r),mangaThumbnailBackdrop:s,children:[g.jsxs(Vn,{children:[g.jsx(In,{manga:r,mangaDynamicColorSchemes:u}),g.jsxs(zn,{children:[g.jsxs(_,{sx:{flexDirection:"row",gap:1,alignItems:"flex-start",mb:1},children:[g.jsx(Dn,{query:r.title,sourceId:r.sourceId,mode:"source.global-search",children:g.jsx(q,{variant:"h5",component:"h2",sx:{wordBreak:"break-word"},children:r.title})}),g.jsx(O,{title:i("global.button.copy"),children:g.jsx(B,{onClick:y,color:"inherit",children:g.jsx(Fe,{fontSize:"small"})})})]}),r.author&&g.jsx(Fn,{title:i("manga.label.author"),value:Hn(ge.getAuthors(r),null===(e=r.source)||void 0===e?void 0:e.id,o)}),r.artist&&g.jsx(Fn,{title:i("manga.label.artist"),value:Hn(ge.getArtists(r),null===(n=r.source)||void 0===n?void 0:n.id,o)}),g.jsx(Fn,{title:i("manga.label.status"),value:i(me[r.status])}),g.jsx(Fn,{title:i("source.title_one"),value:(c=r.source,c?je.isLocalSource(c)?pt("source.local_source.title"):null!==(d=c.displayName)&&void 0!==d?d:c.id:pt("global.label.unknown"))})]})]}),g.jsxs(An,{children:[g.jsxs(Ne,{size:"medium",onClick:b,variant:r.inLibrary?"contained":"outlined",children:[r.inLibrary?g.jsx(he,{}):g.jsx(Nt,{}),r.inLibrary?i("manga.button.in_library"):i("manga.button.add_to_library")]}),g.jsx(Ue,{manga:r}),g.jsx(Wn,{url:r.realUrl})]})]}),g.jsx(En,{manga:r,mode:o})]}),m]})},Nn=function(t){var e=t.manga,n=t.onRefresh,r=t.refreshing,o=v().t,i=lt(),a=vt(i.breakpoints.up("sm")),s=m(bt.useState(null),2),l=s[0],u=s[1],c=Boolean(l),d=function(){u(null)},h=Ut({mangaId:e.id}),f=h.openCategorySelect,p=h.CategorySelectComponent;return g.jsxs(g.Fragment,{children:[a&&g.jsxs(g.Fragment,{children:[g.jsx(O,{title:o("manga.label.reload_from_source"),disabled:r,children:g.jsx(B,{onClick:function(){n()},disabled:r,color:"inherit",children:g.jsx(Se,{})})}),e.inLibrary&&g.jsxs(g.Fragment,{children:[g.jsx(O,{title:o("global.button.migrate"),children:g.jsx(b,{to:st.migrate.childRoutes.search.path(e.sourceId,e.id,e.title),state:{mangaTitle:e.title},style:{textDecoration:"none",color:"inherit"},children:g.jsx(B,{color:"inherit",children:g.jsx(Tt,{})})})}),g.jsx(O,{title:o("manga.label.edit_categories"),children:g.jsx(B,{onClick:function(){f(!0)},color:"inherit",children:g.jsx(Vt,{})})})]})]}),!a&&g.jsxs(g.Fragment,{children:[g.jsx(B,{id:"chaptersMenuButton","aria-controls":c?"chaptersMenu":void 0,"aria-haspopup":"true","aria-expanded":c?"true":void 0,onClick:function(t){return u(t.currentTarget)},color:"inherit",children:g.jsx(yt,{})}),g.jsxs(D,{id:"chaptersMenu",anchorEl:l,open:c,onClose:d,MenuListProps:{"aria-labelledby":"chaptersMenuButton"},children:[g.jsxs(xt,{onClick:function(){n(),d()},disabled:r,children:[g.jsx(jt,{children:g.jsx(Se,{fontSize:"small"})}),g.jsx(wt,{children:o("manga.label.reload_from_source")})]}),e.inLibrary&&[g.jsxs(xt,{component:b,to:st.migrate.childRoutes.search.path(e.sourceId,e.id,e.title),state:{mangaTitle:e.title},style:{textDecoration:"none",color:"inherit"},children:[g.jsx(jt,{children:g.jsx(Tt,{fontSize:"small"})}),g.jsx(wt,{children:o("migrate.title")})]},"migrate"),g.jsxs(xt,{onClick:function(){f(!0),d()},children:[g.jsx(jt,{children:g.jsx(Vt,{fontSize:"small"})}),g.jsx(wt,{children:o("manga.label.edit_categories")})]},"categories")]]})]}),p]})};o("Manga",function(){var t,e,n=v().t,r=kt().id,o=(null!==(t=Ct().state)&&void 0!==t?t:{}).mode,a=l.useRef(!1),s=V.useGetManga(_t,r),u=s.data,c=s.error,d=s.loading,f=s.networkStatus,b=s.refetch,y=St(f),x=null==u?void 0:u.manga,j=function(t){var e=m(l.useState(!1),2),n=e[0],r=e[1],o=m(l.useState(null),2),i=o[0],a=o[1];return[l.useCallback(p(h().m(function e(){return h().w(function(e){for(;;)switch(e.n){case 0:return r(!0),a(null),e.n=1,Promise.all([V.getMangaFetch(t,{awaitRefetchQueries:!0}).response,V.getMangaChaptersFetch(t,{awaitRefetchQueries:!0}).response]).catch(function(t){t instanceof K&&"no chapters found"===de(t.message)||a(t)}).finally(function(){return r(!1)});case 1:return e.a(2)}},e)})),[t]),{loading:n,error:i}]}(r),w=m(j,2),k=w[0],C=w[1],S=C.loading,M=C.error,L=null!=c?c:M;return l.useEffect(function(){null!=x&&(!a.current&&!x.initialized&&(a.current=!0,k()))},[x]),Me(null!==(e=null==x?void 0:x.title)&&void 0!==e?e:n("manga.title_one"),g.jsxs(_,{direction:"row",sx:{alignItems:"center"},children:[L&&!y&&!S&&g.jsx(O,{title:g.jsxs(g.Fragment,{children:[n("manga.error.label.request_failure"),g.jsx("br",{}),A(L)]}),children:g.jsx(B,{onClick:function(){return b()},children:g.jsx(i,{color:"error"})})}),x&&(S||y)&&g.jsx(B,{disabled:!0,children:g.jsx(Mt,{size:16})}),x&&g.jsx(Nn,{manga:x,onRefresh:k,refreshing:S})]}),[n,L,y,S,x,k]),L&&!x?g.jsx(Kt,{message:n("manga.error.label.request_failure"),messageExtra:A(L)}):g.jsxs(N,{sx:{display:{md:"flex"},overflow:"hidden"},children:[d&&g.jsx(F,{}),x&&g.jsx(qn,{manga:x,mode:o}),x&&g.jsx(ze,{manga:x,isRefreshing:S})]})})}}})}();
