!function(){function e(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,l,a,o,u=[],i=!0,c=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;i=!1}else for(;!(i=(r=a.call(t)).done)&&(u.push(r.value),u.length!==n);i=!0);}catch(e){c=!0,l=e}finally{try{if(!i&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(c)throw l}}return u}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){if(e){if("string"==typeof e)return r(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,n):void 0}}function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}System.register(["./index-legacy-D2fd0TAC.js","./AppbarSearch-legacy-Dg_bIlvo.js","./PushPin-legacy-BHAvJUwp.js","./DoneAll-legacy-BkRO7a74.js","./FilterList-legacy-CDCzbSDo.js","./LanguageSelect-legacy-C0MqUHbU.js","./useDebounce-legacy-CDaHW8t2.js","./BaseMangaGrid-legacy-CL3-awUY.js","./EmptyViewAbsoluteCentered-legacy-DHk8a-2j.js","./Sources-legacy-C6NrTruH.js","./useAppTitleAndAction-legacy-e0zTEoQY.js","./Card-legacy-CEsa33e4.js","./CardActionArea-legacy-5TJI9bJ-.js","./ChaptersDownloadActionMenuItems-legacy-6CfHOTx6.js","./Trackers-legacy-CN_LuGVd.js","./ListCardContent-legacy-6PoZHzWi.js","./Avatar-legacy-DpJx3NQX.js","./TextField-legacy-Dyw5ucZA.js","./useFormControl-legacy-IKFbZ5pP.js","./formControlState-legacy-CX958IUm.js","./InputAdornment-legacy-DdcCwy1b.js","./CheckCircle-legacy-D3AKu6DW.js","./MUI.util-legacy-DVBm9YWm.js","./Link-legacy-CAQFGcDU.js","./useManageMangaLibraryState-legacy-CyIjCfh0.js","./ThreeStateCheckboxInput-legacy-2kN5zf0r.js","./Checkbox-legacy-Da283-fC.js","./SwitchBase-legacy-E8Xev_P8.js","./CheckboxInput-legacy-DHRZJL0I.js","./FormGroup-legacy-CaluUkH4.js","./ListPreference-legacy-CTGEFKgl.js","./NumberSetting-legacy-C6xfNiR-.js","./Slider-legacy-CmXgggl2.js","./useMobilePicker-legacy-Dm0zNXIh.js","./Chip-legacy-BPbUBvvW.js","./SelectSetting-legacy-Du3tEi5e.js","./Select-legacy-DXA1mbSp.js","./Switch-legacy-Di96VIo-.js","./MangaGrid-legacy-1gCkK-Ua.js","./Delete-legacy-05PdAvkw.js","./Download-legacy-BovYjBMu.js","./Sync-legacy-Dzd3OBHV.js","./use-merged-ref-legacy-_nAoOPmA.js","./ListCardAvatar-legacy-ZNpVB0q9.js","./PlayArrow-legacy-DCTZvCW_.js","./StyledFab-legacy-CrKWZv7l.js","./useAppTitle-legacy-FhV90IcN.js","./useAppAction-legacy-Nc2q3kdd.js"],(function(t,r){"use strict";var l,a,o,u,i,c,s,g,d,f,h,y,j,m,p,S,x,b,v,w,A,C,L,R,M,k,I,F,P,_,T,q,D,E,N,O,z,B;return{setters:[function(e){l=e.e,a=e.u,o=e.q,u=e.a,i=e.b,c=e.ax,s=e.d,g=e.r,d=e.j,f=e.h,h=e.g,y=e.i,j=e.p,m=e.S,p=e.B,S=e.s,x=e.an,b=e.A,v=e.L,w=e.T,A=e.ay,C=e.m},function(e){L=e.u,R=e.S,M=e.A},function(e){k=e.P},function(e){I=e.D},function(e){F=e.F},function(e){P=e.t,_=e.L},function(e){T=e.u},function(e){q=e.B},function(e){D=e.E},function(e){E=e.S,N=e.g},function(e){O=e.u},function(e){z=e.C},function(e){B=e.C},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var r={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function G(e){var t=function(e){var t=l.useRef(0),a=l.useRef(null),o=n(l.useState(r),2),u=o[0],i=o[1],c=l.useMemo((function(){return"undefined"!=typeof window?new ResizeObserver((function(e){var n=e[0];n&&(cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){if(a.current){var e,t,r=(null===(e=n.borderBoxSize)||void 0===e?void 0:e[0])||(null===(t=n.contentBoxSize)||void 0===t?void 0:t[0]);if(r){var l=r.inlineSize,o=r.blockSize;i({width:l,height:o,x:n.contentRect.x,y:n.contentRect.y,top:n.contentRect.top,left:n.contentRect.left,bottom:n.contentRect.bottom,right:n.contentRect.right})}else i(n.contentRect)}})))})):null}),[]);return l.useEffect((function(){return a.current&&(null==c||c.observe(a.current,e)),function(){null==c||c.disconnect(),t.current&&cancelAnimationFrame(t.current)}}),[a.current]),[a,u]}(e),a=n(t,2),o=a[0],u=a[1];return{ref:o,width:u.width,height:u.height}}var W=function(e,n){return e.displayName.localeCompare(n.displayName)},Q=x.memo((function(e){var t,r,o=e.source,u=e.onSearchRequestFinished,i=e.searchString,c=e.emptyQuery,s=e.mode,f=a().t,j=o.id,m=o.displayName,p=o.lang,S=l.useRef(i),x=l.useRef((function(){}));S.current!==i&&(S.current=i,x.current(new Error("SourceSearchPreview(".concat(j,", ").concat(m,"): search string changed"))));var C=n(g.useSourceSearch(j,null!=i?i:"",void 0,1,{skipRequest:!i,addAbortSignal:!0}),2),L=C[0],R=C[1][0],M=R.data,k=R.isLoading,I=R.error,F=R.abortRequest;x.current=F;var _,T=null!==(t=null==M||null===(r=M.fetchSourceManga)||void 0===r?void 0:r.mangas)&&void 0!==t?t:[],D=!I&&!k&&!T.length;return l.useEffect((function(){u(o,{isLoading:k,hasResults:!D,emptySearch:!i,error:I})}),[k,D,i,I]),I?_=f("search.error.label.source_search_failed"):D&&(_=f("manga.error.label.no_mangas_found")),!k&&!i||c?null:d.jsxs(d.Fragment,{children:[d.jsx(z,{sx:{mb:1},children:d.jsxs(B,{component:v,to:"".concat(b.sources.childRoutes.browse.path(j),"?query=").concat(i),sx:{p:3},children:[d.jsx(w,{variant:"h5",children:m}),d.jsx(w,{variant:"caption",children:P(p)})]})}),_?d.jsx(A,{sx:{alignItems:"start",height:void 0},noFaces:!0,message:_,messageExtra:h(I),retry:I?function(){return L(1).catch(y("SourceSearchPreview(".concat(o.id,")::refetch")))}:void 0}):d.jsx(q,{gridWrapperProps:{sx:{px:0}},mangas:T,isLoading:k,hasNextPage:!1,loadMore:function(){},horizontal:!0,noFaces:!0,message:_,inLibraryIndicator:!0,mode:s},i)]})}));t("SearchAll",(function(){var t=a().t,r=o(),x=r.pathname,b=r.state,v=G(),w=v.ref,A=v.height,P=x.startsWith("/migrate/source"),q=n(L("query",R),1)[0],z=T(q,1e3),B=n(u("shownSourceLangs",i()),2),U=B[0],V=B[1],K=n(c("SearchAll::shouldShowOnlyPinnedSources",!0),2),$=K[0],H=K[1],J=s().settings,X=J.showNsfw,Y=J.shouldShowOnlySourcesWithResults,Z=g.useGetSourceList({notifyOnNetworkStatusChange:!0}),ee=Z.data,ne=Z.loading,te=Z.error,re=Z.refetch,le=l.useMemo((function(){var e;return null!==(e=null==ee?void 0:ee.sources.nodes)&&void 0!==e?e:[]}),[null==ee?void 0:ee.sources.nodes]),ae=n(l.useState(new Map),2),oe=ae[0],ue=ae[1],ie=T(oe,500),ce=l.useMemo((function(){return E.getLanguages(le)}),[le]),se=l.useMemo((function(){return E.filter(le,{showNsfw:X,languages:U,keepLocalSource:!0,pinned:$})}),[le,U,$]),ge=l.useMemo((function(){return Y?se.filter((function(e){var n=ie.get(e.id);return!n||(null==n?void 0:n.isLoading)||(null==n?void 0:n.hasResults)&&!(null!=n&&n.error)})):se}),[se,Y,ie]),de=l.useMemo((function(){return e(ge).toSorted(W)}),[ge]),fe=l.useMemo((function(){return e(de).sort((function(e,n){return function(e,n,t){var r=N(e).isPinned,l=N(n).isPinned,a=t.get(e.id),o=t.get(n.id),u=!(null!=a&&a.isLoading),i=!(null==a||!a.error),c=!(null!=a&&a.hasResults||i),s=!(null!=o&&o.isLoading),g=!(null==o||!o.error),d=!(null!=o&&o.hasResults||g);return u&&!s?-1:!u&&s||c&&!d?1:d&&!c||!i&&g?-1:i&&!g?1:r&&!l?-1:!r&&l?1:0}(e,n,ie)}))}),[de,ie]),he=l.useCallback((function(e,n){var t=e.id;ue((function(e){var r=new Map(e);return r.set(t,n),r}))}),[ue]),ye=S((function(e){return C(t("global.error.label.failed_to_save_changes"),"error",h(e))}));return O(t(P?"migrate.search.title":"search.title.global_search",{title:null==b?void 0:b.mangaTitle}),d.jsxs(d.Fragment,{children:[d.jsx(M,{isClosable:!1}),d.jsx(_,{selectedLanguages:U,setSelectedLanguages:V,languages:ce})]}),[U,V,ce]),ne?d.jsx(f,{}):te?d.jsx(D,{message:t("global.error.label.failed_to_load_data"),messageExtra:h(te),retry:function(){return re().catch(y())}}):d.jsxs(j,{sx:{position:"relative",px:1,pb:1},children:[d.jsxs(m,{ref:w,sx:{width:"100%",position:"fixed",zIndex:1,flexDirection:"row",gap:2,pt:1,pb:2,background:function(e){return e.palette.background.default}},children:[d.jsxs(m,{sx:{flexDirection:"row",gap:1},children:[d.jsx(p,{startIcon:d.jsx(k,{}),variant:$?"contained":"outlined",onClick:function(){return H(!0)},children:t("global.label.pinned")}),d.jsx(p,{startIcon:d.jsx(I,{}),variant:$?"outlined":"contained",onClick:function(){return H(!1)},children:t("extension.language.all")})]}),d.jsx(p,{startIcon:d.jsx(F,{}),variant:Y?"contained":"outlined",onClick:function(){return ye("shouldShowOnlySourcesWithResults",!Y)},children:t("search.filter.has_results")})]}),d.jsx(j,{sx:{pt:"".concat(A,"px")},children:fe.map((function(e,n){return d.jsx(j,{sx:{pb:n+1!==fe.length?2:0},children:d.jsx(Q,{source:e,onSearchRequestFinished:he,searchString:z,emptyQuery:!q,mode:P?"migrate.select":"source"})},e.id)}))})]})}))}}}))}();
