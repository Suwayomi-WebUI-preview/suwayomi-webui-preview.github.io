!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?t(Object(a),!0).forEach(function(t){n(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function n(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,r||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function l(r,n,a,i){var l=n&&n.prototype instanceof s?n:s,u=Object.create(l.prototype);return o(u,"_invoke",function(r,n,a){var o,i,l,s=0,u=a||[],d=!1,g={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return o=t,i=0,l=e,g.n=r,c}};function f(r,n){for(i=r,l=n,t=0;!d&&s&&!a&&t<u.length;t++){var a,o=u[t],f=g.p,b=o[2];r>3?(a=b===n)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=r<2&&f<o[1])?(i=0,g.v=n,g.n=o[1]):f<b&&(a=r<3||o[0]>n||n>b)&&(o[4]=r,o[5]=n,g.n=b,i=0))}if(a||r>1)return c;throw d=!0,n}return function(a,u,b){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,b),i=u,l=b;(t=i<2?e:l)||!d;){o||(i?i<3?(i>1&&(g.n=-1),f(i,l)):g.n=l:g.v=l);try{if(s=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(d=g.n<0)?l:r.call(n,g))!==c)break}catch(t){o=e,i=1,l=t}finally{s=1}}return{value:t,done:d}}}(r,a,i),!0),u}var c={};function s(){}function u(){}function d(){}t=Object.getPrototypeOf;var g=[][n]?t(t([][n]())):(o(t={},n,function(){return this}),t),f=d.prototype=s.prototype=Object.create(g);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=d,o(f,"constructor",d),o(d,"constructor",u),u.displayName="GeneratorFunction",o(d,i,"GeneratorFunction"),o(f),o(f,i,"Generator"),o(f,n,function(){return this}),o(f,"toString",function(){return"[object Generator]"}),(a=function(){return{w:l,m:b}})()}function o(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}o=function(e,t,r,n){function i(t,r){o(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},o(e,t,r,n)}function i(e,t,r,n,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function l(e){i(o,n,a,l,c,"next",e)}function c(e){i(o,n,a,l,c,"throw",e)}l(void 0)})}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],c=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./index-legacy-D-lPLVCc.js","./CategoriesInclusionSetting-legacy-DxYldd2R.js","./CheckboxInput-legacy-BldsPkTk.js","./NumberSetting-legacy-CRNftMM8.js","./usePersistedValue-legacy-CFY7oIgo.js","./Switch-legacy-CvVAbr7P.js","./ListSubheader-legacy-CiXGyP2r.js","./EmptyViewAbsoluteCentered-legacy-CYvSjdew.js","./useAppTitle-legacy-YUh_NpcK.js","./ThreeStateCheckboxInput-legacy-B0NLg2KR.js","./Checkbox-legacy-DNfDEYNq.js","./formControlState-legacy-eu0RN9F_.js","./useFormControl-legacy-Gd5GVaJq.js","./SwitchBase-legacy-9_5B8hFv.js","./TextField-legacy-VFEd8ZPr.js","./InputAdornment-legacy-CLCHZQbt.js","./Slider-legacy-B_D0wOiY.js"],function(e,t){"use strict";var o,i,s,u,d,g,f,b,p,y,h,v,j,m,x,S,_,C,w,O,k,U,P,T,I,N,A,F,E,G,L,M,D,V,q,$,R;return{setters:[function(e){o=e.u,i=e.r,s=e.b,u=e.j,d=e.aO,g=e.p,f=e.i,b=e.k,p=e.n,y=e.bn,h=e.q,v=e.B,j=e.aw,m=e.m,x=e.g,S=e.F,_=e.o,C=e.bo,w=e.a$,O=e.a,k=e.e,U=e.f,P=e.aL,T=e.A,I=e.w,N=e.bp,A=e.$},function(e){F=e.C,E=e.a},function(e){G=e.C},function(e){L=e.N},function(e){M=e.u,D=e.g},function(e){V=e.S},function(e){q=e.L},function(e){$=e.E},function(e){R=e.u},null,null,null,null,null,null,null,null],execute:function(){e("LibrarySettings",function(){var e,t,r,n,a=o().t;R(a("library.title"));var l=i.useGetCategories(w),c=i.useGetServerSettings({notifyOnNetworkStatusChange:!0}),s=O(),f=s.settings,b=s.loading,p=s.request,y=p.error,h=p.refetch,v=I(function(e){return m(a("search.error.label.failed_to_save_settings"),"error",x(e))}),j=(null!==(e=null===(t=l.data)||void 0===t?void 0:t.categories.nodes.length)&&void 0!==e?e:1)-1;if(c.loading||b||l.loading)return u.jsx(k,{});var C=null!==(r=null!==(n=c.error)&&void 0!==n?n:y)&&void 0!==r?r:l.error;if(C)return u.jsx($,{message:a("global.error.label.failed_to_load_data"),messageExtra:x(C),retry:function(){c.error&&(null==c||c.refetch().catch(U())),y&&h().catch(U()),l.error&&l.refetch().catch(U())}});return u.jsxs(S,{sx:{pt:0},children:[u.jsxs(S,{subheader:u.jsx(q,{component:"div",id:"library-category-settings",children:a("category.title.category_other")}),children:[u.jsx(P,{to:T.settings.childRoutes.categories.path,children:u.jsx(g,{primary:a("category.dialog.title.edit_category_other"),secondary:a("category.value",{count:j})})}),u.jsxs(_,{children:[u.jsx(g,{primary:a("library.settings.general.add_to_library.category_selection.label.title"),secondary:a("library.settings.general.add_to_library.category_selection.label.description")}),u.jsx(V,{edge:"end",checked:f.showAddToLibraryCategorySelectDialog,onChange:function(e){return v("showAddToLibraryCategorySelectDialog",e.target.checked)}})]}),u.jsxs(_,{children:[u.jsx(g,{primary:a("library.settings.general.remove_from_library.remove_from_categories.label.title"),secondary:a("library.settings.general.remove_from_library.remove_from_categories.label.description")}),u.jsx(V,{edge:"end",checked:f.removeMangaFromCategories,onChange:function(e){return v("removeMangaFromCategories",e.target.checked)}})]})]}),u.jsx(S,{subheader:u.jsx(q,{component:"div",id:"library-general-settings",children:a("global.label.general")}),children:u.jsxs(_,{children:[u.jsx(g,{primary:a("library.settings.general.search.ignore_filters.label.title"),secondary:a("library.settings.general.search.ignore_filters.label.description")}),u.jsx(V,{edge:"end",checked:f.ignoreFilters,onChange:function(e){return v("ignoreFilters",e.target.checked)}})]})}),u.jsx(z,{serverSettings:c.data.settings,categories:l.data.categories.nodes}),u.jsxs(S,{subheader:u.jsx(q,{component:"div",id:"library-advanced",children:a("global.label.advanced")}),children:[u.jsx(d,{onClick:function(){return H()},children:u.jsx(g,{primary:a("library.settings.advanced.database.cleanup.label.title"),secondary:a("library.settings.advanced.database.cleanup.label.description")})}),u.jsx(P,{to:T.settings.childRoutes.library.childRoutes.duplicates.path,children:u.jsx(g,{primary:a("library.settings.advanced.duplicates.label.title"),secondary:a("library.settings.advanced.duplicates.label.description")})})]})]})});var t=function(e){var t=[];return e.excludeUnreadChapters&&t.push(j(y.excludeUnreadChapters)),e.excludeNotStarted&&t.push(j(y.excludeNotStarted)),e.excludeCompleted&&t.push(j(y.excludeCompleted)),!t.length&&t.push(j("global.label.none")),t.join(", ")},B=function(e){var j=e.serverSettings,S=o().t,_=function(e){return{excludeCompleted:e.excludeCompleted,excludeNotStarted:e.excludeNotStarted,excludeUnreadChapters:e.excludeUnreadChapters}}(j),C=c(i.useUpdateServerSettings(),1)[0],w=c(s.useState(null!=_?_:{}),2),O=w[0],k=w[1],U=c(s.useState(!1),2),P=U[0],T=U[1],I=t(_),N=function(){var e=l(a().m(function e(){var t,r;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=(null==_?void 0:_.excludeCompleted)!==O.excludeCompleted||_.excludeNotStarted!==O.excludeNotStarted||_.excludeUnreadChapters!==O.excludeUnreadChapters,T(!1),t){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,C({variables:{input:{settings:O}}});case 2:e.n=4;break;case 3:e.p=3,r=e.v,m(S("global.error.label.failed_to_save_changes"),"error",x(r));case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),A=function(){k(null!=_?_:{}),T(!1)};return s.useEffect(function(){_&&k(_)},[null==_?void 0:_.excludeCompleted,null==_?void 0:_.excludeNotStarted,null==_?void 0:_.excludeUnreadChapters]),u.jsxs(u.Fragment,{children:[u.jsx(d,{onClick:function(){return T(!0)},children:u.jsx(g,{primary:S("library.settings.global_update.entries.title"),secondary:I,onClick:function(){return T(!0)}})}),u.jsxs(f,{open:P,onClose:A,children:[u.jsx(b,{children:S("library.settings.global_update.entries.title")}),u.jsx(p,{children:u.jsx(F,{children:Object.entries(O).map(function(e){var t=c(e,2),a=t[0],o=t[1];return u.jsx(G,{label:S(y[a]),checked:o,onChange:function(e,t){k(r(r({},O),{},n({},a,t)))}},a)})})}),u.jsxs(h,{children:[u.jsx(v,{onClick:A,color:"primary",children:S("global.button.cancel")}),u.jsx(v,{onClick:N,color:"primary",children:S("global.button.ok")})]})]})]})},W=function(e){var t=e.globalUpdateInterval,r=o().t,n=t,a=!!n,l=c(i.useUpdateServerSettings(),1)[0],d=c(M("lastGlobalUpdateInterval",C.default,n,D),2),f=d[0],b=d[1],p=s.useCallback(function(e){b(0===e?f:e),l({variables:{input:{settings:{globalUpdateInterval:e}}}})},[f]);return u.jsxs(S,{children:[u.jsxs(_,{children:[u.jsx(g,{primary:r("library.settings.global_update.auto_update.label.title")}),u.jsx(V,{edge:"end",checked:a,onChange:function(e){return t=e.target.checked,void p(t?f:0);var t}})]}),u.jsx(L,{settingTitle:r("library.settings.global_update.auto_update.interval.label.title"),settingValue:r("library.settings.global_update.auto_update.interval.label.value",{hours:f}),value:f,minValue:C.min,maxValue:C.max,defaultValue:C.default,showSlider:!0,valueUnit:r("global.time.hour_short"),handleUpdate:p,disabled:!a})]})},z=function(e){var t=e.serverSettings,r=e.categories,s=o().t,d=t.updateMangas,f=c(i.useUpdateServerSettings(),1)[0],b=function(){var e=l(a().m(function e(t,r){var o;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f({variables:{input:{settings:n({},t,r)}}});case 1:e.n=3;break;case 2:e.p=2,o=e.v,m(s("global.error.label.failed_to_save_changes"),"error",x(o));case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t,r){return e.apply(this,arguments)}}();return u.jsxs(S,{subheader:u.jsx(q,{component:"div",id:"global-update-settings",children:s("library.settings.global_update.title")}),children:[u.jsx(W,{globalUpdateInterval:t.globalUpdateInterval}),u.jsx(B,{serverSettings:t}),u.jsx(E,{categories:r,includeField:"includeInUpdate",dialogText:s("library.settings.global_update.categories.label.info")}),u.jsxs(_,{children:[u.jsx(g,{primary:s("library.settings.global_update.metadata.label.title"),secondary:s("library.settings.global_update.metadata.label.description")}),u.jsx(V,{edge:"end",checked:d,onChange:function(e){return b("updateMangas",e.target.checked)}})]})]})},H=function(){var e=l(a().m(function e(){var t,r,n;return a().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,i.getMangas(N,{filter:{inLibrary:{equalTo:!1},categoryId:{isNull:!1}}},{fetchPolicy:"no-cache"}).response;case 1:if(t=e.v,!(r=A.getIds(t.data.mangas.nodes)).length){e.n=2;break}return e.n=2,i.updateMangasCategories(r,{clearCategories:!0}).response;case 2:m(j("library.settings.advanced.database.cleanup.label.success"),"success"),e.n=4;break;case 3:e.p=3,n=e.v,m(j("library.settings.advanced.database.cleanup.label.error"),"error",x(n));case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}()}}})}();
