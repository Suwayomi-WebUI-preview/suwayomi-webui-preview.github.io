import{u as C,r as p,b as A,m as v,g as h,j as t,E as j,o as S,p as f,bu as u,a as T,e as N,f as E,bv as P,bw as V,bx as W,by as y,v as F}from"./index-CPeTXJh6.js";import{N as B}from"./NumberSetting-Bk2Cy7n9.js";import{u as M,g as O}from"./usePersistedValue-eC_AHqOF.js";import{S as w}from"./Switch-Di96ACS3.js";import{T as D}from"./TextSetting-ujqVm7-8.js";import{S as I}from"./SelectSetting-BWYKx536.js";import{E as R}from"./EmptyViewAbsoluteCentered-C0zy76AZ.js";import{u as q}from"./useAppTitle-BS2T-YKX.js";import"./TextField-DmqrC1lA.js";import"./useFormControl-CPzMRNSp.js";import"./formControlState-Dq1zat_P.js";import"./InputAdornment-nw8HS46B.js";import"./Slider-CTmIFjNp.js";import"./SwitchBase-Z17wUCaO.js";import"./PasswordTextField-5lrmyaHQ.js";import"./Select-B38dRF2T.js";const H=({disabled:e=!1,updateCheckInterval:d})=>{const{t:n}=C(),l=!!d,[m]=p.useUpdateServerSettings(),[i,U]=M("lastUpdateCheckInterval",u.default,d,O),c=A.useCallback(s=>{U(s===0?i:s),m({variables:{input:{settings:{webUIUpdateCheckInterval:s}}}}).catch(b=>v(n("global.error.label.failed_to_save_changes"),"error",h(b)))},[i]),g=s=>{c(s?i:0)};return t.jsxs(j,{children:[t.jsxs(S,{children:[t.jsx(f,{primary:n("settings.webui.auto_update.label.title")}),t.jsx(w,{disabled:e,edge:"end",checked:l,onChange:s=>g(s.target.checked)})]}),t.jsx(B,{settingTitle:n("settings.webui.auto_update.label.interval"),settingValue:n("library.settings.global_update.auto_update.interval.label.value",{hours:i}),value:i,minValue:u.min,maxValue:u.max,defaultValue:u.default,showSlider:!0,valueUnit:n("global.time.hour_short"),handleUpdate:c,disabled:e||!l})]})},G=e=>({webUIFlavor:e.webUIFlavor,initialOpenInBrowserEnabled:e.initialOpenInBrowserEnabled,webUIInterface:e.webUIInterface,electronPath:e.electronPath,webUIChannel:e.webUIChannel,webUIUpdateCheckInterval:e.webUIUpdateCheckInterval}),de=()=>{const{t:e}=C();q(e("settings.webui.title.webui"));const{settings:{webUIInformAvailableUpdate:d},loading:n,request:{error:l,refetch:m}}=T(),i=F(a=>v(e("global.error.label.failed_to_save_changes"),"error",h(a))),{data:U,loading:c,error:g,refetch:s}=p.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[b]=p.useUpdateServerSettings(),o=(a,L)=>{a==="webUIChannel"&&p.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),b({variables:{input:{settings:{[a]:L}}}}).catch(k=>v(e("global.error.label.failed_to_save_changes"),"error",h(k)))};if(n||c)return t.jsx(N,{});const _=l!=null?l:g;if(_)return t.jsx(R,{message:e("global.error.label.failed_to_load_data"),messageExtra:h(_),retry:()=>{l&&m().catch(E()),g&&s().catch(E())}});const r=G(U.settings),x=r.webUIFlavor===P.Custom;return t.jsxs(j,{sx:{pt:0},children:[t.jsx(I,{settingName:e("settings.webui.flavor.label.title"),value:r.webUIFlavor,values:V,handleChange:a=>o("webUIFlavor",a)}),t.jsxs(S,{children:[t.jsx(f,{primary:e("settings.webui.label.initial_open_browser")}),t.jsx(w,{edge:"end",checked:r.initialOpenInBrowserEnabled,onChange:a=>o("initialOpenInBrowserEnabled",a.target.checked)})]}),t.jsx(I,{settingName:e("settings.webui.interface.label.title"),value:r.webUIInterface,values:W,handleChange:a=>o("webUIInterface",a)}),t.jsx(D,{settingName:e("settings.webui.electron_path.label.title"),dialogDescription:e("settings.webui.electron_path.label.description"),value:r.electronPath,settingDescription:r.electronPath.length?r.electronPath:e("global.label.default"),handleChange:a=>o("electronPath",a)}),t.jsx(I,{settingName:e("settings.webui.channel.label.title"),value:r.webUIChannel,values:y,handleChange:a=>o("webUIChannel",a),disabled:x}),t.jsx(H,{disabled:x,updateCheckInterval:r.webUIUpdateCheckInterval}),!r.webUIUpdateCheckInterval&&t.jsxs(S,{children:[t.jsx(f,{primary:e("global.update.settings.inform.label.title"),secondary:e("global.update.settings.inform.label.description")}),t.jsx(w,{edge:"end",checked:d,onChange:a=>i("webUIInformAvailableUpdate",a.target.checked)})]})]})};export{de as WebUISettings};
