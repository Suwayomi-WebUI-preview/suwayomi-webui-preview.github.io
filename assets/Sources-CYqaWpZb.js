var f=Object.defineProperty;var M=(a,e,t)=>e in a?f(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var S=(a,e,t)=>M(a,typeof e!="symbol"?e+"":e,t);import{bm as m,f as E,M as b,b as l,O as C,N,D as d,bl as P,bj as A,t as D,bk as U,u as h,a as y,v as T,m as B,g as O}from"./index-C0ZqUDx8.js";const j={savedSearches:void 0,isPinned:!1,isEnabled:!0},L=a=>({...a,savedSearches:a.savedSearches?JSON.stringify(a.savedSearches):void 0}),q=a=>{var e;return{...a,savedSearches:(e=b(a.savedSearches))!=null?e:void 0}},v=(a,e)=>q(C("source",{...a,meta:N(a.meta)},L(j),void 0,e)),g=a=>v(a),F=a=>{const e=v(a,l.useEffect);return l.useMemo(()=>e,[a])},x=async(a,e,t)=>m(a,[[e,L({[e]:t})[e]]]),G=(a,e=E())=>(t,r)=>x(a,t,r).catch(e),i=class i{static isLocalSource(e){return e.id===i.LOCAL_SOURCE_ID}static getLanguage(e){return i.isLocalSource(e)?d.OTHER:e.lang}static getLanguages(e){return[...new Set(e.map(i.getLanguage))]}static groupByLanguage(e){const t=Object.groupBy(e,n=>g(n).isPinned?d.PINNED:i.getLanguage(n)),o=Object.entries(t).toSorted(([n],[c])=>{const u=n===d.PINNED,s=c===d.PINNED;return u?-1:s?1:P(n,c)}).map(([n,c])=>[n,(c!=null?c:[]).toSorted((u,s)=>u.displayName.localeCompare(s.displayName))]);return Object.fromEntries(o)}static filter(e,{showNsfw:t,languages:r,keepLocalSource:o,pinned:n,enabled:c}={}){const u=A(D(r!=null?r:[]));return e.filter(s=>t===void 0||t||!s.isNsfw||o&&i.isLocalSource(s)).filter(s=>!r||u.includes(U(i.getLanguage(s)))||o&&i.isLocalSource(s)).filter(s=>n===void 0||!n||g(s).isPinned||o&&i.isLocalSource(s)).filter(s=>c===void 0||!c||g(s).isEnabled||o&&i.isLocalSource(s))}static areFromMultipleRepos(e){var r;const t=(r=e.find(o=>!!o.extension.repo))==null?void 0:r.extension.repo;return!t||!e.length?!1:e.some(o=>o.extension.repo!==t&&!i.isLocalSource(o))}static getLastUsedSource(e,t){return t.find(r=>r.id===e)}static useLanguages(){const{t:e}=h(),{settings:{sourceLanguages:t}}=y(),r=T(n=>B(e("global.error.label.failed_to_save_changes",O(n)),"error")),o=l.useCallback(n=>r("sourceLanguages",n),[]);return{languages:t,setLanguages:o}}};S(i,"LOCAL_SOURCE_ID","0");let p=i;export{p as S,x as a,G as c,g,F as u};
