!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}var n=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function t(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function r(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(n){i(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function i(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var i=r.call(n,t||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,a,o,u=[],c=!0,l=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=a.call(t)).done)&&(u.push(r.value),u.length!==n);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw i}}return u}}(e,n)||u(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,n){if(e){if("string"==typeof e)return c(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}System.register(["./index-legacy-a7MRAkA8.js","./Chapters-legacy-DWUcDR25.js","./ReaderSettingsOptions-legacy-BNGMZ42v.js","./Select-legacy-BI6mL2OV.js","./CustomIconButton-legacy-9c1mEou2.js","./Collapse-legacy-qcR2Zm-3.js","./TextField-legacy-8Jgafatc.js","./useDebounce-legacy-CDuKgtFp.js","./NumberSetting-legacy-BmuHJwj1.js","./Info-legacy-aCDUI6Wc.js","./InputAdornment-legacy-Cib2E43D.js","./SpinnerImage-legacy-BSXCZ0JF.js","./Switch-legacy-BcbE1-dN.js","./SwitchBase-legacy-CZGiEuev.js"],(function(e,t){"use strict";var u,c,l,s,d,f,p,g,v,h,m,x,y,w,b,C,j,E,R,k,P,L,S,T,O,D,N,I,A,_,W,M,z,H,X,V,B,F,Y,K,G,U,q,$,J,Q,Z,ee,ne,te,re,ie,ae;return{setters:[function(e){u=e.c,c=e.l,l=e.j,s=e.B,d=e.r,f=e.i,p=e.F,g=e.ao,v=e.ap,h=e.aq,m=e.ar,x=e.as,y=e.x,w=e.u,b=e.A,C=e.e,j=e.at,E=e.au,R=e.av,k=e.aw,P=e.f,L=e.I,S=e.T,T=e.ax,O=e.a3,D=e.ay,N=e.a1,I=e.az,A=e.a4,_=e.a,W=e.aA,M=e.aB,z=e.p,H=e.N,X=e.m,V=e.h,B=e.M,F=e.a6,Y=e.E,K=e.aC,G=e.aD},function(e){U=e.b,q=e.C},function(e){$=e.P,J=e.R,Q=e.u,Z=e.g,ee=e.c},function(e){ne=e.S},function(e){te=e.C},function(e){re=e.C},function(e){ie=e.a},function(e){ae=e.u},null,null,null,null,null,null],execute:function(){e("Reader",(function(){var e,n,t,c,d,f,p,g,v=w().t,h=C(),m=j(),x=A(),y=x.chapterIndex,b=x.mangaId,E=u.useMemo((function(){return{id:+b,title:"",thumbnailUrl:"",genre:[],inLibraryAt:0,lastReadAt:0,chapters:{totalCount:0},trackRecords:{totalCount:0}}}),[b]),R=_.useGetManga(W,b),k=R.data,P=R.loading,L=R.error,S=R.refetch,T=u.useRef(null),O=Number(b)===(null===(e=T.current)||void 0===e?void 0:e.mangaId)&&Number(y)===(null===(n=T.current)||void 0===n?void 0:n.sourceOrder)&&-1!==(null===(t=T.current)||void 0===t?void 0:t.pageCount),D=null!==(c=null==k?void 0:k.manga)&&void 0!==c?c:E,N=_.useGetChapters(M,{condition:{mangaId:Number(b),sourceOrder:Number(y)}},{notifyOnNetworkStatusChange:!0}),I=N.data,K=N.loading,$=N.error,J=N.refetch,ne=null==I?void 0:I.chapters.nodes[0],te=u.useRef(!1),re=z().settings.downloadAheadLimit,ie=!!re;T.current=T.current&&O?ne&&(null===(ue=T.current)||void 0===ue?void 0:ue.pageCount)!==ne.pageCount?ne:T.current:(te.current=!1,ne||null);var ue;var ce=null!==(d=T.current)&&void 0!==d?d:Ge,le=u.useRef(Ge);le.current===Ge&&(le.current=ce);ce.mangaId!==(null===(f=le.current)||void 0===f?void 0:f.mangaId)&&(le.current=Ge);var se=o(_.useGetChapterPagesFetch(ce.id),2),de=se[0],fe=se[1],pe=fe.loading,ge=fe.error,ve=function(){K||de().then((function(){te.current=!0})).catch(V())};u.useEffect((function(){ve()}),[ce.id]);var he=o(u.useState(!1),2),me=he[0],xe=he[1],ye=o(u.useState(0),2),we=ye[0],be=ye[1],Ce=we===ce.pageCount-1,je=ae(we,Ce?0:1e3),Ee=o(u.useState(void 0),2),Re=Ee[0],ke=Ee[1],Pe=u.useContext(H),Le=Pe.setOverride,Se=Pe.setTitle,Te=Pe.readerNavBarWidth,Oe=o(u.useState(!1),2),De=Oe[0],Ne=Oe[1],Ie=_.useGetMangaChapters(M,b,{nextFetchPolicy:"standby"}),Ae=Ie.data,_e=Ie.loading,We=Ie.error,Me=Ie.refetch,ze=null==Ae?void 0:Ae.chapters.nodes,He=P||K||_e||pe||!te.current&&!$&&!ge,Xe=null!==(p=null!==(g=null!=L?L:$)&&void 0!==g?g:We)&&void 0!==p?p:ge,Ve=Q(),Ue=Ve.settings,qe=Ve.loading,$e=o(u.useState(Z(D,Ue)),2),Je=$e[0],Qe=$e[1],Ze=z().settings,en=u.useMemo((function(){return Je.skipDupChapters?q.removeDuplicates(le.current,null!=ze?ze:[]):null!=ze?ze:[]}),[le.current,ze,Je.skipDupChapters]),nn=u.useMemo((function(){return q.getNextChapters(ce,null!=ze?ze:[],{offset:U.PREV,skipDupe:Je.skipDupChapters,skipDupeChapter:le.current})}),[ce,le.current,ze,Je.skipDupChapters]),tn=u.useMemo((function(){return q.getNextChapters(ce,null!=ze?ze:[],{skipDupe:Je.skipDupChapters,skipDupeChapter:le.current})}),[ce,le.current,ze,Je.skipDupChapters]),rn=u.useMemo((function(){return q.getNextChapter(ce,null!=ze?ze:[],{offset:U.PREV,skipDupe:Je.skipDupChapters,skipDupeChapter:le.current})}),[ce,le.current,ze,Je.skipDupChapters]),an=u.useMemo((function(){return q.getNextChapter(ce,null!=ze?ze:[],{skipDupe:Je.skipDupChapters,skipDupeChapter:le.current})}),[ce,le.current,ze,Je.skipDupChapters]),on=function(e){if(ce!==Ge){!function(){var n,t=Fe(ce.id),r=(null!==(n=e.lastPageRead)&&void 0!==n?n:0)/ce.pageCount>.25;if(ie&&D.inLibrary&&!(null==t||!t.isDownloaded)&&r){var i=an?Fe(an.id):null;if(null==i||!i.isDownloaded)return;var a=q.getNonRead(tn).map((function(e){return Fe(e.id)})).slice(-re).filter((function(e){return!e.isDownloaded})).map((function(e){return e.id})).filter((function(e){return!q.isDownloading(e)}));if(!a.length)return;q.download(a).catch(V())}}();var n=Je.skipDupChapters?q.getIds(q.addDuplicates([ce],null!=ze?ze:[ce])):[ce.id];_.updateChapters(n,r(r({},e),{},{chapterIdsToDelete:function(){if(!(!!e.isRead&&!!Ze.deleteChaptersWhileReading)||!ze)return[];var n=[ce].concat(a(nn))[Ze.deleteChaptersWhileReading-1];if(!n)return[];var t=Fe(n.id);return t.isRead&&q.isDeletable(t,Ze.deleteChaptersWithBookmark)?Je.skipDupChapters?q.getIds(q.addDuplicates([n],ze)):q.getIds([n]):[]}(),trackProgressMangaId:Ze.updateProgressAfterReading&&e.isRead&&D.trackRecords.totalCount?D.id:void 0}),{errorPolicy:"all"}).response.catch(V())}},un=function(e,n){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Qe(r(r({},Je),{},i({},e,n))),t&&G(D,[[e,n]]).catch((function(){return X(v("reader.settings.error.label.failed_to_save_settings"),"warning")}))},cn=u.useCallback((function(e){var n=e===U.NEXT,t=n?an:rn;t?(Ne(!0),be(0),h("/manga/".concat(D.id,"/chapter/").concat(t.sourceOrder),{replace:!0,state:m.state}),Ne(!1)):X(v(n?"reader.error.label.next_chapter_does_not_exist":"reader.error.label.prev_chapter_does_not_exist"),"error")}),[D.id,null==rn?void 0:rn.id,null==an?void 0:an.id]);u.useEffect((function(){!He&&ce?(xe(!0),ce.lastPageRead===ce.pageCount-1?be(0):be(ce.lastPageRead)):be(0)}),[ce,He]),u.useLayoutEffect((function(){null!=D&&D.title&&ce.name!==v("global.label.loading")?Se("".concat(D.title,": ").concat(ce.name)):Se(v("reader.title"))}),[v,D,ce]),u.useEffect((function(){qe||P||(ee(D,"manga",Ue).catch(V()),Qe(Z(D,Ue)))}),[qe,P]),u.useLayoutEffect((function(){return Le({status:!0,value:l.jsx(Be,{settings:Je,setSettingValue:un,manga:D,chapter:ce,chapters:en,curPage:we,scrollToPage:ke,openNextChapter:cn,retrievingNextChapter:De})}),function(){return Le({status:!1,value:l.jsx("div",{})})}}),[D,ce,Je,we,y,De,cn,en]),u.useEffect((function(){if(me&&ce!==Ge){var e=Fe(ce.id);if(je!==(null==e?void 0:e.lastPageRead)){var n=-1!==je,t=je===ce.pageCount-1;(n||t)&&on({lastPageRead:n?je:void 0,isRead:!!t||void 0})}}}),[je,ie]);var ln=u.useCallback((function(){on({lastPageRead:ce.pageCount-1,isRead:!0}),cn(U.NEXT)}),[ce.pageCount,cn,ce,D]),sn=u.useCallback((function(){cn(U.PREV)}),[cn]),dn=B.useGetScrollbarSize("height");if(He)return l.jsx(s,{sx:{height:"100vh",width:"100vw",display:"grid",placeItems:"center"},children:l.jsx(F,{thickness:5})});if(Xe)return l.jsx(Y,{message:v("global.error.label.failed_to_load_data"),messageExtra:Xe.message,retry:function(){L&&S().catch(V()),$&&J().catch(V()),We&&Me().catch(V()),ge&&ve()}});if(!ce.pageCount)return l.jsx(Y,{message:v("reader.error.label.no_pages_found"),retry:ve});var fn=Ke(ce.pageCount).map((function(e){return{index:e,src:_.getChapterPageUrl(b,y,e)}})),pn=Ye(Je.readerType),gn=null!=Re?Re:ce.lastPageRead===ce.pageCount-1?0:ce.lastPageRead,vn=Je.staticNav?Te:0;return l.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignContent:"center",alignItems:"center",justifyContent:"center",minWidth:"calc((100vw - (100vw - 100%)) - ".concat(vn,"px)"),minHeight:"calc(100vh - ".concat(dn,"px)"),marginLeft:"".concat(vn,"px")},children:[l.jsx(oe,{settings:Je,curPage:we,pageCount:ce.pageCount}),l.jsx(s,{sx:{alignSelf:"stretch"},children:l.jsx(pn,{pages:fn,pageCount:ce.pageCount,setCurPage:be,initialPage:gn,curPage:we,settings:Je,manga:D,chapter:ce,nextChapter:ln,prevChapter:sn},ce.id)})]})}));function t(e){var n=e.pages,t=e.curPage,r=e.initialPage,i=e.settings,a=e.setCurPage,o=e.prevChapter,d=e.nextChapter,f=u.useRef(r),p=u.useRef(null),g=u.useRef([]);function v(){var e;t<n.length-1?(null===(e=g.current[t+1])||void 0===e||e.scrollIntoView({inline:"center"}),a((function(e){return e+1}))):i.loadNextOnEnding&&d()}function h(){var e;t>0?(null===(e=g.current[t-1])||void 0===e||e.scrollIntoView({inline:"center"}),a(t-1)):0===t&&o()}var m=u.useRef(0);function x(e){window.scrollBy(m.current-e.pageX,0)}function y(e){var n;m.current=e.pageX,null===(n=p.current)||void 0===n||n.addEventListener("mousemove",x)}function w(){var e;null===(e=p.current)||void 0===e||e.removeEventListener("mousemove",x)}var b=function(){"ContinuesHorizontalLTR"===i.readerType?window.scrollX+window.innerWidth>=document.body.scrollWidth&&d():"ContinuesHorizontalRTL"===i.readerType&&window.scrollX<=window.innerWidth&&d()};return c(g.current[r],u.useCallback((function(e,n){var t=g.current[r];null!=t&&t.offsetHeight&&(t.scrollIntoView({inline:"center"}),n.disconnect())}),[g.current[r],r])),u.useEffect((function(){var e,n;return null===(e=p.current)||void 0===e||e.addEventListener("mousedown",y),null===(n=p.current)||void 0===n||n.addEventListener("mouseup",w),function(){var e,n;null===(e=p.current)||void 0===e||e.removeEventListener("mousedown",y),null===(n=p.current)||void 0===n||n.removeEventListener("mouseup",w)}}),[p]),u.useEffect((function(){return i.loadNextOnEnding&&document.addEventListener("scroll",b),function(){document.removeEventListener("scroll",b)}}),[p,t,o,d]),u.useEffect((function(){var e=function(){if(p.current){var e=function(e){for(var n=0;n<e.children.length;n++){var t=e.children.item(n);if(t){var r=t.getBoundingClientRect(),i=r.left,a=r.right;if(i<=window.innerWidth/2&&a>window.innerWidth/2)return n}}return-1}(p.current);e!==f.current&&(f.current=e,a(e)),("ContinuesHorizontalLTR"===i.readerType?window.innerWidth+window.scrollX>=document.body.scrollWidth-5:window.scrollX<=0)&&(f.current=n.length-1,a(f.current))}};return window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}}),[i.readerType]),l.jsx(s,{ref:p,sx:{display:"flex",flexDirection:"ContinuesHorizontalLTR"===i.readerType?"row":"row-reverse",justifyContent:"ContinuesHorizontalLTR"===i.readerType?"flex-start":"flex-end",width:"auto",height:"auto",overflowX:"visible",userSelect:"none"},onClick:function(e){e.clientX>=.85*window.innerWidth?"ContinuesHorizontalLTR"===i.readerType?v():h():e.clientX<=.15*window.innerWidth&&("ContinuesHorizontalLTR"===i.readerType?h():v())},onWheel:function(e){window.scrollBy({left:"ContinuesHorizontalLTR"===i.readerType?e.deltaY:-1*e.deltaY})},children:n.map((function(e){return l.jsx($,{index:e.index,src:e.src,onImageLoad:function(){},settings:i,ref:function(n){g.current[e.index]=n}},e.index)}))})}function oe(e){var n=e.settings,t=e.curPage,r=e.pageCount;return l.jsx(s,{sx:{display:n.showPageNumber?"block":"none",position:"fixed",bottom:"50px",padding:"2px",paddingLeft:"4px",paddingRight:"4px",textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.3)",borderRadius:"10px"},children:"".concat(t+1," / ").concat(r)})}function ue(e){var n=e.pages,t=e.settings,r=e.setCurPage,i=e.initialPage,a=e.curPage,o=e.nextChapter,c=e.prevChapter,d=u.useRef(null),f=function(e){r(e),window.scroll({top:0})};function p(){a<n.length-1?f(a+1):t.loadNextOnEnding&&o()}function g(){a>0?f(a-1):c()}function v(){"SingleLTR"===t.readerType?g():"SingleRTL"===t.readerType&&p()}function h(){"SingleLTR"===t.readerType?p():"SingleRTL"===t.readerType&&g()}function m(e){switch(e.key){case"Space":e.preventDefault(),p();break;case"ArrowRight":h();break;case"ArrowLeft":v()}}return u.useEffect((function(){return document.addEventListener("keydown",m),function(){document.removeEventListener("keydown",m)}}),[d,a,t.readerType,c,o]),u.useEffect((function(){setTimeout((function(){f(i)}),0)}),[i]),l.jsx(s,{ref:d,sx:{display:"flex",flexDirection:"column",justifyContent:"center",width:"auto",height:"auto"},onClick:function(e){e.clientX>window.innerWidth/2?h():v()},children:n.map((function(e){var n=e.index,r=e.src;return l.jsx($,{index:n,onImageLoad:function(){},src:r,settings:t,display:n===a},r)}))})}function ce(e){var n=e.pages,t=e.settings,r=e.setCurPage,i=e.initialPage,c=e.curPage,d=e.nextChapter,f=e.prevChapter,p=u.useRef(null),g=u.useRef([]),v=u.useRef([]),h=o(u.useState(Array(n.length).fill(!1)),2),m=h[0],x=h[1],y=o(u.useState(Array(n.length).fill(!1)),2),w=y[0],b=y[1];function C(){var e=function(e){return r(-1===e?n.length-1:e)};if(g.current[n.length-1]&&t.loadNextOnEnding)return c===n.length-1||e(n.length-1),void d();e(g.current.findIndex((function(e,n){return!e&&n>c})))}function j(){var e=function(e){return r(Math.max(e,0))};if(g.current[0])return!c||e(0),void f();e(a(g.current).slice(0,c).findLastIndex((function(e){return!e})))}function E(){"DoubleLTR"===t.readerType?j():C()}function R(){"DoubleLTR"===t.readerType?C():j()}function k(e){switch(e.key){case"Space":e.preventDefault(),C();break;case"ArrowRight":R();break;case"ArrowLeft":E()}}return u.useEffect((function(){return document.addEventListener("keydown",k),function(){document.removeEventListener("keydown",k)}}),[p,c,t.readerType,f,d,w,m]),u.useEffect((function(){r(i)}),[i]),l.jsx(s,{ref:p,onClick:function(e){e.clientX>window.innerWidth/2?R():E()},children:l.jsx(s,{id:"display",sx:{display:"flex",flexDirection:"DoubleLTR"===t.readerType?"row":"row-reverse",justifyContent:"center",width:"auto",height:"auto"},children:n.map((function(e){var n=e.index,r=e.src,i=function(){var e=v.current[c];void 0===e&&(e=Math.max(m.lastIndexOf(!0,c),0),w.slice(0,c).every(Boolean)&&(v.current[c]=e));return e>0?e+1:e}(),a=c-i,o=0===c,u=Number(t.offsetFirstPage)+Number(t.offsetFirstPage&&!a&&!o),s=c+(!((a-u)%2)?1:-1),d=n===c,f=n===s,p=m[c],h=m[s],y=d||f&&!(p||h);return g.current[n]=y,l.jsx($,{index:n,src:r,onImageLoad:function(){var e=new Image;e.onload=function(){b((function(e){return e.toSpliced(n,1,!0)})),x((function(t){return t.toSpliced(n,1,(r=e).height/r.width<1);var r}))},e.src=r},settings:t,display:y},r)}))})})}var le=function(){return window.innerHeight+window.scrollY>=document.body.offsetHeight-5};function se(e){var n=e.pages,t=e.settings,r=e.setCurPage,i=e.initialPage,a=e.nextChapter,o=e.prevChapter,d=u.useRef(i),f=u.useRef(null),p=u.useRef([]);u.useEffect((function(){var e=!1,i=function(){if(f.current)if(le()){if(e)return;e=!0,d.current=n.length-1,r(d.current),t.loadNextOnEnding&&a()}else{e=!1;var i=function(e){for(var n=0;n<e.children.length;n++){var t=e.children.item(n);if(t){var r=t.getBoundingClientRect(),i=r.top,a=r.bottom;if(i<=window.innerHeight&&a>1)return n}}return-1}(f.current);i!==d.current&&(d.current=i,r(i))}};return window.addEventListener("scroll",i),function(){window.removeEventListener("scroll",i)}}),[t.loadNextOnEnding,a]);var g=u.useRef(0),v=u.useRef(!1);function h(e){v.current=!0,window.scrollBy(0,g.current-e.pageY)}function m(e){var n;g.current=e.pageY,null===(n=f.current)||void 0===n||n.addEventListener("mousemove",h)}function x(){var e;null===(e=f.current)||void 0===e||e.removeEventListener("mousemove",h)}u.useEffect((function(){var e,n;return null===(e=f.current)||void 0===e||e.addEventListener("mousedown",m),null===(n=f.current)||void 0===n||n.addEventListener("mouseup",x),function(){var e,n;null===(e=f.current)||void 0===e||e.removeEventListener("mousedown",m),null===(n=f.current)||void 0===n||n.removeEventListener("mouseup",x)}}),[f]);var y=u.useCallback((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95;"down"===e&&le()?a():"up"===e&&window.scrollY<=0?o():window.scroll({top:window.scrollY+window.innerHeight*n*("up"===e?-1:1),behavior:"smooth"})}),[a,o]);return u.useEffect((function(){var e=function(e){switch(e.key){case"Space":case"ArrowRight":e.preventDefault(),y(e.shiftKey?"up":"down");break;case"ArrowDown":e.preventDefault(),y(e.shiftKey?"up":"down",.25);break;case"ArrowUp":e.preventDefault(),y(e.shiftKey?"down":"up",.25);break;case"ArrowLeft":e.preventDefault(),y(e.shiftKey?"down":"up")}};return document.addEventListener("keydown",e,!1),function(){document.removeEventListener("keydown",e)}}),[y]),c(p.current[i],u.useCallback((function(e,n){var t=p.current[i];null!=t&&t.offsetHeight&&(t.scrollIntoView(),n.disconnect())}),[p.current[i],i])),l.jsx(s,{ref:f,sx:{display:"flex",flexDirection:"column",justifyContent:"center",width:"auto",height:"auto",userSelect:"none"},onClick:function(e){v.current?v.current=!1:y(e.clientX>window.innerWidth/2?"down":"up")},children:n.map((function(e){return l.jsx($,{index:e.index,src:e.src,onImageLoad:function(){},settings:t,ref:function(n){p.current[e.index]=n}},e.index)}))})}var de={},fe=f;Object.defineProperty(de,"__esModule",{value:!0});var pe=de.default=void 0,ge=fe(d()),ve=l;pe=de.default=(0,ge.default)((0,ve.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var he={},me=f;Object.defineProperty(he,"__esModule",{value:!0});var xe=he.default=void 0,ye=me(d()),we=l;xe=he.default=(0,ye.default)((0,we.jsx)("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"}),"KeyboardArrowLeft");var be={},Ce=f;Object.defineProperty(be,"__esModule",{value:!0});var je=be.default=void 0,Ee=Ce(d()),Re=l;je=be.default=(0,Ee.default)((0,Re.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight");var ke={},Pe=f;Object.defineProperty(ke,"__esModule",{value:!0});var Le=ke.default=void 0,Se=Pe(d()),Te=l;Le=ke.default=(0,Se.default)((0,Te.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown");var Oe={},De=f;Object.defineProperty(Oe,"__esModule",{value:!0});var Ne=Oe.default=void 0,Ie=De(d()),Ae=l;Ne=Oe.default=(0,Ie.default)((0,Ae.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");var _e={entering:{transform:"none"},entered:{transform:"none"}},We=u.forwardRef((function(e,t){var i=p(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},o=e.addEndListener,c=e.appear,s=void 0===c||c,d=e.children,f=e.easing,y=e.in,w=e.onEnter,b=e.onEntered,C=e.onEntering,j=e.onExit,E=e.onExited,R=e.onExiting,k=e.style,P=e.timeout,L=void 0===P?a:P,S=e.TransitionComponent,T=void 0===S?h:S,O=function(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.includes(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}(e,n),D=u.useRef(null),N=g(D,v(d),t),I=function(e){return function(n){if(e){var t=D.current;void 0===n?e(t):e(t,n)}}},A=I(C),_=I((function(e,n){m(e);var t=x({style:k,timeout:L,easing:f},{mode:"enter"});e.style.webkitTransition=i.transitions.create("transform",t),e.style.transition=i.transitions.create("transform",t),w&&w(e,n)})),W=I(b),M=I(R),z=I((function(e){var n=x({style:k,timeout:L,easing:f},{mode:"exit"});e.style.webkitTransition=i.transitions.create("transform",n),e.style.transition=i.transitions.create("transform",n),j&&j(e)})),H=I(E);return l.jsx(T,r(r({appear:s,in:y,nodeRef:D,onEnter:_,onEntered:W,onEntering:A,onExit:z,onExited:H,onExiting:M,addEndListener:function(e){o&&o(D.current,e)},timeout:L},O),{},{children:function(e,n){return u.cloneElement(d,r({style:r(r(r({transform:"scale(0)",visibility:"exited"!==e||y?void 0:"hidden"},_e[e]),k),d.props.style),ref:N},n))}}))})),Me=y("div")({zIndex:10}),ze=y("div")((function(e){var n=e.theme;return{position:"fixed",top:0,left:0,minWidth:"240px",maxWidth:"400px",height:"100vh",overflowY:"auto",backgroundColor:n.palette.background.default,"& header":{backgroundColor:n.palette.action.hover,display:"flex",alignItems:"center",padding:"".concat(n.spacing(1)," ").concat(n.spacing(3)),transition:"left 2s ease"}}})),He=y("div")((function(e){var n=e.theme;return{margin:"0 ".concat(n.spacing(2))}})),Xe=y("div")({display:"flex",flexWrap:"wrap",alignContent:"center",alignItems:"center",justifyContent:"center"}),Ve=y("div")((function(e){var n=e.theme;return{display:"grid",gridTemplateRows:"auto auto auto",gridTemplateColumns:"0fr 1fr 0fr",gridTemplateAreas:'"pre current next"',gridColumnGap:n.spacing(.5),margin:"".concat(n.spacing(1)," 0"),"& a":{textDecoration:"none",color:"inherit",display:"flex",flexWrap:"wrap",alignContent:"center"}}}));function Be(e){var n,t=w().t,i=b().setReaderNavBarWidth,a=p(),s=C(),d=null!==(n=j().state)&&void 0!==n?n:{},f=d.prevDrawerOpen,g=d.prevSettingsCollapseOpen,v=u.useRef(null);c(v,u.useCallback((function(){var e;void 0!==(null===(e=v.current)||void 0===e?void 0:e.offsetWidth)&&i(v.current.offsetWidth)}),[v.current])),u.useLayoutEffect((function(){return function(){return i(0)}}),[v]);var h=e.settings,m=e.setSettingValue,x=e.manga,y=e.chapter,A=e.chapters,_=e.curPage,W=e.scrollToPage,M=e.openNextChapter,z=e.retrievingNextChapter,H=E(),X=u.useMemo((function(){return new Set(A.map((function(e){return e.scanlator}))).size>1}),[A]),V=o(u.useState(h.staticNav||f),2),B=V[0],F=V[1],Y=o(u.useState(!0),2),K=Y[0],G=Y[1],q=o(u.useState(h.staticNav||f),2),$=q[0],Q=q[1],Z=o(u.useState(0),2),ee=Z[0],ae=Z[1],oe=o(u.useState(null==g||g),2),ue=oe[0],ce=oe[1],le=z,se=function(e){F(e),Q(e)},de=function(){var e=window.pageYOffset;Math.abs(e-ee)>20&&(Q(e>ee),ae(e))};return u.useEffect((function(){K&&se(h.staticNav)}),[h.staticNav]),u.useEffect((function(){window.addEventListener("scroll",de);var e=document.querySelector("#root"),n=document.querySelector("#appMainContainer");return e.style.display="flex",e.style.flexDirection="column",n.style.display="none",function(){e.style.display="block",n.style.display="block",window.removeEventListener("scroll",de)}}),[de]),l.jsxs(Me,{children:[l.jsx(R,{direction:k("right","left"),in:B,timeout:200,appear:!1,mountOnEnter:!0,unmountOnExit:!0,children:l.jsxs(ze,{ref:v,children:[l.jsxs("header",{children:[!h.staticNav&&l.jsx(P,{title:t("reader.button.close_menu"),children:l.jsx(L,{edge:"start",color:"inherit","aria-label":"menu",onClick:function(){return se(!1)},size:"large",children:k(l.jsx(xe,{}),l.jsx(je,{}))})}),l.jsx(S,{variant:"h6",component:"h1",sx:{textOverflow:"ellipsis",overflow:"hidden",py:1,flexGrow:1},children:y.name}),l.jsx(P,{title:t("reader.button.exit"),children:l.jsx(L,{edge:"start",color:"inherit","aria-label":"menu",onClick:H,size:"large",sx:{mr:-1},children:l.jsx(pe,{})})})]}),l.jsxs(T,{ContainerComponent:"div",sx:{"& span":{fontWeight:"bold"}},children:[l.jsx(O,{primary:t("reader.settings.title.reader_settings")}),l.jsxs(L,{edge:"start",color:"inherit","aria-label":"menu",disableRipple:!0,disableFocusRipple:!0,onClick:function(){return ce(!ue)},size:"large",children:[ue&&l.jsx(Ne,{}),!ue&&l.jsx(Le,{})]})]}),l.jsx(re,{in:ue,timeout:"auto",unmountOnExit:!0,children:l.jsx(J,{setSettingValue:function(e,n,t){G("staticNav"!==e),m(e,n,t)},staticNav:h.staticNav,showPageNumber:h.showPageNumber,loadNextOnEnding:h.loadNextOnEnding,skipDupChapters:h.skipDupChapters,fitPageToWindow:h.fitPageToWindow,scalePage:h.scalePage,readerType:h.readerType,offsetFirstPage:h.offsetFirstPage,readerWidth:h.readerWidth})}),l.jsx(D,{sx:{my:1,mx:2}}),l.jsxs(He,{children:[l.jsxs(Xe,{children:[l.jsx("span",{children:t("reader.page_info.label.currently_on_page")}),l.jsx(ie,{size:"small",sx:{mx:.5},disabled:le||-1===y.pageCount,children:l.jsx(ne,{value:y.pageCount>-1?"".concat(_):"",displayEmpty:!0,onChange:function(e){var n=e.target.value;W(Number(n))},children:Array(Math.max(0,y.pageCount)).fill(1).map((function(e,n){return l.jsx(N,{value:n,children:n+1},"Page#".concat(n))}))})}),l.jsx("span",{children:t("reader.page_info.label.of_max_pages",{maxPages:y.pageCount})})]}),l.jsxs(Ve,{children:[l.jsx(P,{title:t("reader.button.previous_chapter"),children:l.jsx(L,{sx:{gridArea:"pre"},disabled:le||y.sourceOrder<=1,onClick:function(){return M(U.PREV)},children:k(l.jsx(xe,{}),l.jsx(je,{}))})}),l.jsx(ie,{sx:{gridArea:"current"},size:"small",disabled:le||y.sourceOrder<1,children:l.jsx(ne,{value:y.sourceOrder>=1?"".concat(y.sourceOrder):"",displayEmpty:!0,onChange:function(e){var n=e.target.value;s("/manga/".concat(x.id,"/chapter/").concat(n),{replace:!0,state:{prevDrawerOpen:B,prevSettingsCollapseOpen:ue}})},children:A.map((function(e){var n=e.id,t=e.sourceOrder,r=e.name,i=e.chapterNumber,a=e.scanlator;return l.jsx(N,{value:t,children:"#".concat(i).concat(X&&null!=a?" (".concat(a,")"):""," | ").concat(r)},n)}))})}),l.jsx(P,{title:t("reader.button.next_chapter"),children:l.jsx(L,{sx:{gridArea:"next"},disabled:le||y.sourceOrder<1||y.sourceOrder>=x.chapters.totalCount,onClick:function(){return M(U.NEXT)},children:k(l.jsx(je,{}),l.jsx(xe,{}))})})]})]})]})}),l.jsx(We,{in:!B,children:l.jsx(I,{in:!$,children:l.jsx(P,{title:t("reader.button.open_menu"),children:l.jsx(te,{sx:r({position:"fixed",top:20,left:20,backgroundColor:"rgba(255, 255, 255, 0.75);",color:"black"},a.applyStyles("dark",{backgroundColor:"rgba(0, 0, 0, 0.75);",color:"white"})),size:"large",variant:"contained",onClick:function(){return se(!0)},children:k(l.jsx(je,{}),l.jsx(xe,{}))})})})})]})}var Fe=function(e){return q.getFromCache(e,K,"CHAPTER_READER_FIELDS")},Ye=function(e){switch(e){case"ContinuesVertical":case"Webtoon":default:return se;case"SingleVertical":case"SingleRTL":case"SingleLTR":return ue;case"DoubleVertical":case"DoubleRTL":case"DoubleLTR":return ce;case"ContinuesHorizontalLTR":case"ContinuesHorizontalRTL":return t}},Ke=function(e){return Array.from({length:e},(function(e,n){return n}))},Ge={pageCount:-1,sourceOrder:-1,chapterCount:0,lastPageRead:0,name:"Loading...",manga:{id:-1}}}}}))}();
