import{u as N,a as V,r as h,aj as z,b as M,j as r,E as o,o as i,p as n,v as B,e as D,g as b,f as y,m as j,al as k}from"./index-D0Dc2eKf.js";import{T as l}from"./TextSetting-kzHnOX1H.js";import{N as v}from"./NumberSetting-BmCJo_i9.js";import{S as R}from"./SelectSetting-ATMRSSEf.js";import{E as H}from"./EmptyViewAbsoluteCentered-BwFEOLlC.js";import{u as I}from"./useAppTitle-Z9HBFjvk.js";import{S as d}from"./Switch-BesssowT.js";import{L as c}from"./ListSubheader-D83sts0l.js";import{T as G}from"./Trans-BjSFAdze.js";import{L as K}from"./Link-DJy8Trvh.js";import"./PasswordTextField-3V2MenRT.js";import"./TextField-CFpSpcy0.js";import"./useFormControl-rXPK9Fse.js";import"./formControlState-Dq1zat_P.js";import"./InputAdornment-BaH50U65.js";import"./Slider-eXWJVmpg.js";import"./Select-DyuPjmql.js";import"./SwitchBase-D0l7rDYX.js";const $=e=>({ip:e.ip,port:e.port,socksProxyEnabled:e.socksProxyEnabled,socksProxyVersion:e.socksProxyVersion,socksProxyHost:e.socksProxyHost,socksProxyPort:e.socksProxyPort,socksProxyUsername:e.socksProxyUsername,socksProxyPassword:e.socksProxyPassword,debugLogsEnabled:e.debugLogsEnabled,systemTrayEnabled:e.systemTrayEnabled,maxLogFiles:e.maxLogFiles,maxLogFileSize:e.maxLogFileSize,maxLogFolderSize:e.maxLogFolderSize,basicAuthEnabled:e.basicAuthEnabled,basicAuthUsername:e.basicAuthUsername,basicAuthPassword:e.basicAuthPassword,flareSolverrEnabled:e.flareSolverrEnabled,flareSolverrTimeout:e.flareSolverrTimeout,flareSolverrUrl:e.flareSolverrUrl,flareSolverrSessionName:e.flareSolverrSessionName,flareSolverrSessionTtl:e.flareSolverrSessionTtl,flareSolverrAsResponseFallback:e.flareSolverrAsResponseFallback}),q=e=>e===0?k("global.label.never"):k("settings.server.misc.log_files.file_cleanup.value",{days:e,count:e}),ve=()=>{const{t:e}=N();I(e("settings.server.title.server"));const{settings:{serverInformAvailableUpdate:x},loading:P,request:{error:g,refetch:_}}=V(),E=B(s=>j(e("global.error.label.failed_to_save_changes"),"error",b(s))),{data:L,loading:A,error:p,refetch:U}=h.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[T]=h.useUpdateServerSettings(),[f,C]=z("serverBaseURL",window.location.origin),F=s=>{const u=s.replaceAll(/(\/)+$/g,"");C(u),h.reset()},t=(s,u)=>{T({variables:{input:{settings:{[s]:u}}}}).catch(w=>j(e("global.error.label.failed_to_save_changes"),"error",b(w)))},m=M.useMemo(()=>r.jsxs(o,{subheader:r.jsx(c,{component:"div",id:"server-settings-client",children:e("global.label.client")}),children:[r.jsx(l,{settingName:e("settings.about.server.label.address"),handleChange:F,value:f,placeholder:"http://localhost:4567"}),r.jsxs(i,{children:[r.jsx(n,{primary:e("global.update.settings.inform.label.title"),secondary:e("global.update.settings.inform.label.description")}),r.jsx(d,{edge:"end",checked:x,onChange:s=>E("serverInformAvailableUpdate",s.target.checked)})]})]}),[f,x]);if(P||A)return r.jsxs(r.Fragment,{children:[m,r.jsx(D,{})]});const S=g!=null?g:p;if(S)return r.jsxs(r.Fragment,{children:[m,r.jsx(H,{message:e("global.error.label.failed_to_load_data"),messageExtra:b(S),retry:()=>{g&&_().catch(y()),p&&U().catch(y())}})]});const a=$(L.settings);return r.jsxs(o,{sx:{pt:0},children:[m,r.jsxs(o,{subheader:r.jsx(c,{component:"div",id:"server-settings-server-address",children:e("settings.server.address.server.title")}),children:[r.jsx(l,{settingName:e("settings.server.address.server.label.ip"),handleChange:s=>t("ip",s),value:a.ip,placeholder:"0.0.0.0"}),r.jsx(v,{settingTitle:e("settings.server.address.server.label.port"),settingValue:a.port.toString(),handleUpdate:s=>t("port",s),value:a.port,defaultValue:4567,valueUnit:e("settings.server.address.server.label.port")})]}),r.jsxs(o,{subheader:r.jsx(c,{component:"div",id:"server-settings-socks-proxy",children:e("settings.server.socks_proxy.title")}),children:[r.jsxs(i,{children:[r.jsx(n,{primary:e("settings.server.socks_proxy.label.enable")}),r.jsx(d,{edge:"end",checked:a.socksProxyEnabled,onChange:s=>t("socksProxyEnabled",s.target.checked)})]}),r.jsx(R,{settingName:e("settings.server.socks_proxy.label.version"),value:a.socksProxyVersion,values:[[4,{text:"4"}],[5,{text:"5"}]],handleChange:s=>t("socksProxyVersion",s)}),r.jsx(l,{settingName:e("settings.server.socks_proxy.label.host"),value:a.socksProxyHost,handleChange:s=>t("socksProxyHost",s)}),r.jsx(l,{settingName:e("settings.server.socks_proxy.label.port"),value:a.socksProxyPort,handleChange:s=>t("socksProxyPort",s)}),r.jsx(l,{settingName:e("settings.server.socks_proxy.label.username"),value:a.socksProxyUsername,handleChange:s=>t("socksProxyUsername",s)}),r.jsx(l,{settingName:e("settings.server.socks_proxy.label.password"),value:a.socksProxyPassword,handleChange:s=>t("socksProxyPassword",s),isPassword:!0})]}),r.jsxs(o,{subheader:r.jsx(c,{component:"div",id:"server-settings-auth",children:e("settings.server.auth.title")}),children:[r.jsxs(i,{children:[r.jsx(n,{primary:e("settings.server.auth.basic.label.enable")}),r.jsx(d,{edge:"end",checked:a.basicAuthEnabled,disabled:!a.basicAuthUsername.trim()&&!a.basicAuthPassword.trim(),onChange:s=>t("basicAuthEnabled",s.target.checked)})]}),r.jsx(l,{settingName:e("settings.server.auth.basic.label.username"),value:a.basicAuthUsername,validate:s=>!a.basicAuthEnabled||!!s.trim(),handleChange:s=>t("basicAuthUsername",s)}),r.jsx(l,{settingName:e("settings.server.auth.basic.label.password"),value:a.basicAuthPassword,isPassword:!0,validate:s=>!a.basicAuthEnabled||!!s.trim(),handleChange:s=>t("basicAuthPassword",s)})]}),r.jsxs(o,{subheader:r.jsx(c,{component:"div",id:"server-settings-clouadflare-bypass",children:e("settings.server.cloudflare.title")}),children:[r.jsxs(i,{children:[r.jsx(n,{primary:e("settings.server.cloudflare.flaresolverr.enabled.label.title"),secondary:r.jsxs(G,{i18nKey:"settings.server.cloudflare.flaresolverr.enabled.label.description",children:["See"," ",r.jsx(K,{href:"https://github.com/FlareSolverr/FlareSolverr?tab=readme-ov-file#installation",target:"_blank",rel:"noreferrer",children:"FlareSolverr"})," ","for information on how to set it up"]})}),r.jsx(d,{edge:"end",checked:a.flareSolverrEnabled,onChange:s=>t("flareSolverrEnabled",s.target.checked)})]}),r.jsx(l,{settingName:e("settings.server.cloudflare.flaresolverr.url.label.title"),dialogDescription:e("settings.server.cloudflare.flaresolverr.url.label.description"),value:a.flareSolverrUrl,handleChange:s=>t("flareSolverrUrl",s)}),r.jsx(v,{settingTitle:e("settings.server.cloudflare.flaresolverr.timeout.label.title"),settingValue:e("global.time.seconds.value",{count:a.flareSolverrTimeout}),dialogDescription:e("settings.server.cloudflare.flaresolverr.timeout.label.description"),value:a.flareSolverrTimeout,defaultValue:60,minValue:20,maxValue:60*5,stepSize:1,showSlider:!0,valueUnit:e("global.time.seconds.second_other"),handleUpdate:s=>t("flareSolverrTimeout",s)}),r.jsx(l,{settingName:e("settings.server.cloudflare.flaresolverr.session.name.label.title"),value:a.flareSolverrSessionName,handleChange:s=>t("flareSolverrSessionName",s)}),r.jsx(v,{settingTitle:e("settings.server.cloudflare.flaresolverr.session.ttl.label.title"),settingValue:e("global.time.minutes.value",{count:a.flareSolverrSessionTtl}),dialogDescription:e("settings.server.cloudflare.flaresolverr.session.ttl.label.description"),value:a.flareSolverrSessionTtl,defaultValue:15,minValue:1,maxValue:60,stepSize:1,showSlider:!0,valueUnit:e("global.time.minutes.minute_other"),handleUpdate:s=>t("flareSolverrSessionTtl",s)}),r.jsxs(i,{children:[r.jsx(n,{primary:e("settings.server.cloudflare.flaresolverr.response_fallback.label.title"),secondary:e("settings.server.cloudflare.flaresolverr.response_fallback.label.description")}),r.jsx(d,{edge:"end",checked:a.flareSolverrAsResponseFallback,onChange:s=>t("flareSolverrAsResponseFallback",s.target.checked)})]})]}),r.jsxs(o,{subheader:r.jsx(c,{component:"div",id:"server-settings-misc",children:e("settings.server.misc.title")}),children:[r.jsxs(i,{children:[r.jsx(n,{primary:e("settings.server.misc.log_level.label.server")}),r.jsx(d,{edge:"end",checked:a.debugLogsEnabled,onChange:s=>t("debugLogsEnabled",s.target.checked)})]}),r.jsxs(i,{children:[r.jsx(n,{primary:e("settings.server.misc.tray_icon.label.title"),secondary:e("settings.server.misc.tray_icon.label.description")}),r.jsx(d,{edge:"end",checked:a.systemTrayEnabled,onChange:s=>t("systemTrayEnabled",s.target.checked)})]}),r.jsx(v,{settingTitle:e("settings.server.misc.log_files.file_cleanup.title"),settingValue:q(a.maxLogFiles),value:a.maxLogFiles,valueUnit:e("global.date.label.day_one"),handleUpdate:s=>t("maxLogFiles",s)}),r.jsx(l,{settingName:e("settings.server.misc.log_files.file_size.title"),value:a.maxLogFileSize,dialogDescription:e("settings.server.misc.log_files.file_size.description"),validate:s=>!!s.match(/^[0-9]+(|kb|KB|mb|MB|gb|GB)$/g),handleChange:s=>t("maxLogFileSize",s)}),r.jsx(l,{settingName:e("settings.server.misc.log_files.total_size.title"),value:a.maxLogFolderSize,dialogDescription:e("settings.server.misc.log_files.total_size.description"),validate:s=>!!s.match(/^[0-9]+(|kb|KB|mb|MB|gb|GB)$/g),handleChange:s=>t("maxLogFolderSize",s)})]})]})};export{ve as ServerSettings};
