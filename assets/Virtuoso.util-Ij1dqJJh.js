var m=Object.defineProperty;var I=(i,e,t)=>e in i?m(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var d=(i,e,t)=>I(i,typeof e!="symbol"?e+"":e,t);import{e as a,q as x,bc as h,cj as p}from"./index-YZjYIyFe.js";class l{static convertIndex(e,t,s){for(let o=0;o<t.length;o++){const r=t[o],n=s[o];if(e<=n-1){const c=n-e===r+1;return{type:c?"group":"normal",index:c?o:e-(o+1),groupIndex:o}}}throw new Error('Unexpected "'.concat(e,'" (').concat(e,') and "groupCounts" (').concat(t,")"))}static useCreateConvertIndex(e){const t=a.useMemo(()=>{var o;const s=[];for(let r=0;r<e.length;r++){const n=(o=s[r-1])!=null?o:0;s[r]=e[r]+1+n}return s},[e]);return a.useCallback(s=>this.convertIndex(s,e,t),[t])}static useCreateGroupedComputeItemKey(e,t,s){const o=this.useCreateConvertIndex(e);return a.useCallback(r=>{const{type:n,index:u,groupIndex:c}=o(r);switch(n){case"group":return t(u,c);case"normal":return s(u,c);default:throw new Error('VirtuosoUtil::useCreateGroupedComputeItemKey: unexpected "converted index type" ('.concat(n,")"))}},[o,t,s])}static usePersistState(e){const t=x(),s="virtuoso-snapshot-".concat(e,"-").concat(t.key),[o]=h(s,void 0),r=a.useRef(void 0),n=a.useCallback(c=>{const f=window.location.href;clearTimeout(r.current),r.current=setTimeout(()=>{f===window.location.href&&p.session.setItem(s,c,!1)},250)},[s]),u=a.useCallback(()=>{p.session.setItem(s,void 0,!1)},[s]);return a.useEffect(()=>clearTimeout(r.current),[t.key,r.current]),{key:s,state:o,persistState:n,deleteState:u}}}d(l,"GROUP",0),d(l,"ITEMS",1);export{l as V};
