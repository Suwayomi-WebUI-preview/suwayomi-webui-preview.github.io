!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,n||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function o(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return n};var t,n={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",s=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(t){d=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var i=t&&t.prototype instanceof x?t:x,o=Object.create(i.prototype),u=new D(r||[]);return a(o,"_invoke",{value:P(e,n,u)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=f;var h="suspendedStart",g="suspendedYield",v="executing",y="completed",m={};function x(){}function w(){}function b(){}var C={};d(C,c,(function(){return this}));var j=Object.getPrototypeOf,E=j&&j(j(N([])));E&&E!==r&&i.call(E,c)&&(C=E);var L=b.prototype=x.prototype=Object.create(C);function R(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function k(t,n){function r(o,a,u,c){var s=p(t[o],t,a);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==e(d)&&i.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,u,c)}),(function(e){r("throw",e,u,c)})):n.resolve(d).then((function(e){l.value=e,u(l)}),(function(e){return r("throw",e,u,c)}))}c(s.arg)}var o;a(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,i){r(e,t,n,i)}))}return o=o?o.then(i,i):i()}})}function P(e,n,r){var i=h;return function(o,a){if(i===v)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var c=O(u,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var s=p(e,n,r);if("normal"===s.type){if(i=r.done?y:g,s.arg===m)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(i=y,r.method="throw",r.arg=s.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=p(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function N(n){if(n||""===n){var r=n[c];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,a=function e(){for(;++o<n.length;)if(i.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(e(n)+" is not iterable")}return w.prototype=b,a(L,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:w,configurable:!0}),w.displayName=d(b,l,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,d(e,l,"GeneratorFunction")),e.prototype=Object.create(L),e},n.awrap=function(e){return{__await:e}},R(k.prototype),d(k.prototype,s,(function(){return this})),n.AsyncIterator=k,n.async=function(e,t,r,i,o){void 0===o&&(o=Promise);var a=new k(f(e,t,r,i),o);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},R(L),d(L,l,"Generator"),d(L,c,(function(){return this})),d(L,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=N,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},n}function a(e,t,n,r,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,i)}function u(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,u=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(u.push(r.value),u.length!==t);c=!0);}catch(e){s=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw i}}return u}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}System.register(["./index-legacy-BJXUhyM2.js","./Chapters-legacy-B_FOLM9O.js","./ReaderSettingsOptions-legacy-BJD3-jPk.js","./Select-legacy-CfVxQC0S.js","./CustomIconButton-legacy-CEeEzhyg.js","./Collapse-legacy-DV2W5eeV.js","./TextField-legacy-Csb_zahn.js","./useDebounce-legacy-D1qFFeBF.js","./NumberSetting-legacy-3KEAatVP.js","./Info-legacy-D0ThK2Sh.js","./InputAdornment-legacy-DgF7ZTvm.js","./SpinnerImage-legacy-KOLxGeyc.js","./Switch-legacy-DzUc5i_s.js","./SwitchBase-legacy-DaWhBMYt.js"],(function(e,n){"use strict";var s,l,d,f,p,h,g,v,y,m,x,w,b,C,j,E,L,R,k,P,O,S,T,D,N,_,I,A,W,M,z,H,F,X,G,V,B,Y,K,q,U,$,J,Q,Z,ee,te,ne,re,ie,oe,ae,ue;return{setters:[function(e){s=e.c,l=e.l,d=e.j,f=e.B,p=e.a,h=e.r,g=e.i,v=e.F,y=e.ao,m=e.ap,x=e.aq,w=e.ar,b=e.as,C=e.x,j=e.u,E=e.A,L=e.e,R=e.at,k=e.au,P=e.av,O=e.aw,S=e.f,T=e.I,D=e.T,N=e.ax,_=e.a3,I=e.ay,A=e.a1,W=e.az,M=e.a4,z=e.aA,H=e.aB,F=e.p,X=e.N,G=e.m,V=e.h,B=e.M,Y=e.a6,K=e.E,q=e.aC,U=e.aD},function(e){$=e.b,J=e.C},function(e){Q=e.P,Z=e.R,ee=e.u,te=e.g,ne=e.c},function(e){re=e.S},function(e){ie=e.C},function(e){oe=e.C},function(e){ae=e.a},function(e){ue=e.u},null,null,null,null,null,null],execute:function(){e("Reader",(function(){var e,t,n,o,a,l,h,g,v=j().t,y=L(),m=R(),x=M(),w=x.chapterIndex,b=x.mangaId,C=s.useMemo((function(){return{id:+b,title:"",thumbnailUrl:"",genre:[],inLibraryAt:0,lastReadAt:0,chapters:{totalCount:0},trackRecords:{totalCount:0}}}),[b]),E=p.useGetManga(z,b),k=E.data,P=E.loading,O=E.error,S=E.refetch,T=s.useRef(null),D=Number(b)===(null===(e=T.current)||void 0===e?void 0:e.mangaId)&&Number(w)===(null===(t=T.current)||void 0===t?void 0:t.sourceOrder)&&-1!==(null===(n=T.current)||void 0===n?void 0:n.pageCount),N=null!==(o=null==k?void 0:k.manga)&&void 0!==o?o:C,_=p.useGetChapters(H,{condition:{mangaId:Number(b),sourceOrder:Number(w)}},{notifyOnNetworkStatusChange:!0}),I=_.data,A=_.loading,W=_.error,q=_.refetch,Q=null==I?void 0:I.chapters.nodes[0],Z=s.useRef(!1),re=F().settings.downloadAheadLimit,ie=!!re;T.current=T.current&&D?Q&&(null===(oe=T.current)||void 0===oe?void 0:oe.pageCount)!==Q.pageCount?Q:T.current:(Z.current=!1,Q||null);var oe;var ae=null!==(a=T.current)&&void 0!==a?a:Ue,se=s.useRef(Ue);se.current===Ue&&(se.current=ae);ae.mangaId!==(null===(l=se.current)||void 0===l?void 0:l.mangaId)&&(se.current=Ue);var le=c(p.useGetChapterPagesFetch(ae.id),2),de=le[0],fe=le[1],pe=fe.loading,he=fe.error,ge=function(){A||de().then((function(){Z.current=!0})).catch(V())};s.useEffect((function(){ge()}),[ae.id]);var ve=c(s.useState(!1),2),ye=ve[0],me=ve[1],xe=c(s.useState(0),2),we=xe[0],be=xe[1],Ce=we===ae.pageCount-1,je=ue(we,Ce?0:1e3),Ee=c(s.useState(void 0),2),Le=Ee[0],Re=Ee[1],ke=s.useContext(X),Pe=ke.setOverride,Oe=ke.setTitle,Se=ke.readerNavBarWidth,Te=c(s.useState(!1),2),De=Te[0],Ne=Te[1],_e=p.useGetMangaChapters(H,b,{nextFetchPolicy:"standby"}),Ie=_e.data,Ae=_e.loading,We=_e.error,Me=_e.refetch,ze=null==Ie?void 0:Ie.chapters.nodes,He=P||A||Ae||pe||!Z.current&&!W&&!he,Fe=null!==(h=null!==(g=null!=O?O:W)&&void 0!==g?g:We)&&void 0!==h?h:he,Xe=ee(),Ge=Xe.settings,Ve=Xe.loading,$e=c(s.useState(te(N,Ge)),2),Je=$e[0],Qe=$e[1],Ze=F().settings,et=s.useMemo((function(){return Je.skipDupChapters?J.removeDuplicates(se.current,null!=ze?ze:[]):null!=ze?ze:[]}),[se.current,ze,Je.skipDupChapters]),tt=s.useMemo((function(){return J.getNextChapters(ae,null!=ze?ze:[],{offset:$.PREV,skipDupe:Je.skipDupChapters,skipDupeChapter:se.current})}),[ae,se.current,ze,Je.skipDupChapters]),nt=s.useMemo((function(){return J.getNextChapters(ae,null!=ze?ze:[],{skipDupe:Je.skipDupChapters,skipDupeChapter:se.current})}),[ae,se.current,ze,Je.skipDupChapters]),rt=s.useMemo((function(){return J.getNextChapter(ae,null!=ze?ze:[],{offset:$.PREV,skipDupe:Je.skipDupChapters,skipDupeChapter:se.current})}),[ae,se.current,ze,Je.skipDupChapters]),it=s.useMemo((function(){return J.getNextChapter(ae,null!=ze?ze:[],{skipDupe:Je.skipDupChapters,skipDupeChapter:se.current})}),[ae,se.current,ze,Je.skipDupChapters]),ot=function(e){if(ae!==Ue){!function(){var t,n=Ye(ae.id),r=(null!==(t=e.lastPageRead)&&void 0!==t?t:0)/ae.pageCount>.25;if(ie&&N.inLibrary&&!(null==n||!n.isDownloaded)&&r){var i=it?Ye(it.id):null;if(null==i||!i.isDownloaded)return;var o=J.getNonRead(nt).map((function(e){return Ye(e.id)})).slice(-re).filter((function(e){return!e.isDownloaded})).map((function(e){return e.id})).filter((function(e){return!J.isDownloading(e)}));if(!o.length)return;J.download(o).catch(V())}}();var t=Je.skipDupChapters?J.getIds(J.addDuplicates([ae],null!=ze?ze:[ae])):[ae.id];p.updateChapters(t,r(r({},e),{},{chapterIdsToDelete:function(){if(!(!!e.isRead&&!!Ze.deleteChaptersWhileReading)||!ze)return[];var t=[ae].concat(u(tt))[Ze.deleteChaptersWhileReading-1];if(!t)return[];var n=Ye(t.id);return n.isRead&&J.isDeletable(n,Ze.deleteChaptersWithBookmark)?Je.skipDupChapters?J.getIds(J.addDuplicates([t],ze)):J.getIds([t]):[]}(),trackProgressMangaId:Ze.updateProgressAfterReading&&e.isRead&&N.trackRecords.totalCount?N.id:void 0}),{errorPolicy:"all"}).response.catch(V())}},at=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Qe(r(r({},Je),{},i({},e,t))),n&&U(N,[[e,t]]).catch((function(){return G(v("reader.settings.error.label.failed_to_save_settings"),"warning")}))},ut=s.useCallback((function(e){var t=e===$.NEXT,n=t?it:rt;n?(Ne(!0),be(0),y("/manga/".concat(N.id,"/chapter/").concat(n.sourceOrder),{replace:!0,state:m.state}),Ne(!1)):G(v(t?"reader.error.label.next_chapter_does_not_exist":"reader.error.label.prev_chapter_does_not_exist"),"error")}),[N.id,null==rt?void 0:rt.id,null==it?void 0:it.id]);s.useEffect((function(){!He&&ae?(me(!0),ae.lastPageRead===ae.pageCount-1?be(0):be(ae.lastPageRead)):be(0)}),[ae,He]),s.useEffect((function(){null!=N&&N.title&&ae.name!==v("global.label.loading")?Oe("".concat(N.title,": ").concat(ae.name)):Oe(v("reader.title"))}),[v,N,ae]),s.useEffect((function(){Ve||P||(ne(N,"manga",Ge).catch(V()),Qe(te(N,Ge)))}),[Ve,P]),s.useEffect((function(){return Pe({status:!0,value:d.jsx(Be,{settings:Je,setSettingValue:at,manga:N,chapter:ae,chapters:et,curPage:we,scrollToPage:Re,openNextChapter:ut,retrievingNextChapter:De})}),function(){return Pe({status:!1,value:d.jsx("div",{})})}}),[N,ae,Je,we,w,De,ut,et]),s.useEffect((function(){if(ye&&ae!==Ue){var e=Ye(ae.id);if(je!==(null==e?void 0:e.lastPageRead)){var t=-1!==je,n=je===ae.pageCount-1;(t||n)&&ot({lastPageRead:t?je:void 0,isRead:!!n||void 0})}}}),[je,ie]);var ct=s.useCallback((function(){ot({lastPageRead:ae.pageCount-1,isRead:!0}),ut($.NEXT)}),[ae.pageCount,ut,ae,N]),st=s.useCallback((function(){ut($.PREV)}),[ut]),lt=B.useGetScrollbarSize("height");if(He)return d.jsx(f,{sx:{height:"100vh",width:"100vw",display:"grid",placeItems:"center"},children:d.jsx(Y,{thickness:5})});if(Fe)return d.jsx(K,{message:v("global.error.label.failed_to_load_data"),messageExtra:Fe.message,retry:function(){O&&S().catch(V()),W&&q().catch(V()),We&&Me().catch(V()),he&&ge()}});if(!ae.pageCount)return d.jsx(K,{message:v("reader.error.label.no_pages_found"),retry:ge});var dt=qe(ae.pageCount).map((function(e){return{index:e,src:p.getChapterPageUrl(b,w,e)}})),ft=Ke(Je.readerType),pt=null!=Le?Le:ae.lastPageRead===ae.pageCount-1?0:ae.lastPageRead,ht=Je.staticNav?Se:0;return d.jsxs(f,{sx:{display:"flex",flexDirection:"column",alignContent:"center",alignItems:"center",justifyContent:"center",minWidth:"calc((100vw - (100vw - 100%)) - ".concat(ht,"px)"),minHeight:"calc(100vh - ".concat(lt,"px)"),marginLeft:"".concat(ht,"px")},children:[d.jsx(ce,{settings:Je,curPage:we,pageCount:ae.pageCount}),d.jsx(f,{sx:{alignSelf:"stretch"},children:d.jsx(ft,{pages:dt,pageCount:ae.pageCount,setCurPage:be,initialPage:pt,curPage:we,settings:Je,manga:N,chapter:ae,nextChapter:ct,prevChapter:st},ae.id)})]})}));function n(e){var t=e.pages,n=e.curPage,r=e.initialPage,i=e.settings,o=e.setCurPage,a=e.prevChapter,u=e.nextChapter,c=s.useRef(r),p=s.useRef(null),h=s.useRef([]);function g(){var e;n<t.length-1?(null===(e=h.current[n+1])||void 0===e||e.scrollIntoView({inline:"center"}),o((function(e){return e+1}))):i.loadNextOnEnding&&u()}function v(){var e;n>0?(null===(e=h.current[n-1])||void 0===e||e.scrollIntoView({inline:"center"}),o(n-1)):0===n&&a()}var y=s.useRef(0);function m(e){window.scrollBy(y.current-e.pageX,0)}function x(e){var t;y.current=e.pageX,null===(t=p.current)||void 0===t||t.addEventListener("mousemove",m)}function w(){var e;null===(e=p.current)||void 0===e||e.removeEventListener("mousemove",m)}var b=function(){"ContinuesHorizontalLTR"===i.readerType?window.scrollX+window.innerWidth>=document.body.scrollWidth&&u():"ContinuesHorizontalRTL"===i.readerType&&window.scrollX<=window.innerWidth&&u()};return l(h.current[r],s.useCallback((function(e,t){var n=h.current[r];null!=n&&n.offsetHeight&&(n.scrollIntoView({inline:"center"}),t.disconnect())}),[h.current[r],r])),s.useEffect((function(){var e,t;return null===(e=p.current)||void 0===e||e.addEventListener("mousedown",x),null===(t=p.current)||void 0===t||t.addEventListener("mouseup",w),function(){var e,t;null===(e=p.current)||void 0===e||e.removeEventListener("mousedown",x),null===(t=p.current)||void 0===t||t.removeEventListener("mouseup",w)}}),[p]),s.useEffect((function(){return i.loadNextOnEnding&&document.addEventListener("scroll",b),function(){document.removeEventListener("scroll",b)}}),[p,n,a,u]),s.useEffect((function(){var e=function(){if(p.current){var e=function(e){for(var t=0;t<e.children.length;t++){var n=e.children.item(t);if(n){var r=n.getBoundingClientRect(),i=r.left,o=r.right;if(i<=window.innerWidth/2&&o>window.innerWidth/2)return t}}return-1}(p.current);e!==c.current&&(c.current=e,o(e)),("ContinuesHorizontalLTR"===i.readerType?window.innerWidth+window.scrollX>=document.body.scrollWidth-5:window.scrollX<=0)&&(c.current=t.length-1,o(c.current))}};return window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}}),[i.readerType]),d.jsx(f,{ref:p,sx:{display:"flex",flexDirection:"ContinuesHorizontalLTR"===i.readerType?"row":"row-reverse",justifyContent:"ContinuesHorizontalLTR"===i.readerType?"flex-start":"flex-end",width:"auto",height:"auto",overflowX:"visible",userSelect:"none"},onClick:function(e){e.clientX>=.85*window.innerWidth?"ContinuesHorizontalLTR"===i.readerType?g():v():e.clientX<=.15*window.innerWidth&&("ContinuesHorizontalLTR"===i.readerType?v():g())},onWheel:function(e){window.scrollBy({left:"ContinuesHorizontalLTR"===i.readerType?e.deltaY:-1*e.deltaY})},children:t.map((function(e){return d.jsx(Q,{index:e.index,src:e.src,onImageLoad:function(){},settings:i,ref:function(t){h.current[e.index]=t}},e.index)}))})}function ce(e){var t=e.settings,n=e.curPage,r=e.pageCount;return d.jsx(f,{sx:{display:t.showPageNumber?"block":"none",position:"fixed",bottom:"50px",padding:"2px",paddingLeft:"4px",paddingRight:"4px",textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.3)",borderRadius:"10px"},children:"".concat(n+1," / ").concat(r)})}function se(e){var t=e.pages,n=e.settings,r=e.setCurPage,i=e.initialPage,o=e.curPage,a=e.nextChapter,u=e.prevChapter,c=e.chapter,l=s.useRef(null);s.useEffect((function(){var e=t.map((function(e){var t=p.requestImage(e.src);return t.response.catch((function(){})),t}));return function(){e.forEach((function(e){return e.abortRequest(new Error("PagedPager::preload: chapter changed"))}))}}),[c.id]);var h=function(e){r(e),window.scroll({top:0})};function g(){o<t.length-1?h(o+1):n.loadNextOnEnding&&a()}function v(){o>0?h(o-1):u()}function y(){"SingleLTR"===n.readerType?v():"SingleRTL"===n.readerType&&g()}function m(){"SingleLTR"===n.readerType?g():"SingleRTL"===n.readerType&&v()}function x(e){switch(e.key){case"Space":e.preventDefault(),g();break;case"ArrowRight":m();break;case"ArrowLeft":y()}}return s.useEffect((function(){return document.addEventListener("keydown",x),function(){document.removeEventListener("keydown",x)}}),[l,o,n.readerType,u,a]),s.useEffect((function(){setTimeout((function(){h(i)}),0)}),[i]),d.jsx(f,{ref:l,sx:{display:"flex",flexDirection:"column",justifyContent:"center",width:"auto",height:"auto"},onClick:function(e){e.clientX>window.innerWidth/2?m():y()},children:t.map((function(e){var t=e.index,r=e.src;return d.jsx(Q,{index:t,onImageLoad:function(){},src:r,settings:n,display:t===o},r)}))})}function le(e){var t=e.pages,n=e.settings,r=e.setCurPage,i=e.initialPage,l=e.curPage,h=e.chapter,g=e.nextChapter,v=e.prevChapter,y=s.useRef(null),m=s.useRef([]),x=s.useRef([]),w=c(s.useState(Array(t.length).fill(!1)),2),b=w[0],C=w[1],j=c(s.useState(Array(t.length).fill(!1)),2),E=j[0],L=j[1];function R(){var e=function(e){return r(-1===e?t.length-1:e)};if(m.current[t.length-1]&&n.loadNextOnEnding)return l===t.length-1||e(t.length-1),void g();e(m.current.findIndex((function(e,t){return!e&&t>l})))}function k(){var e=function(e){return r(Math.max(e,0))};if(m.current[0])return!l||e(0),void v();e(u(m.current).slice(0,l).findLastIndex((function(e){return!e})))}function P(){"DoubleLTR"===n.readerType?k():R()}function O(){"DoubleLTR"===n.readerType?R():k()}function S(e){switch(e.key){case"Space":e.preventDefault(),R();break;case"ArrowRight":O();break;case"ArrowLeft":P()}}return s.useEffect((function(){return document.addEventListener("keydown",S),function(){document.removeEventListener("keydown",S)}}),[y,l,n.readerType,v,g,E,b]),s.useEffect((function(){r(i)}),[i]),s.useEffect((function(){var e=t.map((function(e){return[e.index,p.requestImage(e.src)]}));return e.forEach(function(){var e,t=(e=o().mark((function e(t){var n,r,i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c(t,2),r=n[0],i=n[1],e.prev=1,e.next=4,i.response;case 4:a=e.sent,(u=new Image).onload=function(){URL.revokeObjectURL(a),L((function(e){return e.toSpliced(r,1,!0)})),C((function(e){return e.toSpliced(r,1,(t=u).height/t.width<1);var t}))},u.src=a,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:case"end":return e.stop()}}),e,null,[[1,10]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){a(o,r,i,u,c,"next",e)}function c(e){a(o,r,i,u,c,"throw",e)}u(void 0)}))});return function(e){return t.apply(this,arguments)}}()),function(){e.forEach((function(e){var t=c(e,2),n=t[0];return t[1].abortRequest(new Error("DoublePagedPager::preload(".concat(n,"): chapter changed")))}))}}),[h.id]),d.jsx(f,{ref:y,onClick:function(e){e.clientX>window.innerWidth/2?O():P()},children:d.jsx(f,{id:"display",sx:{display:"flex",flexDirection:"DoubleLTR"===n.readerType?"row":"row-reverse",justifyContent:"center",width:"auto",height:"auto"},children:t.map((function(e){var t=e.index,r=e.src,i=function(){var e=x.current[l];void 0===e&&(e=Math.max(b.lastIndexOf(!0,l),0),E.slice(0,l).every(Boolean)&&(x.current[l]=e));return e>0?e+1:e}(),o=l-i,a=0===l,u=Number(n.offsetFirstPage)+Number(n.offsetFirstPage&&!o&&!a),c=l+(!((o-u)%2)?1:-1),s=t===l,f=t===c,p=b[l],h=b[c],g=s||f&&!(p||h);return m.current[t]=g,d.jsx(Q,{index:t,src:r,onImageLoad:function(){},settings:n,display:g},r)}))})})}var de=function(){return window.innerHeight+window.scrollY>=document.body.offsetHeight-5};function fe(e){var t=e.pages,n=e.settings,r=e.setCurPage,i=e.initialPage,o=e.nextChapter,a=e.prevChapter,u=s.useRef(i),c=s.useRef(null),p=s.useRef([]);s.useEffect((function(){var e=!1,i=function(){if(c.current)if(de()){if(e)return;e=!0,u.current=t.length-1,r(u.current),n.loadNextOnEnding&&o()}else{e=!1;var i=function(e){for(var t=0;t<e.children.length;t++){var n=e.children.item(t);if(n){var r=n.getBoundingClientRect(),i=r.top,o=r.bottom;if(i<=window.innerHeight&&o>1)return t}}return-1}(c.current);i!==u.current&&(u.current=i,r(i))}};return window.addEventListener("scroll",i),function(){window.removeEventListener("scroll",i)}}),[n.loadNextOnEnding,o]);var h=s.useRef(0),g=s.useRef(!1);function v(e){g.current=!0,window.scrollBy(0,h.current-e.pageY)}function y(e){var t;h.current=e.pageY,null===(t=c.current)||void 0===t||t.addEventListener("mousemove",v)}function m(){var e;null===(e=c.current)||void 0===e||e.removeEventListener("mousemove",v)}s.useEffect((function(){var e,t;return null===(e=c.current)||void 0===e||e.addEventListener("mousedown",y),null===(t=c.current)||void 0===t||t.addEventListener("mouseup",m),function(){var e,t;null===(e=c.current)||void 0===e||e.removeEventListener("mousedown",y),null===(t=c.current)||void 0===t||t.removeEventListener("mouseup",m)}}),[c]);var x=s.useCallback((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95;"down"===e&&de()?o():"up"===e&&window.scrollY<=0?a():window.scroll({top:window.scrollY+window.innerHeight*t*("up"===e?-1:1),behavior:"smooth"})}),[o,a]);return s.useEffect((function(){var e=function(e){switch(e.key){case"Space":case"ArrowRight":e.preventDefault(),x(e.shiftKey?"up":"down");break;case"ArrowDown":e.preventDefault(),x(e.shiftKey?"up":"down",.25);break;case"ArrowUp":e.preventDefault(),x(e.shiftKey?"down":"up",.25);break;case"ArrowLeft":e.preventDefault(),x(e.shiftKey?"down":"up")}};return document.addEventListener("keydown",e,!1),function(){document.removeEventListener("keydown",e)}}),[x]),l(p.current[i],s.useCallback((function(e,t){var n=p.current[i];null!=n&&n.offsetHeight&&(n.scrollIntoView(),t.disconnect())}),[p.current[i],i])),d.jsx(f,{ref:c,sx:{display:"flex",flexDirection:"column",justifyContent:"center",width:"auto",height:"auto",userSelect:"none"},onClick:function(e){g.current?g.current=!1:x(e.clientX>window.innerWidth/2?"down":"up")},children:t.map((function(e){return d.jsx(Q,{index:e.index,src:e.src,onImageLoad:function(){},settings:n,ref:function(t){p.current[e.index]=t}},e.index)}))})}var pe={},he=g;Object.defineProperty(pe,"__esModule",{value:!0});var ge=pe.default=void 0,ve=he(h()),ye=d;ge=pe.default=(0,ve.default)((0,ye.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var me={},xe=g;Object.defineProperty(me,"__esModule",{value:!0});var we=me.default=void 0,be=xe(h()),Ce=d;we=me.default=(0,be.default)((0,Ce.jsx)("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"}),"KeyboardArrowLeft");var je={},Ee=g;Object.defineProperty(je,"__esModule",{value:!0});var Le=je.default=void 0,Re=Ee(h()),ke=d;Le=je.default=(0,Re.default)((0,ke.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight");var Pe={},Oe=g;Object.defineProperty(Pe,"__esModule",{value:!0});var Se=Pe.default=void 0,Te=Oe(h()),De=d;Se=Pe.default=(0,Te.default)((0,De.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown");var Ne={},_e=g;Object.defineProperty(Ne,"__esModule",{value:!0});var Ie=Ne.default=void 0,Ae=_e(h()),We=d;Ie=Ne.default=(0,Ae.default)((0,We.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");var Me={entering:{transform:"none"},entered:{transform:"none"}},ze=s.forwardRef((function(e,n){var i=v(),o={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},a=e.addEndListener,u=e.appear,c=void 0===u||u,l=e.children,f=e.easing,p=e.in,h=e.onEnter,g=e.onEntered,C=e.onEntering,j=e.onExit,E=e.onExited,L=e.onExiting,R=e.style,k=e.timeout,P=void 0===k?o:k,O=e.TransitionComponent,S=void 0===O?x:O,T=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,t),D=s.useRef(null),N=y(D,m(l),n),_=function(e){return function(t){if(e){var n=D.current;void 0===t?e(n):e(n,t)}}},I=_(C),A=_((function(e,t){w(e);var n=b({style:R,timeout:P,easing:f},{mode:"enter"});e.style.webkitTransition=i.transitions.create("transform",n),e.style.transition=i.transitions.create("transform",n),h&&h(e,t)})),W=_(g),M=_(L),z=_((function(e){var t=b({style:R,timeout:P,easing:f},{mode:"exit"});e.style.webkitTransition=i.transitions.create("transform",t),e.style.transition=i.transitions.create("transform",t),j&&j(e)})),H=_(E);return d.jsx(S,r(r({appear:c,in:p,nodeRef:D,onEnter:A,onEntered:W,onEntering:I,onExit:z,onExited:H,onExiting:M,addEndListener:function(e){a&&a(D.current,e)},timeout:P},T),{},{children:function(e,t){return s.cloneElement(l,r({style:r(r(r({transform:"scale(0)",visibility:"exited"!==e||p?void 0:"hidden"},Me[e]),R),l.props.style),ref:N},t))}}))})),He=C("div")({zIndex:10}),Fe=C("div")((function(e){var t=e.theme;return{position:"fixed",top:0,left:0,minWidth:"240px",maxWidth:"400px",height:"100vh",overflowY:"auto",backgroundColor:t.palette.background.default,"& header":{backgroundColor:t.palette.action.hover,display:"flex",alignItems:"center",padding:"".concat(t.spacing(1)," ").concat(t.spacing(3)),transition:"left 2s ease"}}})),Xe=C("div")((function(e){var t=e.theme;return{margin:"0 ".concat(t.spacing(2))}})),Ge=C("div")({display:"flex",flexWrap:"wrap",alignContent:"center",alignItems:"center",justifyContent:"center"}),Ve=C("div")((function(e){var t=e.theme;return{display:"grid",gridTemplateRows:"auto auto auto",gridTemplateColumns:"0fr 1fr 0fr",gridTemplateAreas:'"pre current next"',gridColumnGap:t.spacing(.5),margin:"".concat(t.spacing(1)," 0"),"& a":{textDecoration:"none",color:"inherit",display:"flex",flexWrap:"wrap",alignContent:"center"}}}));function Be(e){var t,n=j().t,i=E().setReaderNavBarWidth,o=v(),a=L(),u=null!==(t=R().state)&&void 0!==t?t:{},f=u.prevDrawerOpen,p=u.prevSettingsCollapseOpen,h=s.useRef(null);l(h,s.useCallback((function(){var e;void 0!==(null===(e=h.current)||void 0===e?void 0:e.offsetWidth)&&i(h.current.offsetWidth)}),[h.current])),s.useLayoutEffect((function(){return function(){return i(0)}}),[h]);var g=e.settings,y=e.setSettingValue,m=e.manga,x=e.chapter,w=e.chapters,b=e.curPage,C=e.scrollToPage,M=e.openNextChapter,z=e.retrievingNextChapter,H=k(),F=s.useMemo((function(){return new Set(w.map((function(e){return e.scanlator}))).size>1}),[w]),X=c(s.useState(g.staticNav||f),2),G=X[0],V=X[1],B=c(s.useState(!0),2),Y=B[0],K=B[1],q=c(s.useState(g.staticNav||f),2),U=q[0],J=q[1],Q=c(s.useState(0),2),ee=Q[0],te=Q[1],ne=c(s.useState(null==p||p),2),ue=ne[0],ce=ne[1],se=z,le=function(e){V(e),J(e)},de=function(){var e=window.pageYOffset;Math.abs(e-ee)>20&&(J(e>ee),te(e))};return s.useEffect((function(){Y&&le(g.staticNav)}),[g.staticNav]),s.useEffect((function(){window.addEventListener("scroll",de);var e=document.querySelector("#root"),t=document.querySelector("#appMainContainer");return e.style.display="flex",e.style.flexDirection="column",t.style.display="none",function(){e.style.display="block",t.style.display="block",window.removeEventListener("scroll",de)}}),[de]),d.jsxs(He,{children:[d.jsx(P,{direction:O("right","left"),in:G,timeout:200,appear:!1,mountOnEnter:!0,unmountOnExit:!0,children:d.jsxs(Fe,{ref:h,children:[d.jsxs("header",{children:[!g.staticNav&&d.jsx(S,{title:n("reader.button.close_menu"),children:d.jsx(T,{edge:"start",color:"inherit","aria-label":"menu",onClick:function(){return le(!1)},size:"large",children:O(d.jsx(we,{}),d.jsx(Le,{}))})}),d.jsx(D,{variant:"h6",component:"h1",sx:{textOverflow:"ellipsis",overflow:"hidden",py:1,flexGrow:1},children:x.name}),d.jsx(S,{title:n("reader.button.exit"),children:d.jsx(T,{edge:"start",color:"inherit","aria-label":"menu",onClick:H,size:"large",sx:{mr:-1},children:d.jsx(ge,{})})})]}),d.jsxs(N,{ContainerComponent:"div",sx:{"& span":{fontWeight:"bold"}},children:[d.jsx(_,{primary:n("reader.settings.title.reader_settings")}),d.jsxs(T,{edge:"start",color:"inherit","aria-label":"menu",disableRipple:!0,disableFocusRipple:!0,onClick:function(){return ce(!ue)},size:"large",children:[ue&&d.jsx(Ie,{}),!ue&&d.jsx(Se,{})]})]}),d.jsx(oe,{in:ue,timeout:"auto",unmountOnExit:!0,children:d.jsx(Z,{setSettingValue:function(e,t,n){K("staticNav"!==e),y(e,t,n)},staticNav:g.staticNav,showPageNumber:g.showPageNumber,loadNextOnEnding:g.loadNextOnEnding,skipDupChapters:g.skipDupChapters,fitPageToWindow:g.fitPageToWindow,scalePage:g.scalePage,readerType:g.readerType,offsetFirstPage:g.offsetFirstPage,readerWidth:g.readerWidth})}),d.jsx(I,{sx:{my:1,mx:2}}),d.jsxs(Xe,{children:[d.jsxs(Ge,{children:[d.jsx("span",{children:n("reader.page_info.label.currently_on_page")}),d.jsx(ae,{size:"small",sx:{mx:.5},disabled:se||-1===x.pageCount,children:d.jsx(re,{value:x.pageCount>-1?"".concat(b):"",displayEmpty:!0,onChange:function(e){var t=e.target.value;C(Number(t))},children:Array(Math.max(0,x.pageCount)).fill(1).map((function(e,t){return d.jsx(A,{value:t,children:t+1},"Page#".concat(t))}))})}),d.jsx("span",{children:n("reader.page_info.label.of_max_pages",{maxPages:x.pageCount})})]}),d.jsxs(Ve,{children:[d.jsx(S,{title:n("reader.button.previous_chapter"),children:d.jsx(T,{sx:{gridArea:"pre"},disabled:se||x.sourceOrder<=1,onClick:function(){return M($.PREV)},children:O(d.jsx(we,{}),d.jsx(Le,{}))})}),d.jsx(ae,{sx:{gridArea:"current"},size:"small",disabled:se||x.sourceOrder<1,children:d.jsx(re,{value:x.sourceOrder>=1?"".concat(x.sourceOrder):"",displayEmpty:!0,onChange:function(e){var t=e.target.value;a("/manga/".concat(m.id,"/chapter/").concat(t),{replace:!0,state:{prevDrawerOpen:G,prevSettingsCollapseOpen:ue}})},children:w.map((function(e){var t=e.id,n=e.sourceOrder,r=e.name,i=e.chapterNumber,o=e.scanlator;return d.jsx(A,{value:n,children:"#".concat(i).concat(F&&null!=o?" (".concat(o,")"):""," | ").concat(r)},t)}))})}),d.jsx(S,{title:n("reader.button.next_chapter"),children:d.jsx(T,{sx:{gridArea:"next"},disabled:se||x.sourceOrder<1||x.sourceOrder>=m.chapters.totalCount,onClick:function(){return M($.NEXT)},children:O(d.jsx(Le,{}),d.jsx(we,{}))})})]})]})]})}),d.jsx(ze,{in:!G,children:d.jsx(W,{in:!U,children:d.jsx(S,{title:n("reader.button.open_menu"),children:d.jsx(ie,{sx:r({position:"fixed",top:20,left:20,backgroundColor:"rgba(255, 255, 255, 0.75);",color:"black"},o.applyStyles("dark",{backgroundColor:"rgba(0, 0, 0, 0.75);",color:"white"})),size:"large",variant:"contained",onClick:function(){return le(!0)},children:O(d.jsx(Le,{}),d.jsx(we,{}))})})})})]})}var Ye=function(e){return J.getFromCache(e,q,"CHAPTER_READER_FIELDS")},Ke=function(e){switch(e){case"ContinuesVertical":case"Webtoon":default:return fe;case"SingleVertical":case"SingleRTL":case"SingleLTR":return se;case"DoubleVertical":case"DoubleRTL":case"DoubleLTR":return le;case"ContinuesHorizontalLTR":case"ContinuesHorizontalRTL":return n}},qe=function(e){return Array.from({length:e},(function(e,t){return t}))},Ue={pageCount:-1,sourceOrder:-1,chapterCount:0,lastPageRead:0,name:"Loading...",manga:{id:-1}}}}}))}();
