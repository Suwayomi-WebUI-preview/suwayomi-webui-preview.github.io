import{r as P,i as q,j as e,u as k,c as s,N as z,a as i,aY as H,y as $,g as U,E as V,h as Q,B as u,Q as W,aC as Y,aD as J,aE as K,b as T,T as X,S as Z,f as S,I as v}from"./index-DZ-5g2aw.js";import{D as ee,S as te,P as ae,d as oe}from"./StrictModeDroppable-Ch-pF7gF.js";import{d as re}from"./Add-uQg-crvA.js";import{d as se}from"./Delete-9wPI8iBN.js";import{D as ne,F as le}from"./StyledFab-BAF3HdpG.js";import{T as ie}from"./TextField-BtH_qrtk.js";import{F as ce,C as de}from"./Checkbox-DmLnCKXw.js";import{C as ge,a as ue}from"./CardContent-bbrcNva4.js";import"./SwitchBase-BxnmDjOC.js";var y={},pe=q;Object.defineProperty(y,"__esModule",{value:!0});var F=y.default=void 0,fe=pe(P()),xe=e;F=y.default=(0,fe.default)((0,xe.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");const me=({category:a,provided:n,onEdit:c})=>{const{t:r}=k(),p=()=>{i.deleteCategory(a.id)};return e.jsx(u,{sx:{p:1,pb:0},...n.draggableProps,...n.dragHandleProps,ref:n.innerRef,children:e.jsx(ge,{children:e.jsxs(ue,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:1.5,"&:last-child":{paddingBottom:1.5},gap:2},children:[e.jsx(oe,{}),e.jsx(X,{sx:{flexGrow:1},variant:"h6",component:"h2",children:a.name}),e.jsxs(Z,{sx:{flexDirection:"row"},children:[e.jsx(S,{title:r("global.button.edit"),children:e.jsx(v,{component:u,onClick:c,size:"large",children:e.jsx(F,{})})}),e.jsx(S,{title:r("chapter.action.download.delete.label.action"),children:e.jsx(v,{component:u,onClick:p,size:"large",children:e.jsx(se,{})})})]})]})})})};function Se(){const{t:a}=k(),{setTitle:n,setAction:c}=s.useContext(z);s.useEffect(()=>(n(a("category.title.category_other")),c(null),()=>{n(""),c(null)}),[a]);const{data:r,loading:p,error:b,refetch:I}=i.useGetCategories(H,{notifyOnNetworkStatusChange:!0}),l=s.useMemo(()=>{var o;const t=[...(o=r==null?void 0:r.categories.nodes)!=null?o:[]];return t.length>0&&t[0].name==="Default"&&t.shift(),t},[r]),[f,D]=s.useState(-1),[R,d]=s.useState(!1),[x,m]=s.useState(""),[h,C]=s.useState(!1),[B,{reset:w}]=i.useReorderCategory(),E=$(),O=(t,o,g)=>{const j=t[o];B({variables:{input:{id:j.id,position:g+1}}}).catch(()=>w())},A=t=>{t.destination&&O(l,t.source.index,t.destination.index)},G=()=>{m(""),C(!1),D(-1)},L=()=>{G(),d(!0)},M=t=>{m(l[t].name),C(l[t].default),D(t),d(!0)},_=()=>{d(!1)},N=()=>{if(d(!1),f===-1)i.createCategory({name:x,default:h});else{const t=l[f];i.updateCategory(t.id,{name:x,default:h})}};return p?e.jsx(U,{}):b?e.jsx(V,{message:a("category.error.label.request_failure"),messageExtra:b.message,retry:()=>I().catch(Q())}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{onDragEnd:A,children:e.jsx(te,{droppableId:"droppable",children:t=>e.jsxs(u,{ref:t.innerRef,sx:{paddingBottom:ne},children:[l.map((o,g)=>e.jsx(ae,{draggableId:o.id.toString(),index:g,children:j=>e.jsx(me,{provided:j,category:o,onEdit:()=>M(g)})},o.id)),t.placeholder]})})}),e.jsx(le,{color:"primary","aria-label":"add",style:{position:"fixed",bottom:E.spacing(2),right:E.spacing(2)},onClick:L,children:e.jsx(re,{})}),e.jsxs(W,{open:R,onClose:_,children:[e.jsx(Y,{id:"form-dialog-title",children:a(f===-1?"category.dialog.title.new_category":"category.dialog.title.edit_category")}),e.jsxs(J,{children:[e.jsx(ie,{autoFocus:!0,margin:"dense",id:"name",label:a("category.label.category_name"),type:"text",fullWidth:!0,value:x,onChange:t=>m(t.target.value)}),e.jsx(ce,{control:e.jsx(de,{checked:h,onChange:t=>C(t.target.checked)}),label:a("category.label.use_as_default_category")})]}),e.jsxs(K,{children:[e.jsx(T,{onClick:_,color:"primary",children:a("global.button.cancel")}),e.jsx(T,{onClick:N,color:"primary",children:a("global.button.submit")})]})]})]})}export{Se as Categories};
