import{r as $,i as D,j as e,aR as u,d as G,T as H,e as K,aC as J,O as Q,aS as X,ag as Y,a8 as g,u as Z,f as S,N as ee,c as h,l as re,E as te,m as W,aT as L,v,aU as k,aK as x,az as l,aV as se,aW as T,aM as y}from"./index-DCoLbMjA.js";var C={},ae=D;Object.defineProperty(C,"__esModule",{value:!0});var P=C.default=void 0,oe=ae($()),ne=e;P=C.default=(0,oe.default)((0,ne.jsx)("path",{d:"M18.32 4.26C16.84 3.05 15.01 2.25 13 2.05v2.02c1.46.18 2.79.76 3.9 1.62zM19.93 11h2.02c-.2-2.01-1-3.84-2.21-5.32L18.31 7.1c.86 1.11 1.44 2.44 1.62 3.9m-1.62 5.9 1.43 1.43c1.21-1.48 2.01-3.32 2.21-5.32h-2.02c-.18 1.45-.76 2.78-1.62 3.89M13 19.93v2.02c2.01-.2 3.84-1 5.32-2.21l-1.43-1.43c-1.1.86-2.43 1.44-3.89 1.62M13 12V7h-2v5H7l5 5 5-5zm-2 7.93v2.02c-5.05-.5-9-4.76-9-9.95s3.95-9.45 9-9.95v2.02C7.05 4.56 4 7.92 4 12s3.05 7.44 7 7.93"}),"Downloading");const ie=(r,a,t,o=!1)=>t===u.Downloading?e.jsx(P,{}):r?e.jsx(J,{size:15}):!a||t===u.Error?e.jsx(Q,{}):o?e.jsx(X,{}):e.jsx(Y,{}),le=(r,a,t,o,b=0)=>o===u.Downloading?g("global.update.label.updating",{progress:b}):o===u.Error?g("global.update.label.update_failure"):r?g("global.update.label.checking"):t?g("global.update.label.check_failure"):a?g("global.update.label.available"):g("global.update.label.up_to_date"),R=({version:r,isCheckingForUpdate:a,isUpdateAvailable:t,updateCheckError:o,checkForUpdate:b,triggerUpdate:n,updateState:d,progress:p,downloadAsLink:m,url:f})=>{const j=d===u.Downloading,i=()=>{if(j)return;if(!t||o||d===u.Error){b();return}t&&(n==null||n())};return e.jsxs(G,{sx:{alignItems:"start"},children:[e.jsx(H,{component:"span",variant:"body2",children:r}),e.jsx(K,{sx:{marginTop:"5px",backgroundColor:"transparent",pointerEvents:j?"none":"unset"},size:"small",variant:"outlined",startIcon:ie(a,t,d,m),onClick:i,...f&&t?{href:f,target:"_blank"}:void 0,children:le(a,t,o,d,p)})]})};function ce(){var w,E,F;const{t:r}=Z(),{setTitle:a,setAction:t}=S.useContext(ee);S.useLayoutEffect(()=>(a(r("settings.about.title")),t(null),()=>{a(""),t(null)}),[r]);const{data:o,loading:b,error:n,refetch:d}=h.useGetAbout({notifyOnNetworkStatusChange:!0}),{data:p,loading:m,refetch:f,error:j}=h.useCheckForServerUpdate({notifyOnNetworkStatusChange:!0}),{data:i,loading:I,refetch:M,error:q}=h.useCheckForWebUIUpdate({notifyOnNetworkStatusChange:!0}),A=q||(i==null?void 0:i.checkForWebUIUpdate.tag)==="",{data:U}=h.useGetWebUIUpdateStatus(),{state:z,progress:B}=(w=U==null?void 0:U.getWebUIUpdateStatus)!=null?w:{state:u.Idle,progress:0};if(b)return e.jsx(re,{});if(n)return e.jsx(te,{message:r("global.error.label.failed_to_load_data"),messageExtra:n.message,retry:()=>d().catch(W())});const{aboutServer:s,aboutWebUI:_}=o,c=(E=p==null?void 0:p.checkForServerUpdates)==null?void 0:E.find(V=>V.channel===s.buildType),N=!!(c!=null&&c.tag)&&c.tag!==L(s),O=!!(i!=null&&i.checkForWebUIUpdate.updateAvailable);return e.jsxs(v,{sx:{pt:0},children:[e.jsxs(v,{sx:{padding:0},subheader:e.jsx(k,{component:"div",id:"about-server-info",children:r("settings.server.title.server")}),children:[e.jsx(x,{children:e.jsx(l,{primary:r("settings.server.title.server"),secondary:"".concat(s.name," ").concat(s.buildType)})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.server.label.version"),secondary:e.jsx(R,{version:L(s),isCheckingForUpdate:m,isUpdateAvailable:N,updateCheckError:j,checkForUpdate:f,downloadAsLink:!0,url:(F=c==null?void 0:c.url)!=null?F:""})})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.server.label.build_time"),secondary:se(s)})})]}),e.jsx(T,{}),e.jsxs(v,{sx:{padding:0},subheader:e.jsx(k,{component:"div",id:"about-webui-info",children:r("settings.webui.title.webui")}),children:[e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.webui.label.channel"),secondary:_.channel.toLocaleUpperCase()})}),e.jsx(x,{children:e.jsx(l,{primary:r("settings.about.webui.label.version"),secondary:e.jsx(R,{version:_.tag,isCheckingForUpdate:I,isUpdateAvailable:O,updateCheckError:A,checkForUpdate:M,triggerUpdate:()=>h.updateWebUI().response.catch(W()),progress:B,updateState:z})})})]}),e.jsx(T,{}),e.jsxs(v,{subheader:e.jsx(k,{component:"div",id:"about-links",children:r("global.label.links")}),children:[e.jsx(y,{to:s.github,target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("settings.about.server.label.github"),secondary:s.github})}),e.jsx(y,{to:"https://github.com/Suwayomi/Suwayomi-WebUI",target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("settings.about.webui.label.github"),secondary:"https://github.com/Suwayomi/Suwayomi-WebUI"})}),e.jsx(y,{to:s.discord,target:"_blank",rel:"noreferrer",children:e.jsx(l,{primary:r("global.label.discord"),secondary:s.discord})})]})]})}export{ce as About};
