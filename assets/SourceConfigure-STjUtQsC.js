import{j as e,c as h,am as I,U as k,u as V,az as b,H as D,ar as L,as as O,aR as R,at as B,b as j,R as w,N as A,V as H,a as E,h as N,E as _,k as G,v as U}from"./index-D6RYBNhe.js";import{c as T}from"./cloneObject-DrOPTG0J.js";import{S as W}from"./Switch-uJK7KaYC.js";import{C as F,F as q}from"./Checkbox-CMGh2nfj.js";import{F as z,L as $}from"./ListPreference-BkA9zf4t.js";import{T as J}from"./TextField-BsPhsFsz.js";import"./SwitchBase-B0rT0SwT.js";function K(t){return t==="Switch"?W:F}const Q=t=>t.type==="CheckBoxPreference"?{title:t.CheckBoxTitle,defaultValue:t.CheckBoxDefault,currentValue:t.CheckBoxCheckBoxCurrentValue}:{title:t.SwitchPreferenceTitle,defaultValue:t.SwitchPreferenceDefault,currentValue:t.SwitchPreferenceCurrentValue};function M(t){const{title:a,defaultValue:i,currentValue:n,summary:f,updateValue:m,twoStateType:s}={...t,...Q(t)},[o,u]=h.useState(n!=null?n:i);h.useEffect(()=>{u(n!=null?n:i)},[n]);const x=h.useMemo(()=>K(s),[s]);return e.jsxs(I,{children:[e.jsx(k,{primary:a,secondary:f}),e.jsx(x,{edge:"end",checked:o,onChange:()=>{m(s==="Switch"?"switchState":"checkBoxState",!n),u(!n)}})]})}function X(t){return e.jsx(M,{...t,twoStateType:"Checkbox"})}function Y(t){return e.jsx(M,{...t,twoStateType:"Switch"})}function Z(t){const{t:a}=V(),{EditTextPreferenceTitle:i,summary:n,dialogTitle:f,dialogMessage:m,EditTextPreferenceCurrentValue:s,updateValue:o}=t,[u,x]=h.useState(s!=null?s:""),[C,d]=h.useState(!1),c=()=>{d(!1),x(s!=null?s:"")},l=()=>{d(!1),o("editTextState",u)};return e.jsxs(e.Fragment,{children:[e.jsx(b,{onClick:()=>d(!0),children:e.jsx(k,{primary:i,secondary:n})}),e.jsxs(D,{open:C,onClose:c,children:[e.jsx(L,{children:f}),e.jsxs(O,{children:[e.jsx(R,{children:m}),e.jsx(J,{autoFocus:!0,margin:"dense",id:"name",type:"text",fullWidth:!0,value:u,onChange:p=>x(p.target.value)})]}),e.jsxs(B,{children:[e.jsx(j,{onClick:c,color:"primary",children:a("global.button.cancel")}),e.jsx(j,{onClick:l,color:"primary",children:a("global.button.ok")})]})]})]})}function v(t){const{t:a}=V(),{selectedValues:i,open:n,onClose:f,values:m,title:s}=t,[o,u]=w.useState(i);w.useEffect(()=>{n||u(i)},[i,n]);const x=()=>{f(null)},C=()=>{f(o)},d=(c,l)=>{const{checked:p}=c.target,S=o.some(r=>l===r);if(p){if(!S){const r=T(o);r.push(l),u(r)}}else if(S){const r=T(o),g=r.indexOf(l);r.splice(g,1),u(r)}};return e.jsxs(D,{sx:{"& .MuiDialog-paper":{width:"80%",maxHeight:435}},maxWidth:"xs",open:n,children:[e.jsx(L,{children:s}),e.jsx(O,{dividers:!0,children:e.jsx(z,{children:m.map(c=>e.jsx(q,{control:e.jsx(F,{checked:o.some(l=>c===l),onChange:l=>d(l,c),color:"default"}),label:c},c))})}),e.jsxs(B,{children:[e.jsx(j,{autoFocus:!0,onClick:x,children:a("global.button.cancel")}),e.jsx(j,{onClick:C,children:a("global.button.ok")})]})]})}function ee(t){const{MultiSelectListPreferenceTitle:a,summary:i,MultiSelectListPreferenceCurrentValue:n,MultiSelectListPreferenceDefault:f,updateValue:m,entryValues:s,entries:o}=t,[u,x]=h.useState(n!=null?n:f),[C,d]=h.useState(!1);h.useEffect(()=>{x(n)},[n]);const c=r=>{var g;return(g=r==null?void 0:r.map(P=>{const y=s.indexOf(P);return o[y]}))!=null?g:[]},l=r=>{var g;return(g=r==null?void 0:r.map(P=>{const y=o.indexOf(P);return s[y]}))!=null?g:[]},p=()=>i,S=r=>{r!==null&&(m("multiSelectState",l(r)),x(r)),d(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(b,{onClick:()=>d(!0),children:e.jsx(k,{primary:a,secondary:p()})}),e.jsx(v,{title:a!=null?a:"",open:C,onClose:S,selectedValues:c(u),values:o})]})}function te(t){switch(t){case"CheckBoxPreference":return X;case"SwitchPreference":return Y;case"ListPreference":return $;case"EditTextPreference":return Z;case"MultiSelectListPreference":return ee;default:throw new Error('Unexpected preference type "'.concat(t,'"'))}}function ie(){var C;const{t}=V(),{setTitle:a,setAction:i}=h.useContext(A);h.useEffect(()=>(a(t("source.configuration.title")),i(null),()=>{a(""),i(null)}),[t]);const{sourceId:n}=H(),{data:f,loading:m,error:s,refetch:o}=E.useGetSource(n,{notifyOnNetworkStatusChange:!0}),u=(C=f==null?void 0:f.source.preferences)!=null?C:[],x=d=>(c,l)=>{E.setSourcePreferences(n,{position:d,[c]:l})};return m?e.jsx(N,{}):s?e.jsx(_,{message:t("global.error.label.failed_to_load_data"),messageExtra:s.message,retry:()=>o().catch(G())}):e.jsx(U,{sx:{padding:0},children:u.map((d,c)=>{const l=T(d);return h.createElement(te(d.type),{...l,updateValue:x(c)})})})}export{ie as SourceConfigure};
