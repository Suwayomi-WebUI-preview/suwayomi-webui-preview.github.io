import{r as Ye,i as Ze,j as r,u as H,s as le,f as j,ao as Xe,aJ as et,aK as tt,l as de,aH as Oe,m as ue,d as w,T as be,bI as rt,aq as Le,cW as at,bq as st,aM as nt,e as oe,n as T,o as z,z as he,at as Be,ag as it,k as ae,bC as We,ap as Re,a2 as ot,B as V,cX as Ve,cY as ct,cZ as lt,C as dt,a as ut,c_ as ht,c$ as pt,I as xe,Q as gt,d0 as mt,N as ft,d1 as Ct,M as bt,d2 as I,g as xt,E as jt,w as je,aV as Ae,aL as G,aA as Y,bQ as we,ay as Z,d3 as Te}from"./index-C-NRbn2J.js";import{N as At}from"./NumberSetting-CWXMAhoj.js";import{b as wt}from"./Languages-D1pzpYSw.js";import{T as ve}from"./TextField-DbGGHPPy.js";import{d as Tt}from"./CheckCircle-Di2xQ0qU.js";import{d as vt}from"./Edit-BQ1Fjoyq.js";import{S as Se}from"./Switch-Cx6nj76p.js";import"./Info-s1022MQE.js";import"./InputAdornment-Ba1B_yfN.js";var pe={},St=Ze;Object.defineProperty(pe,"__esModule",{value:!0});var Pe=pe.default=void 0,yt=St(Ye()),kt=r;Pe=pe.default=(0,yt.default)((0,kt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddCircle");class R extends Error{constructor(t,a){super(t+" at position "+a),this.position=a}}const X=92,ie=47,Nt=42,ye=123,ee=125,ke=91,te=93,_t=40,Dt=41,It=32,ge=10,Qe=9,Fe=13,Et=8,Mt=12,ne=34,Ne=43,_e=45,Ue=39,qe=48,Je=57,E=44,re=46,Ot=58,Lt=59,Bt=65,Wt=97,Rt=69,Vt=101,Pt=70,Qt=102,Ft=160,Ut=8192,qt=8202,Jt=8239,Kt=8287,$t=12288,zt=8220,Ht=8221,Gt=8216,Yt=8217,Zt=96,Xt=180;function er(e){return e>=qe&&e<=Je||e>=Bt&&e<=Pt||e>=Wt&&e<=Qt}function M(e){return e>=qe&&e<=Je}function tr(e){return e>=32&&e<=1114111}function P(e){return rr.test(e)}const rr=/^[,:[\]/{}()\n+]$/;function ar(e){return P(e)&&e!=="/"}function De(e){return sr.test(e)||e&&se(e.charCodeAt(0))}const sr=/^[[{\w-]$/;function nr(e){return e===ge||e===Fe||e===Qe||e===Et||e===Mt}function Q(e){return e===It||e===ge||e===Qe||e===Fe}function ir(e){return e===Ft||e>=Ut&&e<=qt||e===Jt||e===Kt||e===$t}function se(e){return Ke(e)||ce(e)}function Ke(e){return e===ne||e===zt||e===Ht}function Ie(e){return e===ne}function ce(e){return e===Ue||e===Gt||e===Yt||e===Zt||e===Xt}function Ee(e){return e===Ue}function K(e,t){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.lastIndexOf(t);return i!==-1?e.substring(0,i)+(a?"":e.substring(i+1)):e}function A(e,t){let a=e.length;if(!Q(e.charCodeAt(a-1)))return e+t;for(;Q(e.charCodeAt(a-1));)a--;return e.substring(0,a)+t+e.substring(a)}function or(e,t,a){return e.substring(0,t)+e.substring(t+a)}function cr(e){return/[,\n][ \t\r]*$/.test(e)}function lr(e){return/^\w+$/.test(e)}const dr={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},ur={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"};function hr(e){let t=0,a="";g()||ze();const f=c(E);for(f&&o(),De(e[t])&&cr(a)?(f||(a=A(a,",")),O()):f&&(a=K(a,","));e.charCodeAt(t)===ee||e.charCodeAt(t)===te;)t++,o();if(t>=e.length)return a;fe();function g(){o();const s=y()||F()||x()||B()||l()||k();return o(),s}function o(){const s=t;let n=d();do n=C(),n&&(n=d());while(n);return t>s}function d(){let s="",n;for(;(n=Q(e.charCodeAt(t)))||ir(e.charCodeAt(t));)n?s+=e[t]:s+=" ",t++;return s.length>0?(a+=s,!0):!1}function C(){if(e.charCodeAt(t)===ie&&e.charCodeAt(t+1)===Nt){for(;t<e.length&&!pr(e,t);)t++;return t+=2,!0}if(e.charCodeAt(t)===ie&&e.charCodeAt(t+1)===ie){for(;t<e.length&&e.charCodeAt(t)!==ge;)t++;return!0}return!1}function c(s){return e.charCodeAt(t)===s?(a+=e[t],t++,!0):!1}function m(s){return e.charCodeAt(t)===s?(t++,!0):!1}function p(){return m(X)}function S(){return o(),e.charCodeAt(t)===re&&e.charCodeAt(t+1)===re&&e.charCodeAt(t+2)===re?(t+=3,o(),m(E),!0):!1}function y(){if(e.charCodeAt(t)===ye){a+="{",t++,o(),m(E)&&o();let s=!0;for(;t<e.length&&e.charCodeAt(t)!==ee;){let n;if(s?(n=!0,s=!1):(n=c(E),n||(a=A(a,",")),o()),S(),!(x()||k())){e.charCodeAt(t)===ee||e.charCodeAt(t)===ye||e.charCodeAt(t)===te||e.charCodeAt(t)===ke||e[t]===void 0?a=K(a,","):He();break}o();const q=c(Ot),W=t>=e.length;q||(De(e[t])||W?a=A(a,":"):Ce()),g()||(q||W?a+="null":Ce())}return e.charCodeAt(t)===ee?(a+="}",t++):a=A(a,"}"),!0}return!1}function F(){if(e.charCodeAt(t)===ke){a+="[",t++,o(),m(E)&&o();let s=!0;for(;t<e.length&&e.charCodeAt(t)!==te;)if(s?s=!1:c(E)||(a=A(a,",")),S(),!g()){a=K(a,",");break}return e.charCodeAt(t)===te?(a+="]",t++):a=A(a,"]"),!0}return!1}function O(){let s=!0,n=!0;for(;n;)s?s=!1:c(E)||(a=A(a,",")),n=g();n||(a=K(a,",")),a="[\n".concat(a,"\n]")}function x(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=e.charCodeAt(t)===X;if(n&&(t++,n=!0),se(e.charCodeAt(t))){const _=Ie(e.charCodeAt(t))?Ie:Ee(e.charCodeAt(t))?Ee:ce(e.charCodeAt(t))?ce:Ke,q=t,W=a.length;let h='"';for(t++;;){if(t>=e.length){const b=v(t-1);return!s&&P(e.charAt(b))?(t=q,a=a.substring(0,W),x(!0)):(h=A(h,'"'),a+=h,!0)}else if(_(e.charCodeAt(t))){const b=t,D=h.length;if(h+='"',t++,a+=h,o(),s||t>=e.length||P(e.charAt(t))||se(e.charCodeAt(t))||M(e.charCodeAt(t)))return L(),!0;if(P(e.charAt(v(b-1))))return t=q,a=a.substring(0,W),x(!0);a=a.substring(0,W),t=b+1,h=h.substring(0,D)+"\\"+h.substring(D)}else{if(s&&P(e[t]))return h=A(h,'"'),a+=h,L(),!0;if(e.charCodeAt(t)===X){const b=e.charAt(t+1);if(ur[b]!==void 0)h+=e.slice(t,t+2),t+=2;else if(b==="u"){let J=2;for(;J<6&&er(e.charCodeAt(t+J));)J++;J===6?(h+=e.slice(t,t+6),t+=6):t+J>=e.length?t=e.length:Ge()}else h+=b,t+=2}else{const b=e.charAt(t),D=e.charCodeAt(t);D===ne&&e.charCodeAt(t-1)!==X?(h+="\\"+b,t++):nr(D)?(h+=dr[b],t++):(tr(D)||me(b),h+=b,t++)}}n&&p()}}return!1}function L(){let s=!1;for(o();e.charCodeAt(t)===Ne;){s=!0,t++,o(),a=K(a,'"',!0);const n=a.length;x()?a=or(a,n,1):a=A(a,'"')}return s}function B(){const s=t;if(e.charCodeAt(t)===_e){if(t++,N())return U(s),!0;if(!M(e.charCodeAt(t)))return t=s,!1}for(;M(e.charCodeAt(t));)t++;if(e.charCodeAt(t)===re){if(t++,N())return U(s),!0;if(!M(e.charCodeAt(t)))return t=s,!1;for(;M(e.charCodeAt(t));)t++}if(e.charCodeAt(t)===Vt||e.charCodeAt(t)===Rt){if(t++,(e.charCodeAt(t)===_e||e.charCodeAt(t)===Ne)&&t++,N())return U(s),!0;if(!M(e.charCodeAt(t)))return t=s,!1;for(;M(e.charCodeAt(t));)t++}if(!N())return t=s,!1;if(t>s){const n=e.slice(s,t),_=/^0\d/.test(n);return a+=_?'"'.concat(n,'"'):n,!0}return!1}function l(){return u("true","true")||u("false","false")||u("null","null")||u("True","true")||u("False","false")||u("None","null")}function u(s,n){return e.slice(t,t+s.length)===s?(a+=n,t+=s.length,!0):!1}function k(){const s=t;for(;t<e.length&&!ar(e[t])&&!se(e.charCodeAt(t));)t++;if(t>s){if(e.charCodeAt(t)===_t&&lr(e.slice(s,t).trim()))return t++,g(),e.charCodeAt(t)===Dt&&(t++,e.charCodeAt(t)===Lt&&t++),!0;{for(;Q(e.charCodeAt(t-1))&&t>0;)t--;const n=e.slice(s,t);return a+=n==="undefined"?"null":JSON.stringify(n),e.charCodeAt(t)===ne&&t++,!0}}}function v(s){let n=s;for(;n>0&&Q(e.charCodeAt(n));)n--;return n}function N(){return t>=e.length||P(e[t])||Q(e.charCodeAt(t))}function U(s){a+=e.slice(s,t)+"0"}function me(s){throw new R("Invalid character "+JSON.stringify(s),t)}function fe(){throw new R("Unexpected character "+JSON.stringify(e[t]),t)}function ze(){throw new R("Unexpected end of json string",e.length)}function He(){throw new R("Object key expected",t)}function Ce(){throw new R("Colon expected",t)}function Ge(){const s=e.slice(t,t+6);throw new R('Invalid unicode character "'.concat(s,'"'),t)}}function pr(e,t){return e[t]==="*"&&e[t+1]==="/"}const gr={id:"",isCustom:!0,getName:()=>"",muiTheme:{palette:{primary:{main:"#1976d2"},secondary:{main:"#9c27b0"}}}},$={create:{title:"settings.appearance.theme.create.title",button:"global.button.ok",action:"settings.appearance.theme.create.action",success:"settings.appearance.theme.create.success",failure:"settings.appearance.theme.create.failure"},edit:{title:"settings.appearance.theme.edit.title",button:"global.button.save",action:"settings.appearance.theme.edit.action",success:"settings.appearance.theme.edit.success",failure:"settings.appearance.theme.edit.failure"}},$e=({bindDialogProps:e,mode:t,appTheme:a=gr})=>{const{t:i}=H(),{settings:{customThemes:f},request:{loading:g,error:o,refetch:d}}=le(),C=he(l=>{throw l}),[c,m]=j.useState(a),[p,S]=j.useState(!1),[y,F]=j.useState(!1),[O,x]=j.useState(!1),[L,B]=j.useState(t==="create");return r.jsxs(Xe,{...e,fullWidth:!0,maxWidth:"md",children:[r.jsx(et,{children:i($[t].title)}),r.jsxs(tt,{children:[g&&r.jsx(de,{}),o&&r.jsx(Oe,{message:i("global.error.label.failed_to_load_data"),messageExtra:o.message,retry:()=>d().catch(ue())}),!o&&r.jsxs(w,{sx:{gap:2},children:[r.jsx(be,{children:r.jsxs(rt,{i18nKey:"settings.appearance.theme.create.dialog.info.creating_theme",children:["Create a custom theme with the"," ",r.jsx(Le,{href:"https://zenoo.github.io/mui-theme-creator/",target:"_blank",rel:"noreferrer",children:"MUI Theme Creator"})," ",', copy everything after "themeOptions" from "',"{",'" to "',"}",'" and paste it into the "theme" text field.']})}),r.jsx(be,{children:i("settings.appearance.theme.create.dialog.info.theme_mode_lock")}),r.jsx(ve,{disabled:t==="edit",label:i("settings.appearance.theme.create.dialog.theme_name"),value:c.getName(),error:p,helperText:p&&i("settings.appearance.theme.create.dialog.error.invalid_name"),onChange:l=>{const u=l.target.value.trim(),k=u.length<=16,v=at(u,f);S(!k||!v),m({...c,id:l.target.value,getName:()=>l.target.value})}}),r.jsx(ve,{label:i("settings.appearance.theme.title"),multiline:!0,error:y,helperText:y&&i("settings.appearance.theme.create.dialog.error.invalid_json"),defaultValue:JSON.stringify(c.muiTheme,null,2),onChange:l=>{const u="invalid",k=(()=>{try{return hr(l.target.value)}catch(fe){return u}})(),v=st(k),N=k===u||!v,U=JSON.stringify(v)!==JSON.stringify(a.muiTheme);B(t==="create"?!0:U),F(N),!N&&JSON.stringify(v)!==JSON.stringify(c.muiTheme)&&m({...c,muiTheme:v})}})]})]}),r.jsxs(nt,{children:[r.jsx(oe,{autoFocus:!0,onClick:e.onClose,color:"primary",children:i("global.button.cancel")}),r.jsx(oe,{disabled:y||p||O||!L||!c.id.length,onClick:l=>{T(i($[t].action,{theme:c.getName()}),"info"),x(!0),C("customThemes",{...f,[c.id]:c}).then(()=>{T(i($[t].success,{theme:c.getName()}),"success"),e.onClose(l)}).catch(u=>T(i($[t].failure,{theme:c.getName()}),"error",z(u))).finally(()=>x(!1))},color:"primary",children:i($[t].button)})]})]})},mr=()=>{const{t:e}=H(),t=Be({variant:"popover",popupId:"theme-creation-dialog"});return r.jsxs(r.Fragment,{children:[r.jsxs(w,{sx:{alignItems:"center",gap:1,minWidth:"150px",maxWidth:"150px"},children:[r.jsx(oe,{sx:{width:"100%",height:"225px"},variant:"contained",size:"large",...it(t),children:r.jsx(Pe,{fontSize:"large"})}),r.jsx(ae,{title:e("settings.appearance.theme.create.title"),placement:"top",children:r.jsx(We,{sx:{maxWidth:"100%"},children:e("settings.appearance.theme.create.title")})})]}),t.isOpen&&r.jsx($e,{bindDialogProps:Re(t),mode:"create"})]})},Me=ot(V)(()=>({width:"15px",height:"20px"})),fr=({theme:e,onDelete:t})=>{const{getName:a}=e,{t:i}=H(),{themeMode:f,setAppTheme:g,appTheme:o,pureBlackMode:d}=j.useContext(Ve),C=Be({variant:"popover",popupId:"theme-edit-dialog-".concat(e.id)}),c=e.id===o,m=j.useMemo(()=>ct(f,e,d),[e,f,d]);return r.jsxs(r.Fragment,{children:[r.jsxs(w,{sx:{justifyContent:"center",alignItems:"center",minWidth:"150px",maxWidth:"150px",gap:1},children:[r.jsx(lt,{theme:m,children:r.jsxs(dt,{sx:{width:"100%",height:"225px",position:"relative"},children:[r.jsx(V,{sx:{position:"absolute",top:0,right:0,bottom:0,left:0,border:"4px solid",borderColor:c?m.palette.primary.light:m.palette.background.paper,zIndex:1,pointerEvents:"none",borderRadius:1}}),r.jsx(ut,{sx:{height:"100%",backgroundColor:"background.default"},onClick:()=>{if(!ht(e.muiTheme)){g(e.id);return}T(i("settings.appearance.theme.select.fonts.loading"),"info"),pt(e.muiTheme).then(()=>g(e.id)).catch(S=>T(i("settings.appearance.theme.select.fonts.error"),"error",z(S)))},children:r.jsxs(w,{sx:{height:"100%",m:0},children:[r.jsxs(w,{sx:{height:"100%",gap:2,p:2},children:[r.jsxs(w,{sx:{maxHeight:"20px",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"},children:[r.jsx(V,{sx:{width:"65%",height:"20px",backgroundColor:"primary.dark",borderRadius:1}}),r.jsxs(w,{sx:{alignItems:"center",gap:1,mt:-.25},children:[c&&r.jsx(Tt,{sx:{visibility:c?"visible":"hidden",color:"primary.light"}}),!c&&e.isCustom&&r.jsx(xe,{onClick:p=>{p.preventDefault(),p.stopPropagation(),t()},component:"div",size:"small",sx:{mt:-.5},children:r.jsx(ae,{title:i("global.button.delete"),children:r.jsx(gt,{})})}),e.isCustom&&r.jsx(xe,{onClick:p=>{p.preventDefault(),p.stopPropagation(),C.open()},component:"div",size:"small",children:r.jsx(ae,{title:i("global.button.edit"),children:r.jsx(vt,{})})})]})]}),r.jsx(V,{sx:{width:"55%",height:"65%",backgroundColor:"background.paper",p:1,borderRadius:1},children:r.jsxs(w,{sx:{width:"max-content",flexDirection:"row",overflow:"hidden",borderRadius:1},children:[r.jsx(Me,{sx:{backgroundColor:"primary.main"}}),r.jsx(Me,{sx:{backgroundColor:"secondary.main"}})]})})]}),r.jsxs(w,{sx:{height:"25%",backgroundColor:m.palette.background.paper,alignItems:"center",flexDirection:"row",gap:2,p:2},children:[r.jsx(V,{sx:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"primary.main"}}),r.jsx(V,{sx:{flexGrow:1,height:"20px",borderRadius:1,backgroundColor:"primary.light"}})]})]})})]})}),r.jsx(ae,{title:a(),placement:"top",children:r.jsx(We,{sx:{maxWidth:"100%"},children:a()})})]}),r.jsx($e,{bindDialogProps:Re(C),mode:"edit",appTheme:e})]})},Cr=()=>{const{t:e}=H(),{settings:{customThemes:t},request:{loading:a,error:i,refetch:f}}=le(),g=j.useMemo(()=>[...mt,...Object.values(t).map(d=>({...d,getName:()=>d.id}))],[t]),o=he(d=>{throw d});return a?r.jsx(de,{}):i?r.jsx(Oe,{message:e("global.error.label.failed_to_load_data"),messageExtra:i.message,retry:()=>f().catch(ue())}):r.jsxs(w,{sx:{flexDirection:"row",flexWrap:"no-wrap",alignItems:"start",overflowX:"auto",gap:1,mx:2},children:[r.jsx(mr,{}),g.map(d=>r.jsx(fr,{theme:d,onDelete:()=>{T(e("settings.appearance.theme.delete.action",{theme:d.getName()}),"info"),o("customThemes",Object.fromEntries(Object.entries(t).filter(([C])=>C!==d.id))).then(()=>T(e("settings.appearance.theme.delete.success",{theme:d.getName()}),"success")).catch(C=>T(e("settings.appearance.theme.delete.failure",{theme:d.getName()}),"error",z(C)))}},d.id))]})},kr=()=>{var B;const{t:e,i18n:t}=H(),{themeMode:a,setThemeMode:i,pureBlackMode:f,setPureBlackMode:g,appTheme:o}=j.useContext(Ve),{setTitle:d,setAction:C}=j.useContext(ft);j.useLayoutEffect(()=>(d(e("settings.appearance.title")),C(null),()=>{d(""),C(null)}),[e]);const{settings:c,request:{loading:m,error:p,refetch:S}}=le(),y=he(l=>T(e("global.error.label.failed_to_save_changes"),"error",z(l))),F=((B=Ct(o).muiTheme.palette)==null?void 0:B.mode)==="dark"||bt.getThemeMode()===I.DARK,O=300,[x,L]=xt("ItemWidth",O);return m?r.jsx(de,{}):p?r.jsx(jt,{message:e("global.error.label.failed_to_load_data"),messageExtra:p.message,retry:()=>S().catch(ue())}):r.jsxs(je,{subheader:r.jsx(Ae,{component:"div",id:"appearance-theme",children:e("settings.appearance.theme.title")}),children:[r.jsxs(G,{children:[r.jsx(Y,{primary:e("settings.appearance.theme.mode")}),r.jsxs(we,{value:a,onChange:l=>i(l.target.value),children:[r.jsx(Z,{value:I.SYSTEM,children:"System"},I.SYSTEM),r.jsx(Z,{value:I.DARK,children:"Dark"},I.DARK),r.jsx(Z,{value:I.LIGHT,children:"Light"},I.LIGHT)]})]}),r.jsx(Cr,{}),F&&r.jsxs(G,{children:[r.jsx(Y,{primary:e("settings.appearance.theme.pure_black_mode")}),r.jsx(Se,{checked:f,onChange:(l,u)=>g(u)})]}),r.jsxs(je,{subheader:r.jsx(Ae,{component:"div",id:"appearance-theme",children:e("global.label.display")}),children:[r.jsxs(G,{children:[r.jsx(Y,{primary:e("global.language.label.language"),secondary:r.jsxs(r.Fragment,{children:[r.jsxs("span",{children:[e("settings.label.language_description")," "]}),r.jsx(Le,{href:"https://hosted.weblate.org/projects/suwayomi/suwayomi-webui",target:"_blank",rel:"noreferrer",children:e("global.language.title.weblate")})]})}),r.jsx(we,{value:Te.includes(t.language)?t.language:"en",onChange:({target:{value:l}})=>t.changeLanguage(l,u=>{u&&T(e("global.language.error.load"),"error",z(u))}),children:Te.map(l=>r.jsx(Z,{value:l,children:wt(l)},l))})]}),r.jsx(At,{settingTitle:e("settings.label.manga_item_width"),settingValue:"px: ".concat(x),value:x,defaultValue:O,minValue:100,maxValue:1e3,stepSize:10,valueUnit:"px",showSlider:!0,handleUpdate:L}),r.jsxs(G,{children:[r.jsx(Y,{primary:e("settings.appearance.manga_thumbnail_backdrop.title"),secondary:e("settings.appearance.manga_thumbnail_backdrop.description")}),r.jsx(Se,{edge:"end",checked:c.mangaThumbnailBackdrop,onChange:l=>y("mangaThumbnailBackdrop",l.target.checked)})]})]})]})};export{kr as Appearance};
