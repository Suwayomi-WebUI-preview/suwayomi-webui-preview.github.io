(function(){"use strict";const T=s=>s.toLowerCase().trim(),r=s=>T(s).replace(/[^a-zA-Z0-9\\s]+/g," ").trim(),a=s=>{const n=Object.groupBy(s,({title:t})=>r(t));return Object.fromEntries(Object.entries(n).filter(t=>{var c,e;return((e=(c=t[1])==null?void 0:c.length)!=null?e:0)>1}).map(([,t])=>[t[0].title,t]))},D=(s,n)=>{const t=r(s.title),c={byTitle:[s],byAlternativeTitle:[s]};return n.forEach(e=>{var o;if(!(s.id!==e.id))return;const l=r(e.title)===t,u=r((o=e==null?void 0:e.description)!=null?o:"").includes(t);(l||u)&&(l&&c.byTitle.push(e),u&&c.byAlternativeTitle.push(e))}),c},h=s=>{const n={},t={};s.forEach(e=>{var p,o;const i=r(e.title);(p=n[i])!=null||(n[i]=[]),(o=t[i])!=null||(t[i]=[]);const{byTitle:l,byAlternativeTitle:u}=D(e,s);n[i].push(...l),t[i].push(...u)});const c=Object.entries(n).map(([e,i])=>{var d;const l=new Set(i),u=new Set((d=t[e])!=null?d:[]),p=[...l][0].title,o=[...l,...u],f=[...new Set([...o])];return f.length===1?null:[p,f]}).filter(e=>!!e);return Object.fromEntries(c)};self.onmessage=async s=>{const{mangas:n}=s.data,{checkAlternativeTitles:t}=s.data;if(t){postMessage(h(n));return}postMessage(a(n))}})();
