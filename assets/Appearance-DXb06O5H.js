import{r as qe,i as He,j as r,u as z,p as Ne,c as j,K as Ge,aA as Ye,aB as Ze,g as De,az as Ie,h as _e,S as w,T as ee,ca as Xe,b5 as et,aC as tt,b as ie,m as T,bj as Oe,Q as Ee,z as rt,O as Me,s as st,B as R,cb as Le,cc as nt,bE as at,cd as it,I as pe,f as me,ce as ot,cf as ct,M as lt,cg as _,N as ut,d as dt,k as fe,aO as ge,as as se,_ as ne,Y as q,ch as Ce}from"./index-DrMaLApM.js";import{S as be}from"./Select-BPexeUAg.js";import{N as ht}from"./NumberSetting-CMsxWZno.js";import{b as pt}from"./language-BWNlW24O.js";import{T as mt}from"./Trans-DgbcZQPv.js";import{L as Be}from"./Link-BzZzh5QK.js";import{T as xe}from"./TextField-aIlb05nB.js";import{d as ft}from"./CheckCircle-bCfQw2NS.js";import{d as gt}from"./Delete-ChLidWWe.js";import{d as Ct}from"./Edit-CGjEIqfD.js";import{C as bt}from"./Card-7woGM9TE.js";import{C as xt}from"./CardActionArea-fvZ2Eb_P.js";import{S as jt}from"./Switch-O3WcZxr7.js";import"./Info-BytbeKyX.js";import"./InputAdornment-B2WSPuJe.js";import"./SwitchBase-NTpreOjo.js";var ce={},At=He;Object.defineProperty(ce,"__esModule",{value:!0});var Re=ce.default=void 0,wt=At(qe()),vt=r;Re=ce.default=(0,wt.default)((0,vt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddCircle");class B extends Error{constructor(t,s){super(t+" at position "+s),this.position=s}}const H=92,ae=47,Tt=42,je=123,G=125,Ae=91,Y=93,St=40,yt=41,kt=32,le=10,We=9,Pe=13,Nt=8,Dt=12,te=34,we=43,ve=45,Qe=39,Ve=48,Ue=57,O=44,Z=46,It=58,_t=59,Ot=65,Et=97,Mt=69,Lt=101,Bt=70,Rt=102,Wt=160,Pt=8192,Qt=8202,Vt=8239,Ut=8287,Ft=12288,Kt=8220,Jt=8221,zt=8216,$t=8217,qt=96,Ht=180;function Gt(e){return e>=Ve&&e<=Ue||e>=Ot&&e<=Bt||e>=Et&&e<=Rt}function E(e){return e>=Ve&&e<=Ue}function Yt(e){return e>=32&&e<=1114111}function W(e){return Zt.test(e)}const Zt=/^[,:[\]/{}()\n+]$/;function Xt(e){return W(e)&&e!=="/"}function Te(e){return er.test(e)||e&&X(e.charCodeAt(0))}const er=/^[[{\w-]$/;function tr(e){return e===le||e===Pe||e===We||e===Nt||e===Dt}function P(e){return e===kt||e===le||e===We||e===Pe}function rr(e){return e===Wt||e>=Pt&&e<=Qt||e===Vt||e===Ut||e===Ft}function X(e){return Fe(e)||oe(e)}function Fe(e){return e===te||e===Kt||e===Jt}function Se(e){return e===te}function oe(e){return e===Qe||e===zt||e===$t||e===qt||e===Ht}function ye(e){return e===Qe}function K(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.lastIndexOf(t);return i!==-1?e.substring(0,i)+(s?"":e.substring(i+1)):e}function A(e,t){let s=e.length;if(!P(e.charCodeAt(s-1)))return e+t;for(;P(e.charCodeAt(s-1));)s--;return e.substring(0,s)+t+e.substring(s)}function sr(e,t,s){return e.substring(0,t)+e.substring(t+s)}function nr(e){return/[,\n][ \t\r]*$/.test(e)}function ar(e){return/^\w+$/.test(e)}const ir={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},or={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"};function cr(e){let t=0,s="";m()||Je();const p=c(O);for(p&&o(),Te(e[t])&&nr(s)?(p||(s=A(s,",")),Q()):p&&(s=K(s,","));e.charCodeAt(t)===G||e.charCodeAt(t)===Y;)t++,o();if(t>=e.length)return s;de();function m(){o();const n=S()||g()||y()||re()||x()||k();return o(),n}function o(){const n=t;let a=l();do a=b(),a&&(a=l());while(a);return t>n}function l(){let n="",a;for(;(a=P(e.charCodeAt(t)))||rr(e.charCodeAt(t));)a?n+=e[t]:n+=" ",t++;return n.length>0?(s+=n,!0):!1}function b(){if(e.charCodeAt(t)===ae&&e.charCodeAt(t+1)===Tt){for(;t<e.length&&!lr(e,t);)t++;return t+=2,!0}if(e.charCodeAt(t)===ae&&e.charCodeAt(t+1)===ae){for(;t<e.length&&e.charCodeAt(t)!==le;)t++;return!0}return!1}function c(n){return e.charCodeAt(t)===n?(s+=e[t],t++,!0):!1}function d(n){return e.charCodeAt(t)===n?(t++,!0):!1}function h(){return d(H)}function M(){return o(),e.charCodeAt(t)===Z&&e.charCodeAt(t+1)===Z&&e.charCodeAt(t+2)===Z?(t+=3,o(),d(O),!0):!1}function S(){if(e.charCodeAt(t)===je){s+="{",t++,o(),d(O)&&o();let n=!0;for(;t<e.length&&e.charCodeAt(t)!==G;){let a;if(n?(a=!0,n=!1):(a=c(O),a||(s=A(s,",")),o()),M(),!(y()||k())){e.charCodeAt(t)===G||e.charCodeAt(t)===je||e.charCodeAt(t)===Y||e.charCodeAt(t)===Ae||e[t]===void 0?s=K(s,","):ze();break}o();const U=c(It),L=t>=e.length;U||(Te(e[t])||L?s=A(s,":"):he()),m()||(U||L?s+="null":he())}return e.charCodeAt(t)===G?(s+="}",t++):s=A(s,"}"),!0}return!1}function g(){if(e.charCodeAt(t)===Ae){s+="[",t++,o(),d(O)&&o();let n=!0;for(;t<e.length&&e.charCodeAt(t)!==Y;)if(n?n=!1:c(O)||(s=A(s,",")),M(),!m()){s=K(s,",");break}return e.charCodeAt(t)===Y?(s+="]",t++):s=A(s,"]"),!0}return!1}function Q(){let n=!0,a=!0;for(;a;)n?n=!1:c(O)||(s=A(s,",")),a=m();a||(s=K(s,",")),s="[\n".concat(s,"\n]")}function y(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=e.charCodeAt(t)===H;if(a&&(t++,a=!0),X(e.charCodeAt(t))){const D=Se(e.charCodeAt(t))?Se:ye(e.charCodeAt(t))?ye:oe(e.charCodeAt(t))?oe:Fe,U=t,L=s.length;let u='"';for(t++;;){if(t>=e.length){const f=v(t-1);return!n&&W(e.charAt(f))?(t=U,s=s.substring(0,L),y(!0)):(u=A(u,'"'),s+=u,!0)}else if(D(e.charCodeAt(t))){const f=t,I=u.length;if(u+='"',t++,s+=u,o(),n||t>=e.length||W(e.charAt(t))||X(e.charCodeAt(t))||E(e.charCodeAt(t)))return $(),!0;if(W(e.charAt(v(f-1))))return t=U,s=s.substring(0,L),y(!0);s=s.substring(0,L),t=f+1,u=u.substring(0,I)+"\\"+u.substring(I)}else{if(n&&W(e[t]))return u=A(u,'"'),s+=u,$(),!0;if(e.charCodeAt(t)===H){const f=e.charAt(t+1);if(or[f]!==void 0)u+=e.slice(t,t+2),t+=2;else if(f==="u"){let F=2;for(;F<6&&Gt(e.charCodeAt(t+F));)F++;F===6?(u+=e.slice(t,t+6),t+=6):t+F>=e.length?t=e.length:$e()}else u+=f,t+=2}else{const f=e.charAt(t),I=e.charCodeAt(t);I===te&&e.charCodeAt(t-1)!==H?(u+="\\"+f,t++):tr(I)?(u+=ir[f],t++):(Yt(I)||ue(f),u+=f,t++)}}a&&h()}}return!1}function $(){let n=!1;for(o();e.charCodeAt(t)===we;){n=!0,t++,o(),s=K(s,'"',!0);const a=s.length;y()?s=sr(s,a,1):s=A(s,'"')}return n}function re(){const n=t;if(e.charCodeAt(t)===ve){if(t++,N())return V(n),!0;if(!E(e.charCodeAt(t)))return t=n,!1}for(;E(e.charCodeAt(t));)t++;if(e.charCodeAt(t)===Z){if(t++,N())return V(n),!0;if(!E(e.charCodeAt(t)))return t=n,!1;for(;E(e.charCodeAt(t));)t++}if(e.charCodeAt(t)===Lt||e.charCodeAt(t)===Mt){if(t++,(e.charCodeAt(t)===ve||e.charCodeAt(t)===we)&&t++,N())return V(n),!0;if(!E(e.charCodeAt(t)))return t=n,!1;for(;E(e.charCodeAt(t));)t++}if(!N())return t=n,!1;if(t>n){const a=e.slice(n,t),D=/^0\d/.test(a);return s+=D?'"'.concat(a,'"'):a,!0}return!1}function x(){return C("true","true")||C("false","false")||C("null","null")||C("True","true")||C("False","false")||C("None","null")}function C(n,a){return e.slice(t,t+n.length)===n?(s+=a,t+=n.length,!0):!1}function k(){const n=t;for(;t<e.length&&!Xt(e[t])&&!X(e.charCodeAt(t));)t++;if(t>n){if(e.charCodeAt(t)===St&&ar(e.slice(n,t).trim()))return t++,m(),e.charCodeAt(t)===yt&&(t++,e.charCodeAt(t)===_t&&t++),!0;{for(;P(e.charCodeAt(t-1))&&t>0;)t--;const a=e.slice(n,t);return s+=a==="undefined"?"null":JSON.stringify(a),e.charCodeAt(t)===te&&t++,!0}}}function v(n){let a=n;for(;a>0&&P(e.charCodeAt(a));)a--;return a}function N(){return t>=e.length||W(e[t])||P(e.charCodeAt(t))}function V(n){s+=e.slice(n,t)+"0"}function ue(n){throw new B("Invalid character "+JSON.stringify(n),t)}function de(){throw new B("Unexpected character "+JSON.stringify(e[t]),t)}function Je(){throw new B("Unexpected end of json string",e.length)}function ze(){throw new B("Object key expected",t)}function he(){throw new B("Colon expected",t)}function $e(){const n=e.slice(t,t+6);throw new B('Invalid unicode character "'.concat(n,'"'),t)}}function lr(e,t){return e[t]==="*"&&e[t+1]==="/"}const ur={id:"",isCustom:!0,getName:()=>"",muiTheme:{palette:{primary:{main:"#1976d2"},secondary:{main:"#9c27b0"}}}},J={create:{title:"settings.appearance.theme.create.title",button:"global.button.ok",action:"settings.appearance.theme.create.action",success:"settings.appearance.theme.create.success",failure:"settings.appearance.theme.create.failure"},edit:{title:"settings.appearance.theme.edit.title",button:"global.button.save",action:"settings.appearance.theme.edit.action",success:"settings.appearance.theme.edit.success",failure:"settings.appearance.theme.edit.failure"}},Ke=({bindDialogProps:e,mode:t,appTheme:s=ur})=>{const{t:i}=z(),{settings:{customThemes:p},request:{loading:m,error:o,refetch:l}}=Ne(),b=Oe(x=>{throw x}),[c,d]=j.useState(s),[h,M]=j.useState(!1),[S,g]=j.useState(!1),[Q,y]=j.useState(!1),[$,re]=j.useState(t==="create");return r.jsxs(Ge,{...e,fullWidth:!0,maxWidth:"md",children:[r.jsx(Ye,{children:i(J[t].title)}),r.jsxs(Ze,{children:[m&&r.jsx(De,{}),o&&r.jsx(Ie,{message:i("global.error.label.failed_to_load_data"),messageExtra:o.message,retry:()=>l().catch(_e())}),!o&&r.jsxs(w,{sx:{gap:2},children:[r.jsx(ee,{children:r.jsxs(mt,{i18nKey:"settings.appearance.theme.create.dialog.info.creating_theme",children:["Create a custom theme with the"," ",r.jsx(Be,{href:"https://zenoo.github.io/mui-theme-creator/",target:"_blank",rel:"noreferrer",children:"MUI Theme Creator"})," ",', copy everything after "themeOptions" from "',"{",'" to "',"}",'" and paste it into the "theme" text field.']})}),r.jsx(ee,{children:i("settings.appearance.theme.create.dialog.info.theme_mode_lock")}),r.jsx(xe,{disabled:t==="edit",label:i("settings.appearance.theme.create.dialog.theme_name"),value:c.getName(),error:h,helperText:h&&i("settings.appearance.theme.create.dialog.error.invalid_name"),onChange:x=>{const C=x.target.value.trim(),k=C.length<=16,v=Xe(C,p);M(!k||!v),d({...c,id:x.target.value,getName:()=>x.target.value})}}),r.jsx(xe,{label:i("settings.appearance.theme.title"),multiline:!0,error:S,helperText:S&&i("settings.appearance.theme.create.dialog.error.invalid_json"),defaultValue:JSON.stringify(c.muiTheme,null,2),onChange:x=>{const C="invalid",k=(()=>{try{return cr(x.target.value)}catch(de){return C}})(),v=et(k),N=k===C||!v,V=JSON.stringify(v)!==JSON.stringify(s.muiTheme);re(t==="create"?!0:V),g(N),!N&&JSON.stringify(v)!==JSON.stringify(c.muiTheme)&&d({...c,muiTheme:v})}})]})]}),r.jsxs(tt,{children:[r.jsx(ie,{autoFocus:!0,onClick:e.onClose,color:"primary",children:i("global.button.cancel")}),r.jsx(ie,{disabled:S||h||Q||!$||!c.id.length,onClick:x=>{T(i(J[t].action,{theme:c.getName()}),"info"),y(!0),b("customThemes",{...p,[c.id]:c}).then(()=>{T(i(J[t].success,{theme:c.getName()}),"success"),e.onClose(x)}).catch(()=>T(i(J[t].failure,{theme:c.getName()}),"error")).finally(()=>y(!1))},color:"primary",children:i(J[t].button)})]})]})},dr=()=>{const{t:e}=z(),t=Ee({variant:"popover",popupId:"theme-creation-dialog"});return r.jsxs(r.Fragment,{children:[r.jsxs(w,{sx:{alignItems:"center",gap:1},children:[r.jsx(ie,{sx:{minWidth:"150px",maxWidth:"150px",height:"225px"},variant:"contained",size:"large",...rt(t),children:r.jsx(Re,{})}),r.jsx(ee,{children:e("settings.appearance.theme.create.title")})]}),t.isOpen&&r.jsx(Ke,{bindDialogProps:Me(t),mode:"create"})]})},ke=st(R)(()=>({width:"15px",height:"20px"})),hr=({theme:e,onDelete:t})=>{const{getName:s}=e,{t:i}=z(),{themeMode:p,setAppTheme:m,appTheme:o,pureBlackMode:l}=j.useContext(Le),b=Ee({variant:"popover",popupId:"theme-edit-dialog-".concat(e.id)}),c=e.id===o,d=j.useMemo(()=>nt(p,e,l),[e,p,l]);return r.jsxs(r.Fragment,{children:[r.jsxs(w,{sx:{justifyContent:"center",alignItems:"center",minWidth:"150px",maxWidth:"150px",gap:1},children:[r.jsx(at,{theme:d,children:r.jsxs(bt,{sx:{width:"100%",height:"225px",position:"relative"},children:[r.jsx(R,{sx:{position:"absolute",top:0,right:0,bottom:0,left:0,border:"4px solid",borderColor:c?d.palette.primary.light:d.palette.background.paper,zIndex:1,pointerEvents:"none",borderRadius:1}}),r.jsx(xt,{sx:{height:"100%",backgroundColor:"background.default"},onClick:()=>{T(i("settings.appearance.theme.select.fonts.loading"),"info"),it(e.muiTheme).then(()=>{m(e.id),T(i("settings.appearance.theme.select.success"),"success")}).catch(()=>T(i("settings.appearance.theme.select.fonts.error"),"error"))},children:r.jsxs(w,{sx:{height:"100%",m:0},children:[r.jsxs(w,{sx:{height:"100%",gap:2,p:2},children:[r.jsxs(w,{sx:{maxHeight:"20px",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[r.jsx(R,{sx:{width:"65%",height:"20px",backgroundColor:"primary.dark",borderRadius:1}}),r.jsxs(w,{sx:{height:"100%",alignItems:"center",gap:1},children:[c&&r.jsx(ft,{sx:{visibility:c?"visible":"hidden",color:"primary.light"}}),!c&&e.isCustom&&r.jsx(pe,{onClick:h=>{h.preventDefault(),h.stopPropagation(),t()},component:"div",size:"small",children:r.jsx(me,{title:i("global.button.delete"),children:r.jsx(gt,{})})}),e.isCustom&&r.jsx(pe,{onClick:h=>{h.preventDefault(),h.stopPropagation(),b.open()},component:"div",size:"small",children:r.jsx(me,{title:i("global.button.edit"),children:r.jsx(Ct,{})})})]})]}),r.jsx(R,{sx:{width:"55%",height:"65%",backgroundColor:"background.paper",p:1,borderRadius:1},children:r.jsxs(w,{sx:{width:"max-content",flexDirection:"row",overflow:"hidden",borderRadius:1},children:[r.jsx(ke,{sx:{backgroundColor:"primary.main"}}),r.jsx(ke,{sx:{backgroundColor:"secondary.main"}})]})})]}),r.jsxs(w,{sx:{height:"25%",backgroundColor:d.palette.background.paper,alignItems:"center",flexDirection:"row",gap:2,p:2},children:[r.jsx(R,{sx:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"primary.main"}}),r.jsx(R,{sx:{flexGrow:1,height:"20px",borderRadius:1,backgroundColor:"primary.light"}})]})]})})]})}),r.jsx(ee,{children:s()})]}),r.jsx(Ke,{bindDialogProps:Me(b),mode:"edit",appTheme:e})]})},pr=()=>{const{t:e}=z(),{settings:{customThemes:t},request:{loading:s,error:i,refetch:p}}=Ne(),m=j.useMemo(()=>[...ot,...Object.values(t).map(l=>({...l,getName:()=>l.id}))],[t]),o=Oe(l=>{throw l});return s?r.jsx(De,{}):i?r.jsx(Ie,{message:e("global.error.label.failed_to_load_data"),messageExtra:i.message,retry:()=>p().catch(_e())}):r.jsxs(w,{sx:{flexDirection:"row",flexWrap:"no-wrap",overflowX:"auto",gap:1,mx:2},children:[r.jsx(dr,{}),m.map(l=>r.jsx(hr,{theme:l,onDelete:()=>{T(e("settings.appearance.theme.delete.action",{theme:l.getName()}),"info"),o("customThemes",Object.fromEntries(Object.entries(t).filter(([b])=>b!==l.id))).then(()=>T(e("settings.appearance.theme.delete.success",{theme:l.getName()}),"success")).catch(()=>T(e("settings.appearance.theme.delete.failure",{theme:l.getName()}),"error"))}},l.id))]})},Ir=()=>{var S;const{t:e,i18n:t}=z(),{themeMode:s,setThemeMode:i,pureBlackMode:p,setPureBlackMode:m,appTheme:o}=j.useContext(Le),l=((S=ct(o).muiTheme.palette)==null?void 0:S.mode)==="dark"||lt.getThemeMode()===_.DARK,{setTitle:b,setAction:c}=j.useContext(ut);j.useEffect(()=>(b(e("settings.appearance.title")),c(null),()=>{b(""),c(null)}),[e]);const d=300,[h,M]=dt("ItemWidth",d);return r.jsxs(fe,{subheader:r.jsx(ge,{component:"div",id:"appearance-theme",children:e("settings.appearance.theme.title")}),children:[r.jsxs(se,{children:[r.jsx(ne,{primary:e("settings.appearance.theme.device_theme")}),r.jsxs(be,{value:s,onChange:g=>i(g.target.value),children:[r.jsx(q,{value:_.SYSTEM,children:"System"},_.SYSTEM),r.jsx(q,{value:_.DARK,children:"Dark"},_.DARK),r.jsx(q,{value:_.LIGHT,children:"Light"},_.LIGHT)]})]}),r.jsx(pr,{}),l&&r.jsxs(se,{children:[r.jsx(ne,{primary:e("settings.appearance.theme.pure_black_mode")}),r.jsx(jt,{checked:p,onChange:(g,Q)=>m(Q)})]}),r.jsxs(fe,{subheader:r.jsx(ge,{component:"div",id:"appearance-theme",children:e("global.label.display")}),children:[r.jsxs(se,{children:[r.jsx(ne,{primary:e("global.language.label.language"),secondary:r.jsxs(r.Fragment,{children:[r.jsxs("span",{children:[e("settings.label.language_description")," "]}),r.jsx(Be,{href:"https://hosted.weblate.org/projects/suwayomi/suwayomi-webui",target:"_blank",rel:"noreferrer",children:e("global.language.title.weblate")})]})}),r.jsx(be,{value:Ce.includes(t.language)?t.language:"en",onChange:({target:{value:g}})=>t.changeLanguage(g),children:Ce.map(g=>r.jsx(q,{value:g,children:pt(g)},g))})]}),r.jsx(ht,{settingTitle:e("settings.label.manga_item_width"),settingValue:"px: ".concat(h),value:h,defaultValue:d,minValue:100,maxValue:1e3,stepSize:10,valueUnit:"px",showSlider:!0,handleUpdate:M})]})]})};export{Ir as Appearance};
