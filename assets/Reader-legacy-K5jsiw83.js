!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=["page","pagesIndex","isCurrentPage","isLeadingPage","isTrailingPage","totalPages","showDraggingStyle","primaryPageLoadState","secondaryPageLoadState","createProgressBarSlot"],r=["direction"],n=["title","type","disabled"],i=["pageScaleMode","shouldStretchPage","updateSetting"],a=["readingMode","setReadingMode"],o=["readingDirection","setReadingDirection"];function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=y(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function a(r,n,i,a){var l=n&&n.prototype instanceof s?n:s,u=Object.create(l.prototype);return c(u,"_invoke",function(r,n,i){var a,s,l,u=0,c=i||[],d=!1,p={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,r){return a=t,s=0,l=e,p.n=r,o}};function g(r,n){for(s=r,l=n,t=0;!d&&u&&!i&&t<c.length;t++){var i,a=c[t],g=p.p,f=a[2];r>3?(i=f===n)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=g&&((i=r<2&&g<a[1])?(s=0,p.v=n,p.n=a[1]):g<f&&(i=r<3||a[0]>n||n>f)&&(a[4]=r,a[5]=n,p.n=f,s=0))}if(i||r>1)return o;throw d=!0,n}return function(i,c,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&g(c,f),s=c,l=f;(t=s<2?e:l)||!d;){a||(s?s<3?(s>1&&(p.n=-1),g(s,l)):p.n=l:p.v=l);try{if(u=2,a){if(s||(i="next"),t=a[i]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),s=1);a=e}else if((t=(d=p.n<0)?l:r.call(n,p))!==o)break}catch(t){a=e,s=1,l=t}finally{u=1}}return{value:t,done:d}}}(r,i,a),!0),u}var o={};function s(){}function l(){}function d(){}t=Object.getPrototypeOf;var p=[][n]?t(t([][n]())):(c(t={},n,function(){return this}),t),g=d.prototype=s.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e}return l.prototype=d,c(g,"constructor",d),c(d,"constructor",l),l.displayName="GeneratorFunction",c(d,i,"GeneratorFunction"),c(g),c(g,i,"Generator"),c(g,n,function(){return this}),c(g,"toString",function(){return"[object Generator]"}),(u=function(){return{w:a,m:f}})()}function c(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}c=function(e,t,r,n){function a(t,r){c(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},c(e,t,r,n)}function d(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function p(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(e){d(a,n,i,o,s,"next",e)}function s(e){d(a,n,i,o,s,"throw",e)}o(void 0)})}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function h(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){m(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function m(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,r||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return P(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(e,t):void 0}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./index-legacy-DmSjrV4i.js","./ReaderSettingsTabs-legacy-BkRQHnOb.js","./Strings-legacy-CzJ32ydF.js","./Chapters-legacy-DA7OdGIu.js","./PushPin-legacy-MzzYwGTm.js","./PushPinOutlined-legacy-ByPQ41uO.js","./Link-legacy-CiH9a_jf.js","./Select-legacy-Cim6SzSF.js","./useManageMangaLibraryState-legacy-CU4fYoKg.js","./index-legacy-CcKrAXOc.js","./ChapterListCard-legacy-CeDW-kjW.js","./Download-legacy-CjnNyGF5.js","./Delete-legacy-BShVBRrd.js","./ChapterCardMetadata-legacy-8Nh9N_OQ.js","./IconWebView-legacy-B8zTTigp.js","./Mangas-legacy-DfSp_KLs.js","./CheckboxInput-legacy-BOaVBiyc.js","./EmptyViewAbsoluteCentered-legacy-CQVHEvyI.js","./SpinnerImage-legacy-DGdCt8a-.js","./use-window-event-legacy-CZr_B_RD.js","./use-merged-ref-legacy-CpGn6jJX.js","./useAppTitle-legacy-BKPMj4TZ.js","./TabsMenu-legacy-BbK4d6u6.js","./Tabs-legacy-rC48gdvH.js","./Trans-legacy-Me7B_BqB.js","./Slider-legacy-Vpjp1lmw.js","./ListSubheader-legacy-CzfKk4FZ.js","./Add-legacy-DjuMJUQa.js","./DateHelper-legacy-Dpu_eXwz.js","./Asserts-legacy-CzJeEoyM.js","./ThreeStateCheckboxInput-legacy-Doj96B86.js","./Checkbox-legacy-CLk3Spsj.js","./SwitchBase-legacy-B6OcK_c9.js","./FormGroup-legacy-CXusLPnU.js","./DoneAll-legacy-2hmvBgtv.js","./MUI.util-legacy-D9xMlHDR.js","./ListCardContent-legacy-CFg7LLNE.js","./Card-legacy-C73-ukat.js","./CardActionArea-legacy-BEKK79LW.js","./Refresh-legacy-4bLOAOpy.js"],function(e,c){"use strict";var d,f,v,b,y,P,j,w,T,E,I,M,D,O,R,L,k,A,N,B,_,W,V,H,z,U,F,G,X,Y,Z,K,q,J,$,Q,ee,te,re,ne,ie,ae,oe,se,le,ue,ce,de,pe,ge,fe,he,ve,xe,me,be,Se,Ce,ye,Pe,je,we,Te,Ee,Ie,Me,De,Oe,Re,Le,ke,Ae,Ne,Be,_e,We,Ve,He,ze,Ue,Fe,Ge,Xe,Ye,Ze,Ke,qe,Je,$e,Qe,et,tt,rt,nt,it,at,ot,st,lt,ut,ct,dt,pt,gt,ft,ht,vt,xt,mt,bt,St,Ct,yt,Pt,jt,wt,Tt,Et,It,Mt,Dt,Ot,Rt,Lt,kt,At,Nt,Bt,_t,Wt,Vt,Ht,zt,Ut,Ft,Gt,Xt,Yt,Zt,Kt,qt,Jt,$t,Qt,er,tr,rr,nr,ir,ar,or,sr,lr,ur,cr,dr,pr,gr,fr,hr,vr,xr,mr,br,Sr,Cr,yr,Pr,jr,wr,Tr,Er,Ir,Mr,Dr,Or,Rr,Lr,kr,Ar,Nr,Br,_r,Wr,Vr,Hr,zr,Ur,Fr,Gr,Xr,Yr,Zr,Kr,qr;return{setters:[function(e){d=e.cP,f=e.b,v=e.cQ,b=e.j,y=e.i,P=e.at,j=e.n,w=e.cR,T=e.E,E=e.cS,I=e.cT,M=e.S,D=e.z,O=e.T,R=e.cw,L=e.cU,k=e.cV,A=e.cW,N=e.a1,B=e.a9,_=e.C,W=e.cX,V=e.cY,H=e.cZ,z=e.c_,U=e.as,F=e.c$,G=e.d0,X=e.d1,Y=e.f,Z=e.b5,K=e.d2,q=e.d3,J=e.a,$=e.d4,Q=e.d5,ee=e.d6,te=e.bW,re=e.M,ne=e.cB,ie=e.d7,ae=e.d8,oe=e.d9,se=e.cC,le=e.am,ue=e.da,ce=e.aO,de=e.db,pe=e.bn,ge=e.A,fe=e.L,he=e.c,ve=e.u,xe=e.c2,me=e.a$,be=e.b0,Se=e.ax,Ce=e.a3,ye=e.a4,Pe=e.c4,je=e.ap,we=e.B,Te=e.dc,Ee=e.dd,Ie=e.de,Me=e.df,De=e.dg,Oe=e.dh,Re=e.di,Le=e.dj,ke=e.aV,Ae=e.dk,Ne=e.b3,Be=e.dl,_e=e.s,We=e.I,Ve=e.r,He=e.c3,ze=e.aE,Ue=e.bb,Fe=e.e,Ge=e.aN,Xe=e.dm,Ye=e.a6,Ze=e.a7,Ke=e.m,qe=e.dn,Je=e.al,$e=e.bd,Qe=e.aX,et=e.dp,tt=e.dq,rt=e.g,nt=e.aA,it=e.dr,at=e.O,ot=e.ds,st=e.dt,lt=e.bc,ut=e.du,ct=e.d,dt=e.az,pt=e.dv,gt=e.dw},function(e){ft=e.b,ht=e.R,vt=e.a,xt=e.w,mt=e.c,bt=e.d,St=e.e,Ct=e.g,yt=e.f,Pt=e.i,jt=e.h,wt=e.j,Tt=e.k,Et=e.l,It=e.m,Mt=e.n,Dt=e.o,Ot=e.p,Rt=e.q,Lt=e.r,kt=e.s,At=e.t,Nt=e.v,Bt=e.x,_t=e.y,Wt=e.S,Vt=e.z,Ht=e.A,zt=e.B,Ut=e.C,Ft=e.D,Gt=e.E,Xt=e.F,Yt=e.G,Zt=e.H,Kt=e.I,qt=e.J,Jt=e.K,$t=e.L,Qt=e.M,er=e.N,tr=e.O,rr=e.P,nr=e.Q,ir=e.T,ar=e.U,or=e.V,sr=e.W,lr=e.X,ur=e.Y,cr=e.Z,dr=e._,pr=e.$,gr=e.a0,fr=e.a1,hr=e.a2,vr=e.a3,xr=e.a4,mr=e.a5,br=e.a6,Sr=e.a7},function(e){Cr=e.r},function(e){yr=e.C,Pr=e.b,jr=e.F},function(e){wr=e.P},function(e){Tr=e.P},function(e){Er=e.L},function(e){Ir=e.S},function(e){Mr=e.C,Dr=e.c,Or=e.F,Rr=e.l,Lr=e.n,kr=e.a},function(e){Ar=e.q},function(e){Nr=e.C,Br=e.B,_r=e.I},function(e){Wr=e.D},function(e){Vr=e.D},function(e){Hr=e.D},function(e){zr=e.F,Ur=e.I},function(e){Fr=e.F},function(e){Gr=e.C},function(e){Xr=e.E},function(e){Yr=e.u},function(e){Zr=e.u},function(e){Kr=e.u},function(e){qr=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var c=function(e){var t,r,n,i,a,o,s=e.isOpen,l=e.close,u=ft(function(e){return e.settings});t=s,r=d(),n=r.activeScopes,i=r.enableScope,a=r.disableScope,o=f.useRef([]),f.useEffect(function(){return t?(o.current=C(n),i(v.NONE),o.current.forEach(a),function(){a(v.NONE),o.current.forEach(i)}):function(){}},[t]);var c=S(f.useState(0),2),p=c[0],g=c[1],h=S(f.useState(!1),2),m=h[0],T=h[1];return s?b.jsx(y,{open:s,maxWidth:"md",fullWidth:!0,onClose:l,hideBackdrop:p===w.FILTER,sx:x({},P(m,{opacity:.75})),children:b.jsx(j,{sx:{p:0},children:b.jsx(ht,{activeTab:p,setActiveTab:g,settings:u,updateSetting:function(){var e;return(e=vt).updateSetting.apply(e,arguments)},deleteSetting:function(){var e;return(e=vt).deleteSetting.apply(e,arguments)},setTransparent:T})})}):null},Jr=xt(function(e){var t=e.isDesktop,r=e.readerNavBarWidth,n=mt(function(e){return e.scrollbar}),i=bt(function(e){return{currentPageIndex:e.pages.currentPageIndex,pages:e.pages.pages,totalPages:e.pages.totalPages}}),a=i.currentPageIndex,o=i.pages,s=i.totalPages,l=ft(function(e){return{readingDirection:e.settings.readingDirection.value,shouldShowPageNumber:e.settings.shouldShowPageNumber,progressBarType:e.settings.progressBarType}}),u=l.readingDirection,c=l.shouldShowPageNumber,d=l.progressBarType,p=St(function(e){return e.progressBar.isMaximized}),g=f.useMemo(function(){var e=Ct(a,o).name,t="".concat(e).concat("/").concat(s);return u===E.LTR?t:Cr(t,"/")},[a,o,s,u]);return c?p||t&&d===I.STANDARD||p&&d===I.HIDDEN?null:b.jsx(M,{sx:{position:"fixed",left:r,right:0,bottom:function(e){return"max(calc(".concat(e.spacing(1)," + ").concat(n.xSize,"px), env(safe-area-inset-bottom))")},alignItems:"center",transition:function(e){return"left 0.".concat(e.transitions.duration.shortest,"s")}},children:b.jsx(D,{sx:{p:.5,borderRadius:1,backgroundColor:"rgba(0, 0, 0, 0.3)"},children:b.jsx(O,{sx:{color:"white"},children:g})})}):null},[vt.useOverlayMode,T],["isDesktop","readerNavBarWidth"]);function $r(e){return e.substring(2).toLowerCase()}function Qr(e){var t=e.children,r=e.disableReactTree,n=void 0!==r&&r,i=e.mouseEvent,a=void 0===i?"onClick":i,o=e.onClickAway,s=e.touchEvent,l=void 0===s?"onTouchEnd":s,u=f.useRef(!1),c=f.useRef(null),d=f.useRef(!1),p=f.useRef(!1);f.useEffect(function(){return setTimeout(function(){d.current=!0},0),function(){d.current=!1}},[]);var g=R(L(t),c),h=k(function(e){var t=p.current;p.current=!1;var r=A(c.current);!d.current||!c.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,r)||(u.current?u.current=!1:(e.composedPath?e.composedPath().includes(c.current):!r.documentElement.contains(e.target)||c.current.contains(e.target))||!n&&t||o(e))}),v=function(e){return function(r){p.current=!0;var n=t.props[e];n&&n(r)}},x={ref:g};return!1!==l&&(x[l]=v(l)),f.useEffect(function(){if(!1!==l){var e=$r(l),t=A(c.current),r=function(){u.current=!0};return t.addEventListener(e,h),t.addEventListener("touchmove",r),function(){t.removeEventListener(e,h),t.removeEventListener("touchmove",r)}}},[h,l]),!1!==a&&(x[a]=v(a)),f.useEffect(function(){if(!1!==a){var e=$r(a),t=A(c.current);return t.addEventListener(e,h),function(){t.removeEventListener(e,h)}}},[h,a]),f.cloneElement(t,x)}var en=N(O)({boxSizing:"content-box",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",textAlign:"center",userSelect:"none",cursor:"pointer"}),tn=N(M,{shouldForwardProp:B(["progressBarPosition"])})(function(e){var t=e.theme,r=e.progressBarPosition;return x(x(x(x({position:"fixed",pointerEvents:"all",touchAction:"none"},P(yt(r).isHorizontal,{justifyContent:"flex-end",bottom:0,right:0})),P(yt(r).isVertical,{top:0,bottom:0})),P(yt(r).isLeft,{alignItems:"ltr"===t.direction?"flex-start":"flex-end"})),P(yt(r).isRight,{alignItems:"ltr"===t.direction?"flex-end":"flex-start"}))}),rn=N(M)(function(e){return{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:e.theme.spacing(.5)}}),nn=N(M)({flexDirection:"row",flexGrow:1,overflow:"hidden"}),an=N(D,{shouldForwardProp:B(["currentPagesIndex","pagesLength","progressBarPosition"])})(function(e){var t=e.currentPagesIndex,r=e.pagesLength,n=e.progressBarPosition;return x(x({position:"absolute",pointerEvents:"none"},P(yt(n).isHorizontal,{left:0,width:"".concat((t+1)/r*100,"%"),height:"100%"})),P(yt(n).isVertical,{top:0,width:"100%",height:"".concat((t+1)/r*100,"%")}))}),on=function(e){var t=e.pageName,r=e.currentPagesIndex,n=e.pagesLength,i=e.isDragging,a=e.boxProps,o=e.children,s=e.progressBarPosition;return b.jsx(_,{title:t,slotProps:{tooltip:{sx:{backgroundColor:"primary.main",color:"primary.contrastText"}}},placement:W[s],children:b.jsx(D,x(x({},a),{},{sx:x(x(x({position:"absolute",cursor:i?"grabbing":"grab"},P(yt(s).isHorizontal,{left:"".concat(Math.max(0,r-1)/(n-1)*100,"%"),width:"calc(100% / ".concat(n-1,")"),height:"100%"})),P(yt(s).isVertical,{top:"".concat(Math.max(0,r-1)/(n-1)*100,"%"),width:"100%",height:"calc(100% / ".concat(n-1,")")})),null==a?void 0:a.sx),children:o}))})},sn=N(M)({position:"relative",flexDirection:"row",flexGrow:1}),ln=m(m(m(m(m({},H.EDGE,[{rect:[0,0,100,33.33],type:V.NEXT},{rect:[0,33.33,33.33,66.66],type:V.NEXT},{rect:[66.66,33.33,33.33,66.66],type:V.NEXT},{rect:[33.33,33.33,33.33,33.33],type:V.MENU},{rect:[33.33,66.66,33.33,33.33],type:V.PREVIOUS}]),H.KINDLE,[{rect:[0,0,100,33.33],type:V.MENU},{rect:[0,33.33,33.33,66.66],type:V.PREVIOUS},{rect:[33.33,33.33,66.66,66.66],type:V.NEXT}]),H.L_SHAPE,[{rect:[0,0,100,33.33],type:V.PREVIOUS},{rect:[0,33.33,33.33,33.33],type:V.PREVIOUS},{rect:[33.33,33.33,33.33,33.33],type:V.MENU},{rect:[66.66,33.33,33.33,33.33],type:V.NEXT},{rect:[0,66.66,100,33.33],type:V.NEXT}]),H.RIGHT_LEFT,[{rect:[0,0,33.33,100],type:V.PREVIOUS},{rect:[33.33,0,33.33,100],type:V.MENU},{rect:[66.66,0,33.33,100],type:V.NEXT}]),H.DISABLED,[{rect:[0,0,100,100],type:V.MENU}]),un=m(m(m({},V.PREVIOUS,{text:"global.label.previous",color:"rgba(255, 114, 118, .5)"}),V.NEXT,{text:"global.label.next",color:"rgba(144, 238, 144, .5)"}),V.MENU,{text:"global.label.menu",color:"rgba(0, 0, 0, .5)"}),cn=function(){return h(function e(){g(this,e)},null,[{key:"invertRect",value:function(e,t){var r=t.vertical,n=t.horizontal,i=t.isRTL,a=r?this.invertVertical(e):e,o=n?this.invertHorizontal(a):a;return i?this.invertHorizontal(o):o}},{key:"getRegions",value:function(e,t){var r=this;return ln[e].map(function(e){var n=e.type,i=e.rect;return{type:n,rect:r.invertRect(i,t)}})}},{key:"isCanvasReusable",value:function(e,t,r,n,i){var a,o=this.layout===e,s=this.width===t,l=this.height===r,u=!!this.canvas,c=this.language===z.language,d=(null===(a=this.invertMode)||void 0===a?void 0:a.vertical)===i.vertical&&this.invertMode.horizontal===i.horizontal&&this.invertMode.isRTL===i.isRTL,p=this.fontStyle===n;return u&&s&&l&&o&&c&&d&&p}},{key:"drawCanvas",value:function(e,t,r,n,i){i.forEach(function(i){var a=i.type,o=S(i.rect,4),s=o[0],l=o[1],u=o[2],c=o[3],d=un[a],p=d.text,g=d.color,f=U(p),h=function(e,t){return e/100*t},v=h(s,t),x=h(l,r),m=h(u,t),b=h(c,r),C=function(e,t){return.5*(e+t)+.5*e},y=C(v,m),P=C(x,b);e.beginPath(),e.rect(v,x,m,b),e.fillStyle=g,e.strokeStyle=g,e.lineWidth=.1,e.stroke(),e.fill(),e.strokeStyle="black",e.textAlign="center",e.textBaseline="middle",e.font="".concat(n.fontSize," ").concat(n.fontFamily),e.strokeStyle="black",e.lineWidth=3,e.strokeText(f,y,P),e.lineWidth=1,e.fillStyle="white",e.fillText(f,y,P)})}},{key:"getOrCreateCanvas",value:function(e,t,r,n,i){if(this.isCanvasReusable(e,t,r,n,i))return this.canvas;var a=document.createElement("canvas"),o=a.getContext("2d");o.canvas.width=t,o.canvas.height=r;var s=this.getRegions(e,i);return this.drawCanvas(o,t,r,n,s),this.layout=e,this.canvas=a,this.width=t,this.height=r,this.language=z.language,this.invertMode=i,this.regions=s,this.fontStyle=n,a}},{key:"doesRegionContainPos",value:function(e,t,r){var n=S(e.rect,4),i=n[0],a=n[1],o=n[2],s=n[3];return t>=i&&t<=i+o&&r>=a&&r<=a+s}},{key:"getAction",value:function(e,t){var r,n=this,i=e/this.width*100,a=t/this.height*100,o=null===(r=this.regions)||void 0===r?void 0:r.find(function(e){return n.doesRegionContainPos(e,i,a)});return o?o.type:V.MENU}}])}();m(cn,"layout",null),m(cn,"canvas",null),m(cn,"width",null),m(cn,"height",null),m(cn,"language",null),m(cn,"invertMode",null),m(cn,"regions",null),m(cn,"fontStyle",null),m(cn,"invertVertical",function(e){var t=S(e,4),r=t[0],n=t[1],i=t[2],a=t[3];return[r,100-(n+a),i,a]}),m(cn,"invertHorizontal",function(e){var t=S(e,4),r=t[0],n=t[1],i=t[2];return[100-(r+i),n,i,t[3]]});var dn=function(){function e(){g(this,e)}return h(e,null,[{key:"scroll",value:function(t,r,n,i,a,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:F.LARGE;if(a){var l=K[i],u=G().direction===l,c=Pt(n),d=Math.abs(a.scrollTop)<=1,p=Math.floor(a.scrollTop)===a.scrollHeight-a.clientHeight||Math.ceil(a.scrollTop)===a.scrollHeight-a.clientHeight,g=Math.abs(a.scrollLeft)<=1,f=a.scrollWidth-a.clientWidth-Math.floor(Math.abs(a.scrollLeft))<=1||a.scrollWidth-a.clientWidth-Math.ceil(Math.abs(a.scrollLeft))<=1,h=u?g:f,v=u?f:g,m=s/100,b=function(e,t,r){if(e===X.X){if(t===ee.BACKWARD)return"ltr"===r?-1:1;if(t===ee.FORWARD)return"ltr"===r?1:-1}return t===ee.BACKWARD?-1:1}(r,t,l),S=function(e,t){return e+t*m*b};jt().setIsVisible(!1),o(!1);var C=function(r,n,i){r&&t===ee.BACKWARD&&c?e.openChapter("previous"):n&&t===ee.FORWARD&&c?e.openChapter("next"):a.scroll(x(x({},i),{},{behavior:"smooth"}))};switch(r){case X.X:C(h,v,{left:S(a.scrollLeft,a.clientWidth)});break;case X.Y:C(d,p,{top:S(a.scrollTop,a.clientHeight)});break;default:throw new Error('Unexpected "ScrollDirection" ('.concat(r,")"))}}}},{key:"openChapter",value:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=wt(),a=i.currentChapter,o=i.previousChapter,s=i.nextChapter,l=i.chapters,c=i.visibleChapters,d=c.lastLeadingChapterSourceOrder,g=c.lastTrailingChapterSourceOrder,f=i.setReaderStateChapters,h=Tt(),v=h.shouldInformAboutMissingChapter,x=h.shouldInformAboutScanlatorChange,m=h.shouldUseInfiniteScroll;if(a){var b="number"==typeof t,S="previous"===t;if(b||S&&!!o||!S&&!!s){var C=function(){var i=p(u().m(function i(){var c,p,h,C;return u().w(function(i){for(;;)switch(i.p=i.n){case 0:if(c=function(){return b?l.find(function(e){return e.id===t}):S?o:s}()){i.n=1;break}return i.a(2);case 1:if(p=c.sourceOrder<a.sourceOrder,i.p=2,!r){i.n=3;break}return i.n=3,e.checkNextChapterConsistency(p?"previous":"next",a,c,v,x);case 3:h=d<=c.sourceOrder&&g>=c.sourceOrder,(C=m&&(!n||h))&&f(function(e){return kt(p,e,c.sourceOrder,n,!p&&void 0,!!p&&void 0)}),vt.navigateToChapter(c,{resumeMode:At(b||!C,p),updateInitialChapter:!C}),i.n=5;break;case 4:i.p=4,i.v;case 5:return i.a(2)}},i,null,[[2,4]])}));return function(){return i.apply(this,arguments)}}();C().catch(Y())}}}},{key:"checkNextChapterConsistency",value:(t=p(u().m(function e(t,r,n,i,a){var o,s,l,c,d,p,g,f;return u().w(function(e){for(;;)switch(e.n){case 0:if(r&&n){e.n=1;break}return e.a(2);case 1:if(o=yr.getGap(r,n),s=!a||r.scanlator===n.scanlator,l=!i||!o,!s||!l){e.n=2;break}return e.a(2);case 2:return c={previous:{scanlator:"reader.chapter_transition.warning.previous.scanlator",chapter_number:"reader.chapter_transition.warning.previous.chapter_number"},next:{scanlator:"reader.chapter_transition.warning.next.scanlator",chapter_number:"reader.chapter_transition.warning.next.chapter_number"}},d=s?"":U(c[t].scanlator,{nextScanlator:n.scanlator,currentScanlator:r.scanlator}),p=l?"":U(c[t].chapter_number,{count:o,nextChapter:"#".concat(n.chapterNumber," ").concat(n.name),currentChapter:"#".concat(r.chapterNumber," ").concat(r.name)}),g=s||l?"":"\n\n",f="".concat(d).concat(g).concat(p),e.n=3,Z({title:U("reader.chapter_transition.warning.title"),message:f,actions:{confirm:{title:U("global.button.open")}}});case 3:return e.a(2)}},e)})),function(e,r,n,i,a){return t.apply(this,arguments)})},{key:"openPage",value:function(t,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Et(),a=i.currentPageIndex,o=i.setPageToScrollToIndex,s=i.pages,l=i.transitionPageMode,u=i.setTransitionPageMode,c=Tt(),d=c.readingDirection,p=c.readingMode,g=c.shouldShowTransitionPage,f=K[d.value],h=te(t,"previous"===t?"next":"previous",null!=r?r:f),v=Ct(a,s),x=It("previous",v.pagesIndex,s),m=It("next",v.pagesIndex,s),b=Mt(s[0]),S=Mt(s[s.length-1]),C=0===v.primary.index,y=a===S,P=Dt(l,p.value),j=Pt(p.value);n&&(jt().setIsVisible(!1),Ot().setShowPreview(!1));var w=function(){return u(q.NONE)};if("number"==typeof t)return o(t),void w();var T=j&&P,E=!j&&l===q.PREVIOUS||T,I=!j&&l===q.NEXT||T;if(!C||g&&!E||"previous"!==h||!wt().previousChapter)if(y&&(!g||I)&&"next"===h&&!!wt().nextChapter)e.openChapter("next");else{var M="previous"===h,D="next"===h;if(P&&!j&&(E&&D||I&&M))return w(),void o(E?b:S);(C&&M||y&&D)&&!j?u(M?q.PREVIOUS:q.NEXT):o(M?x:m)}else e.openChapter("previous")}},{key:"useUpdateCurrentPageIndex",value:function(){var t=vt.useUpdateChapter(),r=J().settings.downloadAheadLimit;return f.useCallback(function(n){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Et(),s=o.currentPageIndex,l=o.setCurrentPageIndex,u=wt(),c=u.currentChapter,d=u.chapters,p=u.previousChapter,g=u.nextChapter,f=u.visibleChapters,h=u.setReaderStateChapters;if((n!==s||a)&&(l(n),c)){var v=yr.getNextChapters(c,d,{offset:$.NEXT}),x=s>n?$.PREVIOUS:$.NEXT;vt.downloadAhead(c,g,v,n,r),vt.preloadChapter(n,c.pageCount,x===$.NEXT?g:p,f.lastLeadingChapterSourceOrder,f.lastTrailingChapterSourceOrder,h,x);var m=function(){var e=Nt(c.id);if(e){var r=a?e.pageCount-1:n,i=r===e.pageCount-1;t({lastPageRead:r,isRead:!!i||void 0})}};clearTimeout(e.updateCurrentPageTimeout),i?e.updateCurrentPageTimeout=setTimeout(m,1e3):m()}},[r])}},{key:"updateCurrentPageOnScroll",value:function(e,t,r,n,i){var a,o=K[i],s=e.current.findIndex(function(e){return e&&Rt(e,n,{bottom:1,left:te(0,window.innerWidth+1,o),right:te(1,0,o)})}),l=null===(a=e.current)||void 0===a?void 0:a[e.current.length-1],u=l&&Lt(l,n,i);-1!==s&&(u?r(s,!1,!0):r(s,s!==t))}},{key:"handleClick",value:function(t,r){if(t){var n=Tt(),i=n.readingMode,a=n.readingDirection,o=n.isStaticNav,s=n.scrollAmount,l=r.currentTarget.getBoundingClientRect(),u=r.clientX-l.left,c=r.clientY-l.top,d=cn.getAction(u,c);Ot().setShowPreview(!1);var p=Pt(i.value),g=i.value===Q.CONTINUOUS_HORIZONTAL?X.X:X.Y;switch(d){case V.MENU:jt().setIsVisible(o||!jt().isVisible);break;case V.PREVIOUS:case V.NEXT:p?e.scroll(d===V.PREVIOUS?ee.BACKWARD:ee.FORWARD,g,i.value,a.value,t,Ot().setShowPreview,s):e.openPage(d===V.PREVIOUS?"previous":"next","ltr");break;default:throw new Error('Unexpected "TapZoneRegionType" ('.concat(d,")"))}}}},{key:"useHandleProgressDragging",value:function(t,r,n,i,a,o,s){f.useEffect(function(){if(!r)return function(){};var l=yt(a).isHorizontal,u=function(r){if(t.current){var a=Mt(Bt(r,t.current,i,l,s,o));Mt(n)!==a&&e.openPage(a,void 0,!1)}},c=function(e){u(e)},d=function(e){e.touches.length>0&&u(e.touches[0])};return document.addEventListener("mousemove",c),document.addEventListener("touchmove",d),function(){document.removeEventListener("mousemove",c),document.removeEventListener("touchmove",d)}},[r,n,i,a])}}]);var t}();m(dn,"updateCurrentPageTimeout",void 0);var pn=f.memo(N(D,{shouldForwardProp:B(["isFirstPage","isLastPage"])})(function(e){return{flexGrow:1,height:"100%",cursor:"pointer",borderLeftWidth:e.isFirstPage?0:void 0,borderRightWidth:e.isLastPage?0:void 0}})),gn=f.memo(function(e){var r=e.page,n=e.pagesIndex,i=e.isCurrentPage,a=e.isLeadingPage,o=e.isTrailingPage,s=e.totalPages,u=e.showDraggingStyle,c=e.primaryPageLoadState,d=e.secondaryPageLoadState,p=e.createProgressBarSlot,g=l(e,t),h=f.useMemo(function(){return p(r,n,c,d,i,a,o,s,u)},[p,r,n,c,d,i,a,o,s,u]);return b.jsx(pn,x(x({},g),{},{isFirstPage:0===n,isLastPage:n===s-1,children:h}))}),fn=f.memo(function(e){var t,r,n,i,a,o,s,l,u,c,d,p,g,h,v,m,y,P,j,w,T=e.slotProps,E=e.slots,I=e.createProgressBarSlot,M=e.progressBarPosition,D=e.direction,O=e.fullSegmentClicks,R=bt(function(e){return{pages:e.pages.pages,pageLoadStates:e.pages.pageLoadStates,totalPages:e.pages.totalPages,currentPageIndex:e.pages.currentPageIndex}}),L=R.pages,k=R.pageLoadStates,A=R.totalPages,N=R.currentPageIndex,B=ft(function(e){return e.settings.readingMode.value}),_=St(function(e){return{isDragging:e.progressBar.isDragging,setIsDragging:e.progressBar.setIsDragging}}),W=_.isDragging,V=_.setIsDragging,H=f.useRef(null),z=f.useRef(void 0),U=S(f.useState(0),2),F=U[0],G=U[1],X=f.useRef(null);re(X,f.useCallback(function(){var e=X.current;if(e){var t=getComputedStyle(e),r=t.paddingLeft,n=t.paddingRight,i=e.clientWidth-parseFloat(r)-parseFloat(n),a=B===Q.DOUBLE_PAGE?2*i+6:i;G(a)}},[B]));var Y=f.useMemo(function(){return Ct(N,L).pagesIndex},[N,L]),Z=yt(M).isHorizontal,K=f.useMemo(function(){return Ct(N,L)},[N,L]),q=f.useCallback(function(){return te(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],D)},[D]);dn.useHandleProgressDragging(H,W,K,L,M,q,O);var J=function(e){if(H.current){var t="touches"in e;dn.openPage(Mt(Bt(t?e.touches[0]:e,H.current,L,Z,O,q)),void 0,!1),clearTimeout(z.current),z.current=setTimeout(function(){return V(!0)},250)}},$=function(){V(!1),clearTimeout(z.current)};return b.jsx(tn,x(x({},null==T?void 0:T.container),{},{progressBarPosition:M,children:b.jsxs(rn,x(x({},null==T?void 0:T.progressBarRoot),{},{children:[b.jsx(en,x(x(x({},null==T||null===(t=T.progressBarPageTexts)||void 0===t?void 0:t.base),null==T||null===(r=T.progressBarPageTexts)||void 0===r?void 0:r.current),{},{sx:[{width:"".concat(F,"px")}].concat(C(Array.isArray(null==T||null===(n=T.progressBarPageTexts)||void 0===n||null===(n=n.base)||void 0===n?void 0:n.sx)?null!==(i=null==T||null===(a=T.progressBarPageTexts)||void 0===a||null===(a=a.base)||void 0===a?void 0:a.sx)&&void 0!==i?i:[]:[null==T||null===(o=T.progressBarPageTexts)||void 0===o||null===(o=o.base)||void 0===o?void 0:o.sx]),C(Array.isArray(null==T||null===(s=T.progressBarPageTexts)||void 0===s||null===(s=s.current)||void 0===s?void 0:s.sx)?null!==(l=null==T||null===(u=T.progressBarPageTexts)||void 0===u||null===(u=u.current)||void 0===u?void 0:u.sx)&&void 0!==l?l:[]:[null==T||null===(c=T.progressBarPageTexts)||void 0===c||null===(c=c.current)||void 0===c?void 0:c.sx])),onClick:function(){return dn.openPage("previous","ltr",!1)},children:K.name})),b.jsx(Qr,{onClickAway:function(){return V(!1)},children:b.jsxs(sn,x(x({},null==T?void 0:T.progressBarSlotsActionArea),{},{onMouseDown:J,onMouseUp:$,onTouchStart:J,onTouchEnd:$,children:[b.jsxs(nn,x(x({ref:H},null==T?void 0:T.progressBarSlotsContainer),{},{children:[L.map(function(e,t){return f.createElement(gn,x(x({},null==T?void 0:T.progressBarSlot),{},{key:e.primary.index,page:e,pagesIndex:t,isCurrentPage:t===Y,isLeadingPage:t<Y,isTrailingPage:t>Y,totalPages:L.length,primaryPageLoadState:k[e.primary.index].loaded,secondaryPageLoadState:e.secondary?k[e.secondary.index].loaded:void 0,createProgressBarSlot:I,showDraggingStyle:t===Y&&W}))}),b.jsx(an,x(x({},null==T?void 0:T.progressBarReadPages),{},{currentPagesIndex:K.pagesIndex,pagesLength:L.length,progressBarPosition:M}))]})),b.jsx(on,{boxProps:null==T?void 0:T.progressBarCurrentPageSlot,pageName:K.name,currentPagesIndex:K.pagesIndex,pagesLength:L.length,isDragging:W,progressBarPosition:M,children:null==E?void 0:E.progressBarCurrentPage})]}))}),b.jsx(en,x(x(x({ref:X},null==T||null===(d=T.progressBarPageTexts)||void 0===d?void 0:d.base),null==T||null===(p=T.progressBarPageTexts)||void 0===p?void 0:p.total),{},{sx:[{minWidth:"unset"}].concat(C(Array.isArray(null==T||null===(g=T.progressBarPageTexts)||void 0===g||null===(g=g.base)||void 0===g?void 0:g.sx)?null!==(h=null==T||null===(v=T.progressBarPageTexts)||void 0===v||null===(v=v.base)||void 0===v?void 0:v.sx)&&void 0!==h?h:[]:[null==T||null===(m=T.progressBarPageTexts)||void 0===m||null===(m=m.base)||void 0===m?void 0:m.sx]),C(Array.isArray(null==T||null===(y=T.progressBarPageTexts)||void 0===y||null===(y=y.total)||void 0===y?void 0:y.sx)?null!==(P=null==T||null===(j=T.progressBarPageTexts)||void 0===j||null===(j=j.total)||void 0===j?void 0:j.sx)&&void 0!==P?P:[]:[null==T||null===(w=T.progressBarPageTexts)||void 0===w||null===(w=w.total)||void 0===w?void 0:w.sx])),onClick:function(){return dn.openPage("next","ltr",!1)},children:A}))]}))}))}),hn=f.forwardRef(function(e,t){var n=e.direction,i=l(e,r),a=J().settings,o=a.customThemes,s=a.appTheme,u=a.themeMode,c=a.shouldUsePureBlackMode,d=f.useMemo(function(){return ne(u,ie(s,o),c,n)},[u,s,o,c,n]);return b.jsx(ae,{value:oe[n],children:b.jsx(se,{theme:d,children:b.jsx(D,x(x({},i),{},{ref:t,dir:n}))})})}),vn=xt(hn,[function(){return{direction:vt.useGetThemeDirection()}}],["direction"]),xn=f.memo(function(e){var t,r=e.pageName,n=e.progressBarPosition,i=e.slotProps,a=e.children;return b.jsx(_,x(x({},null==i?void 0:i.tooltip),{},{title:r,placement:W[n],children:b.jsx(D,x(x({},null==i?void 0:i.box),{},{sx:x({width:"100%",height:"100%"},null==i||null===(t=i.box)||void 0===t?void 0:t.sx),children:a}))}))}),mn=f.memo(function(e){var t=e.pageName,r=e.primaryPageLoadState,n=e.secondaryPageLoadState,i=e.progressBarPosition,a=e.isCurrentPage,o=e.isLeadingPage,s=e.showDraggingStyle,l=le();return b.jsx(xn,{pageName:t,progressBarPosition:i,slotProps:{box:{sx:x(x({cursor:"pointer",backgroundColor:ue(l.palette.background.paper,.2)},l.applyStyles("dark",{backgroundColor:de(l.palette.background.paper,.1)})),P(r&&(null==n||n),x({backgroundColor:ue(l.palette.background.paper,.35)},l.applyStyles("dark",{backgroundColor:de(l.palette.background.paper,.25)}))))},tooltip:{slotProps:a?{tooltip:{sx:{backgroundColor:"primary.main",color:"primary.contrastText"}}}:void 0}},children:b.jsx(D,{sx:x(x({width:"100%",height:"100%"},P(o,{backgroundColor:ce(l.palette.primary.main,.5)})),P(a,x({cursor:s?"grabbing":"grab",pointer:"grabbing",borderRadius:2,backgroundColor:"primary.dark"},l.applyStyles("dark",{backgroundColor:"primary.light"}))))})})}),bn=xt(f.memo(function(e){var t=e.readerNavBarWidth,r=e.readerDirection,n=le(),i=mt(function(e){return e.scrollbar}),a=bt(function(e){return e.pages.totalPages}),o=ft(function(e){return{progressBarType:e.settings.progressBarType,progressBarSize:e.settings.progressBarSize,progressBarPosition:e.settings.progressBarPosition,progressBarPositionAutoVertical:e.settings.progressBarPositionAutoVertical}}),s=o.progressBarType,l=o.progressBarSize,u=o.progressBarPosition,c=o.progressBarPositionAutoVertical,d=St(function(e){return{isMaximized:e.progressBar.isMaximized,setIsMaximized:e.progressBar.setIsMaximized,isDragging:e.progressBar.isDragging}}),p=d.isMaximized,g=d.setIsMaximized,h=d.isDragging,v=S(f.useState({}),2)[1];re(window.document.documentElement,f.useCallback(function(){return v({})},[]));var m=_t(u,c,i.ySize,t+i.xSize),C=yt(m),y=C.isBottom,j=C.isLeft,w=C.isRight,T=C.isVertical,E=C.isHorizontal,M=!!a,D=s===I.HIDDEN,O=!p&&!h;return b.jsx(vn,{children:b.jsx(fn,{direction:E?r:"ltr",progressBarPosition:m,fullSegmentClicks:!0,createProgressBarSlot:f.useCallback(function(e,t,r,n,i,a,o,s,l){return b.jsx(mn,{pageName:e.name,primaryPageLoadState:r,secondaryPageLoadState:n,progressBarPosition:m,isCurrentPage:i,isLeadingPage:a,showDraggingStyle:l})},[m]),slotProps:{container:{sx:x(x(x(x(x(x(x({overflow:"hidden",transition:"all 0.".concat(n.transitions.duration.shortest,"s")},P(E,x(x({minHeight:"100px"},P("ltr"===n.direction,{left:"ltr"===r?t:i.ySize,right:"rtl"===r?t:i.ySize})),P("rtl"===n.direction,{left:"rtl"===r?t:i.ySize,right:"ltr"===r?t:i.ySize})))),P(T,{minWidth:"100px",bottom:"".concat(i.xSize,"px")})),P(y,{bottom:"".concat(i.xSize,"px")})),P(j,x(x({},P("ltr"===n.direction,{left:"ltr"===r?t:"unset",right:"rtl"===r?t:"unset"})),P("rtl"===n.direction,{right:"rtl"===r?i.ySize:"unset",left:"ltr"===r?i.ySize:"unset"})))),P(w,x(x({},P("ltr"===n.direction,{right:"ltr"===r?i.ySize:"unset",left:"rtl"===r?i.ySize:"unset"})),P("rtl"===n.direction,{left:"rtl"===r?t:"unset",right:"ltr"===r?t:"unset"})))),P(O,{opacity:D?0:.85})),P(!M,{pointerEvents:"none"})),onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},progressBarRoot:{sx:x(x({gap:0,transition:"all 0.1s ease-in-out",backgroundColor:"background.paper"},P(T,{flexDirection:"column",height:"100%"})),P(O,x(x(x(x(x({backgroundColor:"unset",pointerEvents:"none"},P(E,{px:2})),P(T,{py:2})),P(y,{pb:.25})),P(j,x(x({},P("ltr"===n.direction,{pl:"ltr"===r?.25:0,pr:"rtl"===r?.25:0})),P("rtl"===n.direction,{pr:"rtl"===r?.25:0,pl:"ltr"===r?.25:0})))),P(w,x(x({},P("ltr"===n.direction,{pr:"ltr"===r?.25:0,pl:"rtl"===r?.25:0})),P("rtl"===n.direction,{pl:"rtl"===r?.25:0,pr:"ltr"===r?.25:0}))))))},progressBarSlotsContainer:{sx:x(x(x({gap:.25,borderRadius:2,transition:"height 0.1s ease-in-out"},P(E,{height:"20px"})),P(T,{flexDirection:"column",width:"20px"})),P(O,x(x({},P(E,{height:"".concat(l,"px")})),P(T,{width:"".concat(l,"px")}))))},progressBarReadPages:{sx:{display:"none"}},progressBarCurrentPageSlot:{sx:{display:"none"}},progressBarPageTexts:{base:{sx:x({px:1,py:1.5,transition:"all 0.1s ease-in-out"},P(O,{transform:"scale(0)",p:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0}))}}}})})}),[T,function(){return{readerDirection:vt.useGetThemeDirection()}}],["readerNavBarWidth","readerDirection"]),Sn=N(M)({width:"400px",minWidth:"400px",maxWidth:"400px",height:"100vh",overflowY:"auto"}),Cn=f.memo(function(e){var t=e.mangaId,r=e.mangaTitle,n=e.chapterTitle,i=e.scanlator;return b.jsxs(M,{children:[b.jsx(_,{title:r,placement:"right",children:b.jsx(pe,{lines:3,variant:"h6",component:"h1",sx:{textAlign:"center"},children:b.jsx(Er,{component:fe,to:ge.manga.path(t),sx:{textDecoration:"none",color:"inherit"},children:r})})}),b.jsx(_,{title:n,placement:"right",children:b.jsx(pe,{lines:4,variant:"body1",component:"h2",sx:{textAlign:"center"},children:n})}),i&&b.jsx(_,{title:i,placement:"right",children:b.jsx(pe,{lines:4,variant:"body2",component:"h3",color:"textDisabled",sx:{textAlign:"center"},children:i})})]})}),yn=he(b.jsx("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"})),Pn=he(b.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"})),jn=function(e){var t=e.title,r=e.type,i=e.disabled,a=l(e,n);return b.jsx(_,{title:t,disabled:i,children:b.jsx(Mr,x(x({sx:{flexBasis:"15%"},variant:"contained",disabled:i},a),{},{children:"previous"===r?b.jsx(yn,{}):b.jsx(Pn,{})}))})},wn=f.memo(function(){var e=ve().t,t=xe(),r=bt(function(e){return{currentPageIndex:e.pages.currentPageIndex,pages:e.pages.pages}}),n=r.currentPageIndex,i=r.pages,a=ft(function(e){return e.settings.readingDirection.value}),o=f.useMemo(function(){return Ct(n,i)},[n,i]),s=K[a];return b.jsxs(M,{sx:{flexDirection:"row",gap:1},dir:"ltr",children:[b.jsx(jn,{type:"previous",title:e(t("reader.button.previous_page","reader.button.next_page",s)),disabled:t(!o.primary.index,Mt(o)===Mt(i.slice(-1)[0]),s),onClick:function(){return dn.openPage("previous",void 0,!1)}}),b.jsxs(me,{sx:{flexBasis:"70%",flexGrow:0,flexShrink:0},children:[b.jsx(be,{id:"reader-nav-bar-desktop-page-select",children:e("reader.page_info.label.page")}),b.jsx(Ir,{labelId:"reader-nav-bar-desktop-page-select",label:e("reader.page_info.label.page"),value:Mt(o),onChange:function(e){return dn.openPage(e.target.value,void 0,!1)},children:i.map(function(e){return b.jsx(Se,{value:Mt(e),children:e.name},Mt(e))})})]}),b.jsx(jn,{type:"next",title:e(t("reader.button.next_page","reader.button.previous_page",s)),disabled:t(Mt(o)===Mt(i.slice(-1)[0]),!o.primary.index,s),onClick:function(){return dn.openPage("next",void 0,!1)}})]})}),Tn=function(){},En=function(e){var t=e.currentChapter,r=e.chapters,n=e.style,i=f.useMemo(function(){return t&&r.findIndex(function(e){return e.id===t.id})},[t,r]);return b.jsx(Ar,{style:x({height:"calc(".concat(r.length," * 100px)")},n),initialTopMostItemIndex:null!=i?i:0,totalCount:r.length,computeItemKey:function(e){return r[e].id},itemContent:function(e){return b.jsx(Nr,{index:e,chapters:r,isSortDesc:!0,mode:"reader",showChapterNumber:!1,selected:null,onSelect:Tn,selectable:!1,isActiveChapter:e===i})},increaseViewportBy:400})},In=xt(f.memo(function(e){var t,r,n=e.currentChapter,i=e.previousChapter,a=e.nextChapter,o=e.chapters,s=void 0===o?[]:o,l=e.readerThemeDirection,u=ve().t,c=Ce({variant:"popover",popupId:"reader-nav-bar-desktop-chapter-list"});return f.useLayoutEffect(function(){c.close()},[null==n?void 0:n.id]),b.jsxs(M,{sx:{flexDirection:"row",gap:1},dir:"ltr",children:[b.jsx(jn,{type:"previous",title:u(te("reader.button.previous_chapter","reader.button.next_chapter",l)),onClick:function(){dn.openChapter(te("previous","next",l))},disabled:te(!i,!a,l)}),b.jsxs(me,{sx:{flexBasis:"70%",flexGrow:0,flexShrink:0},children:[b.jsx(be,{id:"reader-nav-bar-desktop-chapter-select",children:u("chapter.title_one")}),b.jsx(Ir,x(x({},ye(c)),{},{open:c.isOpen,value:null!==(t=null==n?void 0:n.id)&&void 0!==t?t:0,MenuProps:{sx:{visibility:"hidden"}},label:u("chapter.title_one"),labelId:"reader-nav-bar-desktop-chapter-select",children:b.jsx(Se,{value:null!==(r=null==n?void 0:n.id)&&void 0!==r?r:0,children:n?"#".concat(n.chapterNumber," ").concat(n.name):""},null==n?void 0:n.id)}))]}),b.jsx(jn,{component:fe,type:"next",title:u(te("reader.button.next_chapter","reader.button.previous_chapter",l)),onClick:function(){dn.openChapter(te("next","previous",l))},disabled:te(!a,!i,l)}),b.jsx(Pe,x(x({},je(c)),{},{anchorOrigin:{vertical:"bottom",horizontal:"left"},children:b.jsx(D,{sx:{mb:1},children:b.jsx(En,{style:{width:"500px",maxWidth:"90vw",minHeight:"150px",maxHeight:"300px"},currentChapter:n,chapters:s})})}))]})}),[function(){return{readerThemeDirection:vt.useGetThemeDirection()}}],["readerThemeDirection"]),Mn=he(b.jsx("path",{d:"M17 4h3c1.1 0 2 .9 2 2v2h-2V6h-3zM4 8V6h3V4H4c-1.1 0-2 .9-2 2v2zm16 8v2h-3v2h3c1.1 0 2-.9 2-2v-2zM7 18H4v-2H2v2c0 1.1.9 2 2 2h3zM18 8H6v8h12z"})),Dn=function(e,t,r){var n=(e+1)%t.length;if(!(!!r&&0===n))return t[(e+1)%t.length]},On=function(e){var t=e.tooltip,r=e.value,n=e.defaultValue,i=e.values,a=e.setValue,o=e.valueToDisplayData,s=e.isDefaultable,l=e.onDefault,u=e.defaultIcon,c=ve().t,d=void 0===r,p=f.useMemo(function(){return d?-1:i.indexOf(r)},[r,i]);return b.jsx(_,{title:t,children:d?b.jsx(we,{onClick:function(){return a(i[0])},sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},variant:"contained",startIcon:u,size:"large",children:void 0===n?c("global.label.default"):b.jsx(Wt,{i18nKey:"settings.default_value",value:o[n].isTitleString?o[n].title:c(o[n].title)})}):b.jsx(we,{onClick:function(){var e=Dn(p,i,s);void 0!==e?a(e):null==l||l()},sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},variant:"contained",startIcon:o[r].icon,size:"large",children:o[r].isTitleString?o[r].title:c(o[r].title)})})},Rn=function(e){var t=e.pageScaleMode,r=e.shouldStretchPage,n=e.updateSetting,a=l(e,i),o=ve().t;return b.jsxs(M,{sx:{flexDirection:"row",gap:1},children:[b.jsx(On,x(x({},a),{},{tooltip:o("reader.settings.page_scale.title"),value:t.isDefault?void 0:t.value,defaultValue:t.isDefault?t.value:void 0,values:Ie,setValue:function(e){return n("pageScaleMode",e)},valueToDisplayData:Ee,defaultIcon:Ee[t.value].icon})),Te[t.value]&&b.jsx(_,{title:o("reader.settings.page_scale.stretch"),children:b.jsx(Mr,{onClick:function(){return n("shouldStretchPage",!r.value)},sx:{px:void 0},variant:"contained",color:r.value?"secondary":"primary",children:b.jsx(Mn,{})})})]})},Ln=function(e){var t=e.readingMode,r=e.setReadingMode,n=l(e,a),i=ve().t;return b.jsx(On,x(x({},n),{},{tooltip:i("reader.settings.label.reading_mode"),value:t.isDefault?void 0:t.value,defaultValue:t.isDefault?t.value:void 0,values:De,setValue:r,valueToDisplayData:Me,defaultIcon:Me[t.value].icon}))},kn=function(){return b.jsx(Oe,{children:b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:b.jsx("path",{d:"M2 4h6a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2m20 0h-6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M2 12h20m-3-3 3 3-3 3M5 9l-3 3 3 3"})})})},An=function(e){var t=e.readingMode,r=e.shouldOffsetDoubleSpreads,n=e.setShouldOffsetDoubleSpreads,i=ve().t;return Vt(t)?b.jsx(we,{sx:{justifyContent:"start",textTransform:"unset"},size:"large",onClick:function(){return n(!r)},color:r?"secondary":"primary",variant:"contained",startIcon:b.jsx(kn,{}),children:i("reader.settings.label.offset_double_spread")}):null},Nn=function(e){var t=e.readingDirection,r=e.setReadingDirection,n=l(e,o),i=ve().t;return b.jsx(On,x(x({},n),{},{tooltip:i("reader.settings.label.reading_direction"),value:t.isDefault?void 0:t.value,defaultValue:t.isDefault?t.value:void 0,values:Le,setValue:r,valueToDisplayData:Re,defaultIcon:Re[t.value].icon}))},Bn=he(b.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 14H9V8h2zm4 0h-2V8h2z"})),_n=he(b.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 14.5v-9l6 4.5z"})),Wn=function(e){var t=e.autoScroll,r=e.setAutoScroll,n=ve().t,i=Ht(function(e){return{isActive:e.autoScroll.isActive,toggleActive:e.autoScroll.toggleActive}}),a=i.isActive,o=i.toggleActive,s=f.useRef(void 0);return b.jsxs(M,{sx:{flexDirection:"row",gap:1},children:[b.jsx(we,{sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},size:"large",onClick:o,color:a?"secondary":"primary",variant:"contained",startIcon:a?b.jsx(Bn,{}):b.jsx(_n,{}),children:n("reader.settings.auto_scroll.title")}),b.jsx(ke,{value:t.value,type:"number",size:"small",onBlur:function(e){var n=Be(+e.target.value,Ae.min,Ae.max);n!==t.value&&(clearTimeout(s.current),r(x(x({},t),{},{value:n}),!0))},onChange:function(e){var n=Be(+e.target.value,Ae.min,Ae.max);r(x(x({},t),{},{value:n}),!1),clearTimeout(s.current),s.current=setTimeout(function(){return r(x(x({},t),{},{value:n}),!0)},1e3)},slotProps:{input:{inputProps:Ae,endAdornment:b.jsx(Ne,{position:"end",children:n("global.time.seconds.second",{count:t.value})})}}})]})},Vn=f.memo(function(e){var t=e.openSettings,r=ve().t,n=ft(function(e){return{readingMode:e.settings.readingMode,shouldOffsetDoubleSpreads:e.settings.shouldOffsetDoubleSpreads,pageScaleMode:e.settings.pageScaleMode,shouldStretchPage:e.settings.shouldStretchPage,readingDirection:e.settings.readingDirection,autoScroll:e.settings.autoScroll}}),i=n.readingMode,a=n.shouldOffsetDoubleSpreads,o=n.pageScaleMode,s=n.shouldStretchPage,l=n.readingDirection,u=n.autoScroll;return b.jsxs(M,{sx:{gap:1},children:[b.jsx(Ln,{readingMode:i,setReadingMode:function(e){return vt.updateSetting("readingMode",e)},isDefaultable:!0,onDefault:function(){return vt.deleteSetting("readingMode")}}),b.jsx(An,{readingMode:i.value,shouldOffsetDoubleSpreads:a.value,setShouldOffsetDoubleSpreads:function(e){return vt.updateSetting("shouldOffsetDoubleSpreads",e)}}),b.jsx(Rn,{pageScaleMode:o,shouldStretchPage:s,updateSetting:vt.updateSetting,isDefaultable:!0,onDefault:function(){return vt.deleteSetting("pageScaleMode")}}),b.jsx(Nn,{readingDirection:l,setReadingDirection:function(e){return vt.updateSetting("readingDirection",e)},isDefaultable:!0,onDefault:function(){return vt.deleteSetting("readingDirection")}}),b.jsx(Wn,{autoScroll:u,setAutoScroll:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=vt).updateSetting.apply(e,["autoScroll"].concat(r))}}),b.jsx(we,{onClick:function(){return t()},size:"large",sx:{justifyContent:"start",textTransform:"none"},variant:"contained",startIcon:b.jsx(_e,{}),children:r("settings.title")})]})}),Hn=he(b.jsx("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"})),zn=x(x({},Fr),{},{title:"Fallback",inLibrary:!1}),Un=f.memo(function(){var e=zt(function(e){return e.manga}),t=(null!=e?e:zn).inLibrary,r=ve().t,n=Dr(null!=e?e:zn,!0),i=n.CategorySelectComponent,a=n.updateLibraryState;return b.jsxs(b.Fragment,{children:[b.jsx(_,{title:r(t?"manga.action.library.remove.label.action":"manga.button.add_to_library"),children:b.jsx(We,{onClick:a,color:"inherit",children:t?b.jsx(zr,{}):b.jsx(Or,{})})}),i]})}),Fn=he(b.jsx("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"})),Gn=f.memo(function(e){var t=e.id,r=e.isBookmarked,n=ve().t,i=r?"unbookmark":"bookmark";return b.jsx(_,{title:n(Pr[i].action.single),children:b.jsx(We,{onClick:function(){return yr.performAction(i,[t],{})},color:"inherit",children:r?b.jsx(Br,{}):b.jsx(Fn,{})})})}),Xn=function(e){var t,r=e.currentChapter,n=ve().t,i=yr.useDownloadStatusFromCache(null!==(t=null==r?void 0:r.id)&&void 0!==t?t:-1);return r&&yr.isDownloaded(r)?b.jsx(_,{title:n(Pr.delete.action.single),children:b.jsx(We,{onClick:function(){return yr.performAction("delete",[r.id],{})},color:"inherit",children:b.jsx(Vr,{})})}):i?b.jsx(Hr,{chapterId:i.chapter.id}):b.jsx(_,{title:n(Pr.download.action.single),disabled:!r,children:b.jsx(We,{disabled:!r,onClick:function(){var e;return yr.performAction("download",[null!==(e=null==r?void 0:r.id)&&void 0!==e?e:-1],{})},color:"inherit",children:b.jsx(Wr,{})})})},Yn=f.memo(function(){var e=Ut(function(e){return e.chapters.currentChapter}),t=null!=e?e:jr,r=t.id,n=t.isBookmarked,i=t.realUrl,a=ve().t,o=bt(function(e){return{pageLoadStates:e.pages.pageLoadStates,setPageLoadStates:e.pages.setPageLoadStates,setRetryFailedPagesKeyPrefix:e.pages.setRetryFailedPagesKeyPrefix}}),s=o.pageLoadStates,l=o.setPageLoadStates,u=o.setRetryFailedPagesKeyPrefix,c=f.useRef(0),d=f.useMemo(function(){return s.some(function(e){return e.error})},[s]);return b.jsxs(M,{sx:{flexDirection:"row",justifyContent:"center",gap:1},children:[b.jsx(Un,{}),b.jsx(Gn,{id:r,isBookmarked:n}),b.jsx(_,{title:a("reader.button.retry_load_pages"),disabled:!d,children:b.jsx(We,{onClick:function(){l(function(e){return e.map(function(e){return{url:e.url,loaded:e.loaded}})}),u("".concat(c.current)),c.current=(c.current+1)%1e3},disabled:!d,color:"inherit",children:b.jsx(Hn,{})})}),b.jsx(Xn,{currentChapter:e}),b.jsx(_,{title:a("global.button.open_browser"),disabled:!i,children:b.jsx(We,{disabled:!i,href:null!=i?i:"",rel:"noreferrer",target:"_blank",color:"inherit",children:b.jsx(_r,{})})}),b.jsx(_,{title:a("global.button.open_webview"),disabled:!i,children:b.jsx(We,{disabled:!i,href:i?Ve.getWebviewUrl(i):"",rel:"noreferrer",target:"_blank",color:"inherit",children:b.jsx(Ur,{})})})]})}),Zn=xt(f.memo(function(e){var t=e.exit,r=ve().t,n=xe();return b.jsx(_,{title:r("reader.button.exit"),children:b.jsx(We,{sx:{marginRight:2},onClick:t,color:"inherit",children:n(b.jsx(He,{}),b.jsx(ze,{}))})})}),[function(){return{exit:vt.useExit()}}],["exit"]),Kn=xt(f.memo(function(e){var t=e.isVisible,r=e.openSettings,n=e.setReaderNavBarWidth,i=ve().t,a=zt(function(e){return e.manga}),o=Ut(function(e){return{chapters:e.chapters.chapters,currentChapter:e.chapters.currentChapter,previousChapter:e.chapters.previousChapter,nextChapter:e.chapters.nextChapter}}),s=o.chapters,l=o.currentChapter,u=o.previousChapter,c=o.nextChapter,d=ft(function(e){return e.settings.isStaticNav}),p=S(f.useState(),2),g=p[0],h=p[1];re(g,f.useCallback(function(){d&&n(g.offsetWidth)},[g,d])),f.useLayoutEffect(function(){return function(){return n(0)}},[]);var v=function(e,t){var r=f.useRef(t),n=f.useRef(t);return n.current!==r.current&&!e&&(r.current=!1),n.current!==t&&(r.current=n.current,n.current=t),r.current}(t,d),x=v&&t?0:void 0;return b.jsx(Ue,{variant:d?"permanent":"persistent",open:t||d,transitionDuration:x,SlideProps:{unmountOnExit:!0},PaperProps:{ref:function(e){return h(e)}},children:b.jsxs(Sn,{sx:{backgroundColor:"background.paper",pointerEvents:"all"},children:[b.jsxs(M,{sx:{p:2,gap:2,backgroundColor:"action.hover"},children:[b.jsxs(M,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[b.jsx(Zn,{}),b.jsx(_,{title:i("reader.settings.label.static_navigation"),children:b.jsx(We,{onClick:function(){n(0),vt.updateSetting("isStaticNav",!d)},color:d?"primary":"inherit",children:d?b.jsx(wr,{}):b.jsx(Tr,{})})})]}),a&&l?b.jsxs(b.Fragment,{children:[b.jsx(Cn,{mangaId:a.id,mangaTitle:a.title,chapterTitle:l.name,scanlator:l.scanlator}),b.jsx(Yn,{})]}):b.jsx(Fe,{})]}),b.jsxs(M,{sx:{p:2,gap:2},children:[b.jsxs(M,{sx:{gap:1},children:[b.jsx(wn,{}),b.jsx(In,{chapters:s,currentChapter:l,nextChapter:c,previousChapter:u})]}),b.jsx(Ge,{}),b.jsx(Vn,{openSettings:r})]})]})})}),[T],["setReaderNavBarWidth"]),qn=x(x({},Fr),{},{title:""}),Jn=f.forwardRef(function(e,t){var r,n=e.isVisible,i=ve().t,a=Ce({popupId:"reader-overlay-more-menu",variant:"popover"}),o=Ut(function(e){return e.chapters.currentChapter}),s=zt(function(e){return e.manga}),l=mt(function(e){return e.scrollbar}),c=null!=s?s:qn,d=c.id,g=c.title,f=null!=o?o:jr,h=f.id,v=f.name,m=f.realUrl,S=f.isBookmarked;return b.jsx(Xe,{direction:"down",in:n,ref:t,children:b.jsxs(M,{sx:{flexDirection:"row",alignItems:"center",position:"fixed",top:0,left:0,right:"".concat(l.ySize,"px"),p:2,pt:function(e){return"max(env(safe-area-inset-top), ".concat(e.spacing(2),")")},backgroundColor:function(e){return ce(e.palette.background.paper,.95)},pointerEvents:"all",boxShadow:2},children:[b.jsx(Zn,{}),b.jsx(M,{sx:{flexGrow:1},children:s&&o?b.jsxs(b.Fragment,{children:[b.jsx(_,{title:g,children:b.jsx(pe,{lines:1,component:"h1",variant:"h5",children:b.jsx(Er,{component:fe,to:ge.manga.path(d),sx:{textDecoration:"none",color:"inherit"},children:g})})}),b.jsx(_,{title:v,children:b.jsx(pe,{lines:1,children:v})})]}):b.jsx(Fe,{})}),b.jsx(Un,{}),b.jsx(Gn,{id:h,isBookmarked:S}),b.jsx(We,x(x({},ye(a)),{},{color:"inherit",children:b.jsx(Rr,{})})),b.jsxs(Ye,x(x({},Ze(a)),{},{children:[b.jsx(Se,{component:Er,disabled:!m,href:null!=m?m:"",rel:"noreferrer",target:"_blank",children:i("global.button.open_browser")}),b.jsx(Se,{component:Er,disabled:!m,href:m?Ve.getWebviewUrl(m):"",rel:"noreferrer",target:"_blank",children:i("global.button.open_webview")}),b.jsx(Se,{disabled:!m,onClick:(r=p(u().m(function e(){return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,navigator.clipboard.writeText(g);case 1:Ke(i("global.label.copied_clipboard"),"info");case 2:return e.a(2)}},e)})),function(){return r.apply(this,arguments)}),children:i("global.label.share")})]}))]})})}),$n=f.memo(Jn),Qn=he(b.jsx("path",{d:"m21.81 12.74-.82-.63v-.22l.8-.63c.16-.12.2-.34.1-.51l-.85-1.48c-.07-.13-.21-.2-.35-.2q-.075 0-.15.03l-.95.38c-.08-.05-.11-.07-.19-.11l-.15-1.01c-.03-.21-.2-.36-.4-.36h-1.71c-.2 0-.37.15-.4.34l-.14 1.01c-.03.02-.07.03-.1.05l-.09.06-.95-.38q-.075-.03-.15-.03c-.14 0-.27.07-.35.2l-.85 1.48c-.1.17-.06.39.1.51l.8.63v.23l-.8.63c-.16.12-.2.34-.1.51l.85 1.48c.07.13.21.2.35.2q.075 0 .15-.03l.95-.37c.08.05.12.07.2.11l.15 1.01c.03.2.2.34.4.34h1.71c.2 0 .37-.15.4-.34l.15-1.01c.03-.02.07-.03.1-.05l.09-.06.95.38q.075.03.15.03c.14 0 .27-.07.35-.2l.85-1.48c.1-.17.06-.39-.1-.51M18 13.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5M17 17h2v4c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v4h-2V6H7v12h10z"})),ei=he(b.jsx("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5m0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5m0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5M7 19h14v-2H7zm0-6h14v-2H7zm0-8v2h14V5z"})),ti=he(b.jsx("path",{d:"M6 6h2v12H6zm3.5 6 8.5 6V6z"})),ri=he(b.jsx("path",{d:"m6 18 8.5-6L6 6zM16 6v12h2V6z"})),ni={display:"flex",alignItems:"center",justifyContent:"end",position:"relative",backgroundColor:"background.default"},ii=f.memo(function(e){var t=e.isTrailingPage,r=e.pagesIndex,n=e.totalPages,i=e.isVertical,a=e.isHorizontal,o="".concat(r/(n-1)*100,"%");return b.jsx(D,{sx:x(x(x(x({position:"absolute"},P(i,{top:o,left:"50%"})),P(a,{top:"50%",left:o})),{},{transform:"translate(-50%, -50%)",width:"3px",height:"3px",borderRadius:100,backgroundColor:"background.paper"},P(t,{backgroundColor:"primary.main"})),{},{zIndex:1})})}),ai=f.memo(function(e){var t=e.pageName,r=e.isTrailingPage,n=e.isCurrentPage,i=e.pagesIndex,a=e.totalPages,o=e.isVertical,s=e.isHorizontal;return b.jsx(xn,{pageName:t,progressBarPosition:qe.BOTTOM,slotProps:{box:{sx:ni}},children:!n&&b.jsx(ii,{isTrailingPage:r,pagesIndex:i,totalPages:a,isVertical:o,isHorizontal:s})})}),oi=m(m(m(m({},qe.BOTTOM,"up"),qe.LEFT,"right"),qe.RIGHT,"left"),qe.AUTO,"left"),si=xt(f.memo(function(e){var t=e.direction,r=e.topOffset,n=void 0===r?0:r,i=e.bottomOffset,a=void 0===i?0:i,o=mt(function(e){return e.scrollbar}),s=Ft(function(e){return e.overlay.isVisible}),l=bt(function(e){return{currentPageIndex:e.pages.currentPageIndex,pages:e.pages.pages}}),u=l.currentPageIndex,c=l.pages,d=Ut(function(e){return{previousChapter:e.chapters.previousChapter,nextChapter:e.chapters.nextChapter}}),p=d.previousChapter,g=d.nextChapter,h=ft(function(e){return{progressBarPosition:e.settings.progressBarPosition,progressBarPositionAutoVertical:e.settings.progressBarPositionAutoVertical}}),v=h.progressBarPosition,m=h.progressBarPositionAutoVertical,C=St(function(e){return{setIsMaximized:e.progressBar.setIsMaximized,isDragging:e.progressBar.isDragging}}),y=C.setIsMaximized,j=C.isDragging,w=S(f.useState({}),2)[1];re(window.document.documentElement,f.useCallback(function(){return w({})},[]));var T=_t(v,m,n+a,o.xSize),E=yt(T),I=E.isLeft,O=E.isRight,R=E.isVertical,L=E.isHorizontal,k=L?t:"ltr",A=f.useMemo(function(){return Ct(u,c).pagesIndex},[u,c]),N=f.useMemo(function(){return{container:{sx:{flexGrow:1,position:"relative",display:"flex",justifyItems:"center",alignItems:"stretch",backgroundColor:function(e){return ce(e.palette.background.paper,.85)},borderRadius:100,boxShadow:2}},progressBarRoot:{sx:x(x({flexGrow:1,gap:0},P(R,{flexDirection:"column"})),P(L,{alignItems:"stretch"}))},progressBarSlotsActionArea:{sx:x(x({alignItems:"center",cursor:"pointer"},P(R,{width:"100%",flexDirection:"column",px:2})),P(L,{height:"100%",py:2}))},progressBarSlotsContainer:{sx:x(x({borderRadius:100,backgroundColor:"background.default"},P(R,{flexDirection:"column",py:1})),P(L,{px:1}))},progressBarSlot:{sx:x(x({},P(R,{width:"20px"})),P(L,{height:"20px"}))},progressBarCurrentPageSlot:{sx:x(x({display:"flex",zIndex:1,cursor:"inherit"},P(R,{justifyContent:"center"})),P(L,{alignItems:"center"}))},progressBarPageTexts:{base:{sx:x(x({},P(R,{py:1})),P(L,{px:1}))}}}},[R,L]),B=f.useMemo(function(){return{progressBarCurrentPage:b.jsx(D,{sx:x(x(x({position:"absolute"},P(R,x(x({top:"calc(100% - 6px)"},P(0===A,{top:"0"})),{},{width:"75%",height:"6px"}))),P(L,x(x({left:"calc(100% - 0px)"},P(0===A,{left:"0"})),{},{width:"6px",height:"75%"}))),{},{backgroundColor:"primary.main",borderRadius:100,cursor:j?"grabbing":"grab"})})}},[A,c.length,j,R,L]);return f.useLayoutEffect(function(){return y(s),function(){return y(!1)}},[s]),b.jsx(Xe,{direction:oi[T],in:s,children:b.jsx(vn,{sx:x(x({position:"relative",display:"flex",alignItems:"end",height:"100%",pointerEvents:"none"},P(I,{justifyContent:"ltr"===t?"start":"end"})),P(O,{justifyContent:"ltr"===t?"end":"start"})),children:b.jsxs(M,{sx:x(x({p:2,gap:1,pointerEvents:"all",alignItems:"center"},P(R,{height:"100%",flexDirection:"column"})),P(L,{width:"100%",flexDirection:"row"})),children:[b.jsx(We,{onClick:function(){return dn.openChapter("previous")},disabled:!p,sx:{backgroundColor:function(e){return ce(e.palette.background.paper,.85)},boxShadow:2},children:te(b.jsx(ti,{sx:x({},P(R,{transform:"rotate(90deg)"}))}),b.jsx(ri,{sx:x({},P(R,{transform:"rotate(90deg)"}))}),k)}),b.jsx(fn,{direction:k,progressBarPosition:T,fullSegmentClicks:!1,createProgressBarSlot:f.useCallback(function(e,t,r,n,i,a,o,s){return b.jsx(ai,{pageName:e.name,isTrailingPage:o,isCurrentPage:i,pagesIndex:t,totalPages:s,isVertical:R,isHorizontal:L})},[R,L]),slotProps:x(x({},N),{},{progressBarReadPages:{sx:x(x({backgroundColor:"primary.main"},P(R,{width:"20px",height:"".concat(Math.max(0,Ct(u,c).pagesIndex)/(c.length-1)*100,"%"),borderRadius:"400px 400px 0 0"})),P(L,{width:"".concat(Math.max(0,Ct(u,c).pagesIndex)/(c.length-1)*100,"%"),height:"20px",borderRadius:"400px 0 0 400px"}))}}),slots:B}),b.jsx(We,{onClick:function(){return dn.openChapter("next")},disabled:!g,sx:{backgroundColor:function(e){return ce(e.palette.background.paper,.85)},boxShadow:2},children:te(b.jsx(ri,{sx:x({},P(R,{transform:"rotate(90deg)"}))}),b.jsx(ti,{sx:x({},P(R,{transform:"rotate(90deg)"}))}),k)})]})})})}),[function(){return{direction:vt.useGetThemeDirection()}}],["direction"]),li=f.memo(function(){var e=ve().t,t=Ht(function(e){return{isActive:e.autoScroll.isActive,toggleActive:e.autoScroll.toggleActive}}),r=t.isActive,n=t.toggleActive,i=ft(function(e){return{readingMode:e.settings.readingMode,readingDirection:e.settings.readingDirection,autoScroll:e.settings.autoScroll}}),a=i.readingMode,o=i.readingDirection,s=i.autoScroll;return b.jsxs(M,{sx:{gap:2},children:[b.jsx(Gt,{}),b.jsx(Xt,{readingMode:a,setReadingMode:function(e){return vt.updateSetting("readingMode",e)},isDefaultable:!0,onDefault:function(){return vt.deleteSetting("readingMode")}}),b.jsx(Yt,{readingDirection:o,setReadingDirection:function(e){return vt.updateSetting("readingDirection",e)},isDefaultable:!0,onDefault:function(){return vt.deleteSetting("readingDirection")}}),b.jsx(Gr,{label:e("reader.settings.auto_scroll.title"),checked:r,onChange:function(){return n()}}),b.jsx(Zt,{autoScroll:s,setAutoScroll:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=vt).updateSetting.apply(e,["autoScroll"].concat(r))}})]})}),ui=f.memo(function(e){var t=e.openSettings,r=e.isVisible,n=e.topOffset,i=void 0===n?0:n,a=ve().t,o=Ut(function(e){return{currentChapter:e.chapters.currentChapter,chapters:e.chapters.chapters}}),s=o.currentChapter,l=o.chapters,u=Ce({variant:"dialog",popupId:"reader-chapter-list-dialog"}),c=Ce({variant:"dialog",popupId:"reader-quick-settings-dialog"}),d=mt(function(e){return e.scrollbar}),p=S(f.useState(0),2),g=p[0],h=p[1],v=f.useRef(null);return re(v,f.useCallback(function(){var e,t;return h(null!==(e=null===(t=v.current)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:0)},[g])),f.useLayoutEffect(function(){u.close()},[null==s?void 0:s.id]),b.jsxs(b.Fragment,{children:[b.jsxs(M,{sx:{position:"fixed",right:"".concat(d.ySize,"px"),bottom:0,left:0,height:"calc(100% - ".concat(i,"px)")},children:[b.jsx(si,{topOffset:i,bottomOffset:g}),b.jsx(Xe,{direction:"up",in:r,children:b.jsx(M,{ref:v,sx:{alignItems:"center",backgroundColor:function(e){return ce(e.palette.background.paper,.95)},pb:"max(".concat(d.xSize,"px, env(safe-area-inset-bottom))"),boxShadow:2,pointerEvents:"all"},children:b.jsxs(M,{sx:{width:"50%",flexDirection:"row",p:2,gap:1,justifyContent:"space-evenly",alignItems:"center"},children:[b.jsx(_,{title:a("reader.button.chapter_list"),children:b.jsx(We,x(x({},ye(u)),{},{color:"inherit",children:b.jsx(ei,{})}))}),b.jsx(_,{title:a("reader.settings.title.quick_settings"),children:b.jsx(We,x(x({},ye(c)),{},{color:"inherit",children:b.jsx(Qn,{})}))}),b.jsx(_,{title:a("settings.title"),children:b.jsx(We,{onClick:t,color:"inherit",children:b.jsx(_e,{})})})]})})})]}),u.isOpen&&b.jsx(y,x(x({},Je(u)),{},{fullWidth:!0,maxWidth:"md",scroll:"paper",children:b.jsx(j,{sx:{p:0,pb:1},children:b.jsx(En,{style:{minHeight:"15vh",maxHeight:"75vh"},currentChapter:s,chapters:l})})})),c.isOpen&&b.jsx(y,x(x({},Je(c)),{},{fullWidth:!0,maxWidth:"md",scroll:"paper",children:b.jsx(j,{children:b.jsx(li,{})})}))]})}),ci=xt(f.memo(function(e){var t=e.isVisible,r=e.isDesktop,n=e.isMobile,i=S(f.useState(!1),2),a=i[0],o=i[1],s=S(f.useState(0),2),l=s[0],u=s[1],d=f.useRef(null);return re(d,f.useCallback(function(){var e,t;return u(null!==(e=null===(t=d.current)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:0)},[n])),b.jsxs(D,{sx:{position:"absolute",width:"100%",height:"100%",pointerEvents:"none",zIndex:1},children:[r&&b.jsxs(b.Fragment,{children:[b.jsx(bn,{}),b.jsx(Kn,{isVisible:t,openSettings:function(){return o(!0)}})]}),n&&b.jsxs(b.Fragment,{children:[b.jsx($n,{ref:d,isVisible:t}),b.jsx(ui,{openSettings:function(){return o(!0)},isVisible:t,topOffset:l})]}),b.jsx(c,{isOpen:a,close:function(){return o(!1)}}),b.jsx(Jr,{})]})}),[vt.useOverlayMode],["isDesktop","isMobile"]),di="reader-tap-zone-layout-canvas",pi=xt(function(e){var t=e.readerNavBarWidth,r=le(),n=ft(function(e){return{tapZoneLayout:e.settings.tapZoneLayout.value,tapZoneInvertMode:e.settings.tapZoneInvertMode.value,readingDirection:e.settings.readingDirection.value}}),i=n.tapZoneLayout,a=n.tapZoneInvertMode,o=n.readingDirection,s=Kt(function(e){return e.tapZone.showPreview}),l=S(f.useState(0),2),u=l[0],c=l[1],d=S(f.useState(0),2),p=d[0],g=d[1],h=S(f.useState(null),2),v=h[0],x=h[1];re(v,f.useCallback(function(){var e,t;c(null!==(e=null==v?void 0:v.clientWidth)&&void 0!==e?e:0),g(null!==(t=null==v?void 0:v.clientHeight)&&void 0!==t?t:0)},[v]));var m=cn.getOrCreateCanvas(i,u,p,r.typography.h3,{vertical:a.vertical,horizontal:a.horizontal,isRTL:o===E.RTL});return f.useLayoutEffect(function(){var e=document.getElementById(di);null==e||e.replaceChildren(m)},[m,s]),b.jsx(D,{ref:x,sx:{position:"fixed",top:0,left:t,right:0,bottom:0,pointerEvents:"none"},children:s&&b.jsx("div",{id:di})})},[T],["readerNavBarWidth"]),gi=xt(function(e){var t=e.readerNavBarWidth,r=ft(function(e){return e.settings.customFilter.rgba}),n=r.value,i=n.red,a=n.green,o=n.blue,s=n.alpha,l=n.blendMode;return r.enabled?b.jsx(D,{sx:{position:"fixed",top:0,left:t,right:0,bottom:0,pointerEvents:"none",background:"rgba(".concat(i," ").concat(a," ").concat(o," / ").concat(s,"%)"),mixBlendMode:"".concat(l)}}):null},[T],["readerNavBarWidth"]),fi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.XY,r=S(f.useState(!1),2),n=r[0],i=r[1],a=f.useRef(void 0),o=f.useRef([0,0,0]),s=f.useRef([0,0,0]),l=f.useRef([0,0,0]),u=f.useRef([0,0]),c=f.useRef(void 0),d=f.useRef([0,0]),p=f.useRef([0,0]);return f.useEffect(function(){var r=null==e?void 0:e.current;if(!r)return function(){};var n=function(){a.current||(a.current=getComputedStyle(r));var e="rtl"===a.current.direction,t="row-reverse"===a.current.flexDirection;return e||!e&&t},g=t!==X.Y,f=t!==X.X,h=function(){void 0!==c.current&&(cancelAnimationFrame(c.current),c.current=void 0)},v=!1,x=function(e){(function(e){if(v)return!0;var t=[r.clientHeight<r.scrollHeight,r.clientWidth<r.scrollWidth],n=[Math.abs(o.current[0]-e.pageX)>0,Math.abs(s.current[0]-e.pageY)>0];return t[0]&&n[0]||t[1]&&n[1]})(e)&&(v=!0,i(!0),o.current=[].concat(C(o.current.slice(1)),[e.pageX]),s.current=[].concat(C(s.current.slice(1)),[e.pageY]),l.current=[].concat(C(l.current.slice(1)),[Date.now()]),g&&(r.scrollLeft=p.current[0]-(e.pageX-d.current[0])),f&&(r.scrollTop=p.current[1]-(e.pageY-d.current[1])))},m=function(){r.removeEventListener("mousemove",x),r.removeEventListener("mouseup",m),setTimeout(function(){v=!1,i(!1)},0),u.current=[r.scrollLeft,r.scrollTop];var e=function(){!function(){var e=function(e,t,r){return(e[0]-e[2])/(t[0]-t[2])*1e3/r},t=[g?e(o.current,l.current,r.clientWidth):0,f?e(s.current,l.current,r.clientHeight):0],i=g&&f?Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)):f?Math.abs(t[1]):Math.abs(t[0]),c=[t[0]/i,t[1]/i],d=Be(1.2*i,-12,12),p=(Date.now()-l.current[0])/1e3,v=d-14.278*p+75.24*Math.pow(p,2)/d-149.72*Math.pow(p,3)/d/d;if(0!==d&&v>0&&!Number.isNaN(d)){var x=function(e,t){return e*t*(d*p-7.1397*Math.pow(p,2)+25.08*Math.pow(p,3)/d-37.43*Math.pow(p,4)/d/d)},m=[x(r.clientWidth,c[0]),x(r.clientHeight,c[1])],b=[r.scrollWidth-r.clientWidth,r.scrollHeight-r.clientHeight],S=[Be(u.current[0]-m[0],n()?-b[0]:0,b[0]),Be(u.current[1]-m[1],(a.current||(a.current=getComputedStyle(r)),"column-reverse"===a.current.flexDirection?-b[1]:0),b[1])];0!==S[0]||S[0]!==b[0]||0!==S[1]||S[1]!==b[1]||h(),g&&(r.scrollLeft=S[0]),f&&(r.scrollTop=S[1])}else h()}(),c.current=requestAnimationFrame(e)};c.current=requestAnimationFrame(e)},b=function(e){0===e.button&&(e.preventDefault(),d.current=[e.pageX,e.pageY],p.current=[r.scrollLeft,r.scrollTop],o.current=[e.pageX,e.pageX,e.pageX],s.current=[e.pageY,e.pageY,e.pageY],l.current=[Date.now()-2,Date.now()-1,Date.now()],r.addEventListener("mousemove",x),r.addEventListener("mouseup",m),h())};return r.addEventListener("mousedown",b),r.addEventListener("wheel",h),function(){r.removeEventListener("mousedown",b),r.removeEventListener("wheel",h),h()}},[e,t]),n},hi=function(e){var t=e.title,r=e.name,n=e.scanlator,i=e.backgroundColor,a=le(),o=a.palette.getContrastText(et(a.palette,tt[i])),s=ce(o,.5);return r?b.jsxs(M,{children:[b.jsx(O,{color:o,children:t}),b.jsx(O,{color:o,variant:"h6",component:"h1",children:r}),n&&b.jsx(O,{variant:"body2",color:s,children:n})]}):null},vi=xt(f.memo(function(e){var t,r=e.type,n=e.currentChapterName,i=e.currentChapterScanlator,a=e.previousChapterName,o=e.previousChapterScanlator,s=e.nextChapterName,l=e.nextChapterScanlator,u=e.readerNavBarWidth,c=e.handleBack,d=ve().t,p=zt(function(e){return e.manga}),g=mt(function(e){return e.scrollbar}),f=bt(function(e){return e.pages.transitionPageMode}),h=ft(function(e){return{readingMode:e.settings.readingMode.value,backgroundColor:e.settings.backgroundColor,shouldShowTransitionPage:e.settings.shouldShowTransitionPage}}),v=h.readingMode,m=h.backgroundColor,S=h.shouldShowTransitionPage,C=r===q.PREVIOUS,y=r===q.NEXT,j=!!n&&!a,w=!!n&&!s,T=j&&r===q.PREVIOUS,E=w&&r===q.NEXT;return(S||(T||E))&&Qt(r,f,v)?b.jsx(M,{sx:x(x({justifyContent:"center",alignItems:"center"},P(!Pt(v),{width:"100%",height:"100%"})),P(Pt(v),x(x({position:"sticky"},P(er(v),{left:0,maxWidth:"calc(100vw - ".concat(g.ySize,"px - ").concat(u,"px)"),minHeight:"calc(100vh - ".concat(g.xSize,"px)")})),P(v===Q.CONTINUOUS_HORIZONTAL,{top:0,minWidth:"calc(100vw - ".concat(g.ySize,"px - ").concat(u,"px)"),maxHeight:"calc(100vh - ".concat(g.xSize,"px)")})))),children:b.jsxs(M,{sx:{gap:2,maxWidth:function(e){return"calc(100vw - ".concat(g.ySize,"px - ").concat(u,"px - ").concat(e.spacing(2),")")},maxHeight:"calc(100vh - ".concat(g.xSize,"px)"),width:"max-content",p:1},children:[C&&j&&b.jsx(O,{variant:"h6",children:d("reader.transition_page.first_chapter")}),b.jsxs(M,{sx:{gap:5},children:[C&&!j&&b.jsx(hi,{title:d("reader.transition_page.previous"),name:a,scanlator:o,backgroundColor:m}),!!n&&b.jsx(hi,{title:d(C?"reader.transition_page.current":"reader.transition_page.finished"),name:n,scanlator:i,backgroundColor:m}),y&&!w&&b.jsx(hi,{title:d("reader.transition_page.next"),name:s,scanlator:l,backgroundColor:m})]}),y&&w&&b.jsx(O,{variant:"h6",children:d("reader.transition_page.last_chapter")}),(C&&j||y&&w)&&b.jsxs(M,{sx:{flexDirection:"row",flexWrap:"wrap",gap:1},children:[b.jsx(we,{sx:{flexGrow:1},onClick:function(e){e.stopPropagation(),c()},variant:"contained",children:d("reader.transition_page.exit.previous_page")}),b.jsx(we,{sx:{flexGrow:1},component:fe,onClick:function(e){e.stopPropagation()},variant:"contained",to:ge.manga.path(null!==(t=null==p?void 0:p.id)&&void 0!==t?t:-1),children:d("reader.transition_page.exit.manga_page")})]})]})}):null}),[function(e){var t=e.chapterId,r=Ut(function(e){return e.chapters.chapters}),n=f.useMemo(function(){return r.findIndex(function(e){return e.id===t})},[t,r]),i=r[n],a=f.useMemo(function(){return r[n+1]},[n,r]),o=f.useMemo(function(){return r[n-1]},[n,r]);return{currentChapterName:null==i?void 0:i.name,currentChapterScanlator:null==i?void 0:i.scanlator,previousChapterName:null==a?void 0:a.name,previousChapterScanlator:null==a?void 0:a.name,nextChapterName:null==o?void 0:o.name,nextChapterScanlator:null==o?void 0:o.scanlator}},T,function(e){var t=e.chapterId,r=e.type,n=$e(),i=Ut(function(e){return e.chapters.chapters}),a=f.useMemo(function(){return i.findIndex(function(e){return e.id===t})},[t,i]),o=0===a,s=a===i.length-1,l=r===q.PREVIOUS&&s,u=r===q.NEXT&&o;return{handleBack:l||u?n:Qe}}],["currentChapterName","currentChapterScanlator","previousChapterName","previousChapterScanlator","nextChapterName","nextChapterScanlator","readerNavBarWidth","handleBack"]),xi="-10px",mi=function(e,t,r){if(Pt(t)){var n=K[r],i="0px ".concat(xi," 0px 0px"),a="0px 0px 0px ".concat(xi);return er(t)?"first"===e?"0px 0px ".concat(xi," 0px"):"".concat(xi," 0px 0px 0px"):"first"===e?te(i,a,n):te(a,i,n)}},bi=function(e,t,r,n){var i=t.top,a=t.right,o=t.bottom,s=t.left,l=window.innerWidth-n,u=window.innerHeight-r;return m(m({},Q.CONTINUOUS_VERTICAL,{start:o>=u,end:i<0}),Q.CONTINUOUS_HORIZONTAL,function(e,t,r,n){return e===E.LTR?{start:r>=n,end:t<0}:{start:t<0,end:r>=n}}(e,s,a,l))},Si=function(e,t,r,n,i,a,o){var s=ft(function(e){return{readingMode:e.settings.readingMode.value,readingDirection:e.settings.readingDirection.value,shouldUseInfiniteScroll:e.settings.shouldUseInfiniteScroll,shouldShowTransitionPage:e.settings.shouldShowTransitionPage}}),l=s.readingMode,u=s.readingDirection,c=s.shouldUseInfiniteScroll,d=s.shouldShowTransitionPage;f.useEffect(function(){var t=Pt(l),a=er(l);if(d||!o||!t||!c||!n||i||void 0===r)return function(){};var s=function(){var t=0===o.scrollLeft,n=o.scrollLeft===o.scrollWidth-o.clientWidth,i=0===o.scrollTop,s=o.scrollTop===o.scrollHeight-o.clientHeight;("first"===e&&(a?i:t)||"last"===e&&(a?s:n))&&dn.openChapter(r,void 0,!1)};return o.addEventListener("scroll",s),function(){return o.removeEventListener("scroll",s)}},[l,o,d,c,n,i,r]),Yr(a,f.useCallback(function(a){if(c&&Pt(l)&&void 0!==r&&(d||i)){var o=a[a.length-1],s=bi(u,o.target.getBoundingClientRect(),rr().xSize,rr().ySize),p=function(e,t){var r=e[Q.CONTINUOUS_VERTICAL],n=e[Q.CONTINUOUS_HORIZONTAL];return er(t)?r:n}(s,l),g=p.start,f=p.end,h=o.intersectionRatio<=0;if(function(e,t){var r=e[Q.CONTINUOUS_VERTICAL],n=e[Q.CONTINUOUS_HORIZONTAL];return er(t)?r.start||r.end:n.start||n.end}(s,l)){var v="last"===e&&!n&&f;"first"===e&&g&&!i||"last"===e&&f&&h?dn.openChapter(r,!i,!1):v&&dn.openChapter(t,!1,!1)}}},[e,t,r,n,i,l,u,c,d]),f.useMemo(function(){return{root:o,threshold:[0],rootMargin:mi(e,l,u),ignoreInitialObserve:!0}},[e,l,u]))},Ci=f.memo(function(e){var t=e.chapterId,r=e.previousChapterId,n=e.nextChapterId,i=e.isPreviousChapterVisible,a=e.isCurrentChapter,o=e.isNextChapterVisible,s=e.imageWrapper,l=e.scrollElement;return Si("first",t,r,a,i,s,l),Si("last",t,n,a,o,s,l),null}),yi=f.memo(function(e){var t=e.currentPageIndex,r=e.setPages,n=e.setPageLoadStates,i=e.setTotalPages,a=e.setCurrentPageIndex,o=e.updateCurrentPageIndex,s=e.setPageToScrollToIndex,l=e.transitionPageMode,u=e.retryFailedPagesKeyPrefix,c=e.setTransitionPageMode,d=e.readingMode,p=e.readerWidth,g=e.pageScaleMode,h=e.shouldOffsetDoubleSpreads,v=e.readingDirection,m=e.imagePreLoadAmount,C=e.pageGap,y=e.chapterId,j=e.previousChapterId,w=e.nextChapterId,T=e.isPreviousChapterVisible,I=e.isNextChapterVisible,O=e.lastPageRead,R=e.isInitialChapter,L=e.isCurrentChapter,k=e.isPreviousChapter,A=e.isNextChapter,N=e.isLeadingChapter,B=e.isTrailingChapter,_=e.isPreloadMode,W=e.imageRefs,V=e.scrollIntoView,H=e.resumeMode,z=e.customFilter,U=e.shouldStretchPage,F=e.readerNavBarWidth,G=e.onSizeChange,X=e.minWidth,Z=e.minHeight,K=e.scrollElement,J=ve().t,$=le().direction,ee=S(Ve.useGetChapterPagesFetch(null!=y?y:-1),2),te=ee[0],ne=ee[1],ie=S(f.useState(!1),2),ae=ie[0],oe=ie[1],se=S(f.useState(nr.totalPages),2),ue=se[0],ce=se[1],de=S(f.useState(nr.pageUrls),2),pe=de[0],ge=de[1],fe=S(f.useState(nr.pages),2),he=fe[0],xe=fe[1],me=S(f.useState(nr.pageLoadStates),2),be=me[0],Se=me[1],Ce=S(f.useState(be.map(function(e){return{url:e.url,isSpread:!1}})),2),ye=Ce[0],Pe=Ce[1],je=f.useRef(null),we=f.useRef(L),Te=f.useRef(he.map(function(){return null})),Ee=f.useRef(null),Ie=f.useMemo(function(){return!ue?he:ue===ye.length&&d===Q.DOUBLE_PAGE?ir(pe,ye,h,v):he},[ye,d,h,v,ue]),Me=f.useMemo(function(){return ar(d)},[d]),De=v===E.LTR,Oe=Pt(d),Re=!Oe&&!L||_,Le=!Oe&&L,ke=!Re&&(Le||Oe&&(R||N)),Ae=!Re&&(Le||Oe&&(R||B));we.current=L,L&&(W.current=Te.current);var Ne=f.useCallback(function(){y&&(oe(!1),te({variables:{input:{chapterId:y}}}).catch(Y()))},[te,y]),Be=f.useMemo(function(){return or(Ie,Pe,function(e){we.current&&n(e),Se(e)},d)},[Ie,d]),_e=f.useMemo(function(){return sr(function(e){we.current&&n(e),Se(e)})},[]);f.useEffect(function(){Ne()},[y]),re(je,f.useCallback(function(e){var t=e[0].target,r=t.clientWidth,n=t.clientHeight;G(r,n,y)},[G,je.current,y]));var We=function(e,t,r){!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])&&ae||t(e),L&&r(e)};return function(e,t,r,n,i,a,o,s,l,u,c,d,p,g,h,v,m,b){var S,C=f.useRef(void 0);f.useLayoutEffect(function(){var e,f=null===(e=t.data)||void 0===e?void 0:e.fetchChapterPages;if(f){var S=f.pages,y=S.length?S:[""],P=tr(r,null!=n?n:0,y.length-1),j=C.current!==(null==f?void 0:f.pages);if(j){C.current=f.pages;var w=$t(y);l(!0),d(w),p(y),g(w.map(function(e){return{url:e.primary.url,loaded:!1}})),h(w.map(function(e){return{url:e.primary.url,isSpread:!1}}))}else d(i),g(a),h(o);c(f.pages.length),p(y),v(P),m(P),u(function(e){return x(x({},e),{},{isCurrentChapterReady:s||j})}),b(q.NONE)}},[null===(S=t.data)||void 0===S||null===(S=S.fetchChapterPages)||void 0===S?void 0:S.pages,e])}(L,ne,H,O,Ie,be,ye,ae,oe,function(e){return We(e,Qe,wt().setReaderStateChapters)},function(e){return We(e,ce,i)},function(e){return We(e,xe,r)},function(e){return We(e,ge,Qe)},function(e){return We(e,Se,n)},function(e){return We(e,Pe,Qe)},function(e){return We(e,Qe,a)},function(e){(R&&!ae||V)&&(s(e),wt().setReaderStateChapters(function(e){return x(x({},e),{},{visibleChapters:x(x({},e.visibleChapters),{},{scrollIntoView:!1,resumeMode:void 0})})}))},function(e){return We(e,Qe,c)}),function(e,t,r,n,i,a,o){var s=S(f.useState(o===Q.DOUBLE_PAGE),2),l=s[0],u=s[1];f.useLayoutEffect(function(){if(l&&o!==Q.DOUBLE_PAGE){u(!1);var s=$t(r);return n(s),void i(s.map(function(e){return{url:e.primary.url,isSpread:!1}}))}o===Q.DOUBLE_PAGE&&(l||a(Mt(Ct(e,t))),n(t),u(o===Q.DOUBLE_PAGE))},[t,o])}(t,Ie,pe,function(e){return We(e,xe,r,!0)},function(e){return We(e,Pe,Qe,!0)},function(e){return We(e,Qe,o)},d),Oe||L||k||A?ne.error?Re?null:b.jsx(D,{sx:{minHeight:"100%",minWidth:"100%",display:"grid",placeItems:"center",position:"relative"},children:b.jsx(Xr,{message:J("global.error.label.failed_to_load_data"),messageExtra:rt(ne.error),retry:function(){Ne()}})}):ne.loading||!ae?Re?null:b.jsx(D,{sx:{minHeight:"100%",minWidth:"100%",display:"grid",placeItems:"center"},children:b.jsx(Fe,{})}):null==y||ue?b.jsxs(M,{ref:je,sx:x(x(x(x(x({width:"fit-content",height:"fit-content",margin:"auto",flexWrap:"nowrap"},P(d===Q.CONTINUOUS_HORIZONTAL,{minHeight:Z})),P(er(d),{minWidth:X})),P(Re,{maxWidth:0,maxHeight:0,minWidth:"unset",minHeight:"unset",overflow:"hidden",margin:"unset"})),P(er(d)&&lr(p,g),{alignItems:"center"})),P(d===Q.CONTINUOUS_HORIZONTAL,x(x({},P("ltr"===$,{flexDirection:De?"row":"row-reverse"})),P("rtl"===$,{flexDirection:De?"row-reverse":"row"})))),children:[!_&&b.jsx(Ci,{chapterId:y,previousChapterId:j,nextChapterId:w,isCurrentChapter:L,isPreviousChapterVisible:T,isNextChapterVisible:I,imageWrapper:Ee.current,scrollElement:K}),ke&&b.jsx(vi,{chapterId:y,type:q.PREVIOUS}),b.jsx(Me,{ref:Ee,totalPages:ue,currentPageIndex:t,pages:Ie,transitionPageMode:l,pageLoadStates:be,retryFailedPagesKeyPrefix:u,imageRefs:Te,onLoad:Be,onError:_e,isCurrentChapter:L,isPreviousChapter:k,isNextChapter:A,readingMode:d,imagePreLoadAmount:m,readingDirection:v,pageScaleMode:g,pageGap:C,customFilter:z,shouldStretchPage:U,readerWidth:p,readerNavBarWidth:F,isPreloadMode:_,resumeMode:H,handleAsInitialRender:V}),Ae&&b.jsx(vi,{chapterId:y,type:q.NEXT})]}):Re?null:b.jsx(D,{sx:{minWidth:"100%",minHeight:"100%",position:"relative"},children:b.jsx(Xr,{message:J("reader.error.label.no_pages_found"),retry:Ne})}):null}),Pi=function(e,t,r){f.useLayoutEffect(function(){r(t)},[e])},ji=function(e,t,r,n){var i=f.useRef({width:window.innerWidth,height:window.innerHeight}),a=f.useCallback(function(){var a=i.current,o=a.width,s=a.height;i.current={width:window.innerWidth,height:window.innerHeight},function(e,t,r,n){var i=cr(t),a=dr(t),o=r!==window.innerWidth,s=n!==window.innerHeight,l=i&&o,u=a&&s;return!(er(e)||!o)||l||u}(e,t,o,s)&&r(n)},[e,t,n]);Zr("resize",a)},wi=function(e){var t=f.useRef({left:0,top:0,visibleElement:void 0,visibleElementLeft:0,visibleElementTop:0});return f.useEffect(function(){var r=e.current;if(!r)return function(){};var n=function(){var e,n,i=t.current.visibleElement;t.current=x(x({},t.current),{},{left:r.scrollLeft,top:r.scrollTop,visibleElementLeft:null!==(e=null==i?void 0:i.offsetLeft)&&void 0!==e?e:0,visibleElementTop:null!==(n=null==i?void 0:i.offsetTop)&&void 0!==n?n:0})};return r.addEventListener("scroll",n),function(){return r.removeEventListener("scroll",n)}},[]),f.useEffect(function(){var r=e.current;if(!r)return function(){};var n=function(e,t){return Array.from(e).filter(function(e){return e instanceof HTMLElement}).flatMap(function(e){return e instanceof HTMLImageElement?[e]:Array.from(e.querySelectorAll("img"))}).forEach(t)},i=new IntersectionObserver(function(e){var r=e.find(function(e){return e.isIntersecting});(null==r?void 0:r.target)instanceof HTMLElement&&(t.current=x(x({},t.current),{},{visibleElement:r.target,visibleElementLeft:r.target.offsetLeft,visibleElementTop:r.target.offsetTop}))}),a=new MutationObserver(function(e){var t,r=s(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n(a.addedNodes,function(e){return i.observe(e)}),n(a.removedNodes,function(e){return i.unobserve(e)})}}catch(o){r.e(o)}finally{r.f()}});return a.observe(r,{childList:!0,subtree:!0}),function(){a.disconnect(),i.disconnect()}},[]),t},Ti=function(e,t,r,n,i,a,o,l,u,c){!function(e,t,r,n,i,a,o){var l=wi(e),u=function(){var t=e.current,s=l.current,u=s.left,c=s.top,d=s.visibleElementLeft,p=s.visibleElementTop,g=s.visibleElement;if(!t||!o||!g)return!1;var f=ur(r,i,a),h=0===n;if(f.previous||!h)return!1;var v=u-d+g.offsetLeft,x=c-p+g.offsetTop;return t.scrollTo(v,x),!0};f.useEffect(function(){var t=e.current;if(!t||!o)return function(){};var r=!1,n=function(e,t){Array.from(e).filter(function(e){return e instanceof HTMLElement}).flatMap(function(e){return e instanceof HTMLImageElement?[e]:Array.from(e.querySelectorAll("img"))}).forEach(t)},i=new ResizeObserver(function(){r||(r=u())&&i.disconnect()}),a=new MutationObserver(function(e){var t,r=s(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n(a.addedNodes,function(e){return i.observe(e)}),n(a.removedNodes,function(e){return i.unobserve(e)})}}catch(o){r.e(o)}finally{r.f()}});return a.observe(t,{childList:!0,subtree:!0}),function(){a.disconnect(),i.disconnect()}},[t]),f.useLayoutEffect(function(){u()},[t])}(e,t,r,n,i,a,Pt(o)),function(e,t){var r=wi(e),n=Pt(t),i=er(t);f.useEffect(function(){var t=e.current;if(!t||!n)return function(){};var a=function(e,t){return Array.from(e).filter(function(e){return e instanceof HTMLElement}).flatMap(function(e){return e instanceof HTMLImageElement?[e]:Array.from(e.querySelectorAll("img"))}).forEach(t)},o=new ResizeObserver(function(e){var n=r.current,a=n.left,o=n.top,s=n.visibleElement,l=n.visibleElementLeft,u=n.visibleElementTop;if(s&&e.filter(function(e){return e.target instanceof HTMLElement&&!(!e.target.clientWidth&&!e.target.clientHeight)&&(i?e.target.offsetTop<o:Math.abs(e.target.offsetLeft)<Math.abs(a))}).length){var c=a-l+s.offsetLeft,d=o-u+s.offsetTop;t.scrollTo(c,d)}}),l=new MutationObserver(function(e){var t,r=s(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;a(n.addedNodes,function(e){return o.observe(e)}),a(n.removedNodes,function(e){return o.unobserve(e)})}}catch(i){r.e(i)}finally{r.f()}});return l.observe(t,{childList:!0,subtree:!0}),function(){l.disconnect(),o.disconnect()}},[n,i])}(e,o),ji(o,c,u,n),Pi(l,n,u),Pi(o,n,u)},Ei=m(m(m(m(m({},Q.SINGLE_PAGE,ot.X),Q.DOUBLE_PAGE,ot.X),Q.CONTINUOUS_VERTICAL,ot.Y),Q.CONTINUOUS_HORIZONTAL,ot.X),Q.WEBTOON,ot.Y),Ii=f.forwardRef(function(e,t){var r,n=e.readerNavBarWidth,i=e.updateCurrentPageIndex,a=le().direction,o=Ft(function(e){return e.overlay.isVisible}),s=bt(function(e){return{currentPageIndex:e.pages.currentPageIndex,pageToScrollToIndex:e.pages.pageToScrollToIndex,setPageToScrollToIndex:e.pages.setPageToScrollToIndex,pages:e.pages.pages,totalPages:e.pages.totalPages,setPages:e.pages.setPages,setPageLoadStates:e.pages.setPageLoadStates,setTotalPages:e.pages.setTotalPages,setCurrentPageIndex:e.pages.setCurrentPageIndex,transitionPageMode:e.pages.transitionPageMode,retryFailedPagesKeyPrefix:e.pages.retryFailedPagesKeyPrefix,setTransitionPageMode:e.pages.setTransitionPageMode}}),l=s.currentPageIndex,u=s.pageToScrollToIndex,c=s.setPageToScrollToIndex,d=s.pages,p=s.totalPages,g=s.setPages,h=s.setPageLoadStates,v=s.setTotalPages,m=s.setCurrentPageIndex,C=s.transitionPageMode,y=s.retryFailedPagesKeyPrefix,j=s.setTransitionPageMode,w=Ut(function(e){return{initialChapter:e.chapters.initialChapter,currentChapter:e.chapters.currentChapter,chapters:e.chapters.chapters,visibleChapters:e.chapters.visibleChapters,setReaderStateChapters:e.chapters.setReaderStateChapters,isCurrentChapterReady:e.chapters.isCurrentChapterReady}}),T=w.initialChapter,I=w.currentChapter,D=w.chapters,O=w.visibleChapters,R=w.isCurrentChapterReady,L=ft(function(e){return{readingMode:e.settings.readingMode.value,readingDirection:e.settings.readingDirection.value,readerWidth:e.settings.readerWidth.value,pageScaleMode:e.settings.pageScaleMode.value,shouldOffsetDoubleSpreads:e.settings.shouldOffsetDoubleSpreads.value,imagePreLoadAmount:e.settings.imagePreLoadAmount,pageGap:e.settings.pageGap.value,customFilter:e.settings.customFilter,shouldStretchPage:e.settings.shouldStretchPage.value,isStaticNav:e.settings.isStaticNav}}),k=L.readingMode,A=L.readingDirection,N=L.readerWidth,B=L.pageScaleMode,_=L.shouldOffsetDoubleSpreads,W=L.imagePreLoadAmount,V=L.pageGap,H=L.customFilter,z=L.shouldStretchPage,U=L.isStaticNav,F=Kt(function(e){return{showPreview:e.tapZone.showPreview,setShowPreview:e.tapZone.setShowPreview}}),G=F.showPreview,X=F.setShowPreview,Y=(null!==(r=nt().state)&&void 0!==r?r:{resumeMode:it.START}).resumeMode,Z=void 0===Y?it.START:Y,K=f.useRef(null),q=Kr(t,K),J=er(k),ee=Pt(k),te=fi(K),re=Ht(function(e){return{isPaused:e.autoScroll.isPaused,pause:e.autoScroll.pause,resume:e.autoScroll.resume,setScrollRef:e.autoScroll.setScrollRef}});f.useEffect(function(){return re.setScrollRef(K.current)},[]);var ne=at.useGetScrollbarSize("width",K.current),ie=at.useGetScrollbarSize("height",K.current);f.useLayoutEffect(function(){var e=pr().scrollbar;e.setXSize(ne),e.setYSize(ie)},[ne,ie]);var ae=f.useRef(d.map(function(){return null})),oe=S(f.useState({minChapterViewWidth:0,minChapterViewHeight:0,minChapterSizeSourceChapterId:-1}),2),se=oe[0],ue=se.minChapterViewWidth,ce=se.minChapterViewHeight,de=se.minChapterSizeSourceChapterId,pe=oe[1],ge=S(f.useState({}),2)[1],fe=Ei[k],he=A===E.LTR,ve=f.useMemo(function(){return D.findIndex(function(e){return e.id===(null==T?void 0:T.id)})},[D,null==T?void 0:T.id]),xe=f.useMemo(function(){return D.slice(Math.max(0,ve-O.trailing),Math.min(D.length,ve+O.leading+1))},[D,ve,O.trailing,O.leading]),me=f.useMemo(function(){return xe.findIndex(function(e){return e.id===(null==I?void 0:I.id)})},[I,xe]),be=f.useCallback(function(e,t,r){if(ee){var n=r===de;if(J){if(!n&&ue>=e)return;pe({minChapterViewWidth:e,minChapterViewHeight:0,minChapterSizeSourceChapterId:r})}else(n||ce<t)&&pe({minChapterViewWidth:0,minChapterViewHeight:t,minChapterSizeSourceChapterId:r})}},[ee,J,ue,ce,de]);if(function(e,t,r,n,i,a,o,s,l,u){f.useLayoutEffect(function(){if(null!=e){var c=Ct(e,r);if(o){var d=e>t?$.PREVIOUS:$.NEXT,p=s.current[c.pagesIndex];null==p||p.scrollIntoView({block:"start",inline:Jt(d,l,u)})}var g=Mt(c),f=g===n-1;i(null),a(g,!f,f)}},[e])}(u,l,d,p,c,i,ee,ae,a,A),function(e,t,r,n,i){f.useLayoutEffect(function(){var e;t||null===(e=i.current)||void 0===e||e.scrollTo(qt(i.current,r,n),0)},[e])}(l,ee,a,A,K),function(e){var t=f.useRef(void 0);f.useEffect(function(){var r=function(t){var r=e.current;r&&(r.style.cursor=t?"default":"none")},n=function(){r(!0),clearTimeout(t.current),t.current=setTimeout(function(){r(!1)},5e3)};return n(),window.addEventListener("mousemove",n),function(){r(!0),window.removeEventListener("mousemove",n),clearTimeout(t.current)}},[])}(K),function(e,t,r){f.useEffect(function(){if(e!==Q.CONTINUOUS_HORIZONTAL)return function(){};if(!r.current)return function(){};var n,i,a,o=function(e){var o;if(!0!==a){e.preventDefault();var s,l=!Math.abs(Math.abs(null!=n?n:e.deltaX)-Math.abs(e.deltaX)),u=!Math.abs(Math.abs(null!=i?i:e.deltaY)-Math.abs(e.deltaY));n=e.deltaX,i=e.deltaY,a||(a=!l||!u),void 0!==a&&(e.shiftKey?null===(s=r.current)||void 0===s||s.scrollBy({top:e.deltaY}):null===(o=r.current)||void 0===o||o.scrollBy({left:t===E.LTR?e.deltaY:-1*e.deltaY}))}};return r.current.addEventListener("wheel",o),function(){var e;return null===(e=r.current)||void 0===e?void 0:e.removeEventListener("wheel",o)}},[e,t])}(k,A,K),function(e,t,r,n){f.useEffect(function(){var i,a,o=function(){e&&jt().setIsVisible(!1),t&&r(!1)};return null===(i=n.current)||void 0===i||i.addEventListener("wheel",o),null===(a=n.current)||void 0===a||a.addEventListener("touchmove",o),function(){var e,t;null===(e=n.current)||void 0===e||e.removeEventListener("wheel",o),null===(t=n.current)||void 0===t||t.removeEventListener("touchmove",o)}},[e,t])}(o,G,X,K),function(e,t,r,n,i){f.useEffect(function(){!e||i?n():r()},[e,t,i])}(o,re.isPaused,re.pause,re.resume,U),Ti(K,null==I?void 0:I.id,me,l,xe,O,k,A,c,B),f.useLayoutEffect(function(){pe({minChapterViewWidth:0,minChapterViewHeight:0,minChapterSizeSourceChapterId:-1}),ge({})},[k]),!T||!I)throw new Error("ReaderViewer: illegal state - initialChapter and currentChapter should not be undefined");return b.jsx(M,{ref:q,sx:x(x({width:"100%",height:"100%",overflow:"auto",flexWrap:"nowrap"},P(J&&lr(N,B),{alignItems:"center"})),P(!J,x(x({},P("ltr"===a,{flexDirection:he?"row":"row-reverse"})),P("rtl"===a,{flexDirection:he?"row-reverse":"row"})))),onClick:function(e){return!te&&dn.handleClick(K.current,e)},onScroll:function(){return dn.updateCurrentPageOnScroll(ae,p-1,i,fe,A)},children:xe.map(function(e,t){var r,a,o,s,u=Math.max(0,xe.length-t-1),d=xe[u],p=null!==(r=xe[u+1])&&void 0!==r?r:D[ve+O.leading+1],f=null!==(a=xe[u-1])&&void 0!==a?a:D[ve-O.trailing-1],x=d.id===T.id,S=d.id===I.id,P=d.id===(null===(o=xe[me+1])||void 0===o?void 0:o.id),w=d.id===(null===(s=xe[me-1])||void 0===s?void 0:s.id),E=T.sourceOrder>d.sourceOrder,M=T.sourceOrder<d.sourceOrder,L=O.lastLeadingChapterSourceOrder===d.sourceOrder,U=O.lastTrailingChapterSourceOrder===d.sourceOrder,F=L&&O.isLeadingChapterPreloadMode||U&&O.isTrailingChapterPreloadMode,G=ur(u,xe,O),X=d.id===de;return b.jsx(yi,{chapterId:d.id,previousChapterId:null==p?void 0:p.id,nextChapterId:null==f?void 0:f.id,isPreviousChapterVisible:G.previous,isNextChapterVisible:G.next,lastPageRead:Be(d.lastPageRead,0,d.pageCount-1),currentPageIndex:fr(l,d,I,S,R,E,M,O),isInitialChapter:x,isCurrentChapter:S,isPreviousChapter:P,isNextChapter:w,isLeadingChapter:E,isTrailingChapter:M,isPreloadMode:F,imageRefs:ae,setPages:g,setPageLoadStates:h,setTotalPages:v,setCurrentPageIndex:m,setPageToScrollToIndex:c,transitionPageMode:C,retryFailedPagesKeyPrefix:y,readingMode:k,readerWidth:N,pageScaleMode:B,shouldOffsetDoubleSpreads:_,readingDirection:A,updateCurrentPageIndex:S?i:Qe,scrollIntoView:S&&O.scrollIntoView,resumeMode:gr(S,x,E,M,O.resumeMode,Z),setTransitionPageMode:j,pageGap:V,imagePreLoadAmount:W,customFilter:H,shouldStretchPage:z,readerNavBarWidth:n,onSizeChange:be,minWidth:X?0:ue,minHeight:X?0:ce,scrollElement:K.current},d.id)})})}),Mi=xt(f.memo(Ii),[function(){return{updateCurrentPageIndex:dn.useUpdateCurrentPageIndex()}},T],["readerNavBarWidth","updateCurrentPageIndex"]),Di=Object.fromEntries(Object.values(v).map(function(e){return[e,{scopes:e}]})),Oi=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t[1],a=t[2],o=t[3];return lt(n,i,x(x({},a),Di.reader),o)},Ri=function(e,t,r,n,i){if(n)vt.updateSetting(e,r[0]);else{var a=Dn(r.indexOf(t),r,i);void 0===a?vt.deleteSetting(e):vt.updateSetting(e,a)}},Li=function(e){var t=e.scrollElementRef,r=vt.useGetThemeDirection(),n=d(),i=n.enableScope,a=n.disableScope,o=ft(function(e){return{hotkeys:e.settings.hotkeys}}).hotkeys,s=vt.useExit();return Oi(o[st.PREVIOUS_PAGE],function(){return dn.openPage("previous")}),Oi(o[st.NEXT_PAGE],function(){return dn.openPage("next")}),Oi(o[st.SCROLL_BACKWARD],function(){var e=hr(),r=Tt(),n=r.readingMode,i=r.readingDirection,a=r.scrollAmount;e.isActive?e.setDirection(ee.BACKWARD):t.current&&dn.scroll(ee.BACKWARD,ut[n.value],n.value,i.value,t.current,Ot().setShowPreview,a)},{preventDefault:!0}),Oi(o[st.SCROLL_FORWARD],function(){var e=hr(),r=Tt(),n=r.readingMode,i=r.readingDirection,a=r.scrollAmount;e.isActive?e.setDirection(ee.FORWARD):t.current&&dn.scroll(ee.FORWARD,ut[n.value],n.value,i.value,t.current,Ot().setShowPreview,a)},{preventDefault:!0}),Oi(o[st.PREVIOUS_CHAPTER],function(){return dn.openChapter(te("previous","next",r))},[r]),Oi(o[st.NEXT_CHAPTER],function(){return dn.openChapter(te("next","previous",r))},[r]),Oi(o[st.TOGGLE_MENU],function(){return jt().setIsVisible(!jt().isVisible)}),Oi(o[st.CYCLE_SCALE_TYPE],function(){Ri("pageScaleMode",Tt().pageScaleMode.value,Ie,Tt().pageScaleMode.isDefault,!0)},[]),Oi(o[st.STRETCH_IMAGE],function(){return vt.updateSetting("shouldStretchPage",!Tt().shouldStretchPage.value)}),Oi(o[st.OFFSET_SPREAD_PAGES],function(){return vt.updateSetting("shouldOffsetDoubleSpreads",!Tt().shouldOffsetDoubleSpreads.value)}),Oi(o[st.CYCLE_READING_MODE],function(){Ri("readingMode",Tt().readingMode.value,De,Tt().readingMode.isDefault,!0)}),Oi(o[st.CYCLE_READING_DIRECTION],function(){Ri("readingDirection",Tt().readingDirection.value,Le,Tt().readingDirection.isDefault,!0)}),Oi(o[st.TOGGLE_AUTO_SCROLL],function(){return hr().toggleActive()},{preventDefault:!0}),Oi(o[st.AUTO_SCROLL_SPEED_DECREASE],function(){return vt.updateSetting("autoScroll",x(x({},Tt().autoScroll),{},{value:Math.min(Ae.max,Tt().autoScroll.value+Ae.step)}))}),Oi(o[st.AUTO_SCROLL_SPEED_INCREASE],function(){return vt.updateSetting("autoScroll",x(x({},Tt().autoScroll),{},{value:Math.max(Ae.min,Tt().autoScroll.value-Ae.step)}))}),Oi(o[st.EXIT_READER],s,[s]),f.useEffect(function(){return i(v.READER),function(){return a(v.READER)}},[]),null},ki=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Math.max(e*t,1),a=r?-i:i;return n?-1*a:a},Ai=function(e,t,r){return e*(t/100)/r};function Ni(e,t,r,n,i){if(i(),e){var a,o=function(e){var t=e-(null!=a?a:e);a=e,n(t),r(requestAnimationFrame(o),"animationFrame")};r(requestAnimationFrame(o),"animationFrame")}else r(setInterval(function(){n(t)},t),"interval")}var Bi=xt(f.memo(function(e){var t=e.themeDirection,r=e.combinedDirection,n=Ht(function(e){return{scrollRef:e.autoScroll.scrollRef,direction:e.autoScroll.direction}}),i=n.scrollRef,a=n.direction,o=ft(function(e){return{readingMode:e.settings.readingMode.value,autoScroll:e.settings.autoScroll}}),s=o.readingMode,l=o.autoScroll,u=s===Q.CONTINUOUS_HORIZONTAL&&t!==r?te(a===ee.BACKWARD,a===ee.FORWARD,r):a===ee.BACKWARD,c=Pt(s),d=f.useCallback(function(){dn.openPage("next","ltr")},[]),p=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X.Y,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o="function"==typeof e,s=f.useRef(void 0),l=f.useRef(void 0),u=f.useRef(-1),c=S(f.useState(!1),2),d=c[0],p=c[1],g=S(f.useState(!1),2),h=g[0],v=g[1],x=S(f.useState({width:window.innerWidth,height:window.innerHeight}),2),m=x[0],b=x[1];re(document.documentElement,f.useCallback(function(){var e=window.innerWidth,t=window.innerHeight;m.width===e&&m.height===t||b({width:e,height:t})},[]));var C=f.useCallback(function(){clearTimeout(l.current),cancelAnimationFrame(u.current)},[]),y=f.useCallback(function(){p(!0)},[]),P=f.useCallback(function(){p(!1),v(!1),C()},[]),j=f.useCallback(function(){d?P():y()},[d]),w=f.useCallback(function(){v(!0)},[]),T=f.useCallback(function(){v(!1)},[]);return f.useEffect(function(){if(!e||!d)return function(){};if(h)return C(),function(){};var c=1e3*t;if(o)return Ni(!1,c,function(e){l.current=e},e,C),function(){return C()};var p=e.current;if(!p)return function(){};s.current||(s.current=getComputedStyle(p));var g="rtl"===s.current.direction,f=r!==X.Y,v=r!==X.X,x=Ai(window.innerWidth,n,c),m=Ai(window.innerHeight,n,c);return Ni(a,c,function(e,t){switch(t){case"interval":l.current=e;break;case"animationFrame":u.current=e;break;default:throw new Error('Unexpected "type" ('.concat(t,")"))}},function(e){p.scrollBy({top:Number(v)*ki(m,e,!1,i),left:Number(f)*ki(x,e,g,i),behavior:a?void 0:"smooth"})},C),function(){return C()}},[e,t,n,m,d,h,i,a]),f.useMemo(function(){return{isActive:d,isPaused:h,start:y,cancel:P,toggleActive:j,pause:w,resume:T}},[d,h,y,P,j,w,T])}(c?i:d,l.value,ut[s],F.MEDIUM,u,l.smooth);return f.useEffect(function(){var e=hr();e.setIsActive(p.isActive),e.setIsPaused(p.isPaused),e.setStart(p.start),e.setCancel(p.cancel),e.setToggleActive(p.toggleActive),e.setPause(p.pause),e.setResume(p.resume)},[p]),null}),[function(){return{themeDirection:le().direction}},function(){return{combinedDirection:vt.useGetThemeDirection()}}],["themeDirection","combinedDirection"]);e("Reader",xt(f.memo(function(e){var t,r,n,i=e.setOverride,a=e.readerNavBarWidth,o=ve().t,s=zt(function(e){return e.manga}),l=Ft(function(e){return e.overlay}),u=Ut(function(e){return{mangaChapters:e.chapters.mangaChapters,initialChapter:e.chapters.initialChapter,chapterForDuplicatesHandling:e.chapters.chapterForDuplicatesHandling,currentChapter:e.chapters.currentChapter}}),c=u.mangaChapters,d=u.initialChapter,p=u.chapterForDuplicatesHandling,g=u.currentChapter,h=ft(function(e){return{shouldSkipDupChapters:e.settings.shouldSkipDupChapters,shouldSkipFilteredChapters:e.settings.shouldSkipFilteredChapters,backgroundColor:e.settings.backgroundColor,readingMode:e.settings.readingMode,tapZoneLayout:e.settings.tapZoneLayout,tapZoneInvertMode:e.settings.tapZoneInvertMode,shouldShowReadingModePreview:e.settings.shouldShowReadingModePreview,shouldShowTapZoneLayoutPreview:e.settings.shouldShowTapZoneLayoutPreview,setSettings:e.settings.setSettings}}),v=h.shouldSkipDupChapters,m=h.shouldSkipFilteredChapters,C=h.backgroundColor,y=h.readingMode,P=h.tapZoneLayout,j=h.tapZoneInvertMode,w=h.shouldShowReadingModePreview,T=h.shouldShowTapZoneLayoutPreview,E=h.setSettings,I=Kt(function(e){return e.tapZone.setShowPreview}),M=f.useRef(null),O=S(f.useState(!1),2),R=O[0],L=O[1],k=dt(),A=k.chapterSourceOrder,N=k.mangaId,B=Number(A),_=Number(N),W=Ve.useGetManga(pt,_),V=Ve.useGetMangaChapters(gt,_);qr(s&&g?"".concat(s.title,": ").concat(g.name):o("reader.title",{mangaId:_,chapterIndex:B}));var H=Sr(),z=H.metadata,U=H.settings,F=H.request,G=kr(null!=s?s:Fr),X=void 0===g||!R||W.loading||V.loading||F.loading,Z=null!==(t=null!==(r=W.error)&&void 0!==r?r:V.error)&&void 0!==t?t:F.error;return f.useEffect(function(){var e;pr().setManga(null===(e=W.data)||void 0===e?void 0:e.manga)},[null===(n=W.data)||void 0===n?void 0:n.manga]),f.useEffect(function(){return function(){pr().reset()}},[]),function(e,t,r,n,i,a){var o;f.useEffect(function(){var o,s=null===(o=e.data)||void 0===o?void 0:o.manga;if(s&&!t.loading&&!t.error){var l=vr(s,r),u=xr(s,l.shouldUseAutoWebtoonMode,l.readingMode),c=x(x({},r),{},{readingMode:u?Q.WEBTOON:r.readingMode}),d=u?Q.WEBTOON:l.readingMode.value,p=mr("global",{meta:n},c,void 0,d),g=vr(s,p);i(g),a(!0)}},[null===(o=e.data)||void 0===o?void 0:o.manga,r])}(W,F,U,z,E,L),function(e,t,r,n,i,a,o,s,l){var u=ve().t,c=f.useRef(void 0),d=f.useRef(void 0),p=f.useRef(void 0),g=f.useRef(!0);f.useEffect(function(){if(!e&&!t&&r){var f=JSON.stringify(n)!==JSON.stringify(c.current);o&&f&&Ke(u(Me[n.value].title),{autoHideDuration:5e3}),c.current=n;var h=JSON.stringify(i)!==JSON.stringify(d.current)||JSON.stringify(a)!==JSON.stringify(p.current);s&&h&&(l(!0),g.current&&setTimeout(function(){return l(!1)},5e3)),d.current=i,p.current=a,g.current=!1}},[e,t,r,n.value,n.isDefault,i.value,i.isDefault,a.value,a.isDefault])}(X,Z,R,y,P,j,w,T,I),function(e,t,r,n,i,a,o,s){var l,u=ct(),c=nt().state,d=(null!=c?c:{}).updateInitialChapter?void 0:n;f.useEffect(function(){var n,l,p=null===(n=e.data)||void 0===n?void 0:n.chapters.nodes,g=p?null!==(l=p[p.length-t])&&void 0!==l?l:null:void 0,f=null!=d?d:g,h=null!=i?i:g,v=function(){if(!p||!h)return[];var e=o?Lr(null!=r?r:p,s):p;return(a?yr.removeDuplicates(h,e):e).map(function(e){return Nt(e.id)})}(),m=g&&yr.getNextChapter(g,v,{offset:$.NEXT}),b=g&&yr.getNextChapter(g,v,{offset:$.PREVIOUS}),S=null!=f&&f.id!==(null==d?void 0:d.id);S&&u("",{replace:!0,state:x(x({},c),{},{updateInitialChapter:void 0})}),wt().setReaderStateChapters(function(e){var t,r,n,i,a=(null==g?void 0:g.id)!==(null===(t=e.currentChapter)||void 0===t?void 0:t.id);return x(x({},e),{},{mangaChapters:null!==(r=e.mangaChapters)&&void 0!==r?r:p,chapters:v,initialChapter:f,chapterForDuplicatesHandling:h,currentChapter:g,nextChapter:m,previousChapter:b,isCurrentChapterReady:!a&&e.isCurrentChapterReady,visibleChapters:S?x(x({},br.chapters.visibleChapters),{},{lastLeadingChapterSourceOrder:null!==(n=null==f?void 0:f.sourceOrder)&&void 0!==n?n:br.chapters.visibleChapters.lastLeadingChapterSourceOrder,lastTrailingChapterSourceOrder:null!==(i=null==f?void 0:f.sourceOrder)&&void 0!==i?i:br.chapters.visibleChapters.lastTrailingChapterSourceOrder,isLeadingChapterPreloadMode:!1,isTrailingChapterPreloadMode:!1,scrollIntoView:!!e.initialChapter}):e.visibleChapters})})},[null===(l=e.data)||void 0===l?void 0:l.chapters.nodes,t,a,o,d,s])}(V,B,c,d,p,v,m,G),f.useLayoutEffect(function(){return i({status:!0,value:b.jsxs(D,{sx:{position:"absolute"},children:[b.jsx(Li,{scrollElementRef:M}),b.jsx(ci,{isVisible:l.isVisible}),!M.current&&b.jsx(D,{onClick:function(){return l.setIsVisible(!l.isVisible)},sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"transparent"}})]})}),function(){return i({status:!1,value:null})}},[l.isVisible,M.current]),Z?b.jsx(Xr,{message:o("global.error.label.failed_to_load_data"),messageExtra:rt(Z),retry:function(){W.error&&W.refetch().catch(Y()),F.error&&F.refetch().catch(Y()),V.error&&V.refetch().catch(Y())}}):X?b.jsx(D,{sx:{height:"100vh",width:"100vw",display:"grid",placeItems:"center"},children:b.jsx(Fe,{})}):null===g?b.jsx(Xr,{message:o("reader.error.label.chapter_not_found")}):s&&g?b.jsxs(D,{sx:{position:"relative",display:"flex",flexDirection:"column",width:"calc(100vw - ".concat(a,"px)"),height:"100vh",marginLeft:"".concat(a,"px"),transition:function(e){return"width 0.".concat(e.transitions.duration.shortest,"s, margin-left 0.").concat(e.transitions.duration.shortest,"s")},overflow:"auto",backgroundColor:tt[C]},children:[b.jsx(Mi,{ref:M}),b.jsx(pi,{}),b.jsx(gi,{}),b.jsx(Bi,{})]}):null}),[T],["setOverride","readerNavBarWidth"]))}}})}();
