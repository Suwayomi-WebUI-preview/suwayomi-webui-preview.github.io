var L=Object.defineProperty;var I=s=>{throw TypeError(s)};var O=(s,n,i)=>n in s?L(s,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[n]=i;var l=(s,n,i)=>O(s,typeof n!="symbol"?n+"":n,i),F=(s,n,i)=>n.has(s)||I("Cannot "+i);var m=(s,n,i)=>(F(s,n,"read from private field"),i?i.call(s):n.get(s)),K=(s,n,i)=>n.has(s)?I("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(s):n.set(s,i),y=(s,n,i,w)=>(F(s,n,"write to private field"),w?w.call(s,i):n.set(s,i),i);var k=(s,n,i,w)=>({set _(v){y(s,n,v,i)},get _(){return m(s,n,w)}});(function(){"use strict";var u,M,P,C,x;const s=r=>r.toLowerCase().trim(),n=r=>s(r).normalize("NFKC").replace(/[^\p{L}\p{N}]+/gu," ").trim(),i=r=>{const e=Object.groupBy(r,({title:t})=>n(t));return Object.fromEntries(Object.entries(e).filter(t=>{var o,c;return((c=(o=t[1])==null?void 0:o.length)!=null?c:0)>1}).map(([,t])=>[t[0].title,t]))};class w{constructor(e){l(this,"value");l(this,"next");this.value=e}}let v=(C=class{constructor(){K(this,u);K(this,M);K(this,P);this.clear()}enqueue(e){const t=new w(e);m(this,u)?(m(this,M).next=t,y(this,M,t)):(y(this,u,t),y(this,M,t)),k(this,P)._++}dequeue(){const e=m(this,u);if(e)return y(this,u,m(this,u).next),k(this,P)._--,e.value}peek(){if(m(this,u))return m(this,u).value}clear(){y(this,u,void 0),y(this,M,void 0),y(this,P,0)}get size(){return m(this,P)}*[Symbol.iterator](){let e=m(this,u);for(;e;)yield e.value,e=e.next}},u=new WeakMap,M=new WeakMap,P=new WeakMap,C);function R(r){q(r);const e=new v;let t=0;const o=()=>{t<r&&e.size>0&&(e.dequeue()(),t++)},c=()=>{t--,o()},h=async(a,g,p)=>{const f=(async()=>a(...p))();g(f);try{await f}catch(b){}c()},T=(a,g,p)=>{new Promise(f=>{e.enqueue(f)}).then(h.bind(void 0,a,g,p)),(async()=>(await Promise.resolve(),t<r&&o()))()},d=(a,...g)=>new Promise(p=>{T(a,p,g)});return Object.defineProperties(d,{activeCount:{get:()=>t},pendingCount:{get:()=>e.size},clearQueue:{value(){e.clear()}},concurrency:{get:()=>r,set(a){q(a),r=a,queueMicrotask(()=>{for(;t<r&&e.size>0;)o()})}}}),d}function q(r){if(!((Number.isInteger(r)||r===Number.POSITIVE_INFINITY)&&r>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}class j{constructor(){l(this,"orgResolve");l(this,"orgReject");l(this,"promise");this.promise=new Promise((e,t)=>{this.orgResolve=e,this.orgReject=t})}resolve(e){this.orgResolve(e)}reject(e){this.orgReject(e)}}class z{constructor(e){l(this,"queue");l(this,"counter",0);l(this,"pendingKeyToPriorityMap",new Map);l(this,"pendingKeyToFnMap",new Map);l(this,"pendingKeyToPromiseMap",new Map);this.queue=R(e)}clear(){this.pendingKeyToPromiseMap.forEach(e=>{e.reject(new Error("Queue::clear: called"))}),this.pendingKeyToPriorityMap.clear(),this.pendingKeyToFnMap.clear(),this.pendingKeyToPromiseMap.clear()}enqueue(e,t,o=1){this.counter=(this.counter+1)%(1/0);const c="".concat(e,"_").concat(this.counter);this.pendingKeyToPriorityMap.set(c,o),this.pendingKeyToFnMap.set(c,t);const h=new j;return this.pendingKeyToPromiseMap.set(c,h),this.queue(()=>this.process()),{key:c,promise:h.promise}}isProcessing(e){return!this.pendingKeyToFnMap.has(e)}async process(){const{fn:e,promise:t}=this.getNextItemToProcess();try{const o=await e();t.resolve(o)}catch(o){t.reject(o)}}getNextItemToProcess(){const[e]=[...this.pendingKeyToPriorityMap.entries()].toSorted(([,c],[,h])=>h-c)[0],t=this.pendingKeyToFnMap.get(e),o=this.pendingKeyToPromiseMap.get(e);return this.pendingKeyToPriorityMap.delete(e),this.pendingKeyToFnMap.delete(e),this.pendingKeyToPromiseMap.delete(e),{key:e,fn:t,promise:o}}}const S=new z(((x=navigator.hardwareConcurrency)!=null?x:5)-1),N=200;self.onmessage=async r=>{const{mangas:e,checkAlternativeTitles:t}=r.data;if(!t){postMessage(i(e));return}const o=[];for(let d=0;d<e.length;d+=N)o.push(S.enqueue(d.toString(),()=>{const a=new j,g=new Worker(new URL("/assets/LibraryDuplicatesDescriptionWorker-D8fxrz0M.js",self.location.href),{type:"module"});return g.onmessage=p=>a.resolve(p.data),g.postMessage({mangas:e,mangasToCheck:e.slice(d,d+N)}),a.promise}).promise);const c=await Promise.all(o),h={},T={};c.forEach(d=>Object.entries(d).forEach(([a,g])=>{var b,E;const p=n(a);(b=T[p])!=null||(T[p]=a);const f=T[p];(E=h[f])!=null||(h[f]=g)})),postMessage(h)}})();
