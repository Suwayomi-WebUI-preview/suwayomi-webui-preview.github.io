import{u as U,a as u,c as m,j as t,o as f,ab as S,y as E,aV as c,aW as d,aX as v,N as _,A,g as N,E as L,h as T}from"./index-Zl59rTnr.js";import{N as j}from"./NumberSetting-D95Za2Yx.js";import{u as O,g as V}from"./usePersistedValue-DpgK_ISR.js";import{S as x}from"./Switch-Dz039eWF.js";import{T as F}from"./TextSetting-DikKBxMa.js";import{S as h}from"./SelectSetting-DVozOvvZ.js";import"./Info-CBdRtVcr.js";import"./TextField-lew-bJf8.js";import"./InputAdornment-C6brfzM8.js";import"./SwitchBase-B5dQFXOZ.js";import"./PasswordTextField-D4MXzy1a.js";import"./Select-BndaAxxl.js";import"./MenuItem-DWrnvo_k.js";const I=23,k=1,W=23,R=({disabled:e=!1,updateCheckInterval:r})=>{const{t:s}=U(),o=!!r,[p]=u.useUpdateServerSettings(),[n,g]=O("lastUpdateCheckInterval",I,r,V),b=m.useCallback(i=>{g(i===0?n:i),p({variables:{input:{settings:{webUIUpdateCheckInterval:i}}}})},[n]),l=i=>{b(i?n:0)};return t.jsxs(f,{children:[t.jsxs(S,{disabled:e,children:[t.jsx(E,{primary:s("settings.webui.auto_update.label.title")}),t.jsx(x,{disabled:e,edge:"end",checked:o,onChange:i=>l(i.target.checked)})]}),t.jsx(j,{settingTitle:s("settings.webui.auto_update.label.interval"),settingValue:s("library.settings.global_update.auto_update.interval.label.value",{hours:n}),value:n,minValue:k,maxValue:W,defaultValue:I,showSlider:!0,valueUnit:s("global.time.hour_short"),handleUpdate:b,disabled:e||!o})]})},P=Object.values(c),B={[c.Webui]:{text:"settings.webui.title.webui",description:"settings.webui.flavor.option.webui.label.description",disclaimer:"settings.webui.flavor.label.info"},[c.Vui]:{text:"settings.webui.flavor.option.vui.label.title",description:"settings.webui.flavor.option.vui.label.description",disclaimer:"settings.webui.flavor.label.info"},[c.Custom]:{text:"settings.webui.flavor.option.custom.label.title",description:"settings.webui.flavor.option.custom.label.description"}},y=P.map(e=>[e,B[e]]),D=Object.values(d),H={[d.Bundled]:{text:"settings.webui.channel.option.bundled.label.title",description:"settings.webui.channel.option.bundled.label.description",disclaimer:"settings.webui.flavor.label.info"},[d.Stable]:{text:"settings.webui.channel.option.stable.label.title",description:"settings.webui.channel.option.stable.label.description",disclaimer:"settings.webui.flavor.label.info"},[d.Preview]:{text:"settings.webui.channel.option.preview.label.title",description:"settings.webui.channel.option.preview.label.description",disclaimer:"settings.webui.channel.option.preview.label.disclaimer"}},K=D.map(e=>[e,H[e]]),M=Object.values(v),Y={[v.Browser]:{text:"settings.webui.interface.option.label.browser",description:"settings.webui.interface.label.description"},[v.Electron]:{text:"settings.webui.interface.option.label.electron",description:"settings.webui.interface.label.description"}},X=M.map(e=>[e,Y[e]]),q=e=>({webUIFlavor:e.webUIFlavor,initialOpenInBrowserEnabled:e.initialOpenInBrowserEnabled,webUIInterface:e.webUIInterface,electronPath:e.electronPath,webUIChannel:e.webUIChannel,webUIUpdateCheckInterval:e.webUIUpdateCheckInterval}),re=()=>{const{t:e}=U(),{setTitle:r,setAction:s}=m.useContext(_);A("settings"),m.useEffect(()=>(r(e("settings.webui.title.settings")),s(null),()=>{r(""),s(null)}),[e]);const{data:o,loading:p,error:n,refetch:g}=u.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[b]=u.useUpdateServerSettings(),l=(a,C)=>{a==="webUIChannel"&&u.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),b({variables:{input:{settings:{[a]:C}}}})};if(p)return t.jsx(N,{});if(n)return t.jsx(L,{message:e("global.error.label.failed_to_load_data"),messageExtra:n.message,retry:()=>g().catch(T())});const i=q(o.settings),w=i.webUIFlavor===c.Webui;return t.jsxs(f,{children:[t.jsx(h,{settingName:e("settings.webui.flavor.label.title"),value:i.webUIFlavor,values:y,handleChange:a=>l("webUIFlavor",a)}),t.jsxs(S,{children:[t.jsx(E,{primary:e("settings.webui.label.initial_open_browser")}),t.jsx(x,{edge:"end",checked:i.initialOpenInBrowserEnabled,onChange:a=>l("initialOpenInBrowserEnabled",a.target.checked)})]}),t.jsx(h,{settingName:e("settings.webui.interface.label.title"),value:i.webUIInterface,values:X,handleChange:a=>l("webUIInterface",a)}),t.jsx(F,{settingName:e("settings.webui.electron_path.label.title"),dialogDescription:e("settings.webui.electron_path.label.description"),value:i.electronPath,handleChange:a=>l("electronPath",a)}),t.jsx(h,{settingName:e("settings.webui.channel.label.title"),value:i.webUIChannel,values:K,handleChange:a=>l("webUIChannel",a),disabled:!w}),t.jsx(R,{disabled:!w,updateCheckInterval:o.settings.webUIUpdateCheckInterval})]})};export{re as WebUISettings};
