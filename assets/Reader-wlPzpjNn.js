import{cA as bs,e as c,cB as ht,cC as Me,cv as O,j as s,D as Vt,ad as m,n as Wt,cD as qs,cE as W,cF as Qe,a as ze,cG as Ot,cH as De,cI as ye,cJ as Js,cK as nt,cL as Ft,S as A,o as X,T as Ze,aU as Qs,cM as er,aW as tr,c8 as Pt,Z as $e,a7 as Xt,cN as Te,C as z,cO as Es,cP as ge,z as Xe,cQ as N,bH as ue,cR as Le,cS as sr,b as kt,d as rr,cl as nr,cT as or,cU as ar,cV as ir,cm as cr,cr as lr,ae as et,cW as qt,aX as qe,cX as Jt,cY as Ts,c as he,bL as gt,A as Yt,L as Lt,u as F,bU as js,cZ as Cs,ap as bt,ag as Et,a4 as Tt,bX as dr,aj as ur,B as Je,c_ as gr,c$ as Qt,d0 as ws,d1 as Ut,d2 as Os,d3 as hr,d4 as fr,d5 as es,d6 as Ls,d7 as ft,d8 as _e,ct as rt,d9 as Fe,k as Ds,I as ae,_ as We,da as Gt,db as Pe,bV as xr,bW as pr,bh as mr,g as Dt,aN as vr,dc as Kt,a5 as Sr,a6 as Rr,m as Is,dd as ut,de as It,aa as ts,df as At,dg as br,dh as Mt,di as Er,dj as jt,dk as Tr,dl as As,dm as jr,dn as Ue,b3 as Be,dp as Cr,dq as ke,dr as Ge,ds as wr,dt as Bs,du as Or,dv as Lr,r as zt,dw as mt,dx as Dr,dy as Ir,i as St,dz as Ar,dA as Br,h as _s,dB as ys,dC as Ps,dD as _r,dE as yr,p as ks,dF as ss,M as rs,dG as Pr,dH as kr,dI as dt,dJ as q,dK as ns,dL as os,dM as Mr,dN as Rt,dO as Nr,dP as Hr,dQ as as,dR as Vr,dS as Wr,f as Fr,dT as Ur,as as Gr,dU as zr,dV as $r,dW as Xr}from"./index-DWz4TNtd.js";import{R as Yr,S as Kr,D as Zr,a as qr,b as Jr,c as Qr}from"./ReaderSettingsTabs-CsXWyxYE.js";import{L as $t}from"./Link-CkgbKDy3.js";import{S as Ms}from"./Select-DTupB29O.js";import{d as Ns,b as en,B as tn,F as Hs}from"./CustomButtonIcon-ByXdfLnG.js";import{a as Vs,I as Ws,T as sn}from"./TextField-p1pWQlzT.js";import{K as rn}from"./MUI.util-BHb8I4Fi.js";import{I as nn}from"./InputAdornment-D2Hu2W11.js";import{O as on}from"./OpenInNew-DVmBpk4Y.js";import{D as an}from"./Download-BNw0zcIk.js";import{D as cn}from"./Delete-Da55i9yt.js";import{D as ln}from"./ChapterCardMetadata-CVgQm7ae.js";import{F as dn}from"./Favorite-DO_ID7fD.js";import{a as un,F as gn,g as hn}from"./useManageMangaLibraryState-SIk1Scuh.js";import{C as fn}from"./CheckboxInput-DJhQhiao.js";import{E as Ct}from"./EmptyViewAbsoluteCentered-DPrnddnF.js";import"./TabsMenu-Dgyz8PyL.js";import"./Tabs-CgaLWDU0.js";import"./Trans-BQrQcEvJ.js";import"./Slider-DpJVGl_w.js";import"./ListSubheader-Fa3Lxm1G.js";import"./Add-83t_xa_6.js";import"./Card-8Hlh2tNY.js";import"./CardActionArea-DZr1-Ien.js";import"./CardContent-CJ5i7b3K.js";import"./Checkbox-BBcQZP1l.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-BeXl2Zas.js";import"./SwitchBase-DdFM11Au.js";import"./ThreeStateCheckboxInput-bOClE9Pj.js";import"./FormGroup-CzBp0i4z.js";const xn=e=>{const{activeScopes:r,enableScope:n,disableScope:o}=bs(),t=c.useRef([]);c.useEffect(()=>e?(t.current=[...r],n(ht.NONE),t.current.forEach(o),()=>{o(ht.NONE),t.current.forEach(n)}):()=>{},[e])},pn=({isOpen:e,close:r})=>{const{manga:n}=Me(),o=O.useSettings();xn(e);const[t,a]=c.useState(0),[l,d]=c.useState(!1);return!n||!e?null:s.jsx(Vt,{open:e,maxWidth:"md",fullWidth:!0,onClose:r,hideBackdrop:t===qs.FILTER,sx:{...m(l,{opacity:.75})},children:s.jsx(Wt,{sx:{p:0},children:s.jsx(Yr,{activeTab:t,setActiveTab:a,settings:o,updateSetting:(...i)=>O.updateSetting(n,...i),deleteSetting:(...i)=>O.deleteSetting(n,...i),setTransparent:d})})})},mn=({isDesktop:e,scrollbarXSize:r,readerNavBarWidth:n,isMaximized:o,currentPageIndex:t,pages:a,totalPages:l,progressBarType:d,shouldShowPageNumber:i,readingDirection:f})=>{const u=c.useMemo(()=>{const g=ye(t,a).name,h="/",x="".concat(g).concat(h).concat(l);return f===nt.LTR?x:Js(x,h)},[t,a,l,f]);return!i||o||e&&d===Ft.STANDARD||o&&d===Ft.HIDDEN?null:s.jsx(A,{sx:{position:"fixed",left:n,right:0,bottom:g=>"max(calc(".concat(g.spacing(1)," + ").concat(r,"px), env(safe-area-inset-bottom))"),alignItems:"center",transition:g=>"left 0.".concat(g.transitions.duration.shortest,"s")},children:s.jsx(X,{sx:{p:.5,borderRadius:1,backgroundColor:"rgba(0, 0, 0, 0.3)"},children:s.jsx(Ze,{sx:{color:"white"},children:u})})})},vn=W(mn,[O.useOverlayMode,Qe,ze,Ot,De,O.useSettingsWithoutDefaultFlag],["isDesktop","scrollbarXSize","readerNavBarWidth","isMaximized","currentPageIndex","pages","totalPages","progressBarType","shouldShowPageNumber","readingDirection"]);function is(e){return e.substring(2).toLowerCase()}function Sn(e,r){return r.documentElement.clientWidth<e.clientX||r.documentElement.clientHeight<e.clientY}function Rn(e){const{children:r,disableReactTree:n=!1,mouseEvent:o="onClick",onClickAway:t,touchEvent:a="onTouchEnd"}=e,l=c.useRef(!1),d=c.useRef(null),i=c.useRef(!1),f=c.useRef(!1);c.useEffect(()=>(setTimeout(()=>{i.current=!0},0),()=>{i.current=!1}),[]);const u=Qs(er(r),d),g=tr(p=>{const v=f.current;f.current=!1;const E=Pt(d.current);if(!i.current||!d.current||"clientX"in p&&Sn(p,E))return;if(l.current){l.current=!1;return}let j;p.composedPath?j=p.composedPath().includes(d.current):j=!E.documentElement.contains(p.target)||d.current.contains(p.target),!j&&(n||!v)&&t(p)}),h=p=>v=>{f.current=!0;const E=r.props[p];E&&E(v)},x={ref:u};return a!==!1&&(x[a]=h(a)),c.useEffect(()=>{if(a!==!1){const p=is(a),v=Pt(d.current),E=()=>{l.current=!0};return v.addEventListener(p,g),v.addEventListener("touchmove",E),()=>{v.removeEventListener(p,g),v.removeEventListener("touchmove",E)}}},[g,a]),o!==!1&&(x[o]=h(o)),c.useEffect(()=>{if(o!==!1){const p=is(o),v=Pt(d.current);return v.addEventListener(p,g),()=>{v.removeEventListener(p,g)}}},[g,o]),c.cloneElement(r,x)}const cs=$e(Ze)({boxSizing:"content-box",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",textAlign:"center",userSelect:"none",cursor:"pointer"}),bn=$e(A,{shouldForwardProp:Xt(["progressBarPosition"])})(({theme:e,progressBarPosition:r})=>({position:"fixed",pointerEvents:"all",touchAction:"none",...m(Te(r).isHorizontal,{justifyContent:"flex-end",bottom:0,right:0}),...m(Te(r).isVertical,{top:0,bottom:0}),...m(Te(r).isLeft,{alignItems:e.direction==="ltr"?"flex-start":"flex-end"}),...m(Te(r).isRight,{alignItems:e.direction==="ltr"?"flex-end":"flex-start"})})),En=$e(A)(({theme:e})=>({flexDirection:"row",justifyContent:"center",alignItems:"center",gap:e.spacing(.5)})),Tn=$e(A)({flexDirection:"row",flexGrow:1,overflow:"hidden"}),jn=$e(X,{shouldForwardProp:Xt(["currentPagesIndex","pagesLength","progressBarPosition"])})(({currentPagesIndex:e,pagesLength:r,progressBarPosition:n})=>({position:"absolute",pointerEvents:"none",...m(Te(n).isHorizontal,{left:0,width:"".concat((e+1)/r*100,"%"),height:"100%"}),...m(Te(n).isVertical,{top:0,width:"100%",height:"".concat((e+1)/r*100,"%")})})),Cn=({pageName:e,currentPagesIndex:r,pagesLength:n,isDragging:o,boxProps:t,children:a,progressBarPosition:l})=>s.jsx(z,{title:e,slotProps:{tooltip:{sx:{backgroundColor:"primary.main",color:"primary.contrastText"}}},placement:Es[l],children:s.jsx(X,{...t,sx:{position:"absolute",cursor:o?"grabbing":"grab",...m(Te(l).isHorizontal,{left:"".concat(Math.max(0,r-1)/(n-1)*100,"%"),width:"calc(100% / ".concat(n-1,")"),height:"100%"}),...m(Te(l).isVertical,{top:"".concat(Math.max(0,r-1)/(n-1)*100,"%"),width:"100%",height:"calc(100% / ".concat(n-1,")")}),...t==null?void 0:t.sx},children:a})}),wn=$e(A)({position:"relative",flexDirection:"row",flexGrow:1}),On=c.memo($e(X,{shouldForwardProp:Xt(["isFirstPage","isLastPage"])})(({isFirstPage:e,isLastPage:r})=>({flexGrow:1,height:"100%",cursor:"pointer",borderLeftWidth:e?0:void 0,borderRightWidth:r?0:void 0}))),Ln=c.memo(({page:e,pagesIndex:r,isCurrentPage:n,isLeadingPage:o,isTrailingPage:t,totalPages:a,showDraggingStyle:l,primaryPageLoadState:d,secondaryPageLoadState:i,createProgressBarSlot:f,...u})=>{const g=c.useMemo(()=>f(e,r,d,i,n,o,t,a,l),[f,e,r,d,i,n,o,t,a,l]);return s.jsx(On,{...u,isFirstPage:r===0,isLastPage:r===a-1,children:g})}),Dn=({totalPages:e,pages:r,pageLoadStates:n,currentPageIndex:o,slotProps:t,slots:a,createProgressBarSlot:l,progressBarPosition:d,readingMode:i,isDragging:f,setIsDragging:u,openPage:g,direction:h,fullSegmentClicks:x})=>{var I,y,_,U,te,P,k,H,B,ie,ce,Q,G,se,V,Z,fe,je,Ce,xe,pe,le,ve,Se,Ie,me,Ne,Ye,tt,we,Re,Y;const p=c.useRef(null),v=c.useRef(void 0),[E,j]=c.useState(0),S=c.useRef(null);Xe(S,c.useCallback(()=>{const M=S.current;if(!M)return;const{paddingLeft:K,paddingRight:He}=getComputedStyle(M),ee=6,be=M.clientWidth-parseFloat(K)-parseFloat(He),de=i===N.DOUBLE_PAGE?be*2+ee:be;j(de)},[i]));const R=c.useMemo(()=>ye(o,r).pagesIndex,[o,r]),w=Te(d).isHorizontal,b=c.useMemo(()=>ye(o,r),[o,r]),T=c.useCallback((...M)=>ue(M[0],M[1],h),[h]);ge.useHandleProgressDragging(g,p,f,b,r,d,T,x);const L=M=>{if(!p.current)return;const K="touches"in M;g(Le(sr(K?M.touches[0]:M,p.current,r,w,x,T)),void 0,!1),clearTimeout(v.current),v.current=setTimeout(()=>u(!0),250)},D=()=>{u(!1),clearTimeout(v.current)};return s.jsx(bn,{...t==null?void 0:t.container,progressBarPosition:d,children:s.jsxs(En,{...t==null?void 0:t.progressBarRoot,children:[s.jsx(cs,{...(I=t==null?void 0:t.progressBarPageTexts)==null?void 0:I.base,...(y=t==null?void 0:t.progressBarPageTexts)==null?void 0:y.current,sx:[{width:"".concat(E,"px")},...Array.isArray((U=(_=t==null?void 0:t.progressBarPageTexts)==null?void 0:_.base)==null?void 0:U.sx)?(k=(P=(te=t==null?void 0:t.progressBarPageTexts)==null?void 0:te.base)==null?void 0:P.sx)!=null?k:[]:[(B=(H=t==null?void 0:t.progressBarPageTexts)==null?void 0:H.base)==null?void 0:B.sx],...Array.isArray((ce=(ie=t==null?void 0:t.progressBarPageTexts)==null?void 0:ie.current)==null?void 0:ce.sx)?(se=(G=(Q=t==null?void 0:t.progressBarPageTexts)==null?void 0:Q.current)==null?void 0:G.sx)!=null?se:[]:[(Z=(V=t==null?void 0:t.progressBarPageTexts)==null?void 0:V.current)==null?void 0:Z.sx]],onClick:()=>g("previous","ltr",!1),children:b.name}),s.jsx(Rn,{onClickAway:()=>u(!1),children:s.jsxs(wn,{...t==null?void 0:t.progressBarSlotsActionArea,onMouseDown:L,onMouseUp:D,onTouchStart:L,onTouchEnd:D,children:[s.jsxs(Tn,{ref:p,...t==null?void 0:t.progressBarSlotsContainer,children:[r.map((M,K)=>c.createElement(Ln,{...t==null?void 0:t.progressBarSlot,key:M.primary.index,page:M,pagesIndex:K,isCurrentPage:K===R,isLeadingPage:K<R,isTrailingPage:K>R,totalPages:r.length,primaryPageLoadState:n[M.primary.index].loaded,secondaryPageLoadState:M.secondary?n[M.secondary.index].loaded:void 0,createProgressBarSlot:l,showDraggingStyle:K===R&&f})),s.jsx(jn,{...t==null?void 0:t.progressBarReadPages,currentPagesIndex:b.pagesIndex,pagesLength:r.length,progressBarPosition:d})]}),s.jsx(Cn,{boxProps:t==null?void 0:t.progressBarCurrentPageSlot,pageName:b.name,currentPagesIndex:b.pagesIndex,pagesLength:r.length,isDragging:f,progressBarPosition:d,children:a==null?void 0:a.progressBarCurrentPage})]})}),s.jsx(cs,{ref:S,...(fe=t==null?void 0:t.progressBarPageTexts)==null?void 0:fe.base,...(je=t==null?void 0:t.progressBarPageTexts)==null?void 0:je.total,sx:[{minWidth:"unset"},...Array.isArray((xe=(Ce=t==null?void 0:t.progressBarPageTexts)==null?void 0:Ce.base)==null?void 0:xe.sx)?(ve=(le=(pe=t==null?void 0:t.progressBarPageTexts)==null?void 0:pe.base)==null?void 0:le.sx)!=null?ve:[]:[(Ie=(Se=t==null?void 0:t.progressBarPageTexts)==null?void 0:Se.base)==null?void 0:Ie.sx],...Array.isArray((Ne=(me=t==null?void 0:t.progressBarPageTexts)==null?void 0:me.total)==null?void 0:Ne.sx)?(we=(tt=(Ye=t==null?void 0:t.progressBarPageTexts)==null?void 0:Ye.total)==null?void 0:tt.sx)!=null?we:[]:[(Y=(Re=t==null?void 0:t.progressBarPageTexts)==null?void 0:Re.total)==null?void 0:Y.sx]],onClick:()=>g("next","ltr",!1),children:e})]})})},Fs=W(c.memo(Dn),[Ot,()=>({openPage:ge.useOpenPage()}),De,O.useSettingsWithoutDefaultFlag],["isDragging","setIsDragging","openPage","pages","pageLoadStates","totalPages","currentPageIndex","readingMode"]),In=c.forwardRef(({direction:e,...r},n)=>{const[o]=kt("appTheme","default"),[t]=kt("themeMode",lr.SYSTEM),[a]=kt("pureBlackMode",!1),{settings:{customThemes:l}}=rr(),d=c.useMemo(()=>nr(t,or(o,l),a,e),[t,o,l,a,e]);return s.jsx(ar,{value:ir[e],children:s.jsx(cr,{theme:d,children:s.jsx(X,{...r,ref:n,dir:e})})})}),Us=W(In,[()=>({direction:O.useGetThemeDirection()})],["direction"]),Gs=c.memo(({pageName:e,progressBarPosition:r,slotProps:n,children:o})=>{var t;return s.jsx(z,{...n==null?void 0:n.tooltip,title:e,placement:Es[r],children:s.jsx(X,{...n==null?void 0:n.box,sx:{width:"100%",height:"100%",...(t=n==null?void 0:n.box)==null?void 0:t.sx},children:o})})}),An=c.memo(({pageName:e,primaryPageLoadState:r,secondaryPageLoadState:n,progressBarPosition:o,isCurrentPage:t,isLeadingPage:a,showDraggingStyle:l})=>{const d=et();return s.jsx(Gs,{pageName:e,progressBarPosition:o,slotProps:{box:{sx:{cursor:"pointer",backgroundColor:qt(d.palette.background.paper,.2),...d.applyStyles("dark",{backgroundColor:Jt(d.palette.background.paper,.1)}),...m(r&&(n==null||n),{backgroundColor:qt(d.palette.background.paper,.35),...d.applyStyles("dark",{backgroundColor:Jt(d.palette.background.paper,.25)})})}},tooltip:{slotProps:t?{tooltip:{sx:{backgroundColor:"primary.main",color:"primary.contrastText"}}}:void 0}},children:s.jsx(X,{sx:{width:"100%",height:"100%",...m(a,{backgroundColor:qe(d.palette.primary.main,.5)}),...m(t,{cursor:l?"grabbing":"grab",pointer:"grabbing",borderRadius:2,backgroundColor:"primary.dark",...d.applyStyles("dark",{backgroundColor:"primary.light"})})}})})}),Bn=({readerNavBarWidth:e,isMaximized:r,setIsMaximized:n,isDragging:o,progressBarType:t,progressBarSize:a,progressBarPosition:l,progressBarPositionAutoVertical:d,readerDirection:i,scrollbarXSize:f,scrollbarYSize:u,totalPages:g})=>{const h=et(),[,x]=c.useState({});Xe(window.document.documentElement,c.useCallback(()=>x({}),[]));const p=Ts(l,d,u,e+f),{isBottom:v,isLeft:E,isRight:j,isVertical:S,isHorizontal:R}=Te(p),w=!!g,b=t===Ft.HIDDEN,T=!r&&!o;return s.jsx(Us,{children:s.jsx(Fs,{direction:R?i:"ltr",progressBarPosition:p,fullSegmentClicks:!0,createProgressBarSlot:c.useCallback((L,D,I,y,_,U,te,P,k)=>s.jsx(An,{pageName:L.name,primaryPageLoadState:I,secondaryPageLoadState:y,progressBarPosition:p,isCurrentPage:_,isLeadingPage:U,showDraggingStyle:k}),[p]),slotProps:{container:{sx:{overflow:"hidden",transition:"all 0.".concat(h.transitions.duration.shortest,"s"),...m(R,{minHeight:"100px",...m(h.direction==="ltr",{left:i==="ltr"?e:u,right:i==="rtl"?e:u}),...m(h.direction==="rtl",{left:i==="rtl"?e:u,right:i==="ltr"?e:u})}),...m(S,{minWidth:"100px",bottom:"".concat(f,"px")}),...m(v,{bottom:"".concat(f,"px")}),...m(E,{...m(h.direction==="ltr",{left:i==="ltr"?e:"unset",right:i==="rtl"?e:"unset"}),...m(h.direction==="rtl",{right:i==="rtl"?u:"unset",left:i==="ltr"?u:"unset"})}),...m(j,{...m(h.direction==="ltr",{right:i==="ltr"?u:"unset",left:i==="rtl"?u:"unset"}),...m(h.direction==="rtl",{left:i==="rtl"?e:"unset",right:i==="ltr"?e:"unset"})}),...m(T,{opacity:b?0:.85}),...m(!w,{pointerEvents:"none"})},onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},progressBarRoot:{sx:{gap:0,transition:"all 0.1s ease-in-out",backgroundColor:"background.paper",...m(S,{flexDirection:"column",height:"100%"}),...m(T,{backgroundColor:"unset",pointerEvents:"none",...m(R,{px:2}),...m(S,{py:2}),...m(v,{pb:.25}),...m(E,{...m(h.direction==="ltr",{pl:i==="ltr"?.25:0,pr:i==="rtl"?.25:0}),...m(h.direction==="rtl",{pr:i==="rtl"?.25:0,pl:i==="ltr"?.25:0})}),...m(j,{...m(h.direction==="ltr",{pr:i==="ltr"?.25:0,pl:i==="rtl"?.25:0}),...m(h.direction==="rtl",{pl:i==="rtl"?.25:0,pr:i==="ltr"?.25:0})})})}},progressBarSlotsContainer:{sx:{gap:.25,borderRadius:2,transition:"height 0.1s ease-in-out",...m(R,{height:"20px"}),...m(S,{flexDirection:"column",width:"20px"}),...m(T,{...m(R,{height:"".concat(a,"px")}),...m(S,{width:"".concat(a,"px")})})}},progressBarReadPages:{sx:{display:"none"}},progressBarCurrentPageSlot:{sx:{display:"none"}},progressBarPageTexts:{base:{sx:{px:1,py:1.5,transition:"all 0.1s ease-in-out",...m(T,{transform:"scale(0)",p:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0})}}}}})})},_n=W(c.memo(Bn),[ze,Ot,O.useSettingsWithoutDefaultFlag,()=>({readerDirection:O.useGetThemeDirection()}),Qe,De],["readerNavBarWidth","isMaximized","setIsMaximized","isDragging","progressBarType","progressBarSize","progressBarPosition","progressBarPositionAutoVertical","readerDirection","scrollbarXSize","scrollbarYSize","totalPages"]),yn=he(s.jsx("path",{fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3"})),Pn=he(s.jsx("path",{d:"M14 4v5c0 1.12.37 2.16 1 3H9c.65-.86 1-1.9 1-3V4zm3-2H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3V4h1c.55 0 1-.45 1-1s-.45-1-1-1"})),kn=$e(A)({width:"400px",minWidth:"400px",maxWidth:"400px",height:"100vh",overflowY:"auto"}),Mn=c.memo(({mangaId:e,mangaTitle:r,chapterTitle:n,scanlator:o})=>s.jsxs(A,{children:[s.jsx(z,{title:r,placement:"right",children:s.jsx(gt,{lines:3,variant:"h6",component:"h1",sx:{textAlign:"center"},children:s.jsx($t,{component:Lt,to:Yt.manga.path(e),sx:{textDecoration:"none",color:"inherit"},children:r})})}),s.jsx(z,{title:n,placement:"right",children:s.jsx(gt,{lines:4,variant:"body1",component:"h2",sx:{textAlign:"center"},children:n})}),o&&s.jsx(z,{title:o,placement:"right",children:s.jsx(gt,{lines:4,variant:"body2",component:"h3",color:"textDisabled",sx:{textAlign:"center"},children:o})})]})),Nn=he(s.jsx("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"})),Hn=he(s.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"})),wt=({title:e,type:r,disabled:n,...o})=>s.jsx(z,{title:e,disabled:n,children:s.jsx(Ns,{sx:{flexBasis:"15%"},variant:"contained",disabled:n,...o,children:r==="previous"?s.jsx(Nn,{}):s.jsx(Hn,{})})}),Vn=({currentPageIndex:e,pages:r,readingDirection:n,openPage:o})=>{const{t}=F(),a=js(),l=c.useMemo(()=>ye(e,r),[e,r]),d=Cs[n];return s.jsxs(A,{sx:{flexDirection:"row",gap:1},dir:"ltr",children:[s.jsx(wt,{type:"previous",title:t(a("reader.button.previous_page","reader.button.next_page",d)),disabled:a(!l.primary.index,Le(l)===Le(r.slice(-1)[0]),d),onClick:()=>o("previous",void 0,!1)}),s.jsxs(Vs,{sx:{flexBasis:"70%",flexGrow:0,flexShrink:0},children:[s.jsx(Ws,{id:"reader-nav-bar-desktop-page-select",children:t("reader.page_info.label.page")}),s.jsx(Ms,{labelId:"reader-nav-bar-desktop-page-select",label:t("reader.page_info.label.page"),value:Le(l),onChange:i=>o(i.target.value,void 0,!1),children:r.map(i=>s.jsx(bt,{value:Le(i),children:i.name},Le(i)))})]}),s.jsx(wt,{type:"next",title:t(a("reader.button.next_page","reader.button.previous_page",d)),disabled:a(Le(l)===Le(r.slice(-1)[0]),!l.primary.index,d),onClick:()=>o("next",void 0,!1)})]})},Wn=W(c.memo(Vn),[De,()=>({openPage:ge.useOpenPage()}),O.useSettingsWithoutDefaultFlag],["currentPageIndex","pages","readingDirection","openPage"]),Fn=()=>{},zs=({currentChapter:e,chapters:r,style:n})=>{const o=c.useMemo(()=>e&&r.findIndex(t=>t.id===e.id),[e,r]);return s.jsx(rn,{style:{height:"calc(".concat(r.length," * 100px)"),...n},initialTopMostItemIndex:o!=null?o:0,totalCount:r.length,computeItemKey:t=>r[t].id,itemContent:t=>s.jsx(en,{mode:"reader",chapter:r[t],showChapterNumber:!1,selected:null,onSelect:Fn,selectable:!1,isActiveChapter:t===o},r[t].id),increaseViewportBy:400})},Un=({currentChapter:e,previousChapter:r,nextChapter:n,chapters:o=[],readerThemeDirection:t,openChapter:a})=>{var i,f;const{t:l}=F(),d=Et({variant:"popover",popupId:"reader-nav-bar-desktop-chapter-list"});return c.useLayoutEffect(()=>{d.close()},[e==null?void 0:e.id]),s.jsxs(A,{sx:{flexDirection:"row",gap:1},dir:"ltr",children:[s.jsx(wt,{type:"previous",title:l(ue("reader.button.previous_chapter","reader.button.next_chapter",t)),onClick:()=>{a(ue("previous","next",t))},disabled:ue(!r,!n,t)}),s.jsxs(Vs,{sx:{flexBasis:"70%",flexGrow:0,flexShrink:0},children:[s.jsx(Ws,{id:"reader-nav-bar-desktop-chapter-select",children:l("chapter.title_one")}),s.jsx(Ms,{...Tt(d),open:d.isOpen,value:(i=e==null?void 0:e.id)!=null?i:0,MenuProps:{sx:{visibility:"hidden"}},label:l("chapter.title_one"),labelId:"reader-nav-bar-desktop-chapter-select",children:s.jsx(bt,{value:(f=e==null?void 0:e.id)!=null?f:0,children:e?"#".concat(e.chapterNumber," ").concat(e.name):""},e==null?void 0:e.id)})]}),s.jsx(wt,{component:Lt,type:"next",title:l(ue("reader.button.next_chapter","reader.button.previous_chapter",t)),onClick:()=>{a(ue("next","previous",t))},disabled:ue(!n,!r,t)}),s.jsx(dr,{...ur(d),anchorOrigin:{vertical:"bottom",horizontal:"left"},children:s.jsx(X,{sx:{mb:1},children:s.jsx(zs,{style:{width:"500px",maxWidth:"90vw",minHeight:"150px",maxHeight:"300px"},currentChapter:e,chapters:o})})})]})},Gn=W(c.memo(Un),[()=>({readerThemeDirection:O.useGetThemeDirection()}),()=>({openChapter:ge.useOpenChapter()})],["readerThemeDirection","openChapter"]),zn=he(s.jsx("path",{d:"M17 4h3c1.1 0 2 .9 2 2v2h-2V6h-3zM4 8V6h3V4H4c-1.1 0-2 .9-2 2v2zm16 8v2h-3v2h3c1.1 0 2-.9 2-2v-2zM7 18H4v-2H2v2c0 1.1.9 2 2 2h3zM18 8H6v8h12z"})),$s=(e,r,n)=>{const t=(e+1)%r.length===0;if(!(n&&t))return r[(e+1)%r.length]},Zt=({tooltip:e,value:r,defaultValue:n,values:o,setValue:t,valueToDisplayData:a,isDefaultable:l,onDefault:d,defaultIcon:i})=>{const{t:f}=F(),u=r===void 0,g=c.useMemo(()=>u?-1:o.indexOf(r),[r,o]);return s.jsx(z,{title:e,children:u?s.jsx(Je,{onClick:()=>t(o[0]),sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},variant:"contained",startIcon:i,size:"large",children:n===void 0?f("global.label.default"):s.jsx(Kr,{i18nKey:"settings.default_value",value:a[n].isTitleString?a[n].title:f(a[n].title)})}):s.jsx(Je,{onClick:()=>{const h=$s(g,o,l);if(h===void 0){d==null||d();return}t(h)},sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},variant:"contained",startIcon:a[r].icon,size:"large",children:a[r].isTitleString?a[r].title:f(a[r].title)})})},$n=({pageScaleMode:e,shouldStretchPage:r,updateSetting:n,...o})=>{const{t}=F();return s.jsxs(A,{sx:{flexDirection:"row",gap:1},children:[s.jsx(Zt,{...o,tooltip:t("reader.settings.page_scale.title"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:ws,setValue:a=>n("pageScaleMode",a),valueToDisplayData:Qt,defaultIcon:Qt[e.value].icon}),gr[e.value]&&s.jsx(z,{title:t("reader.settings.page_scale.stretch"),children:s.jsx(Ns,{onClick:()=>n("shouldStretchPage",!r.value),sx:{px:void 0},variant:"contained",color:r.value?"secondary":"primary",children:s.jsx(zn,{})})})]})},Xn=({readingMode:e,setReadingMode:r,...n})=>{const{t:o}=F();return s.jsx(Zt,{...n,tooltip:o("reader.settings.label.reading_mode"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:Os,setValue:r,valueToDisplayData:Ut,defaultIcon:Ut[e.value].icon})},Yn=()=>s.jsx(hr,{children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M2 4h6a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2m20 0h-6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M2 12h20m-3-3 3 3-3 3M5 9l-3 3 3 3"})})}),Kn=({readingMode:e,shouldOffsetDoubleSpreads:r,setShouldOffsetDoubleSpreads:n})=>{const{t:o}=F();return fr(e)?s.jsx(Je,{sx:{justifyContent:"start",textTransform:"unset"},size:"large",onClick:()=>n(!r),color:r?"secondary":"primary",variant:"contained",startIcon:s.jsx(Yn,{}),children:o("reader.settings.label.offset_double_spread")}):null},Zn=({readingDirection:e,setReadingDirection:r,...n})=>{const{t:o}=F();return s.jsx(Zt,{...n,tooltip:o("reader.settings.label.reading_direction"),value:e.isDefault?void 0:e.value,defaultValue:e.isDefault?e.value:void 0,values:Ls,setValue:r,valueToDisplayData:es,defaultIcon:es[e.value].icon})},qn=he(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 14H9V8h2zm4 0h-2V8h2z"})),Jn=he(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 14.5v-9l6 4.5z"})),Qn=({autoScroll:e,setAutoScroll:r})=>{const{t:n}=F(),{isActive:o,toggleActive:t}=ft(),a=c.useRef(void 0);return s.jsxs(A,{sx:{flexDirection:"row",gap:1},children:[s.jsx(Je,{sx:{justifyContent:"start",textTransform:"unset",flexGrow:1},size:"large",onClick:t,color:o?"secondary":"primary",variant:"contained",startIcon:o?s.jsx(qn,{}):s.jsx(Jn,{}),children:n("reader.settings.auto_scroll.title")}),s.jsx(sn,{value:e.value,type:"number",size:"small",onBlur:l=>{const d=rt(+l.target.value,_e.min,_e.max);d!==e.value&&(clearTimeout(a.current),r({...e,value:d},!0))},onChange:l=>{const d=rt(+l.target.value,_e.min,_e.max);r({...e,value:d},!1),clearTimeout(a.current),a.current=setTimeout(()=>r({...e,value:d},!0),1e3)},slotProps:{input:{inputProps:_e,endAdornment:s.jsx(nn,{position:"end",children:n("global.time.seconds.second",{count:e.value})})}}})]})},eo=({manga:e,readingMode:r,shouldOffsetDoubleSpreads:n,pageScaleMode:o,shouldStretchPage:t,readingDirection:a,autoScroll:l,openSettings:d})=>{const{t:i}=F(),f=O.useCreateUpdateSetting(e!=null?e:Fe),u=O.useCreateDeleteSetting(e!=null?e:Fe);return s.jsxs(A,{sx:{gap:1},children:[s.jsx(Xn,{readingMode:r,setReadingMode:g=>f("readingMode",g),isDefaultable:!0,onDefault:()=>u("readingMode")}),s.jsx(Kn,{readingMode:r.value,shouldOffsetDoubleSpreads:n.value,setShouldOffsetDoubleSpreads:g=>f("shouldOffsetDoubleSpreads",g)}),s.jsx($n,{pageScaleMode:o,shouldStretchPage:t,updateSetting:f,isDefaultable:!0,onDefault:()=>u("pageScaleMode")}),s.jsx(Zn,{readingDirection:a,setReadingDirection:g=>f("readingDirection",g),isDefaultable:!0,onDefault:()=>u("readingDirection")}),s.jsx(Qn,{autoScroll:l,setAutoScroll:(...g)=>f("autoScroll",...g)}),s.jsx(Je,{onClick:()=>d(),size:"large",sx:{justifyContent:"start",textTransform:"none"},variant:"contained",startIcon:s.jsx(Ds,{}),children:i("reader.settings.title.reader")})]})},to=W(eo,[Me,O.useSettings],["manga","readingMode","shouldOffsetDoubleSpreads","pageScaleMode","shouldStretchPage","readingDirection","autoScroll"]),so=he(s.jsx("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"})),ls={...Fe,title:"Fallback",inLibrary:!1},ro=({manga:e})=>{const{inLibrary:r}=e!=null?e:ls,{t:n}=F(),{CategorySelectComponent:o,updateLibraryState:t}=un(e!=null?e:ls,!0);return s.jsxs(s.Fragment,{children:[s.jsx(z,{title:n(r?"manga.action.library.remove.label.action":"manga.button.add_to_library"),children:s.jsx(ae,{onClick:t,color:"inherit",children:r?s.jsx(dn,{}):s.jsx(gn,{})})}),o]})},Xs=W(c.memo(ro),[Me],["manga"]),no=he(s.jsx("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"})),oo=({id:e,isBookmarked:r})=>{const{t:n}=F(),o=r?"unbookmark":"bookmark";return s.jsx(z,{title:n(Gt[o].action.single),children:s.jsx(ae,{onClick:()=>We.performAction(o,[e],{}),color:"inherit",children:r?s.jsx(tn,{}):s.jsx(no,{})})})},Ys=c.memo(oo),ao=({currentChapter:e})=>{var o;const{t:r}=F(),n=We.useDownloadStatusFromCache((o=e==null?void 0:e.id)!=null?o:-1);return e&&We.isDownloaded(e)?s.jsx(z,{title:r(Gt.delete.action.single),children:s.jsx(ae,{onClick:()=>We.performAction("delete",[e.id],{}),color:"inherit",children:s.jsx(cn,{})})}):n?s.jsx(ln,{chapterId:n.chapter.id}):s.jsx(z,{title:r(Gt.download.action.single),disabled:!e,children:s.jsx(ae,{disabled:!e,onClick:()=>{var t;return We.performAction("download",[(t=e==null?void 0:e.id)!=null?t:-1],{})},color:"inherit",children:s.jsx(an,{})})})},io=c.memo(({currentChapter:e,pageLoadStates:r,setPageLoadStates:n,setRetryFailedPagesKeyPrefix:o})=>{const{id:t,isBookmarked:a,realUrl:l}=e!=null?e:Hs,{t:d}=F(),i=c.useRef(0),f=c.useMemo(()=>r.some(u=>u.error),[r]);return s.jsxs(A,{sx:{flexDirection:"row",justifyContent:"center",gap:1},children:[s.jsx(Xs,{}),s.jsx(Ys,{id:t,isBookmarked:a}),s.jsx(z,{title:d("reader.button.retry_load_pages"),disabled:!f,children:s.jsx(ae,{onClick:()=>{n(u=>u.map(g=>({url:g.url,loaded:g.loaded}))),o("".concat(i.current)),i.current=(i.current+1)%1e3},disabled:!f,color:"inherit",children:s.jsx(so,{})})}),s.jsx(ao,{currentChapter:e}),s.jsx(z,{title:d("chapter.action.label.open_on_source"),disabled:!l,children:s.jsx(ae,{disabled:!l,href:l!=null?l:"",rel:"noreferrer",target:"_blank",color:"inherit",children:s.jsx(on,{})})})]})}),co=W(io,[Pe,De],["currentChapter","pageLoadStates","setPageLoadStates","setRetryFailedPagesKeyPrefix"]),lo=({exit:e})=>{const{t:r}=F(),n=js();return s.jsx(z,{title:r("reader.button.exit"),children:s.jsx(ae,{sx:{marginRight:2},onClick:e,color:"inherit",children:n(s.jsx(xr,{}),s.jsx(pr,{}))})})},Ks=W(c.memo(lo),[()=>({exit:O.useExit()})],["exit"]),uo=(e,r)=>{const n=c.useRef(r),o=c.useRef(r);return o.current!==n.current&&!e&&(n.current=!1),o.current!==r&&(n.current=o.current,o.current=r),n.current},go=({isVisible:e,openSettings:r,setReaderNavBarWidth:n,manga:o,chapters:t,currentChapter:a,previousChapter:l,nextChapter:d,isStaticNav:i})=>{const{t:f}=F(),u=O.useCreateUpdateSetting(o!=null?o:Fe),[g,h]=c.useState();Xe(g,c.useCallback(()=>{i&&n(g.offsetWidth)},[g,i])),c.useLayoutEffect(()=>()=>n(0),[]);const v=uo(e,i)&&e?0:void 0;return s.jsx(mr,{variant:i?"permanent":"persistent",open:e||i,transitionDuration:v,SlideProps:{unmountOnExit:!0},PaperProps:{ref:E=>h(E)},children:s.jsxs(kn,{sx:{backgroundColor:"background.paper",pointerEvents:"all"},children:[s.jsxs(A,{sx:{p:2,gap:2,backgroundColor:"action.hover"},children:[s.jsxs(A,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[s.jsx(Ks,{}),s.jsx(z,{title:f("reader.settings.label.static_navigation"),children:s.jsx(ae,{onClick:()=>{n(0),u("isStaticNav",!i)},color:i?"primary":"inherit",children:i?s.jsx(yn,{}):s.jsx(Pn,{})})})]}),o&&a?s.jsxs(s.Fragment,{children:[s.jsx(Mn,{mangaId:o.id,mangaTitle:o.title,chapterTitle:a.name,scanlator:a.scanlator}),s.jsx(co,{})]}):s.jsx(Dt,{})]}),s.jsxs(A,{sx:{p:2,gap:2},children:[s.jsxs(A,{sx:{gap:1},children:[s.jsx(Wn,{}),s.jsx(Gn,{chapters:t,currentChapter:a,nextChapter:d,previousChapter:l})]}),s.jsx(vr,{}),s.jsx(to,{openSettings:r})]})]})})},ho=W(c.memo(go),[ze,Me,Pe,De,O.useSettingsWithoutDefaultFlag],["setReaderNavBarWidth","manga","chapters","currentChapter","previousChapter","nextChapter","isStaticNav"]),fo={...Fe,title:""},xo=c.forwardRef(({isVisible:e,manga:r,currentChapter:n,scrollbarYSize:o},t)=>{const{t:a}=F(),l=Et({popupId:"reader-overlay-more-menu",variant:"popover"}),{id:d,title:i}=r!=null?r:fo,{id:f,name:u,realUrl:g,isBookmarked:h}=n!=null?n:Hs;return s.jsx(Kt,{direction:"down",in:e,ref:t,children:s.jsxs(A,{sx:{flexDirection:"row",alignItems:"center",position:"fixed",top:0,left:0,right:"".concat(o,"px"),p:2,pt:x=>"max(env(safe-area-inset-top), ".concat(x.spacing(2),")"),backgroundColor:x=>qe(x.palette.background.paper,.95),pointerEvents:"all",boxShadow:2},children:[s.jsx(Ks,{}),s.jsx(A,{sx:{flexGrow:1},children:r&&n?s.jsxs(s.Fragment,{children:[s.jsx(z,{title:i,children:s.jsx(gt,{lines:1,component:"h1",variant:"h5",children:s.jsx($t,{component:Lt,to:Yt.manga.path(d),sx:{textDecoration:"none",color:"inherit"},children:i})})}),s.jsx(z,{title:u,children:s.jsx(gt,{lines:1,children:u})})]}):s.jsx(Dt,{})}),s.jsx(Xs,{}),s.jsx(Ys,{id:f,isBookmarked:h}),s.jsx(ae,{...Tt(l),color:"inherit",children:s.jsx(hn,{})}),s.jsxs(Sr,{...Rr(l),children:[s.jsx(bt,{component:$t,disabled:!g,href:g!=null?g:"",rel:"noreferrer",target:"_blank",children:a("chapter.action.label.open_on_source")}),s.jsx(bt,{disabled:!g,onClick:async()=>{await navigator.clipboard.writeText(i),Is(a("global.label.copied_clipboard"),"info")},children:a("global.label.share")})]})]})})}),po=W(c.memo(xo),[Me,Pe,Qe],["manga","currentChapter","scrollbarYSize"]),mo=he(s.jsx("path",{d:"m21.81 12.74-.82-.63v-.22l.8-.63c.16-.12.2-.34.1-.51l-.85-1.48c-.07-.13-.21-.2-.35-.2q-.075 0-.15.03l-.95.38c-.08-.05-.11-.07-.19-.11l-.15-1.01c-.03-.21-.2-.36-.4-.36h-1.71c-.2 0-.37.15-.4.34l-.14 1.01c-.03.02-.07.03-.1.05l-.09.06-.95-.38q-.075-.03-.15-.03c-.14 0-.27.07-.35.2l-.85 1.48c-.1.17-.06.39.1.51l.8.63v.23l-.8.63c-.16.12-.2.34-.1.51l.85 1.48c.07.13.21.2.35.2q.075 0 .15-.03l.95-.37c.08.05.12.07.2.11l.15 1.01c.03.2.2.34.4.34h1.71c.2 0 .37-.15.4-.34l.15-1.01c.03-.02.07-.03.1-.05l.09-.06.95.38q.075.03.15.03c.14 0 .27-.07.35-.2l.85-1.48c.1-.17.06-.39-.1-.51M18 13.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5M17 17h2v4c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v4h-2V6H7v12h10z"})),vo=he(s.jsx("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5m0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5m0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5M7 19h14v-2H7zm0-6h14v-2H7zm0-8v2h14V5z"})),ds=he(s.jsx("path",{d:"M6 6h2v12H6zm3.5 6 8.5 6V6z"})),us=he(s.jsx("path",{d:"m6 18 8.5-6L6 6zM16 6v12h2V6z"})),So={display:"flex",alignItems:"center",justifyContent:"end",position:"relative",backgroundColor:"background.default"},gs="3px",Ro=c.memo(({isTrailingPage:e,pagesIndex:r,totalPages:n,isVertical:o,isHorizontal:t})=>{const a="".concat(r/(n-1)*100,"%");return s.jsx(X,{sx:{position:"absolute",...m(o,{top:a,left:"50%"}),...m(t,{top:"50%",left:a}),transform:"translate(-50%, -50%)",width:gs,height:gs,borderRadius:100,backgroundColor:"background.paper",...m(e,{backgroundColor:"primary.main"}),zIndex:1}})}),bo=c.memo(({pageName:e,isTrailingPage:r,isCurrentPage:n,pagesIndex:o,totalPages:t,isVertical:a,isHorizontal:l})=>s.jsx(Gs,{pageName:e,progressBarPosition:ut.BOTTOM,slotProps:{box:{sx:So}},children:!n&&s.jsx(Ro,{isTrailingPage:r,pagesIndex:o,totalPages:t,isVertical:a,isHorizontal:l})})),Eo={[ut.BOTTOM]:"up",[ut.LEFT]:"right",[ut.RIGHT]:"left",[ut.AUTO]:"left"},To=({previousChapter:e,nextChapter:r,isVisible:n,setIsMaximized:o,isDragging:t,currentPageIndex:a,pages:l,direction:d,progressBarPosition:i,progressBarPositionAutoVertical:f,topOffset:u=0,bottomOffset:g=0,scrollbarXSize:h})=>{const x=ge.useOpenChapter(),[,p]=c.useState({});Xe(window.document.documentElement,c.useCallback(()=>p({}),[]));const v=Ts(i,f,u+g,h),{isLeft:E,isRight:j,isVertical:S,isHorizontal:R}=Te(v),w=R?d:"ltr",b=c.useMemo(()=>ye(a,l).pagesIndex,[a,l]),T=c.useMemo(()=>({container:{sx:{flexGrow:1,position:"relative",display:"flex",justifyItems:"center",alignItems:"stretch",backgroundColor:D=>qe(D.palette.background.paper,.85),borderRadius:100,boxShadow:2}},progressBarRoot:{sx:{flexGrow:1,gap:0,...m(S,{flexDirection:"column"}),...m(R,{alignItems:"stretch"})}},progressBarSlotsActionArea:{sx:{alignItems:"center",cursor:"pointer",...m(S,{width:"100%",flexDirection:"column",px:2}),...m(R,{height:"100%",py:2})}},progressBarSlotsContainer:{sx:{borderRadius:100,backgroundColor:"background.default",...m(S,{flexDirection:"column",py:1}),...m(R,{px:1})}},progressBarSlot:{sx:{...m(S,{width:"20px"}),...m(R,{height:"20px"})}},progressBarCurrentPageSlot:{sx:{display:"flex",zIndex:1,cursor:"inherit",...m(S,{justifyContent:"center"}),...m(R,{alignItems:"center"})}},progressBarPageTexts:{base:{sx:{...m(S,{py:1}),...m(R,{px:1})}}}}),[S,R]),L=c.useMemo(()=>({progressBarCurrentPage:s.jsx(X,{sx:{position:"absolute",...m(S,{top:"calc(100% - 6px)",...m(b===0,{top:"0"}),width:"75%",height:"6px"}),...m(R,{left:"calc(100% - 0px)",...m(b===0,{left:"0"}),width:"6px",height:"75%"}),backgroundColor:"primary.main",borderRadius:100,cursor:t?"grabbing":"grab"}})}),[b,l.length,t,S,R]);return c.useLayoutEffect(()=>(o(n),()=>o(!1)),[n]),s.jsx(Kt,{direction:Eo[v],in:n,children:s.jsx(Us,{sx:{position:"relative",display:"flex",alignItems:"end",height:"100%",pointerEvents:"none",...m(E,{justifyContent:d==="ltr"?"start":"end"}),...m(j,{justifyContent:d==="ltr"?"end":"start"})},children:s.jsxs(A,{sx:{p:2,gap:1,pointerEvents:"all",alignItems:"center",...m(S,{height:"100%",flexDirection:"column"}),...m(R,{width:"100%",flexDirection:"row"})},children:[s.jsx(ae,{onClick:()=>x("previous"),disabled:!e,sx:{backgroundColor:D=>qe(D.palette.background.paper,.85),boxShadow:2},children:ue(s.jsx(ds,{sx:{...m(S,{transform:"rotate(90deg)"})}}),s.jsx(us,{sx:{...m(S,{transform:"rotate(90deg)"})}}),w)}),s.jsx(Fs,{direction:w,progressBarPosition:v,fullSegmentClicks:!1,createProgressBarSlot:c.useCallback((D,I,y,_,U,te,P,k)=>s.jsx(bo,{pageName:D.name,isTrailingPage:P,isCurrentPage:U,pagesIndex:I,totalPages:k,isVertical:S,isHorizontal:R}),[S,R]),slotProps:{...T,progressBarReadPages:{sx:{backgroundColor:"primary.main",...m(S,{width:"20px",height:"".concat(Math.max(0,ye(a,l).pagesIndex)/(l.length-1)*100,"%"),borderRadius:"400px 400px 0 0"}),...m(R,{width:"".concat(Math.max(0,ye(a,l).pagesIndex)/(l.length-1)*100,"%"),height:"20px",borderRadius:"400px 0 0 400px"})}}},slots:L}),s.jsx(ae,{onClick:()=>x("next"),disabled:!r,sx:{backgroundColor:D=>qe(D.palette.background.paper,.85),boxShadow:2},children:ue(s.jsx(us,{sx:{...m(S,{transform:"rotate(90deg)"})}}),s.jsx(ds,{sx:{...m(S,{transform:"rotate(90deg)"})}}),w)})]})})})},jo=W(c.memo(To),[Pe,It,Ot,De,()=>({direction:O.useGetThemeDirection()}),O.useSettingsWithoutDefaultFlag,Qe],["previousChapter","nextChapter","isVisible","setIsMaximized","isDragging","currentPageIndex","pages","direction","progressBarPosition","progressBarPositionAutoVertical","scrollbarXSize"]),Co=({manga:e,readingMode:r,readingDirection:n,autoScroll:o,isActive:t,toggleActive:a})=>{const{t:l}=F(),d=O.useCreateDeleteSetting(e!=null?e:Fe);return e?s.jsxs(A,{sx:{gap:2},children:[s.jsx(Zr,{}),s.jsx(qr,{readingMode:r,setReadingMode:i=>O.updateSetting(e,"readingMode",i),isDefaultable:!0,onDefault:()=>d("readingMode")}),s.jsx(Jr,{readingDirection:n,setReadingDirection:i=>O.updateSetting(e,"readingDirection",i),isDefaultable:!0,onDefault:()=>d("readingDirection")}),s.jsx(fn,{label:l("reader.settings.auto_scroll.title"),checked:t,onChange:()=>a()}),s.jsx(Qr,{autoScroll:o,setAutoScroll:(...i)=>O.updateSetting(e,"autoScroll",...i)})]}):null},wo=W(c.memo(Co),[Me,O.useSettings,ft],["manga","readingMode","readingDirection","autoScroll","isActive","toggleActive"]),Oo=({openSettings:e,isVisible:r,currentChapter:n,chapters:o,scrollbarXSize:t,scrollbarYSize:a,topOffset:l=0})=>{const{t:d}=F(),i=Et({variant:"dialog",popupId:"reader-chapter-list-dialog"}),f=Et({variant:"dialog",popupId:"reader-quick-settings-dialog"}),[u,g]=c.useState(0),h=c.useRef(null);return Xe(h,c.useCallback(()=>{var x,p;return g((p=(x=h.current)==null?void 0:x.clientHeight)!=null?p:0)},[u])),c.useLayoutEffect(()=>{i.close()},[n==null?void 0:n.id]),s.jsxs(s.Fragment,{children:[s.jsxs(A,{sx:{position:"fixed",right:"".concat(a,"px"),bottom:0,left:0,height:"calc(100% - ".concat(l,"px)")},children:[s.jsx(jo,{topOffset:l,bottomOffset:u}),s.jsx(Kt,{direction:"up",in:r,children:s.jsx(A,{ref:h,sx:{alignItems:"center",backgroundColor:x=>qe(x.palette.background.paper,.95),pb:"max(".concat(t,"px, env(safe-area-inset-bottom))"),boxShadow:2,pointerEvents:"all"},children:s.jsxs(A,{sx:{width:"50%",flexDirection:"row",p:2,gap:1,justifyContent:"space-evenly",alignItems:"center"},children:[s.jsx(z,{title:d("reader.button.chapter_list"),children:s.jsx(ae,{...Tt(i),color:"inherit",children:s.jsx(vo,{})})}),s.jsx(z,{title:d("reader.settings.title.quick_settings"),children:s.jsx(ae,{...Tt(f),color:"inherit",children:s.jsx(mo,{})})}),s.jsx(z,{title:d("settings.title"),children:s.jsx(ae,{onClick:e,color:"inherit",children:s.jsx(Ds,{})})})]})})})]}),i.isOpen&&s.jsx(Vt,{...ts(i),fullWidth:!0,maxWidth:"md",scroll:"paper",children:s.jsx(Wt,{sx:{p:0,pb:1},children:s.jsx(zs,{style:{minHeight:"15vh",maxHeight:"75vh"},currentChapter:n,chapters:o})})}),f.isOpen&&s.jsx(Vt,{...ts(f),fullWidth:!0,maxWidth:"md",scroll:"paper",children:s.jsx(Wt,{children:s.jsx(wo,{})})})]})},Lo=W(c.memo(Oo),[Pe,Qe],["currentChapter","chapters","scrollbarXSize","scrollbarYSize"]),Do=({isVisible:e,isDesktop:r,isMobile:n})=>{const[o,t]=c.useState(!1),[a,l]=c.useState(0),d=c.useRef(null);return Xe(d,c.useCallback(()=>{var i,f;return l((f=(i=d.current)==null?void 0:i.clientHeight)!=null?f:0)},[n])),s.jsxs(X,{sx:{position:"absolute",width:"100%",height:"100%",pointerEvents:"none",zIndex:1},children:[r&&s.jsxs(s.Fragment,{children:[s.jsx(_n,{}),s.jsx(ho,{isVisible:e,openSettings:()=>t(!0)})]}),n&&s.jsxs(s.Fragment,{children:[s.jsx(po,{ref:d,isVisible:e}),s.jsx(Lo,{openSettings:()=>t(!0),isVisible:e,topOffset:a})]}),s.jsx(pn,{isOpen:o,close:()=>t(!1)}),s.jsx(vn,{})]})},Io=W(c.memo(Do),[O.useOverlayMode],["isDesktop","isMobile"]),hs="reader-tap-zone-layout-canvas",Ao=({readerNavBarWidth:e,showPreview:r,tapZoneLayout:n,tapZoneInvertMode:o,readingDirection:t})=>{const a=et(),[l,d]=c.useState(0),[i,f]=c.useState(0),[u,g]=c.useState(null);Xe(u,c.useCallback(()=>{var x,p;d((x=u==null?void 0:u.clientWidth)!=null?x:0),f((p=u==null?void 0:u.clientHeight)!=null?p:0)},[u]));const h=br.getOrCreateCanvas(n,l,i,a.typography.h3,{vertical:o.vertical,horizontal:o.horizontal,isRTL:t===nt.RTL});return c.useLayoutEffect(()=>{const x=document.getElementById(hs);x==null||x.replaceChildren(h)},[h,r]),s.jsx(X,{ref:g,sx:{position:"fixed",top:0,left:e,right:0,bottom:0,pointerEvents:"none"},children:r&&s.jsx("div",{id:hs})})},Bo=W(Ao,[ze,At,O.useSettingsWithoutDefaultFlag],["readerNavBarWidth","showPreview","tapZoneLayout","tapZoneInvertMode","readingDirection"]),_o=({readerNavBarWidth:e,customFilter:{rgba:{value:{red:r,green:n,blue:o,alpha:t,blendMode:a},enabled:l}}})=>l?s.jsx(X,{sx:{position:"fixed",top:0,left:e,right:0,bottom:0,pointerEvents:"none",background:"rgba(".concat(r," ").concat(n," ").concat(o," / ").concat(t,"%)"),mixBlendMode:"".concat(a)}}):null,yo=W(_o,[ze,O.useSettingsWithoutDefaultFlag],["readerNavBarWidth","customFilter"]),fs=2,xs=1,Ke=0,ne=0,oe=1,Po=(e,r=Mt.XY)=>{const[n,o]=c.useState(!1),t=c.useRef(void 0),a=c.useRef([0,0,0]),l=c.useRef([0,0,0]),d=c.useRef([0,0,0]),i=c.useRef([0,0]),f=c.useRef(void 0);return c.useEffect(()=>{const u=e==null?void 0:e.current;if(!u)return()=>{};const g=()=>{t.current||(t.current=getComputedStyle(u));const T=t.current.direction==="rtl",L=t.current.flexDirection==="row-reverse";return T||!T&&L},h=()=>(t.current||(t.current=getComputedStyle(u)),t.current.flexDirection==="column-reverse"),x=r!==Mt.Y,p=r!==Mt.X,v=()=>clearInterval(f.current),E=()=>{const T=(G,se,V)=>(G[Ke]-G[fs])/(se[Ke]-se[fs])*1e3/V,L=[x?T(a.current,d.current,u.clientWidth):0,p?T(l.current,d.current,u.clientHeight):0],D=x&&p?Math.sqrt(L[ne]**2+L[oe]**2):Math.abs(p?L[oe]:L[ne]),I=[L[ne]/D,L[oe]/D],y=rt(1.2*D,-12,12),_=(Date.now()-d.current[Ke])/1e3,U=y-14.278*_+75.24*_**2/y-149.72*_**3/y/y;if(!(y!==0&&U>0&&!Number.isNaN(y))){v();return}const P=(G,se)=>G*se*(y*_-7.1397*_**2+25.08*_**3/y-37.43*_**4/y/y),k=[P(u.clientWidth,I[ne]),P(u.clientHeight,I[oe])],H=[u.scrollWidth-u.clientWidth,u.scrollHeight-u.clientHeight],B=[rt(i.current[ne]-k[ne],g()?-H[ne]:0,H[ne]),rt(i.current[oe]-k[oe],h()?-H[oe]:0,H[oe])],ie=B[ne]!==0||B[ne]!==H[ne],ce=B[oe]!==0||B[oe]!==H[oe];ie||ce||v(),x&&(u.scrollLeft=B[ne]),p&&(u.scrollTop=B[oe])};let j=!1;const S=T=>{if(j)return!0;const L=[u.clientHeight<u.scrollHeight,u.clientWidth<u.scrollWidth],D=[Math.abs(a.current[Ke]-T.pageX)>0,Math.abs(l.current[Ke]-T.pageY)>0];return L[ne]&&D[ne]||L[oe]&&D[oe]},R=T=>{S(T)&&(j=!0,o(!0),a.current=[...a.current.slice(1),T.pageX],l.current=[...l.current.slice(1),T.pageY],d.current=[...d.current.slice(1),Date.now()],x&&(u.scrollLeft+=a.current[Ke]-a.current[xs]),p&&(u.scrollTop+=l.current[Ke]-l.current[xs]))},w=()=>{u.removeEventListener("mousemove",R),u.removeEventListener("mouseup",w),setTimeout(()=>{j=!1,o(!1)},0),i.current=[u.scrollLeft,u.scrollTop],f.current=setInterval(E,16)},b=T=>{T.button===0&&(T.preventDefault(),a.current=[T.pageX,T.pageX,T.pageX],l.current=[T.pageY,T.pageY,T.pageY],d.current=[Date.now()-2,Date.now()-1,Date.now()],u.addEventListener("mousemove",R),u.addEventListener("mouseup",w),v())};return u.addEventListener("mousedown",b),u.addEventListener("wheel",v),()=>{u.removeEventListener("mousedown",b),u.removeEventListener("wheel",v),v()}},[e,r]),n},ko=(e,r)=>{c.useEffect(()=>{if(e){r.pause();return}r.resume()},[e,r.isPaused])},Mo=(e,r,n,o,t)=>{c.useEffect(()=>{var l,d;const a=()=>{e&&r(!1),n&&o(!1)};return(l=t.current)==null||l.addEventListener("wheel",a),(d=t.current)==null||d.addEventListener("touchmove",a),()=>{var i,f;(i=t.current)==null||i.removeEventListener("wheel",a),(f=t.current)==null||f.removeEventListener("touchmove",a)}},[e,n])},No=(e,r,n)=>{c.useEffect(()=>{if(e!==N.CONTINUOUS_HORIZONTAL)return()=>{};if(!n.current)return()=>{};const o=t=>{var a,l;if(t.preventDefault(),t.shiftKey){(a=n.current)==null||a.scrollBy({top:t.deltaY});return}(l=n.current)==null||l.scrollBy({left:r===nt.LTR?t.deltaY:t.deltaY*-1})};return n.current.addEventListener("wheel",o),()=>{var t;return(t=n.current)==null?void 0:t.removeEventListener("wheel",o)}},[e,r])},Ho=e=>{const r=c.useRef(void 0);c.useEffect(()=>{const n=t=>{const a=e.current;a&&(a.style.cursor=t?"default":"none")},o=()=>{n(!0),clearTimeout(r.current),r.current=setTimeout(()=>{n(!1)},5e3)};return o(),window.addEventListener("mousemove",o),()=>{n(!0),window.removeEventListener("mousemove",o),clearTimeout(r.current)}},[])},Vo=(e,r,n,o,t)=>{c.useLayoutEffect(()=>{var a;r||(a=t.current)==null||a.scrollTo(Er(t.current,n,o),0)},[e])},Wo=(e,r,n,o,t,a,l,d,i,f)=>{c.useLayoutEffect(()=>{if(e==null)return;const u=ye(e,n);if(l){const x=e>r?jt.PREVIOUS:jt.NEXT,p=d.current[u.pagesIndex];p==null||p.scrollIntoView({block:"start",inline:Tr(x,i,f)})}const g=Le(u),h=g===o-1;t(null),a(g,!h,h)},[e])},Fo=(e,r,n,o,t,a,l)=>{const[d,i]=c.useState(l===N.DOUBLE_PAGE);c.useLayoutEffect(()=>{if(d&&l!==N.DOUBLE_PAGE){i(!1);const g=As(n);o(g),t(g.map(({primary:{url:h}})=>({url:h,isSpread:!1})));return}l===N.DOUBLE_PAGE&&(d||a(Le(ye(e,r))),o(r),i(l===N.DOUBLE_PAGE))},[r,l])},Nt=({title:e,name:r,scanlator:n,backgroundColor:o})=>{const t=et(),a=t.palette.getContrastText(wr(t.palette,Bs[o])),l=qe(a,.5);return r?s.jsxs(A,{children:[s.jsx(Ze,{color:a,children:e}),s.jsx(Ze,{color:a,variant:"h6",component:"h1",children:r}),n&&s.jsx(Ze,{variant:"body2",color:l,children:n})]}):null},Uo=({type:e,transitionPageMode:r,readingMode:n,backgroundColor:o,manga:t,currentChapterName:a,currentChapterScanlator:l,previousChapterName:d,previousChapterScanlator:i,nextChapterName:f,nextChapterScanlator:u,scrollbarXSize:g,scrollbarYSize:h,readerNavBarWidth:x,handleBack:p})=>{var w;const{t:v}=F(),E=e===Ue.PREVIOUS,j=e===Ue.NEXT,S=!!a&&!d,R=!!a&&!f;return Cr(e,r,n)?s.jsx(A,{sx:{justifyContent:"center",alignItems:"center",...m(!Ge(n),{width:"100%",height:"100%"}),...m(Ge(n),{position:"sticky",...m(ke(n),{left:0,maxWidth:"calc(100vw - ".concat(h,"px - ").concat(x,"px)"),minHeight:"calc(100vh - ".concat(g,"px)")}),...m(n===N.CONTINUOUS_HORIZONTAL,{top:0,minWidth:"calc(100vw - ".concat(h,"px - ").concat(x,"px)"),maxHeight:"calc(100vh - ".concat(g,"px)")})})},children:s.jsxs(A,{sx:{gap:2,maxWidth:b=>"calc(100vw - ".concat(h,"px - ").concat(x,"px - ").concat(b.spacing(2),")"),maxHeight:"calc(100vh - ".concat(g,"px)"),width:"max-content",p:1},children:[E&&S&&s.jsx(Ze,{variant:"h6",children:v("reader.transition_page.first_chapter")}),s.jsxs(A,{sx:{gap:5},children:[E&&!S&&s.jsx(Nt,{title:v("reader.transition_page.previous"),name:d,scanlator:i,backgroundColor:o}),!!a&&s.jsx(Nt,{title:v(E?"reader.transition_page.current":"reader.transition_page.finished"),name:a,scanlator:l,backgroundColor:o}),j&&!R&&s.jsx(Nt,{title:v("reader.transition_page.next"),name:f,scanlator:u,backgroundColor:o})]}),j&&R&&s.jsx(Ze,{variant:"h6",children:v("reader.transition_page.last_chapter")}),(E&&S||j&&R)&&s.jsxs(A,{sx:{flexDirection:"row",flexWrap:"wrap",gap:1},children:[s.jsx(Je,{sx:{flexGrow:1},onClick:b=>{b.stopPropagation(),p()},variant:"contained",children:v("reader.transition_page.exit.previous_page")}),s.jsx(Je,{sx:{flexGrow:1},component:Lt,onClick:b=>{b.stopPropagation()},variant:"contained",to:Yt.manga.path((w=t==null?void 0:t.id)!=null?w:-1),children:v("reader.transition_page.exit.manga_page")})]})]})}):null},ps=W(c.memo(Uo),[Me,({chapterId:e})=>{const{chapters:r}=Pe(),n=c.useMemo(()=>r.findIndex(l=>l.id===e),[e,r]),o=r[n],t=c.useMemo(()=>r[n+1],[n,r]),a=c.useMemo(()=>r[n-1],[n,r]);return{currentChapterName:o==null?void 0:o.name,currentChapterScanlator:o==null?void 0:o.scanlator,previousChapterName:t==null?void 0:t.name,previousChapterScanlator:t==null?void 0:t.name,nextChapterName:a==null?void 0:a.name,nextChapterScanlator:a==null?void 0:a.scanlator}},Qe,ze,De,O.useSettingsWithoutDefaultFlag,({chapterId:e,type:r})=>{const n=jr(),{chapters:o}=Pe(),t=c.useMemo(()=>o.findIndex(u=>u.id===e),[e,o]),a=t===0,l=t===o.length-1,d=r===Ue.PREVIOUS&&l,i=r===Ue.NEXT&&a;return{handleBack:d||i?n:Be}}],["manga","currentChapterName","currentChapterScanlator","previousChapterName","previousChapterScanlator","nextChapterName","nextChapterScanlator","scrollbarXSize","scrollbarYSize","readerNavBarWidth","backgroundColor","transitionPageMode","readingMode","handleBack"]),Go=(e,r,n,o,t,a,l,d,i,f,u,g,h,x,p,v,E,j)=>{var R,w;const S=c.useRef(void 0);c.useLayoutEffect(()=>{var y;const b=(y=r.data)==null?void 0:y.fetchChapterPages;if(!b)return;const{pages:T}=b,L=T.length?T:[""],D=Or(n,o!=null?o:0,L.length-1),I=S.current!==(b==null?void 0:b.pages);if(I){S.current=b.pages;const _=As(L);i(!0),g(_),h(L),x(_.map(({primary:{url:U}})=>({url:U,loaded:!1}))),p(_.map(({primary:{url:U}})=>({url:U,isSpread:!1})))}else g(t),x(a),p(l);u(b.pages.length),h(L),v(D),E(D),f(_=>({..._,isCurrentChapterReady:d||I})),j(Ue.NONE)},[(w=(R=r.data)==null?void 0:R.fetchChapterPages)==null?void 0:w.pages,e])},ms=0,vt="-10px",zo=(e,r,n)=>{if(!Ge(r))return;const o=Cs[n],t="0px ".concat(vt," 0px 0px"),a="0px 0px 0px ".concat(vt);return ke(r)?e==="first"?"0px 0px ".concat(vt," 0px"):"".concat(vt," 0px 0px 0px"):e==="first"?ue(t,a,o):ue(a,t,o)},$o=(e,r,n,o)=>e===nt.LTR?{start:n>=o,end:r<0}:{start:r<0,end:n>=o},Xo=(e,{top:r,right:n,bottom:o,left:t},a,l)=>{const d=window.innerWidth-l,i=window.innerHeight-a;return{[N.CONTINUOUS_VERTICAL]:{start:o>=i,end:r<0},[N.CONTINUOUS_HORIZONTAL]:$o(e,t,n,d)}},Yo=({[N.CONTINUOUS_VERTICAL]:e,[N.CONTINUOUS_HORIZONTAL]:r},n)=>ke(n)?e.start||e.end:r.start||r.end,Ko=({[N.CONTINUOUS_VERTICAL]:e,[N.CONTINUOUS_HORIZONTAL]:r},n)=>ke(n)?e:r,vs=(e,r,n,o,t,a,l,d,i,f,u,g,h)=>{Lr(f,c.useCallback(x=>{if(!d||!Ge(a)||n===void 0)return;const p=x[x.length-1],v=Xo(l,p.target.getBoundingClientRect(),u,g),{start:E,end:j}=Ko(v,a),S=p.intersectionRatio<=ms;if(!Yo(v,a))return;const R=e==="first"&&E&&!t,w=e==="last"&&!o&&j;if(R||e==="last"&&j&&S){i(n,!t,!1);return}w&&i(r,!1,!1)},[e,r,n,o,t,a,l,d,i,u,g]),c.useMemo(()=>({root:h,threshold:[ms],rootMargin:zo(e,a,l),ignoreInitialObserve:!0}),[e,a,l]))},Zo=({readingMode:e,readingDirection:r,shouldUseInfiniteScroll:n,chapterId:o,previousChapterId:t,nextChapterId:a,isPreviousChapterVisible:l,isCurrentChapter:d,isNextChapterVisible:i,imageWrapper:f,openChapter:u,scrollbarXSize:g,scrollbarYSize:h,scrollElement:x})=>(vs("first",o,t,d,l,e,r,n,u,f,g,h,x),vs("last",o,a,d,i,e,r,n,u,f,g,h,x),null),qo=W(c.memo(Zo),[()=>({openChapter:ge.useOpenChapter()})],["openChapter"]),Jo=({currentPageIndex:e,setPages:r,setPageLoadStates:n,setTotalPages:o,setCurrentPageIndex:t,updateCurrentPageIndex:a,setPageToScrollToIndex:l,transitionPageMode:d,retryFailedPagesKeyPrefix:i,setTransitionPageMode:f,readingMode:u,readerWidth:g,pageScaleMode:h,shouldOffsetDoubleSpreads:x,readingDirection:p,shouldUseInfiniteScroll:v,imagePreLoadAmount:E,pageGap:j,chapterId:S,previousChapterId:R,nextChapterId:w,isPreviousChapterVisible:b,isNextChapterVisible:T,lastPageRead:L,isInitialChapter:D,isCurrentChapter:I,isPreviousChapter:y,isNextChapter:_,isLeadingChapter:U,isTrailingChapter:te,isPreloadMode:P,imageRefs:k,scrollIntoView:H,setReaderStateChapters:B,resumeMode:ie,customFilter:ce,shouldStretchPage:Q,scrollbarXSize:G,scrollbarYSize:se,readerNavBarWidth:V,onSizeChange:Z,minWidth:fe,minHeight:je,scrollElement:Ce})=>{const{t:xe}=F(),{direction:pe}=et(),[le,ve]=zt.useGetChapterPagesFetch(S!=null?S:-1),[Se,Ie]=c.useState(!1),[me,Ne]=c.useState(mt.totalPages),[Ye,tt]=c.useState(mt.pageUrls),[we,Re]=c.useState(mt.pages),[Y,M]=c.useState(mt.pageLoadStates),[K,He]=c.useState(Y.map(({url:C})=>({url:C,isSpread:!1}))),ee=c.useRef(null),be=c.useRef(I),de=c.useRef(we.map(()=>null)),$=c.useRef(null),Ae=c.useMemo(()=>!!!me||!(me===K.length)?we:u===N.DOUBLE_PAGE?Dr(Ye,K,x,p):we,[K,u,x,p,me]),ot=c.useMemo(()=>Ir(u),[u]),at=p===nt.LTR,Ee=Ge(u),Ve=!Ee&&!I||P,xt=!Ee&&I,it=!Ve&&(xt||Ee&&(D||U)),ct=!Ve&&(xt||Ee&&(D||te));be.current=I,I&&(k.current=de.current);const lt=c.useCallback(()=>{S&&(Ie(!1),le({variables:{input:{chapterId:S}}}).catch(St()))},[le,S]),Bt=c.useMemo(()=>Ar(Ae,K,He,Y,C=>{be.current&&n(C),M(C)},u),[Ae,u]),_t=c.useMemo(()=>Br(C=>{be.current&&n(C),M(C)}),[]);c.useEffect(()=>{lt()},[S]),Xe(ee,c.useCallback(C=>{const{clientWidth:Oe,clientHeight:st}=C[0].target;Z(Oe,st,S)},[Z,ee.current,S]));const re=(C,Oe,st,pt=!1)=>{(pt||!Se)&&Oe(C),I&&st(C)};return Go(I,ve,ie,L,Ae,Y,K,Se,Ie,C=>re(C,Be,B),C=>re(C,Ne,o),C=>re(C,Re,r),C=>re(C,tt,Be),C=>re(C,M,n),C=>re(C,He,Be),C=>re(C,Be,t),C=>{(D&&!Se||H)&&(l(C),B(Oe=>({...Oe,visibleChapters:{...Oe.visibleChapters,scrollIntoView:!1,resumeMode:void 0}})))},C=>re(C,Be,f)),Fo(e,Ae,Ye,C=>re(C,Re,r,!0),C=>re(C,He,Be,!0),C=>re(C,Be,a),u),Ee||I||y||_?ve.error?Ve?null:s.jsx(X,{sx:{minHeight:"100%",minWidth:"100%",display:"grid",placeItems:"center",position:"relative"},children:s.jsx(Ct,{message:xe("global.error.label.failed_to_load_data"),messageExtra:_s(ve.error),retry:()=>{lt()}})}):ve.loading||!Se?Ve?null:s.jsx(X,{sx:{minHeight:"100%",minWidth:"100%",display:"grid",placeItems:"center"},children:s.jsx(Dt,{})}):S!=null&&!me?Ve?null:s.jsx(X,{sx:{minWidth:"100%",minHeight:"100%",position:"relative"},children:s.jsx(Ct,{message:xe("reader.error.label.no_pages_found"),retry:lt})}):s.jsxs(A,{ref:ee,sx:{width:"fit-content",height:"fit-content",margin:"auto",flexWrap:"nowrap",...m(u===N.CONTINUOUS_HORIZONTAL,{minHeight:je}),...m(ke(u),{minWidth:fe}),...m(Ve,{maxWidth:0,maxHeight:0,minWidth:"unset",minHeight:"unset",overflow:"hidden",margin:"unset"}),...m(ke(u)&&ys(g,h),{alignItems:"center"}),...m(u===N.CONTINUOUS_HORIZONTAL,{...m(pe==="ltr",{flexDirection:at?"row":"row-reverse"}),...m(pe==="rtl",{flexDirection:at?"row-reverse":"row"})})},children:[!P&&s.jsx(qo,{readingMode:u,readingDirection:p,shouldUseInfiniteScroll:v,chapterId:S,previousChapterId:R,nextChapterId:w,isCurrentChapter:I,isPreviousChapterVisible:b,isNextChapterVisible:T,imageWrapper:$.current,scrollbarXSize:G,scrollbarYSize:se,scrollElement:Ce}),it&&s.jsx(ps,{chapterId:S,type:Ue.PREVIOUS}),s.jsx(ot,{ref:$,totalPages:me,currentPageIndex:e,pages:Ae,transitionPageMode:d,pageLoadStates:Y,retryFailedPagesKeyPrefix:i,imageRefs:de,onLoad:Bt,onError:_t,isCurrentChapter:I,isPreviousChapter:y,isNextChapter:_,readingMode:u,imagePreLoadAmount:E,readingDirection:p,pageScaleMode:h,pageGap:j,customFilter:ce,shouldStretchPage:Q,readerWidth:g,scrollbarXSize:G,scrollbarYSize:se,readerNavBarWidth:V,isPreloadMode:P,resumeMode:ie,handleAsInitialRender:H}),ct&&s.jsx(ps,{chapterId:S,type:Ue.NEXT})]}):null},Qo=c.memo(Jo),ea=(e,r,n,o)=>{const t=_r(r),a=yr(r),l=n!==window.innerWidth,d=o!==window.innerHeight,i=t&&l,f=a&&d;return!ke(e)&&l?!0:i||f},Ss=(e,r,n)=>{c.useLayoutEffect(()=>{n(r)},[e])},ta=(e,r,n,o)=>{const t=c.useRef({width:window.innerWidth,height:window.innerHeight});c.useEffect(()=>{const a=()=>{const{width:l,height:d}=t.current;t.current={width:window.innerWidth,height:window.innerHeight},ea(e,r,l,d)&&n(o)};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[e,r,o])},Zs=e=>{const r=c.useRef({left:0,top:0,visibleElement:void 0,visibleElementLeft:0,visibleElementTop:0});return c.useEffect(()=>{const n=e.current;if(!n)return()=>{};const o=()=>{var a,l;const{visibleElement:t}=r.current;r.current={...r.current,left:n.scrollLeft,top:n.scrollTop,visibleElementLeft:(a=t==null?void 0:t.offsetLeft)!=null?a:0,visibleElementTop:(l=t==null?void 0:t.offsetTop)!=null?l:0}};return n.addEventListener("scroll",o),()=>n.removeEventListener("scroll",o)},[]),c.useEffect(()=>{const n=e.current;if(!n)return()=>{};const o=(l,d)=>Array.from(l).filter(i=>i instanceof HTMLElement).flatMap(i=>i instanceof HTMLImageElement?[i]:Array.from(i.querySelectorAll("img"))).forEach(d),t=new IntersectionObserver(l=>{const d=l.find(i=>i.isIntersecting);(d==null?void 0:d.target)instanceof HTMLElement&&(r.current={...r.current,visibleElement:d.target,visibleElementLeft:d.target.offsetLeft,visibleElementTop:d.target.offsetTop})}),a=new MutationObserver(l=>{for(const d of l)o(d.addedNodes,i=>t.observe(i)),o(d.removedNodes,i=>t.unobserve(i))});return a.observe(n,{childList:!0,subtree:!0}),()=>{a.disconnect(),t.disconnect()}},[]),r},sa=(e,r)=>{const n=Zs(e),o=Ge(r),t=ke(r);c.useEffect(()=>{const a=e.current;if(!a||!o)return()=>{};const l=u=>{const{left:g,top:h,visibleElement:x,visibleElementLeft:p,visibleElementTop:v}=n.current;if(!x||!!!u.filter(w=>!(w.target instanceof HTMLElement)||!w.target.clientWidth&&!w.target.clientHeight?!1:t?w.target.offsetTop<h:Math.abs(w.target.offsetLeft)<Math.abs(g)).length)return;const S=g-p+x.offsetLeft,R=h-v+x.offsetTop;a.scrollTo(S,R)},d=(u,g)=>Array.from(u).filter(h=>h instanceof HTMLElement).flatMap(h=>h instanceof HTMLImageElement?[h]:Array.from(h.querySelectorAll("img"))).forEach(g),i=new ResizeObserver(l),f=new MutationObserver(u=>{for(const g of u)d(g.addedNodes,h=>i.observe(h)),d(g.removedNodes,h=>i.unobserve(h))});return f.observe(a,{childList:!0,subtree:!0}),()=>{f.disconnect(),i.disconnect()}},[o,t])},ra=(e,r,n,o,t,a,l)=>{const d=Zs(e),i=()=>{const f=e.current,{left:u,top:g,visibleElementLeft:h,visibleElementTop:x,visibleElement:p}=d.current;if(!f||!l||!p)return!1;const v=Ps(n,t,a),E=o===0;if(!(!v.previous&&E))return!1;const S=u-h+p.offsetLeft,R=g-x+p.offsetTop;return f.scrollTo(S,R),!0};c.useEffect(()=>{const f=e.current;if(!f||!l)return()=>{};let u=!1;const g=(p,v)=>{Array.from(p).filter(E=>E instanceof HTMLElement).flatMap(E=>E instanceof HTMLImageElement?[E]:Array.from(E.querySelectorAll("img"))).forEach(v)},h=new ResizeObserver(()=>{u||(u=i(),u&&h.disconnect())}),x=new MutationObserver(p=>{for(const v of p)g(v.addedNodes,E=>h.observe(E)),g(v.removedNodes,E=>h.unobserve(E))});return x.observe(f,{childList:!0,subtree:!0}),()=>{x.disconnect(),h.disconnect()}},[r]),c.useLayoutEffect(()=>{i()},[r])},na=(e,r,n,o,t,a,l,d,i,f)=>{ra(e,r,n,o,t,a,Ge(l)),sa(e,l),ta(l,f,i,o),Ss(d,o,i),Ss(l,o,i)},oa={[N.SINGLE_PAGE]:dt.X,[N.DOUBLE_PAGE]:dt.X,[N.CONTINUOUS_VERTICAL]:dt.Y,[N.CONTINUOUS_HORIZONTAL]:dt.X,[N.WEBTOON]:dt.Y},aa=c.forwardRef(({currentPageIndex:e,pageToScrollToIndex:r,setPageToScrollToIndex:n,pages:o,totalPages:t,setPages:a,setPageLoadStates:l,setTotalPages:d,setCurrentPageIndex:i,transitionPageMode:f,retryFailedPagesKeyPrefix:u,setTransitionPageMode:g,readingMode:h,readingDirection:x,shouldUseInfiniteScroll:p,readerWidth:v,pageScaleMode:E,shouldOffsetDoubleSpreads:j,imagePreLoadAmount:S,pageGap:R,customFilter:w,shouldStretchPage:b,readerNavBarWidth:T,setScrollbarXSize:L,setScrollbarYSize:D,isVisible:I,setIsVisible:y,updateCurrentPageIndex:_,showPreview:U,setShowPreview:te,initialChapter:P,currentChapter:k,chapters:H,visibleChapters:B,setReaderStateChapters:ie,isCurrentChapterReady:ce},Q)=>{var He;const{direction:G}=et(),{resumeMode:se=ss.START}=(He=ks().state)!=null?He:{resumeMode:ss.START},V=c.useRef(null);c.useImperativeHandle(Q,()=>V.current);const Z=ke(h),fe=Ge(h),je=Po(V),Ce=ft();c.useEffect(()=>Ce.setScrollRef(V),[]);const xe=rs.useGetScrollbarSize("width",V.current),pe=rs.useGetScrollbarSize("height",V.current);c.useLayoutEffect(()=>{L(xe),D(pe)},[xe,pe]);const le=ge.useHandleClick(V.current),ve=c.useRef(o.map(()=>null)),[{minChapterViewWidth:Se,minChapterViewHeight:Ie,minChapterSizeSourceChapterId:me},Ne]=c.useState({minChapterViewWidth:0,minChapterViewHeight:0,minChapterSizeSourceChapterId:-1}),[,Ye]=c.useState({}),tt=oa[h],we=x===nt.LTR,Re=c.useMemo(()=>H.findIndex(ee=>ee.id===(P==null?void 0:P.id)),[H,P==null?void 0:P.id]),Y=c.useMemo(()=>H.slice(Math.max(0,Re-B.trailing),Math.min(H.length,Re+B.leading+1)),[H,Re,B.trailing,B.leading]),M=c.useMemo(()=>Y.findIndex(ee=>ee.id===(k==null?void 0:k.id)),[k,Y]),K=c.useCallback((ee,be,de)=>{if(!fe)return;const $=de===me;if(Z){if(!$&&Se>=ee)return;Ne({minChapterViewWidth:ee,minChapterViewHeight:0,minChapterSizeSourceChapterId:de});return}($||Ie<be)&&Ne({minChapterViewWidth:0,minChapterViewHeight:be,minChapterSizeSourceChapterId:de})},[fe,Z,Se,Ie,me]);if(Wo(r,e,o,t,n,_,fe,ve,G,x),Vo(e,fe,G,x,V),Ho(V),No(h,x,V),Mo(I,y,U,te,V),ko(I,Ce),na(V,k==null?void 0:k.id,M,e,Y,B,h,x,n,E),c.useLayoutEffect(()=>{Ne({minChapterViewWidth:0,minChapterViewHeight:0,minChapterSizeSourceChapterId:-1}),Ye({})},[h]),!P||!k)throw new Error("ReaderViewer: illegal state - initialChapter and currentChapter should not be undefined");return s.jsx(A,{ref:V,sx:{width:"100%",height:"100%",overflow:"auto",flexWrap:"nowrap",...m(Z&&ys(v,E),{alignItems:"center"}),...m(!Z,{...m(G==="ltr",{flexDirection:we?"row":"row-reverse"}),...m(G==="rtl",{flexDirection:we?"row-reverse":"row"})})},onClick:ee=>!je&&le(ee),onScroll:()=>ge.updateCurrentPageOnScroll(ve,t-1,_,tt,x),children:Y.map((ee,be)=>{var C,Oe,st,pt;const de=Math.max(0,Y.length-be-1),$=Y[de],Ae=(C=Y[de+1])!=null?C:H[Re+B.leading+1],ot=(Oe=Y[de-1])!=null?Oe:H[Re-B.trailing-1],at=$.id===P.id,Ee=$.id===k.id,Ve=$.id===((st=Y[M+1])==null?void 0:st.id),xt=$.id===((pt=Y[M-1])==null?void 0:pt.id),it=P.sourceOrder>$.sourceOrder,ct=P.sourceOrder<$.sourceOrder,lt=B.lastLeadingChapterSourceOrder===$.sourceOrder,Bt=B.lastTrailingChapterSourceOrder===$.sourceOrder,_t=lt&&B.isLeadingChapterPreloadMode||Bt&&B.isTrailingChapterPreloadMode,re=Ps(de,Y,B),yt=$.id===me;return s.jsx(Qo,{chapterId:$.id,previousChapterId:Ae==null?void 0:Ae.id,nextChapterId:ot==null?void 0:ot.id,isPreviousChapterVisible:re.previous,isNextChapterVisible:re.next,lastPageRead:rt($.lastPageRead,0,$.pageCount-1),currentPageIndex:kr(e,$,k,Ee,ce,it,ct,B),isInitialChapter:at,isCurrentChapter:Ee,isPreviousChapter:Ve,isNextChapter:xt,isLeadingChapter:it,isTrailingChapter:ct,isPreloadMode:_t,imageRefs:ve,setPages:a,setPageLoadStates:l,setTotalPages:d,setCurrentPageIndex:i,setPageToScrollToIndex:n,transitionPageMode:f,retryFailedPagesKeyPrefix:u,readingMode:h,readerWidth:v,pageScaleMode:E,shouldOffsetDoubleSpreads:j,readingDirection:x,shouldUseInfiniteScroll:p,updateCurrentPageIndex:Ee?_:Be,scrollIntoView:Ee&&B.scrollIntoView,resumeMode:Pr(Ee,at,it,ct,B.resumeMode,se),setReaderStateChapters:ie,setTransitionPageMode:g,pageGap:R,imagePreLoadAmount:S,customFilter:w,shouldStretchPage:b,scrollbarXSize:xe,scrollbarYSize:pe,readerNavBarWidth:T,onSizeChange:K,minWidth:yt?0:Se,minHeight:yt?0:Ie,scrollElement:V.current},$.id)})})}),ia=W(c.memo(aa),[De,O.useSettingsWithoutDefaultFlag,Qe,It,()=>({updateCurrentPageIndex:ge.useUpdateCurrentPageIndex()}),At,Pe,ze],["currentPageIndex","pageToScrollToIndex","setPageToScrollToIndex","pages","totalPages","setPages","setPageLoadStates","setTotalPages","setCurrentPageIndex","retryFailedPagesKeyPrefix","setTransitionPageMode","readingMode","readingDirection","shouldUseInfiniteScroll","readerWidth","pageScaleMode","shouldOffsetDoubleSpreads","imagePreLoadAmount","pageGap","customFilter","shouldStretchPage","readerNavBarWidth","transitionPageMode","setScrollbarXSize","setScrollbarYSize","isVisible","setIsVisible","updateCurrentPageIndex","showPreview","setShowPreview","initialChapter","currentChapter","chapters","visibleChapters","setReaderStateChapters","isCurrentChapterReady"]),ca=Object.fromEntries(Object.values(ht).map(e=>[e,{scopes:e}])),J=(...e)=>{const[r,n,o,t]=e;return Mr(r,n,{...o,...ca.reader},t)},Ht=(e,r,n,o,t,a,l)=>{if(a){e(n,t[0]);return}const d=$s(t.indexOf(o),t,l);if(d===void 0){r(n);return}e(n,d)},la=({scrollElementRef:e})=>{const{direction:r}=et(),n=O.useGetThemeDirection(),{enableScope:o,disableScope:t}=bs(),{manga:a}=Me(),{isVisible:l,setIsVisible:d}=It(),{hotkeys:i,pageScaleMode:f,shouldStretchPage:u,shouldOffsetDoubleSpreads:g,readingMode:h,readingDirection:x,autoScroll:p,scrollAmount:v}=O.useSettings(),E=ft(),{setShowPreview:j}=At(),S=O.useExit(),R=ge.useOpenChapter(),w=ge.useOpenPage(),b=O.useCreateUpdateSetting(a!=null?a:Fe),T=O.useCreateDeleteSetting(a!=null?a:Fe);return J(i[q.PREVIOUS_PAGE],()=>w("previous"),[w]),J(i[q.NEXT_PAGE],()=>w("next"),[w]),J(i[q.SCROLL_BACKWARD],()=>e.current&&ge.scroll(ns.BACKWARD,os[h.value],h.value,x.value,r,e.current,R,d,j,v),{preventDefault:!0},[h.value,x.value,r,R,v]),J(i[q.SCROLL_FORWARD],()=>e.current&&ge.scroll(ns.FORWARD,os[h.value],h.value,x.value,r,e.current,R,d,j,v),{preventDefault:!0},[h.value,x.value,r,R,v]),J(i[q.PREVIOUS_CHAPTER],()=>R(ue("previous","next",n)),[R,n]),J(i[q.NEXT_CHAPTER],()=>R(ue("next","previous",n)),[R,n]),J(i[q.TOGGLE_MENU],()=>d(!l),[l]),J(i[q.CYCLE_SCALE_TYPE],()=>{Ht(b,T,"pageScaleMode",f.value,ws,f.isDefault,!0)},[b,T,f.value,f.isDefault]),J(i[q.STRETCH_IMAGE],()=>b("shouldStretchPage",!u.value),[b,u.value]),J(i[q.OFFSET_SPREAD_PAGES],()=>b("shouldOffsetDoubleSpreads",!g.value),[b,g.value]),J(i[q.CYCLE_READING_MODE],()=>{Ht(b,T,"readingMode",h.value,Os,h.isDefault,!0)},[b,T,h.value,h.isDefault]),J(i[q.CYCLE_READING_DIRECTION],()=>{Ht(b,T,"readingDirection",x.value,Ls,x.isDefault,!0)},[b,T,x.value,x.isDefault]),J(i[q.TOGGLE_AUTO_SCROLL],E.toggleActive,{preventDefault:!0},[E.toggleActive]),J(i[q.AUTO_SCROLL_SPEED_DECREASE],()=>b("autoScroll",{...p,value:Math.min(_e.max,p.value+_e.step)}),[b,p.value]),J(i[q.AUTO_SCROLL_SPEED_INCREASE],()=>b("autoScroll",{...p,value:Math.max(_e.min,p.value-_e.step)}),[b,p.value]),J(i[q.EXIT_READER],S,[S]),c.useEffect(()=>(o(ht.READER),()=>t(ht.READER)),[]),null},da=(e,r,n,o,t,a,l,d,i,f,u,g)=>{c.useEffect(()=>()=>{e(void 0),r(Rt),n(0),o(null),t(0),a([Nr("",0)]),l([]),d([{url:"",loaded:!1}]),i(Ue.NONE),f(!1),u(Hr),g()},[])},ua=(e,r,n,o,t,a)=>{var l;c.useEffect(()=>{var p;const d=(p=e.data)==null?void 0:p.manga;if(!d||r.loading||r.error)return;const i=as(d,n),f=Vr(d,i.shouldUseAutoWebtoonMode,i.readingMode),u={...n,readingMode:f?N.WEBTOON:n.readingMode},g=f?N.WEBTOON:i.readingMode.value,h=Wr("global",{meta:o},u,void 0,g),x=as(d,h);t(x),a(!0)},[(l=e.data)==null?void 0:l.manga,n])},Rs=5e3,ga=(e,r,n,o,t,a,l,d,i)=>{const{t:f}=F(),u=c.useRef(void 0),g=c.useRef(void 0),h=c.useRef(void 0),x=c.useRef(!0);c.useEffect(()=>{if(e||r||!n)return;const p=JSON.stringify(o)!==JSON.stringify(u.current);l&&p&&Is(f(Ut[o.value].title),{autoHideDuration:Rs}),u.current=o;const E=JSON.stringify(t)!==JSON.stringify(g.current)||JSON.stringify(a)!==JSON.stringify(h.current);d&&E&&(i(!0),x.current&&setTimeout(()=>i(!1),Rs)),g.current=t,h.current=a,x.current=!1},[e,r,n,o.value,o.isDefault,t.value,t.isDefault,a.value,a.isDefault])},ha=(e,r,n,o,t,a)=>{var u;const l=Fr(),d=ks().state,{updateInitialChapter:i}=d!=null?d:{},f=i?void 0:n;c.useEffect(()=>{var R,w;const g=(R=e.data)==null?void 0:R.chapters.nodes,h=g?(w=g[g.length-r])!=null?w:null:void 0,x=f!=null?f:h,p=o!=null?o:h,v=g&&h&&We.getNextChapter(h,g,{offset:jt.NEXT,skipDupe:a,skipDupeChapter:p}),E=g&&h&&We.getNextChapter(h,g,{offset:jt.PREVIOUS,skipDupe:a,skipDupeChapter:p}),j=!g||!p?[]:a?We.removeDuplicates(p,g):g,S=x!=null&&x.id!==(f==null?void 0:f.id);S&&l("",{replace:!0,state:{...d,updateInitialChapter:void 0}}),t(b=>{var L,D,I;const T=(h==null?void 0:h.id)!==((L=b.currentChapter)==null?void 0:L.id);return{...b,mangaChapters:g!=null?g:[],chapters:j,initialChapter:x,chapterForDuplicatesHandling:p,currentChapter:h,nextChapter:v,previousChapter:E,isCurrentChapterReady:T?!1:b.isCurrentChapterReady,visibleChapters:S?{...Rt.visibleChapters,lastLeadingChapterSourceOrder:(D=x==null?void 0:x.sourceOrder)!=null?D:Rt.visibleChapters.lastLeadingChapterSourceOrder,lastTrailingChapterSourceOrder:(I=x==null?void 0:x.sourceOrder)!=null?I:Rt.visibleChapters.lastTrailingChapterSourceOrder,isLeadingChapterPreloadMode:!1,isTrailingChapterPreloadMode:!1,scrollIntoView:!!b.initialChapter}:b.visibleChapters}})},[(u=e.data)==null?void 0:u.chapters.nodes,r,a,f])},fa=({setTitle:e,setOverride:r,readerNavBarWidth:n,isVisible:o,setIsVisible:t,manga:a,setManga:l,shouldSkipDupChapters:d,backgroundColor:i,readingMode:f,tapZoneLayout:u,tapZoneInvertMode:g,shouldShowReadingModePreview:h,shouldShowTapZoneLayoutPreview:x,setSettings:p,initialChapter:v,chapterForDuplicatesHandling:E,currentChapter:j,setReaderStateChapters:S,setTotalPages:R,setCurrentPageIndex:w,setPageToScrollToIndex:b,setPages:T,setPageUrls:L,setPageLoadStates:D,setTransitionPageMode:I,cancelAutoScroll:y,setShowPreview:_})=>{var Ce,xe,pe;const{t:U}=F(),te=c.useRef(null),[P,k]=c.useState(!1),{chapterSourceOrder:H,mangaId:B}=Gr(),ie=Number(H),ce=Number(B),Q=zt.useGetManga(zr,ce),G=zt.useGetMangaChapters($r,ce),{metadata:se,settings:V,request:Z}=Xr(),fe=j===void 0||!P||Q.loading||G.loading||Z.loading,je=(xe=(Ce=Q.error)!=null?Ce:G.error)!=null?xe:Z.error;return c.useLayoutEffect(()=>{if(!a||!j){e(U("reader.title",{mangaId:ce,chapterIndex:ie}));return}e("".concat(a.title,": ").concat(j.name))},[U,ce,ie,a,j]),c.useEffect(()=>{var le;l((le=Q.data)==null?void 0:le.manga)},[(pe=Q.data)==null?void 0:pe.manga]),da(l,S,w,b,R,T,L,D,I,t,p,y),ua(Q,Z,V,se,p,k),ga(fe,je,P,f,u,g,h,x,_),ha(G,ie,v,E,S,d),c.useLayoutEffect(()=>(r({status:!0,value:s.jsxs(X,{sx:{position:"absolute"},children:[s.jsx(la,{scrollElementRef:te}),s.jsx(Io,{isVisible:o}),!te.current&&s.jsx(X,{onClick:()=>t(!o),sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"transparent"}})]})}),()=>r({status:!1,value:null})),[o,t,te.current]),je?s.jsx(Ct,{message:U("global.error.label.failed_to_load_data"),messageExtra:_s(je),retry:()=>{Q.error&&Q.refetch().catch(St()),Z.error&&Z.refetch().catch(St()),G.error&&G.refetch().catch(St())}}):fe?s.jsx(X,{sx:{height:"100vh",width:"100vw",display:"grid",placeItems:"center"},children:s.jsx(Dt,{})}):j===null?s.jsx(Ct,{message:U("reader.error.label.chapter_not_found")}):!a||!j?null:s.jsxs(X,{sx:{position:"relative",display:"flex",flexDirection:"column",width:"calc(100vw - ".concat(n,"px)"),height:"100vh",marginLeft:"".concat(n,"px"),transition:le=>"width 0.".concat(le.transitions.duration.shortest,"s, margin-left 0.").concat(le.transitions.duration.shortest,"s"),overflow:"auto",backgroundColor:Bs[i]},children:[s.jsx(ia,{ref:te}),s.jsx(Bo,{}),s.jsx(yo,{})]})},$a=W(c.memo(fa),[ze,It,Me,Pe,Ur,()=>{const{shouldSkipDupChapters:e,backgroundColor:r,shouldShowReadingModePreview:n,shouldShowTapZoneLayoutPreview:o}=O.useSettingsWithoutDefaultFlag();return{shouldSkipDupChapters:e,backgroundColor:r,shouldShowReadingModePreview:n,shouldShowTapZoneLayoutPreview:o}},()=>{const{readingMode:e,tapZoneLayout:r,tapZoneInvertMode:n}=O.useSettings();return{readingMode:e,tapZoneLayout:r,tapZoneInvertMode:n}},De,()=>({cancelAutoScroll:ft().cancel}),At],["setTitle","setOverride","readerNavBarWidth","isVisible","setIsVisible","manga","setManga","shouldSkipDupChapters","backgroundColor","readingMode","tapZoneLayout","tapZoneInvertMode","shouldShowReadingModePreview","shouldShowTapZoneLayoutPreview","setSettings","initialChapter","chapterForDuplicatesHandling","currentChapter","setReaderStateChapters","setTotalPages","setCurrentPageIndex","setPageToScrollToIndex","setPages","setPageUrls","setPageLoadStates","setTransitionPageMode","cancelAutoScroll","setShowPreview"]);export{$a as Reader};
