import{u as C,r as p,b as A,m as v,g as h,j as t,E as j,o as S,p as f,bC as u,a as T,e as N,f as x,bD as P,bE as V,bF as F,bG as W,v as y}from"./index-DfKtWX_m.js";import{N as B}from"./NumberSetting-bfcbDfto.js";import{u as M,g as O}from"./usePersistedValue-DTX6ehrf.js";import{S as w}from"./Switch-BtfbqINo.js";import{T as D}from"./TextSetting-B3BTNEk6.js";import{S as I}from"./SelectSetting-DAnmVseq.js";import{E as R}from"./EmptyViewAbsoluteCentered-Cl5kUZOM.js";import{u as q}from"./useAppTitle-DQpLsU8G.js";import"./TextField-BTuSLyVR.js";import"./useFormControl-XGWtFnFC.js";import"./formControlState-Dq1zat_P.js";import"./InputAdornment-BxrSEztd.js";import"./Slider-DXBo4YDc.js";import"./SwitchBase-BXye88Mu.js";import"./PasswordTextField-999fDDtg.js";import"./VisibilityOff-BCvM3Owa.js";import"./Select-BCF1SMTQ.js";const G=({disabled:e=!1,updateCheckInterval:d})=>{const{t:n}=C(),l=!!d,[m]=p.useUpdateServerSettings(),[i,U]=M("lastUpdateCheckInterval",u.default,d,O),c=A.useCallback(s=>{U(s===0?i:s),m({variables:{input:{settings:{webUIUpdateCheckInterval:s}}}}).catch(b=>v(n("global.error.label.failed_to_save_changes"),"error",h(b)))},[i]),g=s=>{c(s?i:0)};return t.jsxs(j,{children:[t.jsxs(S,{children:[t.jsx(f,{primary:n("settings.webui.auto_update.label.title")}),t.jsx(w,{disabled:e,edge:"end",checked:l,onChange:s=>g(s.target.checked)})]}),t.jsx(B,{settingTitle:n("settings.webui.auto_update.label.interval"),settingValue:n("library.settings.global_update.auto_update.interval.label.value",{hours:i}),value:i,minValue:u.min,maxValue:u.max,defaultValue:u.default,showSlider:!0,valueUnit:n("global.time.hour_short"),handleUpdate:c,disabled:e||!l})]})},H=e=>({webUIFlavor:e.webUIFlavor,initialOpenInBrowserEnabled:e.initialOpenInBrowserEnabled,webUIInterface:e.webUIInterface,electronPath:e.electronPath,webUIChannel:e.webUIChannel,webUIUpdateCheckInterval:e.webUIUpdateCheckInterval}),ce=()=>{const{t:e}=C();q(e("settings.webui.title.webui"));const{settings:{webUIInformAvailableUpdate:d},loading:n,request:{error:l,refetch:m}}=T(),i=y(a=>v(e("global.error.label.failed_to_save_changes"),"error",h(a))),{data:U,loading:c,error:g,refetch:s}=p.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[b]=p.useUpdateServerSettings(),o=(a,L)=>{a==="webUIChannel"&&p.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),b({variables:{input:{settings:{[a]:L}}}}).catch(k=>v(e("global.error.label.failed_to_save_changes"),"error",h(k)))};if(n||c)return t.jsx(N,{});const _=l!=null?l:g;if(_)return t.jsx(R,{message:e("global.error.label.failed_to_load_data"),messageExtra:h(_),retry:()=>{l&&m().catch(x()),g&&s().catch(x())}});const r=H(U.settings),E=r.webUIFlavor===P.Custom;return t.jsxs(j,{sx:{pt:0},children:[t.jsx(I,{settingName:e("settings.webui.flavor.label.title"),value:r.webUIFlavor,values:V,handleChange:a=>o("webUIFlavor",a)}),t.jsxs(S,{children:[t.jsx(f,{primary:e("settings.webui.label.initial_open_browser")}),t.jsx(w,{edge:"end",checked:r.initialOpenInBrowserEnabled,onChange:a=>o("initialOpenInBrowserEnabled",a.target.checked)})]}),t.jsx(I,{settingName:e("settings.webui.interface.label.title"),value:r.webUIInterface,values:F,handleChange:a=>o("webUIInterface",a)}),t.jsx(D,{settingName:e("settings.webui.electron_path.label.title"),dialogDescription:e("settings.webui.electron_path.label.description"),value:r.electronPath,settingDescription:r.electronPath.length?r.electronPath:e("global.label.default"),handleChange:a=>o("electronPath",a)}),t.jsx(I,{settingName:e("settings.webui.channel.label.title"),value:r.webUIChannel,values:W,handleChange:a=>o("webUIChannel",a),disabled:E}),t.jsx(G,{disabled:E,updateCheckInterval:r.webUIUpdateCheckInterval}),!r.webUIUpdateCheckInterval&&t.jsxs(S,{children:[t.jsx(f,{primary:e("global.update.settings.inform.label.title"),secondary:e("global.update.settings.inform.label.description")}),t.jsx(w,{edge:"end",checked:d,onChange:a=>i("webUIInformAvailableUpdate",a.target.checked)})]})]})};export{ce as WebUISettings};
