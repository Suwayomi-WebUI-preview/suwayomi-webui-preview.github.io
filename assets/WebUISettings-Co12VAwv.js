import{u as L,r as h,f as N,m as v,g as S,j as e,N as w,s as I,v as b,dj as u,e as V,i as W,k as j,dk as F,dl as T,dm as B,cO as P,dn as y,F as M}from"./index-BKuQKJJ1.js";import{N as O}from"./NumberSetting-CeDiuUMc.js";import{u as $,g as H}from"./usePersistedValue-W28ntJS2.js";import{S as f}from"./Switch-Da1dbtDj.js";import{S as _}from"./SelectSetting-GLR3tP5T.js";import{E as X}from"./EmptyViewAbsoluteCentered-CaygheSf.js";import{u as D}from"./useAppTitle-Z2fQgui6.js";import"./Slider-CYLdR3c_.js";import"./SwitchBase-CqlGZ_yT.js";import"./Select-BnIO2UpE.js";const G=({disabled:t=!1,updateCheckInterval:p})=>{const{i18n:n,_:x}=L(),i=!!p,[m]=h.useUpdateServerSettings(),[d,U]=$("lastUpdateCheckInterval",u.default,p,H),l=N.useCallback(r=>{U(r===0?d:r),m({variables:{input:{settings:{webUIUpdateCheckInterval:r}}}}).catch(g=>v(n._({id:"cBoXe4"}),"error",S(g)))},[d]),c=r=>{l(r?d:0)};return e.jsxs(w,{children:[e.jsxs(I,{children:[e.jsx(b,{primary:n._({id:"eX6y8L"})}),e.jsx(f,{disabled:t,edge:"end",checked:i,onChange:r=>c(r.target.checked)})]}),e.jsx(O,{settingTitle:n._({id:"KXpFbx"}),settingValue:"".concat(d).concat(n._({id:"3S9JH+"})),value:d,minValue:u.min,maxValue:u.max,defaultValue:u.default,showSlider:!0,valueUnit:n._({id:"3S9JH+"}),handleUpdate:l,disabled:t||!i})]})},se=()=>{const{i18n:t,_:p}=L();D(t._({id:"GYkIV+"}));const{settings:{webUIInformAvailableUpdate:n},loading:x,request:{error:i,refetch:m}}=V(),d=M(a=>v(t._({id:"cBoXe4"}),"error",S(a))),{data:U,loading:l,error:c,refetch:r}=h.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[g]=h.useUpdateServerSettings(),o=(a,k)=>{a==="webUIChannel"&&h.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),g({variables:{input:{settings:{[a]:k}}}}).catch(A=>v(t._({id:"cBoXe4"}),"error",S(A)))};if(x||l)return e.jsx(W,{});const E=i!=null?i:c;if(E)return e.jsx(X,{message:t._({id:"6m5aox"}),messageExtra:S(E),retry:()=>{i&&m().catch(j("WebUISettings::refetchServerMetadataSettings")),c&&r().catch(j("WebUISettings::refetchServerSettings"))}});const s=U.settings,C=s.webUIFlavor===F.Custom;return e.jsxs(w,{sx:{pt:0},children:[e.jsx(_,{settingName:t._({id:"1Ov6Nl"}),value:s.webUIFlavor,values:T,handleChange:a=>o("webUIFlavor",a)}),e.jsxs(I,{children:[e.jsx(b,{primary:t._({id:"toJF0g"})}),e.jsx(f,{edge:"end",checked:s.initialOpenInBrowserEnabled,onChange:a=>o("initialOpenInBrowserEnabled",a.target.checked)})]}),e.jsx(_,{settingName:t._({id:"GfnKOF"}),value:s.webUIInterface,values:B,handleChange:a=>o("webUIInterface",a)}),e.jsx(P,{settingName:t._({id:"Wdus0i"}),dialogDescription:t._({id:"iaJUy1"}),value:s.electronPath,settingDescription:s.electronPath.length?s.electronPath:t._({id:"ovBPCi"}),handleChange:a=>o("electronPath",a)}),e.jsx(_,{settingName:t._({id:"HdE1If"}),value:s.webUIChannel,values:y,handleChange:a=>o("webUIChannel",a),disabled:C}),e.jsx(G,{disabled:C,updateCheckInterval:s.webUIUpdateCheckInterval}),!s.webUIUpdateCheckInterval&&e.jsxs(I,{children:[e.jsx(b,{primary:t._({id:"IV9G4u"}),secondary:t._({id:"3tqdsS"})}),e.jsx(f,{edge:"end",checked:n,onChange:a=>d("webUIInformAvailableUpdate",a.target.checked)})]})]})};export{se as WebUISettings};
