import{u as M,b as r,t as l,h as b,j as e,C as O,I as _,i as w,k as D,n as U,o as C,p as L,w as q,r as A,q as K,B as k,m as W,g as H}from"./index-uuLFyWjH.js";import{F as P}from"./FilterList-G5OStLEY.js";import{K as V}from"./index-CPmTO8DF.js";import{t as R}from"./Extensions.utils-48bj3xnY.js";import{S as z,g as G,a as J}from"./Sources-BRmxXLpx.js";import{L as N}from"./ListCardAvatar-u06x7-od.js";import{S as y}from"./Switch-BRAFUyI1.js";import{L as Q}from"./ListItemAvatar-Bm5Z5M4u.js";const oe=({selectedLanguages:p,setSelectedLanguages:I,languages:u,sources:c})=>{const{t:n}=M(),[d,m]=r.useState({}),[o,g]=r.useState(l(p)),[E,h]=r.useState(!1),T=r.useMemo(()=>z.groupByLanguage(c),[c]),x=r.useMemo(()=>l([...o.toSorted(b),...u.toSorted(b)]),[u,o]),S=()=>{h(!1),m({}),g(l(p))},B=()=>{h(!1),Promise.all(Object.entries(d).map(([t,s])=>J(c.find(i=>i.id===t),"isEnabled",s))).catch(t=>W(n("global.error.label.failed_to_save_changes"),"error",H(t))),m({}),I(l(o))},v=(t,s)=>{g(s?[...o,t]:o.toSpliced(o.indexOf(t),1))};return e.jsxs(e.Fragment,{children:[e.jsx(O,{title:n("settings.title"),children:e.jsx(_,{onClick:()=>h(!0),"aria-label":"display more actions",edge:"end",color:"inherit",children:e.jsx(P,{})})}),e.jsxs(w,{fullWidth:!0,maxWidth:"xs",open:E,onClose:S,children:[e.jsx(D,{children:n("global.language.title.enabled_languages")}),e.jsx(U,{dividers:!0,sx:{padding:0},children:e.jsx(V,{style:{height:x.length*54,minHeight:"25vh",maxHeight:"50vh"},data:x,increaseViewportBy:400,computeItemKey:t=>x[t],itemContent:(t,s)=>{const i=T[s],j=o.includes(s);return e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[e.jsx(L,{primary:R(s)}),e.jsx(y,{checked:j,onChange:a=>v(s,a.target.checked)})]}),j&&i.length&&e.jsx(q,{sx:{ml:1},children:i.map(a=>{var f;return e.jsxs(C,{children:[e.jsx(Q,{sx:{minWidth:32,mr:1},children:e.jsx(N,{iconUrl:A.getValidImgUrlFor(a.iconUrl),alt:a.name,slots:{avatarProps:{sx:{width:32,height:32}}}})}),e.jsx(L,{primary:a.name}),e.jsx(y,{checked:(f=d[a.id])!=null?f:G(a).isEnabled,onChange:F=>m({...d,[a.id]:F.target.checked})})]},a.id)})})]})}})}),e.jsxs(K,{children:[e.jsx(k,{autoFocus:!0,onClick:S,color:"primary",children:n("global.button.cancel")}),e.jsx(k,{onClick:B,color:"primary",children:n("global.button.ok")})]})]})]})};export{oe as S};
