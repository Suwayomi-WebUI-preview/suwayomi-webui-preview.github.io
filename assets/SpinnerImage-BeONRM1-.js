import{f as t,c as K,j as e,u as M,b as v,H as Q,b3 as k,bE as T,B as G,r as J,bF as q}from"./index-Dg11ME2R.js";import{R as O}from"./Refresh-M7Isng9V.js";import{I as N}from"./Image-CSWZ2_qY.js";function W(s){const c=t.useRef(void 0);return t.useEffect(()=>{c.current=s},[s]),c.current}const X=K(e.jsx("path",{d:"M21 5v6.59l-3-3.01-4 4.01-4-4-4 4-3-3.01V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2m-3 6.42 3 3.01V19c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-6.58l3 2.99 4-4 4 4z"})),Y=(s,c,{ignoreInitialObserve:l=!1,root:h,rootMargin:p,threshold:g}={})=>{const[y,r]=t.useState(()=>{});return t.useLayoutEffect(()=>{const I=s instanceof HTMLElement?s:s==null?void 0:s.current;if(!I)return()=>{};let i=!0;const o=new IntersectionObserver((...m)=>{if(l&&i){i=!1;return}c(...m)},{root:h,rootMargin:p,threshold:g});return o.observe(I),r(()=>()=>o.disconnect()),()=>o.disconnect()},[s,c,l,h,p,g]),y},re=({ref:s,...c})=>{const{shouldLoad:l=!0,shouldDecode:h,useFetchApi:p,disableCors:g,ignoreQueue:y,src:r,alt:I,onLoad:i,onError:o,spinnerStyle:{small:m,...R}={},imgStyle:d,hideImgStyle:E,priority:P,retryKeyPrefix:w}=c,{i18n:$,_:Z}=M(),L=t.useRef(null),j=!r.length,B=W(r),[x,F]=t.useState(),[_,H]=t.useState(0),[S,U]=t.useState(),[b,V]=t.useState(!1),[z,D]=t.useState(!1),C=(n,u=!1,a=!1)=>{U(n),V(u),u&&!n&&!a&&(o==null||o()),!n&&!u&&!a&&(i==null||i())};return Y(L,t.useCallback(n=>D(n[0].isIntersecting),[])),t.useEffect(()=>{if(j||!l||!!x&&!(B!==r))return()=>{};let a={response:Promise.resolve(""),cleanup:q,abortRequest:q,fromCache:!1};return(async()=>{try{a=await J.requestImage(r,{priority:P,shouldDecode:h,useFetchApi:p,disableCors:g,ignoreQueue:y}),a.fromCache||C(!0);const f=await a.response;C(!1),F(f)}catch(f){const A=f instanceof Error&&(f.name==="AbortError"||f.message==="Component was unmounted");C(!1,!A,A)}})().catch(()=>{}),()=>{a.cleanup(),a.abortRequest(new Error("Component was unmounted"))}},[r,_,w,j,l]),e.jsxs(e.Fragment,{children:[j?e.jsx(v,{ref:s,sx:{height:"100%",alignItems:"center",justifyContent:"center",background:n=>n.palette.background.default,...R},children:e.jsx(N,{fontSize:"large"})}):e.jsx(Q,{component:"img",sx:[...Array.isArray(d)?d!=null?d:[]:[d],k(!x||S||b,{...E,...k(!E,{display:"none"})})],ref:s,crossOrigin:g?void 0:"anonymous",src:x,alt:I,draggable:!1},"".concat(r,"_").concat(_,"_").concat(w)),(!!S||r&&!x||b)&&e.jsx(v,{ref:L,sx:{height:"100%",justifyContent:"center",alignItems:"center",...R},children:e.jsxs(v,{sx:{height:"100%",alignItems:"center",justifyContent:"center"},children:[z&&!!S&&e.jsx(T,{thickness:5}),b&&S===!1&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx(G,{startIcon:!m&&e.jsx(O,{}),onClick:n=>{n.stopPropagation(),n.preventDefault(),H(u=>(u+1)%100)},size:m?"small":"large",children:m?e.jsx(O,{}):$._({id:"6gRgw8"})})]})]})})]})};export{re as S,Y as u};
