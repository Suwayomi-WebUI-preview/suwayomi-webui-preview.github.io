import{r as G,i as H,j as e,u as z,c as r,N as P,a as i,aR as U,w as V,g as $,E as W,h as J,l as K,an as Q,U as X,V as Y,f as _,I as E,H as Z,av as ee,aw as te,ax as ae,b as T}from"./index-D56_pS91.js";import{D as oe,S as re,P as se,d as le}from"./StrictModeDroppable-C-UDsQ6b.js";import{d as ne}from"./Add-BhP8wF8Y.js";import{d as ie}from"./Delete-DTOlkiGh.js";import{D as ce,F as de}from"./StyledFab-DJEIGkcX.js";import{T as ge}from"./TextField-BRxbzYTt.js";import{F as ue,C as fe}from"./Checkbox-BPf1ceHt.js";import"./SwitchBase-C3mDf01C.js";var j={},me=H;Object.defineProperty(j,"__esModule",{value:!0});var S=j.default=void 0,pe=me(G()),he=e;S=j.default=(0,pe.default)((0,he.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");const xe=(a,c,d)=>({...c,...a&&{background:d.mode==="dark"?"#424242":"rgb(235,235,235)"}});function Se(){const{t:a}=z(),{setTitle:c,setAction:d}=r.useContext(P);r.useEffect(()=>(c(a("category.title.category_other")),d(null),()=>{c(""),d(null)}),[a]);const{data:g,loading:I,error:C,refetch:k}=i.useGetCategories(U,{notifyOnNetworkStatusChange:!0}),s=r.useMemo(()=>{var o;const t=[...(o=g==null?void 0:g.categories.nodes)!=null?o:[]];return t.length>0&&t[0].name==="Default"&&t.shift(),t},[g]),[f,b]=r.useState(-1),[v,u]=r.useState(!1),[m,p]=r.useState(""),[h,x]=r.useState(!1),[R,{reset:F}]=i.useReorderCategory(),y=V(),L=(t,o,n)=>{const l=t[o];R({variables:{input:{id:l.id,position:n+1}}}).catch(()=>F())},O=t=>{t.destination&&L(s,t.source.index,t.destination.index)},w=()=>{p(""),x(!1),b(-1)},A=()=>{w(),u(!0)},M=t=>{p(s[t].name),x(s[t].default),b(t),u(!0)},D=()=>{u(!1)},N=()=>{if(u(!1),f===-1)i.createCategory({name:m,default:h});else{const t=s[f];i.updateCategory(t.id,{name:m,default:h})}},q=t=>{const o=s[t];i.deleteCategory(o.id)};return I?e.jsx($,{}):C?e.jsx(W,{message:a("category.error.label.request_failure"),messageExtra:C.message,retry:()=>k().catch(J())}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{onDragEnd:O,children:e.jsx(re,{droppableId:"droppable",children:t=>e.jsxs(K,{ref:t.innerRef,sx:{paddingBottom:ce},children:[s.map((o,n)=>e.jsx(se,{draggableId:o.id.toString(),index:n,children:(l,B)=>e.jsxs(Q,{ref:l.innerRef,...l.draggableProps,...l.dragHandleProps,style:xe(B.isDragging,l.draggableProps.style,y.palette),children:[e.jsx(X,{children:e.jsx(le,{})}),e.jsx(Y,{primary:o.name}),e.jsx(_,{title:a("global.button.edit"),children:e.jsx(E,{onClick:()=>{M(n)},size:"large",children:e.jsx(S,{})})}),e.jsx(_,{title:a("chapter.action.download.delete.label.action"),children:e.jsx(E,{onClick:()=>{q(n)},size:"large",children:e.jsx(ie,{})})})]})},o.id)),t.placeholder]})})}),e.jsx(de,{color:"primary","aria-label":"add",style:{position:"fixed",bottom:y.spacing(2),right:y.spacing(2)},onClick:A,children:e.jsx(ne,{})}),e.jsxs(Z,{open:v,onClose:D,children:[e.jsx(ee,{id:"form-dialog-title",children:a(f===-1?"category.dialog.title.new_category":"category.dialog.title.edit_category")}),e.jsxs(te,{children:[e.jsx(ge,{autoFocus:!0,margin:"dense",id:"name",label:a("category.label.category_name"),type:"text",fullWidth:!0,value:m,onChange:t=>p(t.target.value)}),e.jsx(ue,{control:e.jsx(fe,{checked:h,onChange:t=>x(t.target.checked),color:"default"}),label:a("category.label.use_as_default_category")})]}),e.jsxs(ae,{children:[e.jsx(T,{onClick:D,color:"primary",children:a("global.button.cancel")}),e.jsx(T,{onClick:N,color:"primary",children:a("global.button.submit")})]})]})]})}export{Se as Categories};
