import{u as C,r as h,b as k,m as U,g as p,j as e,H as j,o as f,p as _,bM as b,a as N,e as T,f as E,bN as V,bO as P,bP as y,bQ as W,y as M}from"./index-DNzWMDIq.js";import{N as F}from"./NumberSetting-tqPdI90a.js";import{u as B,g as O}from"./usePersistedValue-CdSwPuKz.js";import{S as I}from"./Switch-CJVhClLx.js";import{T as D}from"./TextSetting-DF9aedhu.js";import{S as v}from"./SelectSetting-C3igilQn.js";import{E as R}from"./EmptyViewAbsoluteCentered-CpTPQwzc.js";import{u as H}from"./useAppTitle-C0CxbCoH.js";import"./Slider-lSeQ03vP.js";import"./SwitchBase-DxMBGP13.js";import"./Select-CwEzC7pv.js";const q=({disabled:t=!1,updateCheckInterval:g})=>{const{t:n}=C(),l=!!g,[m]=h.useUpdateServerSettings(),[i,S]=B("lastUpdateCheckInterval",b.default,g,O),d=k.useCallback(r=>{S(r===0?i:r),m({variables:{input:{settings:{webUIUpdateCheckInterval:r}}}}).catch(u=>U(n("global.error.label.failed_to_save_changes"),"error",p(u)))},[i]),c=r=>{d(r?i:0)};return e.jsxs(j,{children:[e.jsxs(f,{children:[e.jsx(_,{primary:n("settings.webui.auto_update.label.title")}),e.jsx(I,{disabled:t,edge:"end",checked:l,onChange:r=>c(r.target.checked)})]}),e.jsx(F,{settingTitle:n("settings.webui.auto_update.label.interval"),settingValue:n("library.settings.global_update.auto_update.interval.label.value",{hours:i}),value:i,minValue:b.min,maxValue:b.max,defaultValue:b.default,showSlider:!0,valueUnit:n("global.time.hour_short"),handleUpdate:d,disabled:t||!l})]})},se=()=>{const{t}=C();H(t("settings.webui.title.webui"));const{settings:{webUIInformAvailableUpdate:g},loading:n,request:{error:l,refetch:m}}=N(),i=M(a=>U(t("global.error.label.failed_to_save_changes"),"error",p(a))),{data:S,loading:d,error:c,refetch:r}=h.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[u]=h.useUpdateServerSettings(),o=(a,L)=>{a==="webUIChannel"&&h.graphQLClient.client.cache.evict({fieldName:"checkForWebUIUpdate"}),u({variables:{input:{settings:{[a]:L}}}}).catch(A=>U(t("global.error.label.failed_to_save_changes"),"error",p(A)))};if(n||d)return e.jsx(T,{});const x=l!=null?l:c;if(x)return e.jsx(R,{message:t("global.error.label.failed_to_load_data"),messageExtra:p(x),retry:()=>{l&&m().catch(E()),c&&r().catch(E())}});const s=S.settings,w=s.webUIFlavor===V.Custom;return e.jsxs(j,{sx:{pt:0},children:[e.jsx(v,{settingName:t("settings.webui.flavor.label.title"),value:s.webUIFlavor,values:P,handleChange:a=>o("webUIFlavor",a)}),e.jsxs(f,{children:[e.jsx(_,{primary:t("settings.webui.label.initial_open_browser")}),e.jsx(I,{edge:"end",checked:s.initialOpenInBrowserEnabled,onChange:a=>o("initialOpenInBrowserEnabled",a.target.checked)})]}),e.jsx(v,{settingName:t("settings.webui.interface.label.title"),value:s.webUIInterface,values:y,handleChange:a=>o("webUIInterface",a)}),e.jsx(D,{settingName:t("settings.webui.electron_path.label.title"),dialogDescription:t("settings.webui.electron_path.label.description"),value:s.electronPath,settingDescription:s.electronPath.length?s.electronPath:t("global.label.default"),handleChange:a=>o("electronPath",a)}),e.jsx(v,{settingName:t("settings.webui.channel.label.title"),value:s.webUIChannel,values:W,handleChange:a=>o("webUIChannel",a),disabled:w}),e.jsx(q,{disabled:w,updateCheckInterval:s.webUIUpdateCheckInterval}),!s.webUIUpdateCheckInterval&&e.jsxs(f,{children:[e.jsx(_,{primary:t("global.update.settings.inform.label.title"),secondary:t("global.update.settings.inform.label.description")}),e.jsx(I,{edge:"end",checked:g,onChange:a=>i("webUIInformAvailableUpdate",a.target.checked)})]})]})};export{se as WebUISettings};
