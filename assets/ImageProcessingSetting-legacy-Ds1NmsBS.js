!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}var n=["id","mode"],t=["id"];function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",l=t.toStringTag||"@@toStringTag";function a(t,r,i,l){var a=r&&r.prototype instanceof c?r:c,s=Object.create(a.prototype);return o(s,"_invoke",function(t,r,o){var i,l,a,c=0,s=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return i=n,l=0,a=e,f.n=t,u}};function p(t,r){for(l=t,a=r,n=0;!d&&c&&!o&&n<s.length;n++){var o,i=s[n],p=f.p,m=i[2];t>3?(o=m===r)&&(a=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=t<2&&p<i[1])?(l=0,f.v=r,f.n=i[1]):p<m&&(o=t<3||i[0]>r||r>m)&&(i[4]=t,i[5]=r,f.n=m,l=0))}if(o||t>1)return u;throw d=!0,r}return function(o,s,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&p(s,m),l=s,a=m;(n=l<2?e:a)||!d;){i||(l?l<3?(l>1&&(f.n=-1),p(l,a)):f.n=a:f.v=a);try{if(c=2,i){if(l||(o="next"),n=i[o]){if(!(n=n.call(i,a)))throw TypeError("iterator result is not an object");if(!n.done)return n;a=n.value,l<2&&(l=0)}else 1===l&&(n=i.return)&&n.call(i),l<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((n=(d=f.n<0)?a:t.call(r,f))!==u)break}catch(n){i=e,l=1,a=n}finally{c=1}}return{value:n,done:d}}}(t,i,l),!0),s}var u={};function c(){}function s(){}function d(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(o(n={},i,function(){return this}),n),p=d.prototype=c.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,l,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=d,o(p,"constructor",d),o(d,"constructor",s),s.displayName="GeneratorFunction",o(d,l,"GeneratorFunction"),o(p),o(p,l,"Generator"),o(p,i,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:a,m:m}})()}function o(e,n,t,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,n,t,r){function l(n,t){o(e,n,function(e){return this._invoke(n,t,e)})}n?i?i(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(l("next",0),l("throw",1),l("return",2))},o(e,n,t,r)}function i(e,n,t,r,o,i,l){try{var a=e[i](l),u=a.value}catch(e){return void t(e)}a.done?n(u):Promise.resolve(u).then(r,o)}function l(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,l,a=[],u=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=i.call(t)).done)&&(a.push(r.value),a.length!==n);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,n)||u(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,n){if(e){if("string"==typeof e)return c(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach(function(n){p(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function p(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var o=r.call(n,t||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}System.register(["./index-legacy-BEz05uZU.js","./EmptyViewAbsoluteCentered-legacy-DSv8HBJj.js","./Asserts-legacy-Cg9rVpcE.js","./useAppTitle-legacy-DKfzBHVc.js","./Delete-legacy-1jM-qs_k.js","./Select-legacy-CkhsjRRc.js","./use-resize-observer-legacy-C4beM6Ku.js"],function(e,o){"use strict";var u,c,d,m,v,g,b,h,y,x,j,w,S,T,O,D,P,A,C,_,I,E,k,L,G,F,U,W,M,N,B,K,R,z,H,J,V,$,q;return{setters:[function(e){u=e.bB,c=e.bC,d=e.bD,m=e.bE,v=e.bF,g=e.bG,b=e.aL,h=e.bH,y=e.u,x=e.ap,j=e.j,w=e.b,S=e.b6,T=e.bI,O=e.C,D=e.I,P=e.au,A=e.T,C=e.B,_=e.bg,I=e.f,E=e.bJ,k=e.bc,L=e.bd,G=e.bK,F=e.aA,U=e.bL,W=e.r,M=e.i,N=e.g,B=e.k,K=e.bM,R=e.m},function(e){z=e.E},function(e){H=e.a},function(e){J=e.u},function(e){V=e.D},function(e){$=e.S},function(e){q=e.u}],execute:function(){var o=0,Q=function(e){return e.replace(d,"")},X=function(e){return Q(e.toLowerCase().trim())===u},Y=function(e,n,t){var r;return null!==(r=null==t?void 0:t.slice(0,n).some(function(n){return n.name===e}))&&void 0!==r&&r},Z=function(e,n,t){return t.slice(0,n).some(function(n){return n.mimeType===e})},ee=function(e){return""!==e&&!!e.match(/^https?:\/\/.+/)},ne=function(e,n,t){return null==e||e>=n&&e<=t},te=function(e){return ne(e?b(e).seconds.inWholeSeconds:null,g.min,g.max)},re=function(e){return ne(e?b(e).seconds.inWholeSeconds:null,h.min,h.max)},oe=function(e){return ne(e,v.min,v.max)},ie=function(e){return e.some(function(n,t){var r=n.mimeType,o=n.compressionLevel,i=n.target,l=n.callTimeout,a=n.connectTimeout,u=n.headers,s=n.mode;return function(e,n){return""===e&&""===n}(r,i)||function(e,n,t){return!(X(t)&&!e||n!==c.URL||ee(e))}(i,s,r)||!oe(o)||!te(l)||!re(a)||Z(r,t,e)||function(e){var n;return null!==(n=null==e?void 0:e.some(function(n,t){return Y(n.name,t,e)}))&&void 0!==n&&n}(u)})},le=function(e){return e.map(function(e){var n;return f({id:null!==(n=e.id)&&void 0!==n?n:o++},e)})},ae=function(e){return e.map(function(e){var n,t,r;return f(f({id:null!==(n=e.id)&&void 0!==n?n:o++},e),{},{mode:(t=Q(e.target),r=Q(t),r===m?c.DISABLED:ee(r)?c.URL:c.IMAGE),headers:e.headers?le(e.headers):null})})},ue=function(e){return e.map(function(e){return f(f({},e),{},{mimeType:Q(e.mimeType),target:Q(e.target)})})},ce=function(e){return e.filter(function(e){var n=e.mimeType,t=e.target;return!!n&&!!t}).map(function(e){e.id,e.mode;var r,o,i,l=s(e,n);return f(f({},l),{},{mimeType:(i=l.mimeType,X(i)?u:"".concat(d).concat(i)),target:ee(l.target)?l.target:"".concat(d).concat(l.target),headers:null!==(r=null===(o=l.headers)||void 0===o?void 0:o.map(function(e){e.id;return s(e,t)}))&&void 0!==r?r:null})})},se=function(e){var n=e.some(function(e){var n=e.mimeType;return X(n)});return[].concat(a(n?[]:[{id:-1,mode:c.IMAGE,mimeType:u,target:"",compressionLevel:null,headers:null,callTimeout:null,connectTimeout:null}]),a(e))},de=function(e){return null==e?void 0:e.filter(function(e){return""!==e.name})},fe=function(e){var n=e.id,t=e.name,r=e.value,o=e.onChange,i=e.isDuplicate,l=y().t,a=x();return j.jsxs(w,{sx:{gap:1,flexDirection:"row",flexWrap:"nowrap",alignItems:"center"},children:[j.jsxs(w,{sx:p({flexDirection:"row",gap:2},a.breakpoints.down("md"),{flexDirection:"column",width:"100%"}),children:[j.jsx(S,{autoFocus:!0,sx:{width:T},label:l("download.settings.conversion.headers.name"),value:t,error:i,helperText:i&&l("global.error.label.invalid_input"),onChange:function(e){return o({id:n,name:e.target.value,value:r})}}),j.jsx(S,{sx:{width:T},label:l("download.settings.conversion.headers.value"),value:r,onChange:function(e){return o({id:n,name:t,value:e.target.value})}})]}),j.jsx(O,{disabled:!1,title:l("chapter.action.download.delete.label.action"),children:j.jsx(D,{onClick:function(){o(null)},children:j.jsx(V,{})})})]})},pe=function(e){var n=e.open,t=e.headers,r=e.onChange,o=y().t;return j.jsx(P,{in:n,children:j.jsxs(w,{sx:{justifyContent:"start",gap:2,pt:2},children:[j.jsx(A,{children:o("download.settings.conversion.headers.title")}),null==t?void 0:t.map(function(e,n){return j.jsx(fe,f(f({},e),{},{isDuplicate:Y(e.name,n,t),onChange:function(e){r(null==e?null==t?void 0:t.toSpliced(n,1):(null!=t?t:[]).toSpliced(n,1,e))}}),e.id)}),j.jsx(C,{onClick:function(){return r([].concat(a(null!=t?t:[]),a(le([{name:"",value:""}]))))},variant:"contained",sx:{width:"fit-content"},children:o("global.button.add")})]})})},me=function(e){var n=e.shouldAutoFocus,t=e.isDefault,r=e.isDuplicate,o=e.label,i=e.value,l=e.onUpdate,a=e.mode,u=y().t,s=a===c.IMAGE,f=!i.length||ee(i),p=!r&&(s||f);return j.jsx(S,{sx:{width:T},autoFocus:n,label:o,value:i,disabled:t,error:!p,helperText:!p&&u("global.error.label.invalid_input"),slotProps:{input:{startAdornment:j.jsx(_,{position:"start",children:s?d:null})}},onChange:function(e){return l(e.target.value.trim())}})},ve=function(e){var n,t=e.conversion,r=e.conversion,o=r.mode,i=r.mimeType,a=r.target,u=r.compressionLevel,s=r.headers,d=r.callTimeout,P=r.connectTimeout,A=e.onChange,U=e.isDuplicate,W=y().t,M=x(),N=q(),B=N.ref,K=N.height,R=l(I.useState(!0),2),z=R[0],H=R[1],J=o===c.DISABLED,Q=o===c.IMAGE,Y=te(d),Z=re(P),ee=oe(u),ne=X(i)&&!U,ie=ne&&!a&&null==u;return j.jsxs(w,{children:[j.jsxs(w,{sx:{gap:1,flexDirection:"row",flexWrap:"nowrap",alignItems:"center",pt:1},children:[j.jsxs(w,{sx:p({gap:1,flexDirection:"row",alignItems:"baseline",flexWrap:"wrap"},M.breakpoints.down("md"),{flexDirection:"column",width:"100%"}),children:[j.jsx(me,{mode:c.IMAGE,shouldAutoFocus:!0,isDefault:ne,isDuplicate:U,label:W("download.settings.conversion.mime_type"),value:i,onUpdate:function(e){A(f(f({},t),{},{mimeType:e}))}}),j.jsx(E,{sx:p({},M.breakpoints.up("md"),{mx:1}),children:"â†’"}),j.jsxs(k,{sx:{minWidth:"100px"},children:[j.jsx(L,{id:"image-conversion-target-mode-label",children:W("download.settings.conversion.target_modes.title")}),j.jsx($,{ref:B,id:"image-conversion-target-mode",labelId:"image-conversion-target-mode-label",label:W("download.settings.conversion.target_modes.title"),value:o,onChange:function(e){return A(f(f({},t),{},{mode:e.target.value,target:e.target.value===c.DISABLED?m:""}))},children:G.map(function(e){var n=l(e,2),t=n[0],r=n[1].text;return j.jsx(F,{value:t,children:W(r)},t)})})]}),!J&&j.jsx(me,{mode:o,shouldAutoFocus:!1,isDefault:!1,isDuplicate:!1,label:W("download.settings.conversion.target"),value:a,onUpdate:function(e){return A(f(f({},t),{},{target:e}))}}),J?null:Q?j.jsx(S,{sx:{width:T},label:W("download.settings.conversion.compression_level"),value:null!=u?u:"",type:"number",error:!ee,helperText:ee?"":W("global.error.label.invalid_input"),slotProps:{input:{inputProps:v}},onChange:function(e){A(f(f({},t),{},{compressionLevel:e.target.value?Number(e.target.value):null}))}}):j.jsxs(j.Fragment,{children:[j.jsx(S,{sx:{width:T},label:W("download.settings.conversion.call_timeout"),value:d?b(d).seconds.inWholeSeconds:"",type:"number",error:!Y,helperText:Y?"":W("global.error.label.invalid_input"),slotProps:{input:{inputProps:g,endAdornment:j.jsx(_,{position:"end",children:W("global.date.label.second_other")})}},onChange:function(e){A(f(f({},t),{},{callTimeout:e.target.value?b(Number(e.target.value)).seconds.toISOString():null}))}}),j.jsx(S,{sx:{width:T},label:W("download.settings.conversion.connect_timeout"),value:P?b(P).seconds.inWholeSeconds:"",type:"number",error:!Z,helperText:Z?"":W("global.error.label.invalid_input"),slotProps:{input:{inputProps:h,endAdornment:j.jsx(_,{position:"end",children:W("global.date.label.second_other")})}},onChange:function(e){A(f(f({},t),{},{connectTimeout:e.target.value?b(Number(e.target.value)).seconds.toISOString():null}))}}),j.jsx(C,{onClick:function(){return H(!z)},variant:z?"outlined":"contained",sx:{height:K},children:W("download.settings.conversion.headers.button",{count:null!==(n=null==s?void 0:s.length)&&void 0!==n?n:0})})]})]}),j.jsx(O,{disabled:ie,title:W("chapter.action.download.delete.label.action"),children:j.jsx(D,{disabled:ie,onClick:function(){A(null)},children:j.jsx(V,{})})})]}),j.jsx(pe,{open:!z,headers:s,onChange:function(e){return A(f(f({},t),{},{headers:e}))}})]})};e("ImageProcessingSetting",function(e){var n,t,o=e.type,u=y().t;J(u(U[o]));var c=W.useGetServerSettings({notifyOnNetworkStatusChange:!0}),s=c.data,d=c.loading,f=c.error,v=c.refetch,g=l(W.useUpdateServerSettings(),1)[0];if(d)return j.jsx(M,{});if(f)return j.jsx(z,{message:u("global.error.label.failed_to_load_data"),messageExtra:N(f),retry:function(){return v().catch(B())}});var b=K[o];H(null==s||null===(n=s.settings)||void 0===n?void 0:n[b]);var h=null==s||null===(t=s.settings)||void 0===t?void 0:t[b],x=l(I.useState(ue(se(ae(h)))),2),S=x[0],T=x[1],O=ie(S),D=function(e,n){return e.length!==n.length||e.some(function(e,t){var r,o,i=e.mimeType,l=e.target,a=e.compressionLevel,u=e.callTimeout,c=e.connectTimeout,s=e.headers,d=n[t],f=de(s),p=de(d.headers);return Q(i)!==d.mimeType||Q(l)!==d.target||a!==d.compressionLevel||u!==d.callTimeout||c!==d.connectTimeout||(null!==(r=null==f?void 0:f.length)&&void 0!==r?r:0)!==(null!==(o=null==p?void 0:p.length)&&void 0!==o?o:0)||!(null==f||!f.some(function(e,n){var t,r;return e.name!==(null==p||null===(t=p[n])||void 0===t?void 0:t.name)||e.value!==(null==p||null===(r=p[n])||void 0===r?void 0:r.value)}))})}(ue(se(ae(h))),S),P=function(e){var n=g({variables:{input:{settings:p({},b,e)}}});return n.catch(function(e){return R(u("global.error.label.failed_to_save_changes"),"error",N(e))}),n},_=function(){var e,n=(e=r().m(function e(){return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,P(ce(S));case 1:e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}),function(){var n=this,t=arguments;return new Promise(function(r,o){var l=e.apply(n,t);function a(e){i(l,r,o,a,u,"next",e)}function u(e){i(l,r,o,a,u,"throw",e)}a(void 0)})});return function(){return n.apply(this,arguments)}}();return j.jsxs(w,{sx:{p:2,gap:3},children:[j.jsx(A,{children:u("download.settings.conversion.description",{value:m})}),j.jsx(w,{sx:{flexDirection:"column",gap:5},children:S.map(function(e,n){var t=e.mimeType,r=Z(t,n,S);return j.jsx(ve,{conversion:e,isDuplicate:r,onChange:function(e){T(function(t){return se(t.toSpliced.apply(t,[n,1].concat(a(e?[e]:[]))))})}},e.id)})}),j.jsxs(w,{direction:"row",sx:{gap:1},children:[j.jsx(C,{variant:"outlined",onClick:function(){T(function(e){return[].concat(a(e),a(ae([{mimeType:"",target:"",compressionLevel:null,headers:null,callTimeout:null,connectTimeout:null}])))})},children:u("global.button.add")}),j.jsx(C,{variant:"contained",disabled:O||!D,onClick:_,children:u("global.button.save")})]})]})})}}})}();
