import{u as E,j as e,N as p,s as c,v as l,cV as m,aJ as V,m as w,g as j,r as D,cP as I,e as M,i as U,k as v,cO as O,cG as P,A as G,F as W}from"./index-C-R-YL45.js";import{N}from"./NumberSetting-C6tB4ymP.js";import{u as B,g as H}from"./usePersistedValue-CMnimjv6.js";import{S as h}from"./Switch-BrMuZ2K0.js";import{S as $}from"./SelectSetting-HEHwLjO8.js";import{a as z}from"./CategoriesInclusionSetting-BAiLeYaM.js";import{E as J}from"./EmptyViewAbsoluteCentered-COFR2M2Y.js";import{u as K}from"./useAppTitle-B2JGZY0n.js";import{L as f}from"./ListSubheader-xQ9Lf-t7.js";import"./Slider-mW1YVHK7.js";import"./SwitchBase-CTSE5RWO.js";import"./Select-MzJUBpbh.js";import"./ThreeStateCheckboxInput-DSi4gXoo.js";import"./Checkbox-C2YCtdbY.js";const X=({downloadAheadLimit:t})=>{const{i18n:i,_:o}=E(),r=!!t,[n,g]=B("lastDownloadAheadLimit",m.default,t,H),x=d=>{g(d===0?n:d),V("downloadAheadLimit",d).catch(C=>w(i._({id:"cBoXe4"}),"error",j(C)))},_=d=>{x(d?n:0)};return e.jsxs(p,{children:[e.jsxs(c,{children:[e.jsx(l,{primary:i._({id:"mnjFvf"})}),e.jsx(h,{edge:"end",checked:r,onChange:d=>_(d.target.checked)})]}),e.jsx(N,{settingTitle:i._({id:"+yt12/"}),settingValue:i._({id:"N9Ns+T",values:{currentDownloadAheadLimit:n}}),value:n,minValue:m.min,maxValue:m.max,defaultValue:m.default,stepSize:m.step,showSlider:!0,dialogDescription:i._({id:"+cKebU"}),dialogDisclaimer:i._({id:"/LvTk7"}),valueUnit:i._({id:"QIei5D"}),handleUpdate:x,disabled:!r})]})},F=[0,1,2,3,4,5],Q={0:{text:{id:"E/QGRL"}},1:{text:{id:"lems6I"}},2:{text:{id:"Xb5oRM"}},3:{text:{id:"fS8bRV"}},4:{text:{id:"6Z1gVj"}},5:{text:{id:"DAoIa+"}}},Z=F.map(t=>[t,Q[t]]),q=t=>typeof t=="boolean"?Number(t):t,Y=({chapterToDelete:t,handleChange:i})=>{const{i18n:o,_:r}=E(),n=q(t);return e.jsx($,{settingName:o._({id:"wgoHJO"}),value:n,values:Z,handleChange:i})},me=()=>{var A,T,k;const{i18n:t,_:i}=E();K(t._({id:"fK7YOw"}));const o=D.useGetCategories(I),r=D.useGetServerSettings({notifyOnNetworkStatusChange:!0}),[n]=D.useUpdateServerSettings(),{settings:g,loading:x,request:{error:_,refetch:d}}=M();if(r.loading||x||o.loading)return e.jsx(U,{});const L=(T=(A=r.error)!=null?A:_)!=null?T:o.error;if(L)return e.jsx(J,{message:t._({id:"6m5aox"}),messageExtra:j(L),retry:()=>{r.error&&r.refetch().catch(v("DownloadSettings::refetchServerSettings")),_&&d().catch(v("refetchMetadataServerSettings::")),o.error&&o.refetch().catch(v("LibrarySettings::refetchCategories"))}});const a=r.data.settings,u=(s,R)=>{const b=n({variables:{input:{settings:{[s]:R}}}});return b.catch(y=>w(t._({id:"cBoXe4"}),"error",j(y))),b},S=W(s=>w(t._({id:"cBoXe4"}),"error",j(s)));return e.jsxs(p,{sx:{pt:0},children:[e.jsx(O,{settingName:t._({id:"XyEAOB"}),dialogDescription:t._({id:"sfY9oj"}),value:a==null?void 0:a.downloadsPath,settingDescription:a!=null&&a.downloadsPath.length?a.downloadsPath:t._({id:"ovBPCi"}),handleChange:s=>u("downloadsPath",s)}),e.jsxs(c,{children:[e.jsx(l,{primary:t._({id:"74wOv7"})}),e.jsx(h,{edge:"end",checked:!!(a!=null&&a.downloadAsCbz),onChange:s=>u("downloadAsCbz",s.target.checked)})]}),e.jsx(P,{to:G.settings.childRoutes.images.childRoutes.processingDownloads.path,children:e.jsx(l,{primary:t._({id:"yIl0jv"})})}),e.jsxs(p,{subheader:e.jsx(f,{component:"div",id:"download-settings-auto-delete-downloads",children:t._({id:"1bFjRe"})}),children:[e.jsxs(c,{children:[e.jsx(l,{primary:t._({id:"wtP+o1"})}),e.jsx(h,{edge:"end",checked:g.deleteChaptersManuallyMarkedRead,onChange:s=>S("deleteChaptersManuallyMarkedRead",s.target.checked)})]}),e.jsx(Y,{chapterToDelete:g.deleteChaptersWhileReading,handleChange:s=>S("deleteChaptersWhileReading",s)}),e.jsxs(c,{children:[e.jsx(l,{primary:t._({id:"Hv/00V"})}),e.jsx(h,{edge:"end",checked:g.deleteChaptersWithBookmark,onChange:s=>S("deleteChaptersWithBookmark",s.target.checked)})]})]}),e.jsxs(p,{subheader:e.jsx(f,{component:"div",id:"download-settings-auto-download",children:t._({id:"V8CSia"})}),children:[e.jsxs(c,{children:[e.jsx(l,{primary:t._({id:"oRvNd6"})}),e.jsx(h,{edge:"end",checked:!!(a!=null&&a.autoDownloadNewChapters),onChange:s=>u("autoDownloadNewChapters",s.target.checked)})]}),e.jsx(N,{disabled:!(a!=null&&a.autoDownloadNewChapters),settingTitle:t._({id:"ZTZoif"}),dialogDescription:t._({id:"1nKbCG"}),value:(k=a==null?void 0:a.autoDownloadNewChaptersLimit)!=null?k:0,settingValue:a.autoDownloadNewChaptersLimit?t._({id:"CLov6M",values:{0:a.autoDownloadNewChaptersLimit}}):t._({id:"EdQY6l"}),defaultValue:0,minValue:0,maxValue:20,showSlider:!0,valueUnit:t._({id:"QIei5D"}),handleUpdate:s=>u("autoDownloadNewChaptersLimit",s)}),e.jsxs(c,{children:[e.jsx(l,{primary:t._({id:"bA1JBj"})}),e.jsx(h,{edge:"end",checked:!!(a!=null&&a.excludeEntryWithUnreadChapters),onChange:s=>u("excludeEntryWithUnreadChapters",s.target.checked),disabled:!(a!=null&&a.autoDownloadNewChapters)})]}),e.jsxs(c,{children:[e.jsx(l,{primary:t._({id:"RZniKv"})}),e.jsx(h,{edge:"end",checked:!!(a!=null&&a.autoDownloadIgnoreReUploads),onChange:s=>u("autoDownloadIgnoreReUploads",s.target.checked),disabled:!(a!=null&&a.autoDownloadNewChapters)})]}),e.jsx(z,{categories:o.data.categories.nodes,includeField:"includeInDownload",dialogText:t._({id:"JJqKw8"})})]}),e.jsx(p,{subheader:e.jsx(f,{component:"div",id:"download-settings-download-ahead",children:t._({id:"SG9sWi"})}),children:e.jsx(X,{downloadAheadLimit:g.downloadAheadLimit})})]})};export{me as DownloadSettings};
