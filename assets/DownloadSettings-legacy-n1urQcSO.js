!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach(function(t){r(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function r(t,n,o){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,n||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,l,i=[],s=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=a.call(n)).done)&&(i.push(o.value),i.length!==t);s=!0);}catch(e){d=!0,r=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(d)throw r}}return i}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}System.register(["./index-legacy-CSSZIQ5o.js","./NumberSetting-legacy-BthhchXQ.js","./usePersistedValue-legacy-Cx8bvXUX.js","./Switch-legacy-BRYCyn78.js","./SelectSetting-legacy-VdMChEXF.js","./CategoriesInclusionSetting-legacy-C0F19MY-.js","./EmptyViewAbsoluteCentered-legacy-Co_Xsk6O.js","./useAppTitle-legacy-CeT4RTXU.js","./Delete-legacy-DqewH_vH.js","./ListSubheader-legacy-CFr4X6x4.js","./Slider-legacy-xx4CoWg7.js","./SwitchBase-legacy-CFSlLxuf.js","./Select-legacy-DLHm5KXG.js","./ThreeStateCheckboxInput-legacy-CivNmSPI.js","./Checkbox-legacy-CoOhF-Sj.js"],function(e,n){"use strict";var l,i,s,d,c,u,h,p,g,f,m,b,w,y,x,v,j,_,C,S,D,T,k,A,L,O,P,N,F,U,I,V,E,M,W,R,z,B,q,G,H;return{setters:[function(e){l=e.u,i=e.j,s=e.H,d=e.o,c=e.p,u=e.bz,h=e.Z,p=e.m,g=e.g,f=e.b,m=e.aS,b=e.i,w=e.k,y=e.n,x=e.b8,v=e.S,j=e.q,_=e.B,C=e.bA,S=e.b3,D=e.bB,T=e.C,k=e.I,A=e.be,L=e.r,O=e.b5,P=e.a,N=e.e,F=e.f,U=e.b2,I=e.y},function(e){V=e.N},function(e){E=e.u,M=e.g},function(e){W=e.S},function(e){R=e.S},function(e){z=e.a},function(e){B=e.E},function(e){q=e.u},function(e){G=e.D},function(e){H=e.L},null,null,null,null,null],execute:function(){var n=function(e){var t=e.downloadAheadLimit,n=l().t,o=!!t,r=a(E("lastDownloadAheadLimit",u.default,t,M),2),f=r[0],m=r[1],b=function(e){m(0===e?f:e),h("downloadAheadLimit",e).catch(function(e){return p(n("global.error.label.failed_to_save_changes"),"error",g(e))})};return i.jsxs(s,{children:[i.jsxs(d,{children:[i.jsx(c,{primary:n("download.settings.download_ahead.label.while_reading")}),i.jsx(W,{edge:"end",checked:o,onChange:function(e){return t=e.target.checked,void b(t?f:0);var t}})]}),i.jsx(V,{settingTitle:n("download.settings.download_ahead.label.unread_chapters_to_download"),settingValue:n("download.settings.download_ahead.label.value",{chapters:f,count:f}),value:f,minValue:u.min,maxValue:u.max,defaultValue:u.default,stepSize:u.step,showSlider:!0,dialogDescription:n("download.settings.download_ahead.label.description"),dialogDisclaimer:n("download.settings.download_ahead.label.disclaimer"),valueUnit:n("chapter.title_one"),handleUpdate:b,disabled:!o})]})},Z={0:{text:"global.label.disabled"},1:{text:"download.settings.delete_chapters.while_reading.option.label.first"},2:{text:"download.settings.delete_chapters.while_reading.option.label.second"},3:{text:"download.settings.delete_chapters.while_reading.option.label.third"},4:{text:"download.settings.delete_chapters.while_reading.option.label.fourth"},5:{text:"download.settings.delete_chapters.while_reading.option.label.fifth"}},$=[0,1,2,3,4,5].map(function(e){return[e,Z[e]]}),J=function(e){var t=e.chapterToDelete,n=e.handleChange,o=l().t,r=function(e){return"boolean"==typeof e?Number(e):e}(t);return i.jsx(R,{settingName:o("download.settings.delete_chapters.while_reading.label.title"),value:r,values:$,handleChange:n})},K="default",Q="image/",X=function(e){return e.replace(Q,"")},Y=function(e){return X(e.toLowerCase().trim())===K},ee=function(e,t,n){return n.slice(0,t).some(function(t){return t.mimeType===e})},te=function(e){return null==e||e>=D.min&&e<=D.max},ne=function(e){return e.map(function(e){return o(o({},e),{},{mimeType:X(e.mimeType),target:X(e.target)})})},oe=function(e){return e.filter(function(e){var t=e.mimeType,n=e.target;return!!t&&!!n}).map(function(e){return o(o({},e),{},{mimeType:"".concat(Q).concat(e.mimeType),target:"".concat(Q).concat(e.target)})})},re=function(e){var n=e.some(function(e){var t=e.mimeType;return Y(t)});return[].concat(t(n?[]:[{mimeType:K,target:"",compressionLevel:null}]),t(e))},ae=function(e){var t=e.shouldAutoFocus,n=e.isDefault,o=e.isDuplicate,r=e.label,a=e.value,s=e.onUpdate,d=l().t;return i.jsx(S,{sx:{maxWidth:150},autoFocus:t,label:r,value:a,disabled:n,error:o,helperText:o&&d("global.error.label.invalid_input"),slotProps:{input:{startAdornment:i.jsx(A,{position:"start",children:Q})}},onChange:function(e){return s(e.target.value.trim())}})},le=function(e){var t=e.shouldAutoFocusMimeTypeTextField,n=e.conversion,o=n.mimeType,r=n.target,a=n.compressionLevel,s=e.setFocusMimeTypeTextField,d=e.onChange,c=e.isDuplicate,u=l().t,h=te(a),p=Y(o)&&!c,g=p&&!r&&null==a;return i.jsxs(v,{sx:{gap:1,flexDirection:"row",flexWrap:"nowrap",alignItems:"center",pt:1},children:[i.jsxs(v,{sx:{gap:1,flexDirection:"row",alignItems:"baseline",flexWrap:"wrap"},children:[i.jsx(ae,{shouldAutoFocus:t,isDefault:p,isDuplicate:c,label:u("download.settings.conversion.mime_type"),value:o,onUpdate:function(e){s(!0),d({mimeType:e,target:r,compressionLevel:a})}}),i.jsx(C,{sx:{mx:1},children:"→"}),i.jsx(ae,{shouldAutoFocus:!1,isDefault:!1,isDuplicate:!1,label:u("download.settings.conversion.target"),value:r,onUpdate:function(e){return d({mimeType:o,target:e,compressionLevel:a})}}),i.jsx(S,{label:u("download.settings.conversion.compression_level"),value:null!=a?a:"",type:"number",error:!h,helperText:h?"":u("global.error.label.invalid_input"),slotProps:{input:{inputProps:D}},onChange:function(e){d({mimeType:o,target:r,compressionLevel:e.target.value?Number(e.target.value):void 0})}})]}),i.jsx(T,{disabled:g,title:u("chapter.action.download.delete.label.action"),children:i.jsx(k,{disabled:g,onClick:function(){s(!1),d(null)},children:i.jsx(G,{})})})]})},ie=function(e){var n=e.conversions,o=e.updateSetting,r=l().t,s=a(f.useState(!1),2),d=s[0],u=s[1],h=a(f.useState(ne(re(n))),2),p=h[0],g=h[1],C=a(f.useState(-1),2),S=C[0],D=C[1],T=function(e){return e.some(function(t,n){var o=t.mimeType,r=t.compressionLevel;return!te(r)||ee(o,n,e)})}(p),k=function(e,t){return e.length!==t.length||e.some(function(e,n){var o=e.mimeType,r=e.target,a=e.compressionLevel,l=t[n];return X(o)!==l.mimeType||X(r)!==l.target||a!==l.compressionLevel})}(ne(re(n)),p),A=function(){g(ne(re(arguments.length>0&&void 0!==arguments[0]?arguments[0]:n))),u(!1)},L=function(){A(n)};return i.jsxs(i.Fragment,{children:[i.jsx(m,{disabled:!1,onClick:function(){return u(!0)},children:i.jsx(c,{primary:r("download.settings.conversion.title"),secondary:n.map(function(e){return"".concat(e.mimeType," → ").concat(e.target)}).join("; "),secondaryTypographyProps:{style:{display:"flex",flexDirection:"column"}}})}),i.jsxs(b,{open:d,onClose:L,children:[i.jsx(w,{children:r("download.settings.conversion.title")}),i.jsxs(y,{children:[i.jsx(x,{sx:{mb:2,whiteSpace:"pre-line"},children:r("download.settings.conversion.description",{value:"none"})}),i.jsx(v,{sx:{flexDirection:"column",gap:3},children:p.map(function(e,n){var o=e.mimeType,r=ee(o,n,p),a=n===S;return i.jsx(le,{conversion:e,isDuplicate:r,setFocusMimeTypeTextField:function(e){return D(e?n:-1)},shouldAutoFocusMimeTypeTextField:a,onChange:function(e){g(function(o){return re(o.toSpliced.apply(o,[n,1].concat(t(e?[e]:[]))))})}},"".concat(o,"-").concat(n))})})]}),i.jsx(j,{children:i.jsxs(v,{direction:"row",sx:{justifyContent:"space-between",width:"100%"},children:[i.jsx(_,{variant:"outlined",onClick:function(){g(function(e){return[].concat(t(e),[{mimeType:"",target:"",compressionLevel:null}])})},children:r("global.button.add")}),i.jsxs(v,{direction:"row",children:[i.jsx(_,{onClick:L,children:r("global.button.cancel")}),i.jsx(_,{disabled:T||!k,onClick:function(){return o(oe(p)).then(function(){return A(oe(p))})},children:r("global.button.ok")})]})]})})]})]})};e("DownloadSettings",function(){var e,t,o,u=l().t;q(u("download.title.download"));var h=L.useGetCategories(O),f=L.useGetServerSettings({notifyOnNetworkStatusChange:!0}),m=a(L.useUpdateServerSettings(),1)[0],b=P(),w=b.settings,y=b.loading,x=b.request,v=x.error,j=x.refetch;if(f.loading||y||h.loading)return i.jsx(N,{});var _=null!==(e=null!==(t=f.error)&&void 0!==t?t:v)&&void 0!==e?e:h.error;if(_)return i.jsx(B,{message:u("global.error.label.failed_to_load_data"),messageExtra:g(_),retry:function(){f.error&&f.refetch().catch(F()),v&&j().catch(F()),h.error&&h.refetch().catch(F())}});var C=f.data.settings,S=function(e,t){var n=m({variables:{input:{settings:r({},e,t)}}});return n.catch(function(e){return p(u("global.error.label.failed_to_save_changes"),"error",g(e))}),n},D=I(function(e){return p(u("global.error.label.failed_to_save_changes"),"error",g(e))});return i.jsxs(s,{sx:{pt:0},children:[i.jsx(U,{settingName:u("download.settings.download_path.label.title"),dialogDescription:u("download.settings.download_path.label.description"),value:null==C?void 0:C.downloadsPath,settingDescription:null!=C&&C.downloadsPath.length?C.downloadsPath:u("global.label.default"),handleChange:function(e){return S("downloadsPath",e)}}),i.jsxs(d,{children:[i.jsx(c,{primary:u("download.settings.file_type.label.cbz")}),i.jsx(W,{edge:"end",checked:!(null==C||!C.downloadAsCbz),onChange:function(e){return S("downloadAsCbz",e.target.checked)}})]}),i.jsx(ie,{conversions:null==C?void 0:C.downloadConversions,updateSetting:function(e){return S("downloadConversions",e)}}),i.jsxs(s,{subheader:i.jsx(H,{component:"div",id:"download-settings-auto-delete-downloads",children:u("download.settings.delete_chapters.title")}),children:[i.jsxs(d,{children:[i.jsx(c,{primary:u("download.settings.delete_chapters.label.manually_marked_as_read")}),i.jsx(W,{edge:"end",checked:w.deleteChaptersManuallyMarkedRead,onChange:function(e){return D("deleteChaptersManuallyMarkedRead",e.target.checked)}})]}),i.jsx(J,{chapterToDelete:w.deleteChaptersWhileReading,handleChange:function(e){return D("deleteChaptersWhileReading",e)}}),i.jsxs(d,{children:[i.jsx(c,{primary:u("download.settings.delete_chapters.label.allow_deletion_of_bookmarked")}),i.jsx(W,{edge:"end",checked:w.deleteChaptersWithBookmark,onChange:function(e){return D("deleteChaptersWithBookmark",e.target.checked)}})]})]}),i.jsxs(s,{subheader:i.jsx(H,{component:"div",id:"download-settings-auto-download",children:u("download.settings.auto_download.title")}),children:[i.jsxs(d,{children:[i.jsx(c,{primary:u("download.settings.auto_download.label.new_chapters")}),i.jsx(W,{edge:"end",checked:!(null==C||!C.autoDownloadNewChapters),onChange:function(e){return S("autoDownloadNewChapters",e.target.checked)}})]}),i.jsx(V,{disabled:!(null!=C&&C.autoDownloadNewChapters),settingTitle:u("download.settings.auto_download.download_limit.label.title"),dialogDescription:u("download.settings.auto_download.download_limit.label.description"),value:null!==(o=null==C?void 0:C.autoDownloadNewChaptersLimit)&&void 0!==o?o:0,settingValue:C.autoDownloadNewChaptersLimit?u("download.settings.download_ahead.label.value",{chapters:C.autoDownloadNewChaptersLimit,count:C.autoDownloadNewChaptersLimit}):u("global.label.none"),defaultValue:0,minValue:0,maxValue:20,showSlider:!0,valueUnit:u("chapter.title_one"),handleUpdate:function(e){return S("autoDownloadNewChaptersLimit",e)}}),i.jsxs(d,{children:[i.jsx(c,{primary:u("download.settings.auto_download.label.ignore_with_unread_chapters")}),i.jsx(W,{edge:"end",checked:!(null==C||!C.excludeEntryWithUnreadChapters),onChange:function(e){return S("excludeEntryWithUnreadChapters",e.target.checked)},disabled:!(null!=C&&C.autoDownloadNewChapters)})]}),i.jsxs(d,{children:[i.jsx(c,{primary:u("download.settings.auto_download.label.ignore_re_uploads")}),i.jsx(W,{edge:"end",checked:!(null==C||!C.autoDownloadIgnoreReUploads),onChange:function(e){return S("autoDownloadIgnoreReUploads",e.target.checked)},disabled:!(null!=C&&C.autoDownloadNewChapters)})]}),i.jsx(z,{categories:h.data.categories.nodes,includeField:"includeInDownload",dialogText:u("download.settings.auto_download.categories.label.include_in_download")})]}),i.jsx(s,{subheader:i.jsx(H,{component:"div",id:"download-settings-download-ahead",children:u("download.settings.download_ahead.title")}),children:i.jsx(n,{downloadAheadLimit:w.downloadAheadLimit})})]})})}}})}();
