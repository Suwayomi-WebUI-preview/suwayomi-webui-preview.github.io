import{u as O,b as r,t as l,h as C,j as e,C as _,I as w,i as D,k as U,n as q,o as L,p as k,w as A,r as W,q as H,B as y,m as P,g as V}from"./index-G46Fdggo.js";import{F as K}from"./FilterList-CCu3WPMo.js";import{j as R}from"./index-As6JimRO.js";import{t as z}from"./Extensions.utils-DBFrFiTZ.js";import{S as G,g as J,a as N}from"./Sources-DUNUbIYd.js";import{L as Q}from"./ListCardAvatar-BoCoTQrN.js";import{S as I}from"./Switch-BtnmcNda.js";import{L as X}from"./ListItemAvatar-CuBE0f-t.js";const ne=({selectedLanguages:p,setSelectedLanguages:E,languages:u,sources:c})=>{const{t:n}=O(),[d,m]=r.useState({}),[o,g]=r.useState(l(p)),[T,h]=r.useState(!1),B=r.useMemo(()=>G.groupByLanguage(c),[c]),x=r.useMemo(()=>l([...o.toSorted(C),...u.toSorted(C)]),[u,o]),j=()=>{h(!1),m({}),g(l(p))},v=()=>{h(!1),Promise.all(Object.entries(d).map(([t,s])=>N(c.find(i=>i.id===t),"isEnabled",s))).catch(t=>P(n("global.error.label.failed_to_save_changes"),"error",V(t))),m({}),E(l(o))},F=(t,s)=>{g(s?[...o,t]:o.toSpliced(o.indexOf(t),1))};return e.jsxs(e.Fragment,{children:[e.jsx(_,{title:n("settings.title"),children:e.jsx(w,{onClick:()=>h(!0),"aria-label":"display more actions",edge:"end",color:"inherit",children:e.jsx(K,{})})}),e.jsxs(D,{fullWidth:!0,maxWidth:"xs",open:T,onClose:j,children:[e.jsx(U,{children:n("global.language.title.enabled_languages")}),e.jsx(q,{dividers:!0,sx:{padding:0},children:e.jsx(R,{style:{height:x.length*54,minHeight:"25vh",maxHeight:"50vh"},data:x,increaseViewportBy:400,computeItemKey:t=>x[t],itemContent:(t,s)=>{var f;const i=(f=B[s])!=null?f:[],S=o.includes(s);return e.jsxs(e.Fragment,{children:[e.jsxs(L,{children:[e.jsx(k,{primary:z(s)}),e.jsx(I,{checked:S,onChange:a=>F(s,a.target.checked)})]}),S&&i.length&&e.jsx(A,{sx:{ml:1},children:i.map(a=>{var b;return e.jsxs(L,{children:[e.jsx(X,{sx:{minWidth:32,mr:1},children:e.jsx(Q,{iconUrl:W.getValidImgUrlFor(a.iconUrl),alt:a.name,slots:{avatarProps:{sx:{width:32,height:32}}}})}),e.jsx(k,{primary:a.name}),e.jsx(I,{checked:(b=d[a.id])!=null?b:J(a).isEnabled,onChange:M=>m({...d,[a.id]:M.target.checked})})]},a.id)})})]})}})}),e.jsxs(H,{children:[e.jsx(y,{autoFocus:!0,onClick:j,color:"primary",children:n("global.button.cancel")}),e.jsx(y,{onClick:v,color:"primary",children:n("global.button.ok")})]})]})]})};export{ne as S};
