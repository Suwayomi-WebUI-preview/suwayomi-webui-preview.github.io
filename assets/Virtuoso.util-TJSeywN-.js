var m=Object.defineProperty;var I=(u,e,t)=>e in u?m(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var l=(u,e,t)=>I(u,typeof e!="symbol"?e+"":e,t);import{f as a,af as h,ag as x,ah as p}from"./index-BgB0VFLg.js";class f{static convertIndex(e,t,s){for(let r=0;r<t.length;r++){const o=t[r],n=s[r];if(e<=n-1){const i=n-e===o+1;return{type:i?"group":"normal",index:i?r:e-(r+1),groupIndex:r}}}throw new Error('Unexpected "index" ('.concat(e,') and "groupCounts" (').concat(t,")"))}static useCreateConvertIndex(e){const t=a.useMemo(()=>{var r;const s=[];for(let o=0;o<e.length;o++){const n=(r=s[o-1])!=null?r:0;s[o]=e[o]+1+n}return s},[e]);return a.useCallback(s=>this.convertIndex(s,e,t),[t])}static useCreateGroupedComputeItemKey(e,t,s){const r=this.useCreateConvertIndex(e),o=a.useMemo(()=>e.reduce((n,c)=>n+c,0),[e]);return a.useCallback(n=>{if(n>e.length-1&&o===0)return-1;const{type:c,index:i,groupIndex:d}=r(n);switch(c){case"group":return t(i,d);case"normal":return s(i,d);default:throw new Error('VirtuosoUtil::useCreateGroupedComputeItemKey: unexpected "converted index type" ('.concat(c,")"))}},[r,t,s])}static usePersistState(e){const t=h(),s="virtuoso-snapshot-".concat(e,"-").concat(t.key),[r]=x(s,void 0),o=a.useRef(void 0),n=a.useCallback(i=>{const d=window.location.href;clearTimeout(o.current),o.current=setTimeout(()=>{d===window.location.href&&p.session.setItem(s,i,!1)},250)},[s]),c=a.useCallback(()=>{p.session.setItem(s,void 0,!1)},[s]);return a.useEffect(()=>clearTimeout(o.current),[t.key,o.current]),{key:s,state:r,persistState:n,deleteState:c}}}l(f,"GROUP",0),l(f,"ITEMS",1);export{f as V};
