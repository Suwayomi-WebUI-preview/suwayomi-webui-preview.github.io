!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach(function(t){a(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function a(t,n,o){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var a=o.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,l,i=[],s=!0,d=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=r.call(n)).done)&&(i.push(o.value),i.length!==t);s=!0);}catch(e){d=!0,a=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(d)throw a}}return i}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}System.register(["./index-legacy-D88yqlTr.js","./TextSetting-legacy-BYv6q06W.js","./NumberSetting-legacy-BLkLalJP.js","./usePersistedValue-legacy-bwgCAY8n.js","./Switch-legacy-Ch-gwiDJ.js","./SelectSetting-legacy-D3Tdmh1r.js","./CategoriesInclusionSetting-legacy-r3_KrDpL.js","./EmptyViewAbsoluteCentered-legacy-kH8P5sGv.js","./useAppTitle-legacy-C7IRcI95.js","./Delete-legacy-BFd3_riU.js","./TextField-legacy-CawwwfoM.js","./InputAdornment-legacy-DUaOyGvg.js","./ListSubheader-legacy-BiGDVPKA.js","./PasswordTextField-legacy-CtACuuud.js","./VisibilityOff-legacy-DCmzhERJ.js","./Slider-legacy-g4ZXraRL.js","./SwitchBase-legacy-lp_oJHi_.js","./useFormControl-legacy-Sre35_lk.js","./Select-legacy-DWuFcUdX.js","./ThreeStateCheckboxInput-legacy-CrukXqWt.js","./Checkbox-legacy-BC9njTIs.js","./formControlState-legacy-eu0RN9F_.js"],function(e,n){"use strict";var l,i,s,d,u,c,h,p,g,f,m,w,b,y,x,j,v,_,C,S,D,T,k,A,O,P,L,N,U,F,I,E,V,W,M,R,z,B,q,G,$;return{setters:[function(e){l=e.u,i=e.j,s=e.E,d=e.o,u=e.p,c=e.bv,h=e.V,p=e.m,g=e.g,f=e.b,m=e.aO,w=e.i,b=e.k,y=e.n,x=e.b6,j=e.S,v=e.q,_=e.B,C=e.bw,S=e.bx,D=e.C,T=e.I,k=e.r,A=e.b3,O=e.a,P=e.e,L=e.f,N=e.v},function(e){U=e.T},function(e){F=e.N},function(e){I=e.u,E=e.g},function(e){V=e.S},function(e){W=e.S},function(e){M=e.a},function(e){R=e.E},function(e){z=e.u},function(e){B=e.D},function(e){q=e.T},function(e){G=e.I},function(e){$=e.L},null,null,null,null,null,null,null,null,null],execute:function(){var n=function(e){var t=e.downloadAheadLimit,n=l().t,o=!!t,a=r(I("lastDownloadAheadLimit",c.default,t,E),2),f=a[0],m=a[1],w=function(e){m(0===e?f:e),h("downloadAheadLimit",e).catch(function(e){return p(n("global.error.label.failed_to_save_changes"),"error",g(e))})};return i.jsxs(s,{children:[i.jsxs(d,{children:[i.jsx(u,{primary:n("download.settings.download_ahead.label.while_reading")}),i.jsx(V,{edge:"end",checked:o,onChange:function(e){return t=e.target.checked,void w(t?f:0);var t}})]}),i.jsx(F,{settingTitle:n("download.settings.download_ahead.label.unread_chapters_to_download"),settingValue:n("download.settings.download_ahead.label.value",{chapters:f,count:f}),value:f,minValue:c.min,maxValue:c.max,defaultValue:c.default,stepSize:c.step,showSlider:!0,dialogDescription:n("download.settings.download_ahead.label.description"),dialogDisclaimer:n("download.settings.download_ahead.label.disclaimer"),valueUnit:n("chapter.title_one"),handleUpdate:w,disabled:!o})]})},X={0:{text:"global.label.disabled"},1:{text:"download.settings.delete_chapters.while_reading.option.label.first"},2:{text:"download.settings.delete_chapters.while_reading.option.label.second"},3:{text:"download.settings.delete_chapters.while_reading.option.label.third"},4:{text:"download.settings.delete_chapters.while_reading.option.label.fourth"},5:{text:"download.settings.delete_chapters.while_reading.option.label.fifth"}},H=[0,1,2,3,4,5].map(function(e){return[e,X[e]]}),J=function(e){var t=e.chapterToDelete,n=e.handleChange,o=l().t,a=function(e){return"boolean"==typeof e?Number(e):e}(t);return i.jsx(W,{settingName:o("download.settings.delete_chapters.while_reading.label.title"),value:a,values:H,handleChange:n})},K="default",Q="image/",Y=function(e){return e.replace(Q,"")},Z=function(e){return Y(e.toLowerCase().trim())===K},ee=function(e,t,n){return n.slice(0,t).some(function(t){return t.mimeType===e})},te=function(e){return null==e||e>=S.min&&e<=S.max},ne=function(e){return e.map(function(e){return o(o({},e),{},{mimeType:Y(e.mimeType),target:Y(e.target)})})},oe=function(e){var n=e.some(function(e){var t=e.mimeType;return Z(t)});return[].concat(t(n?[]:[{mimeType:K,target:""}]),t(e))},ae=function(e){var t=e.shouldAutoFocus,n=e.isDefault,o=e.isDuplicate,a=e.label,r=e.value,s=e.onUpdate,d=l().t;return i.jsx(q,{sx:{maxWidth:150},autoFocus:t,label:a,value:r,disabled:n,error:o,helperText:o&&d("global.error.label.invalid_input"),slotProps:{input:{startAdornment:i.jsx(G,{position:"start",children:Q})}},onChange:function(e){return s(e.target.value.trim())}})},re=function(e){var t=e.index,n=e.shouldAutoFocusMimeTypeTextField,o=e.conversion,a=o.mimeType,r=o.target,s=o.compressionLevel,d=e.setFocusMimeTypeTextField,u=e.onChange,c=e.isDuplicate,h=l().t,p=te(s),g=Z(a)&&!c,f=g&&!r&&null==s;return i.jsxs(j,{sx:{gap:1,flexDirection:"row",flexWrap:"nowrap",alignItems:"center",pt:1},children:[i.jsxs(j,{sx:{gap:1,flexDirection:"row",alignItems:"baseline",flexWrap:"wrap"},children:[i.jsx(ae,{shouldAutoFocus:n,isDefault:g,isDuplicate:c,label:h(g?"global.label.default":"download.settings.conversion.mime_type"),value:a,onUpdate:function(e){d(!0),u({mimeType:e,target:r,compressionLevel:s})}}),i.jsx(C,{sx:{mx:1},children:"→"}),i.jsx(ae,{shouldAutoFocus:!1,isDefault:!1,isDuplicate:!1,label:h("download.settings.conversion.compression_level"),value:r,onUpdate:function(e){return u({mimeType:a,target:e,compressionLevel:s})}}),i.jsx(q,{label:"Compression",value:null!=s?s:"",type:"number",error:!p,helperText:p?"":h("global.error.label.invalid_input"),slotProps:{input:{inputProps:S}},onChange:function(e){u({mimeType:a,target:r,compressionLevel:e.target.value?Number(e.target.value):void 0})}})]}),i.jsx(D,{disabled:f,title:h("chapter.action.download.delete.label.action"),children:i.jsx(T,{disabled:f,onClick:function(){d(!1),u(null)},children:i.jsx(B,{})})})]},"".concat(a,"-").concat(t))},le=function(e){var n=e.conversions,a=e.updateSetting,s=l().t,d=r(f.useState(!1),2),c=d[0],h=d[1],p=r(f.useState(ne(oe(n))),2),g=p[0],C=p[1],S=r(f.useState(-1),2),D=S[0],T=S[1],k=function(e){return e.some(function(t,n){var o=t.mimeType,a=t.compressionLevel;return!te(a)||ee(o,n,e)})}(g),A=function(e,t){return e.length!==t.length||e.some(function(e,n){var o=e.mimeType,a=e.target,r=e.compressionLevel,l=t[n];return Y(o)!==l.mimeType||Y(a)!==l.target||r!==l.compressionLevel})}(n,g),O=function(){C(ne(oe(n))),h(!1)};return i.jsxs(i.Fragment,{children:[i.jsx(m,{disabled:!1,onClick:function(){return h(!0)},children:i.jsx(u,{primary:s("download.settings.conversion.title"),secondary:n.map(function(e){return"".concat(e.mimeType," → ").concat(e.target)}).join("; "),secondaryTypographyProps:{style:{display:"flex",flexDirection:"column"}}})}),i.jsxs(w,{open:c,onClose:O,children:[i.jsx(b,{children:s("download.settings.conversion.title")}),i.jsxs(y,{children:[i.jsx(x,{sx:{mb:2},children:s("download.settings.conversion.description")}),i.jsx(j,{sx:{flexDirection:"column",gap:3},children:g.map(function(e,n){var o=e.mimeType,a=ee(o,n,g),r=n===D;return i.jsx(re,{conversion:e,isDuplicate:a,index:n,setFocusMimeTypeTextField:function(e){return T(e?n:-1)},shouldAutoFocusMimeTypeTextField:r,onChange:function(e){C(function(o){return oe(o.toSpliced.apply(o,[n,1].concat(t(e?[e]:[]))))})}},"".concat(o,"-").concat(n))})})]}),i.jsx(v,{children:i.jsxs(j,{direction:"row",sx:{justifyContent:"space-between",width:"100%"},children:[i.jsx(_,{variant:"outlined",onClick:function(){C(function(e){return[].concat(t(e),[{mimeType:"",target:""}])})},children:s("global.button.add")}),i.jsxs(j,{direction:"row",children:[i.jsx(_,{onClick:O,children:s("global.button.cancel")}),i.jsx(_,{disabled:k||!A,onClick:function(){return a(function(e){return e.filter(function(e){var t=e.mimeType,n=e.target;return!!t&&!!n}).map(function(e){return o(o({},e),{},{mimeType:"".concat(Q).concat(e.mimeType),target:"".concat(Q).concat(e.target)})})}(g))},children:s("global.button.ok")})]})]})})]})]})};e("DownloadSettings",function(){var e,t,o,c=l().t;z(c("download.title.download"));var h=k.useGetCategories(A),f=k.useGetServerSettings({notifyOnNetworkStatusChange:!0}),m=r(k.useUpdateServerSettings(),1)[0],w=O(),b=w.settings,y=w.loading,x=w.request,j=x.error,v=x.refetch;if(f.loading||y||h.loading)return i.jsx(P,{});var _=null!==(e=null!==(t=f.error)&&void 0!==t?t:j)&&void 0!==e?e:h.error;if(_)return i.jsx(R,{message:c("global.error.label.failed_to_load_data"),messageExtra:g(_),retry:function(){f.error&&f.refetch().catch(L()),j&&v().catch(L()),h.error&&h.refetch().catch(L())}});var C,S={downloadAsCbz:(C=f.data.settings).downloadAsCbz,downloadsPath:C.downloadsPath,autoDownloadNewChapters:C.autoDownloadNewChapters,autoDownloadNewChaptersLimit:C.autoDownloadNewChaptersLimit,excludeEntryWithUnreadChapters:C.excludeEntryWithUnreadChapters,autoDownloadIgnoreReUploads:C.autoDownloadIgnoreReUploads,downloadConversions:C.downloadConversions},D=function(e,t){m({variables:{input:{settings:a({},e,t)}}}).catch(function(e){return p(c("global.error.label.failed_to_save_changes"),"error",g(e))})},T=N(function(e){return p(c("global.error.label.failed_to_save_changes"),"error",g(e))});return i.jsxs(s,{sx:{pt:0},children:[i.jsx(U,{settingName:c("download.settings.download_path.label.title"),dialogDescription:c("download.settings.download_path.label.description"),value:null==S?void 0:S.downloadsPath,settingDescription:null!=S&&S.downloadsPath.length?S.downloadsPath:c("global.label.default"),handleChange:function(e){return D("downloadsPath",e)}}),i.jsxs(d,{children:[i.jsx(u,{primary:c("download.settings.file_type.label.cbz")}),i.jsx(V,{edge:"end",checked:!(null==S||!S.downloadAsCbz),onChange:function(e){return D("downloadAsCbz",e.target.checked)}})]}),i.jsx(le,{conversions:null==S?void 0:S.downloadConversions,updateSetting:function(e){return D("downloadConversions",e)}}),i.jsxs(s,{subheader:i.jsx($,{component:"div",id:"download-settings-auto-delete-downloads",children:c("download.settings.delete_chapters.title")}),children:[i.jsxs(d,{children:[i.jsx(u,{primary:c("download.settings.delete_chapters.label.manually_marked_as_read")}),i.jsx(V,{edge:"end",checked:b.deleteChaptersManuallyMarkedRead,onChange:function(e){return T("deleteChaptersManuallyMarkedRead",e.target.checked)}})]}),i.jsx(J,{chapterToDelete:b.deleteChaptersWhileReading,handleChange:function(e){return T("deleteChaptersWhileReading",e)}}),i.jsxs(d,{children:[i.jsx(u,{primary:c("download.settings.delete_chapters.label.allow_deletion_of_bookmarked")}),i.jsx(V,{edge:"end",checked:b.deleteChaptersWithBookmark,onChange:function(e){return T("deleteChaptersWithBookmark",e.target.checked)}})]})]}),i.jsxs(s,{subheader:i.jsx($,{component:"div",id:"download-settings-auto-download",children:c("download.settings.auto_download.title")}),children:[i.jsxs(d,{children:[i.jsx(u,{primary:c("download.settings.auto_download.label.new_chapters")}),i.jsx(V,{edge:"end",checked:!(null==S||!S.autoDownloadNewChapters),onChange:function(e){return D("autoDownloadNewChapters",e.target.checked)}})]}),i.jsx(F,{disabled:!(null!=S&&S.autoDownloadNewChapters),settingTitle:c("download.settings.auto_download.download_limit.label.title"),dialogDescription:c("download.settings.auto_download.download_limit.label.description"),value:null!==(o=null==S?void 0:S.autoDownloadNewChaptersLimit)&&void 0!==o?o:0,settingValue:S.autoDownloadNewChaptersLimit?c("download.settings.download_ahead.label.value",{chapters:S.autoDownloadNewChaptersLimit,count:S.autoDownloadNewChaptersLimit}):c("global.label.none"),defaultValue:0,minValue:0,maxValue:20,showSlider:!0,valueUnit:c("chapter.title_one"),handleUpdate:function(e){return D("autoDownloadNewChaptersLimit",e)}}),i.jsxs(d,{children:[i.jsx(u,{primary:c("download.settings.auto_download.label.ignore_with_unread_chapters")}),i.jsx(V,{edge:"end",checked:!(null==S||!S.excludeEntryWithUnreadChapters),onChange:function(e){return D("excludeEntryWithUnreadChapters",e.target.checked)},disabled:!(null!=S&&S.autoDownloadNewChapters)})]}),i.jsxs(d,{children:[i.jsx(u,{primary:c("download.settings.auto_download.label.ignore_re_uploads")}),i.jsx(V,{edge:"end",checked:!(null==S||!S.autoDownloadIgnoreReUploads),onChange:function(e){return D("autoDownloadIgnoreReUploads",e.target.checked)},disabled:!(null!=S&&S.autoDownloadNewChapters)})]}),i.jsx(M,{categories:h.data.categories.nodes,includeField:"includeInDownload",dialogText:c("download.settings.auto_download.categories.label.include_in_download")})]}),i.jsx(s,{subheader:i.jsx($,{component:"div",id:"download-settings-download-ahead",children:c("download.settings.download_ahead.title")}),children:i.jsx(n,{downloadAheadLimit:b.downloadAheadLimit})})]})})}}})}();
