!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}System.register(["./index-legacy-BaDOBlI5.js","./DownloadStateIndicator-legacy-D_zyBN8R.js","./UpdateChecker-legacy-DYs01ojn.js","./StyledGroupItemWrapper-legacy-2HN9F4az.js","./Mangas-legacy-BHxfarIW.js","./SpinnerImage-legacy-SpLWE-op.js","./TypographyMaxLines-legacy-Bb4tSDts.js","./CardContent-legacy-B5pHT2xx.js","./index-legacy-CqmSho3F.js","./Avatar-legacy-DhWT09_h.js","./Progress-legacy-D1AuYd6f.js","./Chapters-legacy-S2TbBbK9.js"],(function(e,a){"use strict";var o,i,l,u,c,s,d,f,p,g,h,y,m,b,v,x,j,S,w,C,I,T,A,k,_,P,D,E,M,O,U;return{setters:[function(e){o=e.u,i=e.ar,l=e.c,u=e.N,c=e.a,s=e.j,d=e.E,f=e.h,p=e.T,g=e.bj,h=e.g,y=e.L,m=e.B,b=e.f,v=e.I,x=e.x,j=e.z,S=e.bk,w=e.m},function(e){C=e.D},function(e){I=e.U},function(e){T=e.S,A=e.a,k=e.b},function(e){_=e.M},function(e){P=e.S},function(e){D=e.T},function(e){E=e.C,M=e.a},function(e){O=e.C},function(e){U=e.A},null,null],execute:function(){e("Updates",(function(){var e,a,G=o().t,N=i(),R=l.useContext(u),L=R.setTitle,F=R.setAction,H=c.useGetRecentlyUpdatedChapters(void 0,{fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!0}),z=H.data,B=H.loading,q=H.error,J=H.fetchMore,Q=H.refetch,W=!(null==z||!z.chapters.pageInfo.hasNextPage),$=null==z?void 0:z.chapters.pageInfo.endCursor,K=null!==(e=null==z?void 0:z.chapters.nodes)&&void 0!==e?e:[],V=l.useMemo((function(){return function(e){if(!e.length)return[];var t=new Map;return e.forEach((function(e){var n,r=j(S(Number(e.fetchedAt)));t.set(r,(null!==(n=t.get(r))&&void 0!==n?n:0)+1)})),r(t.entries())}(K)}),[K]),X=l.useMemo((function(){return V.map((function(e){return e[1]}))}),[V]),Y=c.useGetDownloadStatus().data,Z=null!==(a=null==Y?void 0:Y.downloadStatus.queue)&&void 0!==a?a:[],ee=l.useRef(null),te=n(l.useState(0),2),ne=te[0],re=te[1];l.useLayoutEffect((function(){var e,t;re(null!==(e=null===(t=ee.current)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:0)}),[ee.current]);var ae=c.useGetLastGlobalUpdateTimestamp({fetchPolicy:"cache-only"}).data,oe=null==ae?void 0:ae.lastUpdateTimestamp.timestamp;l.useEffect((function(){return L(G("updates.title")),F(s.jsx(I,{})),function(){L(""),F(null)}}),[G,oe]);var ie=l.useCallback((function(){W&&J({variables:{offset:K.length}})}),[W,$]);return q?s.jsx(d,{message:G("global.error.label.failed_to_load_data"),messageExtra:q.message,retry:function(){return Q().catch(f())}}):B||0!==K.length?s.jsxs(s.Fragment,{children:[s.jsx(p,{ref:ee,sx:{marginLeft:"10px",paddingTop:function(e){return t({},e.breakpoints.up("sm"),{paddingTop:"6px"})}},children:G("library.settings.global_update.label.last_update",{date:oe?g.format(+oe):"-"})}),s.jsx(T,{heightToSubtract:ne,style:{height:"undefined"},components:{Footer:function(){return B?s.jsx(h,{usePadding:!0}):null}},overscan:.5*window.innerHeight,endReached:ie,groupCounts:X,groupContent:function(e){return s.jsx(A,{variant:"h5",component:"h2",isFirstItem:0===e,children:V[e][0]})},itemContent:function(e){var t=K[e],n=t.manga,r=function(e){var t=e.sourceOrder,n=e.mangaId;return Z.find((function(e){return t===e.chapter.sourceOrder&&n===e.manga.id}))}(t);return s.jsx(k,{children:s.jsx(E,{children:s.jsx(O,{component:y,to:"/manga/".concat(t.manga.id,"/chapter/").concat(t.sourceOrder),state:N.state,sx:{color:function(e){return e.palette.text[t.isRead?"disabled":"primary"]}},children:s.jsxs(M,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:1.5},children:[s.jsxs(m,{sx:{display:"flex"},children:[s.jsx(y,{to:"/manga/".concat(t.manga.id),style:{textDecoration:"none"},children:s.jsx(U,{variant:"rounded",sx:{width:56,height:56,flex:"0 0 auto",marginRight:1,background:"transparent"},children:s.jsx(P,{imgStyle:{objectFit:"cover",width:"100%",height:"100%",imageRendering:"pixelated"},spinnerStyle:{small:!0},alt:n.title,src:_.getThumbnailUrl(n)})})}),s.jsxs(m,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,flexShrink:1,wordBreak:"break-word"},children:[s.jsx(D,{variant:"h6",component:"h3",children:n.title}),s.jsx(D,{variant:"caption",display:"block",lines:1,children:t.name})]})]}),r&&s.jsx(C,{download:r}),null==r&&!t.isDownloaded&&s.jsx(b,{title:G("chapter.action.download.add.label.action"),children:s.jsx(v,{onClick:function(e){e.stopPropagation(),e.preventDefault(),function(e){c.addChapterToDownloadQueue(e.id).response.catch((function(){return w(G("global.error.label.failed_to_save_changes"),"error")}))}(t)},size:"large",children:s.jsx(x,{})})})]})})})},e)}})]}):s.jsx(d,{message:G("updates.error.label.no_updates_available")})}))}}}))}();
