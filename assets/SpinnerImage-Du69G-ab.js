import{c as F,j as s,f as t,u as K,b as C,H as M,b0 as k,bD as U,B as Q,r as T,bE as q}from"./index-DYDfuFXW.js";import{R as A}from"./Refresh-CDBbkylL.js";import{I as G}from"./Image-DKXK6bhO.js";const J=F(s.jsx("path",{d:"M21 5v6.59l-3-3.01-4 4.01-4-4-4 4-3-3.01V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2m-3 6.42 3 3.01V19c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-6.58l3 2.99 4-4 4 4z"})),N=(n,f,{ignoreInitialObserve:u=!1,root:d,rootMargin:p,threshold:l}={})=>{const[y,r]=t.useState(()=>{});return t.useLayoutEffect(()=>{const h=n instanceof HTMLElement?n:n==null?void 0:n.current;if(!h)return()=>{};let c=!0;const o=new IntersectionObserver((...m)=>{if(u&&c){c=!1;return}f(...m)},{root:d,rootMargin:p,threshold:l});return o.observe(h),r(()=>()=>o.disconnect()),()=>o.disconnect()},[n,f,u,d,p,l]),y},ee=({ref:n,...f})=>{const{shouldLoad:u=!0,shouldDecode:d,useFetchApi:p,disableCors:l,ignoreQueue:y,src:r,alt:h,onLoad:c,onError:o,spinnerStyle:{small:m,...R}={},imgStyle:g,hideImgStyle:v,priority:O,retryKeyPrefix:E}=f,{i18n:$,_:W}=K(),w=t.useRef(null),j=!r.length,[I,B]=t.useState(),[_,D]=t.useState(0),[x,H]=t.useState(),[b,P]=t.useState(!1),[V,z]=t.useState(!1),S=(e,i=!1,a=!1)=>{H(e),P(i),i&&!e&&!a&&(o==null||o()),!e&&!i&&!a&&(c==null||c())};return N(w,t.useCallback(e=>z(e[0].isIntersecting),[])),t.useEffect(()=>{if(j||!u||I)return()=>{};let e={response:Promise.resolve(""),cleanup:q,abortRequest:q,fromCache:!1};return(async()=>{try{e=await T.requestImage(r,{priority:O,shouldDecode:d,useFetchApi:p,disableCors:l,ignoreQueue:y}),e.fromCache||S(!0);const a=await e.response;S(!1),B(a)}catch(a){const L=a instanceof Error&&(a.name==="AbortError"||a.message==="Component was unmounted");S(!1,!L,L)}})().catch(()=>{}),()=>{e.cleanup(),e.abortRequest(new Error("Component was unmounted"))}},[r,_,E,j,u]),s.jsxs(s.Fragment,{children:[j?s.jsx(C,{ref:n,sx:{height:"100%",alignItems:"center",justifyContent:"center",background:e=>e.palette.background.default,...R},children:s.jsx(G,{fontSize:"large"})}):s.jsx(M,{component:"img",sx:[...Array.isArray(g)?g!=null?g:[]:[g],k(!I||x||b,{...v,...k(!v,{display:"none"})})],ref:n,crossOrigin:l?void 0:"anonymous",src:I,alt:h,draggable:!1},"".concat(r,"_").concat(_,"_").concat(E)),(!!x||r&&!I||b)&&s.jsx(C,{ref:w,sx:{height:"100%",justifyContent:"center",alignItems:"center",...R},children:s.jsxs(C,{sx:{height:"100%",alignItems:"center",justifyContent:"center"},children:[V&&!!x&&s.jsx(U,{thickness:5}),b&&x===!1&&s.jsxs(s.Fragment,{children:[s.jsx(J,{}),s.jsx(Q,{startIcon:!m&&s.jsx(A,{}),onClick:e=>{e.stopPropagation(),e.preventDefault(),D(i=>(i+1)%100)},size:m?"small":"large",children:m?s.jsx(A,{}):$._({id:"6gRgw8"})})]})]})})]})};export{ee as S,N as u};
