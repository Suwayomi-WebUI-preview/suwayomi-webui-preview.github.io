{"version":3,"sources":["util/localStorage.tsx","util/client.tsx","components/context/NavbarContext.tsx","components/context/DarkTheme.tsx","components/util/CustomExtensionOutlinedIcon.tsx","util/useBackTo.ts","components/navbar/navigation/DesktopSideBar.tsx","components/navbar/navigation/MobileBottomBar.tsx","components/navbar/DefaultNavBar.tsx","util/useLocalStorage.tsx","components/util/ListItemLink.tsx","screens/Settings.tsx","components/util/LoadingPlaceholder.tsx","screens/settings/About.tsx","screens/settings/Categories.tsx","components/util/Toast.tsx","screens/settings/Backup.tsx","components/util/EmptyView.tsx","components/util/TabPanel.tsx","components/context/LibraryOptionsContext.tsx","components/atoms/CheckboxInput.tsx","components/atoms/RadioInput.tsx","components/atoms/SortRadioInput.tsx","components/atoms/ThreeStateCheckbox.tsx","components/atoms/ThreeStateCheckboxInput.tsx","components/molecules/OptionsPanel.tsx","components/molecules/OptionsTabs.tsx","components/library/LibraryOptionsPanel.tsx","components/library/LibraryToolbarMenu.tsx","components/util/SpinnerImage.tsx","components/MangaCard.tsx","components/MangaGrid.tsx","components/library/LibraryMangaGrid.tsx","components/util/AppbarSearch.tsx","components/library/UpdateChecker.tsx","screens/Library.tsx","components/sourceConfiguration/TwoStatePreference.tsx","components/sourceConfiguration/ListPreference.tsx","components/sourceConfiguration/EditTextPreference.tsx","util/cloneObject.tsx","components/sourceConfiguration/MultiSelectListPreference.tsx","screens/SourceConfigure.tsx","components/library/useSubscription.ts","components/manga/ChapterCard.tsx","components/manga/ResumeFAB.tsx","components/manga/util.tsx","components/util/helpers.ts","components/manga/ChapterOptions.tsx","components/manga/ChaptersToolbarMenu.tsx","components/manga/SelectionFABActionItem.tsx","components/manga/SelectionFAB.tsx","components/manga/ChapterList.tsx","components/manga/MangaDetails.tsx","components/navbar/action/CategorySelect.tsx","components/manga/MangaToolbarMenu.tsx","screens/Manga.tsx","components/manga/hooks.ts","components/source/SourceMangaGrid.tsx","components/source/filters/CheckBoxFilter.tsx","components/source/filters/HeaderFilter.tsx","components/source/filters/SelectFilter.tsx","components/source/filters/SortFilter.tsx","components/source/filters/TextFilter.tsx","components/source/filters/TriStateFilter.tsx","components/source/filters/GroupFilter.tsx","components/source/filters/SeparatorFilter.tsx","components/source/SourceOptions.tsx","components/source/GridLayouts.tsx","screens/SourceMangas.tsx","components/reader/Page.tsx","components/reader/pager/HorizontalPager.tsx","components/reader/PageNumber.tsx","components/reader/pager/PagedPager.tsx","components/reader/DoublePage.tsx","components/reader/pager/DoublePagedPager.tsx","components/reader/pager/VerticalPager.tsx","components/navbar/ReaderNavBar.tsx","screens/Reader.tsx","screens/Updates.tsx","screens/DownloadQueue.tsx","util/language.tsx","components/navbar/action/LangSelect.tsx","components/SourceCard.tsx","screens/Sources.tsx","components/ExtensionCard.tsx","screens/Extensions.tsx","screens/Browse.tsx","components/navbar/NavBarContextProvider.tsx","components/library/LibraryOptionsProvider.tsx","screens/SearchAll.tsx","App.tsx","index.tsx"],"names":["inferredPort","getItem","key","defaultValue","item","window","localStorage","JSON","parse","setItem","stringify","value","location","hostname","port","protocol","baseURL","storage","client","axios","create","interceptors","request","use","config","data","FormData","Object","assign","headers","fetcher","path","a","get","res","status","Error","statusText","useQuery","useSWR","loading","error","NavBarContext","React","createContext","defaultBackTo","undefined","setDefaultBackTo","title","setTitle","action","setAction","override","setOverride","useNavBarContext","useContext","DarkTheme","darkTheme","setDarkTheme","icon","createSvgIcon","d","BACK","useBackTo","useLocation","url","state","backLink","back","SideNavBarContainer","styled","theme","height","width","spacing","backgroundColor","palette","mode","grey","position","top","left","paddingTop","display","flexDirection","DesktopSideBar","navBarItems","useTheme","iconFor","IconComponent","SelectedIconComponent","pathname","sx","color","fontSize","map","to","style","textDecoration","ListItem","disableRipple","button","ListItemIcon","minWidth","Tooltip","placement","BottomNavContainer","bottom","justifyContent","alignItems","zIndex","Link","RRDLink","flex","MobileBottomBar","padding","Box","navbarItems","CollectionsBookmarkIcon","CollectionsOutlinedBookmarkIcon","show","NewReleasesIcon","NewReleasesOutlinedIcon","ExtensionIcon","ExtensionOutlinedIcon","ExploreIcon","ExploreOutlinedIcon","GetAppIcon","GetAppOutlinedIcon","SettingsIcon","DefaultNavBar","backTo","history","useHistory","isMobileWidth","useMediaQuery","breakpoints","down","isMainRoute","some","navbar","filter","it","flexGrow","AppBar","Toolbar","IconButton","component","edge","marginRight","size","onClick","goBack","Typography","variant","noWrap","textOverflow","id","NavbarToolbar","children","container","document","getElementById","createPortal","useLocalStorage","initialState","Function","useState","storedValue","setStoredValue","useCallback","prevValue","valueToStore","ListItemLink","props","directLink","href","Settings","NavbarContext","useEffect","serverAddress","setServerAddress","showNsfw","setShowNsfw","useCache","setUseCache","dialogOpen","setDialogOpen","dialogValue","setDialogValue","dialogOpenItemWidth","setDialogOpenItemWidth","ItemWidth","setItemWidth","DialogItemWidth","setDialogItemWidth","handleDialogCancel","handleDialogCancelItemWidth","List","ListItemText","primary","ListItemSecondaryAction","Switch","checked","onChange","ListItemButton","secondary","Dialog","open","onClose","DialogContent","DialogContentText","TextField","autoFocus","margin","label","type","fullWidth","placeholder","e","target","DialogActions","Button","DialogTitle","parseInt","Slider","step","min","max","event","newValue","LoadingPlaceholder","shouldRender","componentProps","condition","createElement","CircularProgress","thickness","About","about","name","buildType","version","revision","Date","buildTime","toUTCString","github","discord","Categories","mutate","categories","useMemo","length","shift","categoryToEdit","setCategoryToEdit","dialogName","setDialogName","dialogDefault","setDialogDefault","onDragEnd","result","destination","list","from","newData","splice","removed","revalidate","formData","append","patch","finally","categoryReorder","source","index","droppableId","provided","ref","innerRef","draggableId","toString","snapshot","ContainerProps","draggableProps","dragHandleProps","isDragging","draggableStyle","background","default","handleEditDialogOpen","category","delete","deleteCategory","Fab","right","FormControlLabel","control","Checkbox","post","Transition","Slide","direction","Toast","message","severity","setOpen","handleClose","Snackbar","autoHideDuration","TransitionComponent","elevation","makeToast","Math","floor","random","body","appendChild","ReactDOM","render","setTimeout","querySelector","unmountComponentAtNode","removeChild","removeToast","Backup","defaults","submitBackup","file","toLowerCase","endsWith","then","catch","dropHandler","preventDefault","fromEvent","files","dragOverHandler","addEventListener","input","evt","removeEventListener","click","ERROR_FACES","EmptyView","messageExtra","errorFace","randIndex","getRandomErrorFace","transform","textAlign","gutterBottom","TabPanel","currentIndex","role","hidden","defaultProps","DefaultLibraryOptions","showDownloadBadge","showUnreadBadge","gridLayout","SourcegridLayout","downloaded","sortDesc","sorts","unread","LibraryOptionsContext","options","setOptions","useLibraryOptionsContext","CheckboxInput","rest","RadioInput","Radio","SortRadioInput","sortDescending","checkedIcon","ThreeStateCheckbox","handleChange","newState","indeterminateIcon","DisabledByDefaultRounded","indeterminate","ThreeStateCheckboxInput","OptionsPanel","minHeight","Drawer","anchor","PaperProps","maxWidth","marginLeft","OptionsTabs","tabs","tabTitle","tabContent","tabNum","setTabNum","Tabs","newTab","indicatorColor","textColor","tab","tabIndex","Tab","Stack","px","py","TITLES","sort","SORT_OPTIONS","LibraryOptionsPanel","handleFilterChange","v","c","FormLabel","RadioGroup","Number","mt","LibraryToolbarMenu","active","SpinnerImage","src","alt","onImageLoad","imgRef","spinnerStyle","imgStyle","imageSrc","setImagsrc","img","Image","onload","onerror","BottomGradient","BottomGradientDoubledDown","MangaTitle","textShadow","BadgeContainer","borderRadius","overflow","paddingInline","truncateText","str","maxLength","trimmedString","substr","MangaCard","forwardRef","manga","thumbnailUrl","downloadCount","unreadCount","inLibrary","dimensions","inLibraryIndicator","mangaLinkTo","colomns","round","Grid","xs","sm","md","lg","Card","aspectRatio","CardActionArea","objectFit","placeItems","CardContent","transition","Avatar","imageRendering","MangaGrid","mapped","mangas","isLoading","hasNextPage","lastPageNum","setLastPageNum","horisontal","noFaces","lastManga","useRef","scrollHandler","current","rect","getBoundingClientRect","y","innerHeight","movementTimer","setDimensions","gridRef","TestDimensions","offsetWidth","useLayoutEffect","clearInterval","idx","overflowX","flexWrap","sortByUnread","b","sortByTitle","localeCompare","sortById","LibraryMangaGrid","useQueryParam","StringParam","query","sortedManga","desc","reverse","sortManga","filteredManga","m","downloadedFilter","unreadFilter","includes","queryFilter","filterManga","showFilteredOutMessage","AppbarSearch","autoOpen","setQuery","searchOpen","setSearchOpen","inputRef","openSearch","focus","handleSearchShortcut","code","ctrlKey","Input","onBlur","endAdornment","Progress","progress","baseWebsocketUrl","replace","UpdateChecker","setLoading","setProgress","wsc","WebSocket","onmessage","statusMap","COMPLETE","RUNNING","PENDING","running","currentProgress","isNaN","close","disabled","Library","tabsData","tabsError","NumberParam","tabSearchParam","setTabSearchParam","activeTab","find","t","order","isPaused","mangaData","mangaError","mangaLoading","scrollableTabs","innerWidth","handleTabChange","centered","scrollButtons","allowScrollButtonsMobile","getTwoStateType","TwoSatePreference","summary","currentValue","updateValue","internalCurrentValue","setInternalCurrentValue","CheckBoxPreference","SwitchPreferenceCompat","ListDialog","valueProp","setValue","radioGroupRef","maxHeight","TransitionProps","onEntering","dividers","option","ListPreference","entryValues","entries","findEntryOf","indexOf","findEntryValueOf","EditTextPreference","dialogTitle","dialogMessage","cloneObject","obj","selectedValuesProp","selectedValues","values","setSelectedValues","FormGroup","selectedValue","hasEntry","selectedValuesClone","push","MultiSelectListPreference","SourceConfigure","sourceId","useParams","sourcePreferences","convertToString","defaultValueType","getPrefComponent","useSubscription","callback","setState","ChapterCard","chapter","triggerChaptersUpdate","dc","downloadChapter","showChapterNumber","onSelect","selected","isSelecting","dateStr","uploadDate","toLocaleDateString","anchorEl","setAnchorEl","sendChange","mangaId","isDownloaded","canBeDownloaded","cursor","text","read","stopPropagation","pb","bookmarked","mr","chapterNumber","scanlator","toFixed","currentTarget","LinearProgress","opacity","Menu","keepMounted","Boolean","MenuItem","ResumeFab","lastPageRead","PlayArrow","defaultChapterOptions","sortBy","chapterOptionsReducer","actions","filterType","filterValue","useChapterOptions","reducer","defaultState","useReducer","useReducerLocalStorage","pluralize","count","interpolate","one","many","replaceAll","ChapterOptions","optionsDispatch","ChaptersToolbarMenu","isFiltered","isFilterActive","Badge","invisible","ICONS","download","Download","Delete","bookmark","BookmarkAdd","unbookmark","BookmarkRemove","mark_as_read","Done","mark_as_unread","RemoveDone","SelectionFABActionItem","matchingChapters","Icon","SelectionFAB","selectedChapters","onAction","handleAction","chapters","pt","ml","anchorOrigin","horizontal","vertical","transformOrigin","MenuListProps","StyledVirtuoso","Virtuoso","listStyle","up","actionsStrings","success","ChapterList","selection","setSelection","prevQueueRef","queue","dispatch","chaptersData","prevQueue","cd","prevChapterDownload","pcd","chapterIndex","visibleChapters","filtered","chp","isChapterRead","chapterDownload","downloadFilter","chapterBookmarked","bookmarkedFilter","Sorted","fetchedAt","filterAndSortChapters","firstUnreadChapter","slice","noChaptersFound","noChaptersMatchingFilter","chaptersWithMeta","mb","overflowY","totalCount","itemContent","newSelection","cid","handleSelection","useWindowScroll","overscan","actionChapters","actionPromise","chapterIds","change","isBookmarked","isRead","getValueOrUnknown","val","MangaDetails","classes","makeStyles","root","alignSelf","leftRight","leftSide","rightSide","fontWeight","buttons","paddingLeft","paddingRight","description","marginTop","marginBottom","textJustify","genre","border","className","author","artist","displayName","realUrl","rel","g","CategorySelect","mangaCategoriesData","categoriesData","allCategories","cats","selectedIds","categoryId","MangaToolbarMenu","onRefresh","refreshing","isLargeScreen","editCategories","setEditCategories","Manga","autofetchedRef","isValidating","fetchingOnline","setFetchingOnline","Promise","all","useRefreshManga","refresh","useSetDefaultBackTo","age","chaptersAge","Warning","SourceMangaGrid","CheckBoxFilter","group","updateFilterValue","update","setval","upd","HeaderFilter","SelectFilter","rett","FormControl","my","InputLabel","Select","vall","noSelect","displayname","hasSelect","SortFilter","mx","ExpandLess","ExpandMore","Collapse","in","ascending","tmp","TextFilter","typingTimer","Search","setsearch","clearTimeout","el","doneTyping","InputAdornment","TriStateFilter","GroupFilter","Options","sourceFilter","SeparatorFilter","Divider","checkif","displayValues","SourceOptions","resetFilterValue","setTriggerUpdate","setSearch","FilterOptions","setFilterOptions","p","SourceGridLayout","setGridContextOptions","prev","SourceMangas","isConfigurable","setIsConfigurable","setMangas","setHasNextPage","fetched","setFetched","setquery","reset","setReset","setUpdate","triggerUpdate","Data","SetData","Init","setInit","Noreset","setNoreset","makeFilters","response","rep","delayDebounceFn","sourceType","popular","mangaList","Page","settings","handleResize","readerType","pointerEvents","imageStyle","HorizontalPager","pages","curPage","initialPage","setCurPage","prevChapter","nextChapter","currentPageRef","selfRef","pagesRef","nextPage","scrollIntoView","inline","page","loadNextonEnding","prevPage","mouseXPos","dragScreen","scrollBy","pageX","dragControl","removeDragControl","clickControl","clientX","handleLoadNextonEnding","scrollX","scrollWidth","handleScroll","currentPage","wrapper","i","child","findCurrentPageIndex","userSelect","PageNumber","pageCount","showPageNumber","staticNav","PagedReader","changePage","newPage","scroll","goLeft","goRight","keyboardControl","DoublePage","image1src","image2src","DoublePagedPager","pagesDisplayed","pageLoaded","Array","fill","nextCurPage","imgElem","pagesToGoBack","retryDisplay","setInterval","setPagesToDisplay","onLoad","isAtBottom","scrollY","offsetHeight","VerticalPager","go","behavior","handleKeyboard","Root","flexShrink","Navigation","ChapterNavigation","gridTemplateColumns","gridTemplateAreas","gridColumnGap","textTransform","OpenDrawerButton","defaultReaderSettings","continuesPageGap","ReaderNavBar","setSettings","drawerOpen","setDrawerOpen","hideOpenButton","setHideOpenButton","prevScrollPos","setPrevScrollPos","settingsCollapseOpen","setSettingsCollapseOpen","setSettingValue","currentScrollPos","pageYOffset","abs","rootEl","mainContainer","timeout","appear","mountOnEnter","unmountOnExit","ContainerComponent","disableFocusRipple","gridArea","startIcon","chapterCount","endIcon","Zoom","Fade","initialChapter","Reader","setManga","setChapter","settingsClone","defualtSettings","shouldUpdateSettings","keys","forEach","keyOf","formDataRead","n","ReaderComponent","PagedPager","getReaderComponent","isTheSameDay","first","second","getDate","getMonth","getFullYear","groupByDate","updates","groups","globalIdx","date","today","yesterday","setDate","getDateString","epoch","setUTCSeconds","epochToDate","initialQueue","Updates","updateEntries","setUpdateEntries","setWsClient","setQueueState","fetchedHasNextPage","lastEntry","downloadStatusStringFor","rtn","q","dateGroup","DownloadQueue","queueState","toggleQueueStatus","deleteChapterQueue","callDeleteServer","ISOLanguages","nativeName","langCodeToName","whereToCut","proccessedCode","toLocaleLowerCase","substring","langSortCmp","aLang","bLang","LangSelect","firstList","shownLangs","setShownLangs","allLangs","forcedLangs","mShownLangs","setMShownLangs","lang","clone","MobileWidthButtons","WiderWidthButtons","SourceCard","iconUrl","supportsLatest","isNsfw","redirectTo","sourceToLangList","sources","groupByLang","Sources","forcedLang","hasLang","shownLangsCopy","Fragment","ExtensionCard","extension","versionName","installed","hasUpdate","obsolete","pkgName","notifyInstall","installedState","setInstalledState","langPress","toUpperCase","uninstall","handleButtonClick","reload","MangaExtensions","isMobile","allExtensions","filteredExtensions","ext","nsfwFilter","flatRenderItems","extensions","sortedExtenions","langExt","concat","groupExtensions","flat","toasts","setToasts","makeToaster","submitExternalExtension","paddingBottom","apkName","Browse","NavBarProvider","Provider","LibraryOptionsContextProvider","SearchAll","setSources","FetchedSources","setFetchedSources","ResetUI","setResetUI","limit","PQueue","concurrency","elem","ele","add","tmp2","doIT","af","bf","al","bl","App","darkThemeContext","createTheme","components","MuiCssBaseline","styleOverrides","StyledEngineProvider","injectFirst","ThemeProvider","ReactRouterRoute","Route","CssBaseline","Container","disableGutters","exact","match","params","StrictMode"],"mappings":"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","file":"static/js/main.56b14c93.chunk.js","sourcesContent":["/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nfunction getItem<T>(key: string, defaultValue: T) : T {\n    try {\n        const item = window.localStorage.getItem(key);\n\n        if (item !== null) {\n            return JSON.parse(item);\n        }\n\n        window.localStorage.setItem(key, JSON.stringify(defaultValue));\n\n        /* eslint-disable no-empty */\n    } finally { }\n    return defaultValue;\n}\n\nfunction setItem<T>(key: string, value: T): void {\n    try {\n        window.localStorage.setItem(key, JSON.stringify(value));\n\n        // eslint-disable-next-line no-empty\n    } finally { }\n}\n\nexport default { getItem, setItem };\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport axios from 'axios';\nimport useSWR, { SWRConfiguration, SWRResponse } from 'swr';\nimport storage from './localStorage';\n\nconst { hostname, port, protocol } = window.location;\n\n// if port is 3000 it's probably running from webpack devlopment server\nlet inferredPort;\nif (port === '3000') { inferredPort = '4567'; } else { inferredPort = port; }\n\nconst baseURL = storage.getItem('serverBaseURL', `${protocol}//${hostname}:${inferredPort}`);\n\nconst client = axios.create({\n    // baseURL must not have traling slash\n    baseURL,\n});\n\nclient.interceptors.request.use((config) => {\n    if (config.data instanceof FormData) {\n        Object.assign(config.headers, { 'Content-Type': 'multipart/form-data' });\n    }\n    return config;\n});\n\nexport default client;\n\nexport async function fetcher<T = any>(path: string) {\n    const res = await client.get(path);\n    if (res.status !== 200) {\n        throw new Error(res.statusText);\n    }\n    if (res.headers['content-type'] !== 'application/json') {\n        throw new Error('Response is not json');\n    }\n    return res.data as T;\n}\n\nexport const useQuery = <\n    D extends any = any,\n    E extends any = any,\n>(\n    key: string,\n    config?: SWRConfiguration<D, E>,\n): SWRResponse<D, E> & { loading: boolean } => {\n    const res = useSWR(key, config);\n    return {\n        ...res,\n        loading: res.data == null && res.error == null,\n    };\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\n\ntype ContextType = {\n    // Default back button url\n    defaultBackTo: string | undefined\n    setDefaultBackTo: React.Dispatch<React.SetStateAction<string | undefined>>\n\n    // AppBar title\n    title: string\n    setTitle: React.Dispatch<React.SetStateAction<string>>\n\n    // AppBar action buttons\n    action: any\n    setAction: React.Dispatch<React.SetStateAction<any>>\n\n    // Allow default navbar to be overrided\n    override: INavbarOverride\n    setOverride: React.Dispatch<React.SetStateAction<INavbarOverride>>\n};\n\nconst NavBarContext = React.createContext<ContextType>({\n    defaultBackTo: undefined,\n    setDefaultBackTo: ():void => {},\n    title: 'Tachidesk',\n    setTitle: ():void => {},\n    action: <div />,\n    setAction: ():void => {},\n    override: { status: false, value: <div /> },\n    setOverride: ():void => {},\n});\n\nexport default NavBarContext;\n\nexport const useNavBarContext = () => useContext(NavBarContext);\n\nexport const useSetDefaultBackTo = (value: string) => {\n    const { setDefaultBackTo } = useNavBarContext();\n\n    useEffect(() => {\n        setDefaultBackTo(value);\n        return () => setDefaultBackTo(undefined);\n    }, [value]);\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ntype ContextType = {\n    darkTheme: boolean\n    setDarkTheme: React.Dispatch<React.SetStateAction<boolean>>\n};\n\nconst DarkTheme = React.createContext<ContextType>({\n    darkTheme: true,\n    setDarkTheme: ():void => {},\n});\n\nexport default DarkTheme;\n","import React from 'react';\nimport createSvgIcon from '@mui/material/utils/createSvgIcon';\n\nconst d = 'M 11 1 C 9.3550302 1 8 2.3550302 8 4 L 4 4 C 2.9069372 4 2 4.9069372 2 6 L 2 12 L 4 12 C 4.5650302 12 5 12.43497 5 13 C 5 13.56503 4.5650302 14 4 14 L 2 14 L 2 20 C 2 21.093063 2.9069372 22 4 22 L 10 22 L 10 20 C 10 19.43497 10.43497 19 11 19 C 11.56503 19 12 19.43497 12 20 L 12 22 L 18 22 C 19.093063 22 20 21.093063 20 20 L 20 16 C 21.64497 16 23 14.64497 23 13 C 23 11.35503 21.64497 10 20 10 L 20 6 C 20 4.9069372 19.093063 4 18 4 L 14 4 C 14 2.3550302 12.64497 1 11 1 z M 11 3 C 11.56503 3 12 3.4349698 12 4 L 12 6 L 18 6 L 18 12 L 20 12 C 20.56503 12 21 12.43497 21 13 C 21 13.56503 20.56503 14 20 14 L 18 14 L 18 20 L 14 20 C 14 18.35503 12.64497 17 11 17 C 9.3550302 17 8 18.35503 8 20 L 4 20 L 4 16 C 5.6449698 16 7 14.64497 7 13 C 7 11.35503 5.6449698 10 4 10 L 4 6 L 10 6 L 10 4 C 10 3.4349698 10.43497 3 11 3 z';\n\nconst icon = createSvgIcon(<path d={d} />, 'CustomExtensionOutlined');\n\nexport default icon;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { useNavBarContext } from 'components/context/NavbarContext';\nimport { useLocation } from 'react-router-dom';\n\nexport const BACK = '__BACK__';\n\nconst useBackTo = (): { url?: string, back: boolean } => {\n    const location = useLocation<{ backLink?: string }>();\n    const { defaultBackTo } = useNavBarContext();\n\n    const url = location.state?.backLink ?? defaultBackTo;\n    return {\n        url: url === BACK ? undefined : url,\n        back: url === BACK,\n    };\n};\n\nexport default useBackTo;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { ListItem, ListItemIcon, Tooltip } from '@mui/material';\nimport { Link, useLocation } from 'react-router-dom';\nimport { styled } from '@mui/system';\nimport { useTheme } from '@mui/material/styles';\n\nconst SideNavBarContainer = styled('div')(({ theme }) => ({\n    height: '100vh',\n    width: theme.spacing(8),\n    backgroundColor: theme.palette.mode === 'light' ? theme.palette.grey[100] : theme.palette.grey[900],\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    paddingTop: theme.spacing(8),\n    display: 'flex',\n    flexDirection: 'column',\n}));\n\ninterface IProps {\n    navBarItems: Array<NavbarItem>\n}\n\nexport default function DesktopSideBar({ navBarItems }: IProps) {\n    const location = useLocation();\n    const theme = useTheme();\n\n    const iconFor = (path: string, IconComponent: any, SelectedIconComponent: any) => {\n        if (location.pathname === path) return <SelectedIconComponent sx={{ color: 'primary.main' }} fontSize=\"large\" />;\n        return <IconComponent sx={{ color: (theme.palette.mode === 'dark') ? 'grey.A400' : 'grey.600' }} fontSize=\"large\" />;\n    };\n\n    return (\n        <SideNavBarContainer>\n            {\n                // eslint-disable-next-line react/destructuring-assignment\n                navBarItems.map(({\n                    path, title, IconComponent, SelectedIconComponent,\n                }: NavbarItem) => (\n                    <Link to={path} style={{ color: 'inherit', textDecoration: 'none' }} key={path}>\n                        <ListItem disableRipple button key={title}>\n                            <ListItemIcon sx={{ minWidth: '0' }}>\n                                <Tooltip placement=\"right\" title={title}>\n                                    {iconFor(path, IconComponent, SelectedIconComponent)}\n                                </Tooltip>\n                            </ListItemIcon>\n                        </ListItem>\n                    </Link>\n                ))\n            }\n        </SideNavBarContainer>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { ListItem } from '@mui/material';\nimport { styled, Box } from '@mui/system';\nimport { Link as RRDLink, useLocation } from 'react-router-dom';\nimport { useTheme } from '@mui/material/styles';\n\nconst BottomNavContainer = styled('div')(({ theme }) => ({\n    bottom: 0,\n    left: 0,\n    height: theme.spacing(7),\n    width: '100vw',\n    backgroundColor: theme.palette.mode === 'light' ? theme.palette.grey[100] : theme.palette.grey[900],\n    position: 'fixed',\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-evenly',\n    alignItems: 'center',\n    // For Some reason the theme is throwing and error when accessing the Zindex object,\n    // This is the zIndex of the appBar in the default theme\n    zIndex: 1100,\n}));\n\nconst Link = styled(RRDLink)({\n    textDecoration: 'none',\n    flex: 1,\n});\n\ninterface IProps {\n    navBarItems: Array<NavbarItem>\n}\n\nexport default function MobileBottomBar({ navBarItems }: IProps) {\n    const location = useLocation();\n    const theme = useTheme();\n\n    const iconFor = (path: string, IconComponent: any, SelectedIconComponent: any) => {\n        if (location.pathname === path) return <SelectedIconComponent sx={{ color: 'primary.main' }} fontSize=\"medium\" />;\n        return <IconComponent sx={{ color: (theme.palette.mode === 'dark') ? 'grey.A400' : 'grey.600' }} fontSize=\"medium\" />;\n    };\n\n    return (\n        <BottomNavContainer>\n            {\n                navBarItems.map((\n                    {\n                        path, title, IconComponent, SelectedIconComponent,\n                    }: NavbarItem,\n                ) => (\n                    <Link to={path} key={path}>\n                        <ListItem disableRipple button sx={{ justifyContent: 'center', padding: '8px' }} key={title}>\n                            <Box\n                                display=\"flex\"\n                                flexDirection=\"column\"\n                                alignItems=\"center\"\n                            >\n                                {iconFor(path, IconComponent, SelectedIconComponent)}\n                                <Box sx={{\n                                    fontSize: '0.65rem',\n                                    // eslint-disable-next-line no-nested-ternary\n                                    color: location.pathname === path\n                                        ? 'primary.main'\n                                        : ((theme.palette.mode === 'dark')\n                                            ? 'grey.A400'\n                                            : 'grey.600'),\n                                }}\n                                >\n                                    {title}\n                                </Box>\n                            </Box>\n                        </ListItem>\n                    </Link>\n                ))\n            }\n        </BottomNavContainer>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext } from 'react';\nimport AppBar from '@mui/material/AppBar';\nimport Toolbar from '@mui/material/Toolbar';\nimport Typography from '@mui/material/Typography';\nimport IconButton from '@mui/material/IconButton';\nimport { useMediaQuery } from '@mui/material';\nimport { useTheme } from '@mui/material/styles';\nimport CollectionsBookmarkIcon from '@mui/icons-material/CollectionsBookmark';\nimport CollectionsOutlinedBookmarkIcon from '@mui/icons-material/CollectionsBookmarkOutlined';\nimport NewReleasesIcon from '@mui/icons-material/NewReleases';\nimport NewReleasesOutlinedIcon from '@mui/icons-material/NewReleasesOutlined';\nimport ExploreIcon from '@mui/icons-material/Explore';\nimport ExploreOutlinedIcon from '@mui/icons-material/ExploreOutlined';\nimport ExtensionIcon from '@mui/icons-material/Extension';\nimport GetAppIcon from '@mui/icons-material/GetApp';\nimport GetAppOutlinedIcon from '@mui/icons-material/GetAppOutlined';\nimport SettingsIcon from '@mui/icons-material/Settings';\nimport ArrowBack from '@mui/icons-material/ArrowBack';\nimport { Link, useHistory } from 'react-router-dom';\nimport NavBarContext from 'components/context/NavbarContext';\nimport DarkTheme from 'components/context/DarkTheme';\nimport ExtensionOutlinedIcon from 'components/util/CustomExtensionOutlinedIcon';\nimport { Box } from '@mui/system';\nimport { createPortal } from 'react-dom';\nimport useBackTo from 'util/useBackTo';\nimport DesktopSideBar from './navigation/DesktopSideBar';\nimport MobileBottomBar from './navigation/MobileBottomBar';\n\nconst navbarItems: Array<NavbarItem> = [\n    {\n        path: '/library',\n        title: 'Library',\n        SelectedIconComponent: CollectionsBookmarkIcon,\n        IconComponent: CollectionsOutlinedBookmarkIcon,\n        show: 'both',\n    }, {\n        path: '/updates',\n        title: 'Updates',\n        SelectedIconComponent: NewReleasesIcon,\n        IconComponent: NewReleasesOutlinedIcon,\n        show: 'both',\n    }, {\n        path: '/extensions',\n        title: 'Extensions',\n        SelectedIconComponent: ExtensionIcon,\n        IconComponent: ExtensionOutlinedIcon,\n        show: 'desktop',\n    }, {\n        path: '/sources',\n        title: 'Sources',\n        SelectedIconComponent: ExploreIcon,\n        IconComponent: ExploreOutlinedIcon,\n        show: 'desktop',\n    }, {\n        path: '/browse',\n        title: 'Browse',\n        SelectedIconComponent: ExploreIcon,\n        IconComponent: ExploreOutlinedIcon,\n        show: 'mobile',\n    }, {\n        path: '/downloads',\n        title: 'Downloads',\n        SelectedIconComponent: GetAppIcon,\n        IconComponent: GetAppOutlinedIcon,\n        show: 'both',\n    }, {\n        path: '/settings',\n        title: 'Settings',\n        SelectedIconComponent: SettingsIcon,\n        IconComponent: SettingsIcon,\n        show: 'both',\n    },\n];\n\nexport default function DefaultNavBar() {\n    const { title, action, override } = useContext(NavBarContext);\n    const backTo = useBackTo();\n    const { darkTheme } = useContext(DarkTheme);\n\n    const theme = useTheme();\n    const history = useHistory();\n\n    const isMobileWidth = useMediaQuery(theme.breakpoints.down('sm'));\n    const isMainRoute = navbarItems.some(({ path }) => path === history.location.pathname);\n\n    // Allow default navbar to be overrided\n    if (override.status) return override.value;\n\n    let navbar = <></>;\n    if (isMobileWidth) {\n        if (isMainRoute) {\n            navbar = <MobileBottomBar navBarItems={navbarItems.filter((it) => it.show !== 'desktop')} />;\n        }\n    } else {\n        navbar = <DesktopSideBar navBarItems={navbarItems.filter((it) => it.show !== 'mobile')} />;\n    }\n\n    const handleBack = () => {\n        if (backTo.url != null) return;\n        history.goBack();\n    };\n\n    return (\n        <Box sx={{ flexGrow: 1 }}>\n            <AppBar position=\"fixed\" color={darkTheme ? 'default' : 'primary'}>\n                <Toolbar>\n                    {!isMainRoute && (\n                        <IconButton\n                            component={backTo.url ? Link : 'button'}\n                            to={backTo.url}\n                            edge=\"start\"\n                            sx={{ marginRight: theme.spacing(2) }}\n                            color=\"inherit\"\n                            aria-label=\"menu\"\n                            disableRipple\n                            size=\"large\"\n                            onClick={handleBack}\n                        >\n                            <ArrowBack />\n                        </IconButton>\n                    )}\n                    <Typography variant={isMobileWidth ? 'h6' : 'h5'} sx={{ flexGrow: 1 }} noWrap textOverflow=\"ellipsis\">\n                        {title}\n                    </Typography>\n                    {action}\n                    <div id=\"navbarToolbar\" />\n                </Toolbar>\n            </AppBar>\n            {navbar}\n        </Box>\n    );\n}\n\ninterface INavbarToolbarProps {\n    children?: React.ReactNode\n}\n\nexport const NavbarToolbar: React.FC<INavbarToolbarProps> = ({ children }) => {\n    const container = document.getElementById('navbarToolbar');\n    if (!container) return null;\n\n    return createPortal(children, container);\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, {\n    useState,\n    Dispatch,\n    SetStateAction,\n    useReducer,\n    Reducer,\n    useCallback,\n} from 'react';\nimport storage from './localStorage';\n\n// eslint-disable-next-line max-len\nexport default function useLocalStorage<T>(\n    key: string,\n    defaultValue: T | (() => T),\n): [T, Dispatch<SetStateAction<T>>] {\n    const initialState = defaultValue instanceof Function ? defaultValue() : defaultValue;\n    const [storedValue, setStoredValue] = useState<T>(\n        storage.getItem(key, initialState),\n    );\n\n    const setValue = useCallback<React.Dispatch<React.SetStateAction<T>>>(\n        ((value) => {\n            setStoredValue((prevValue) => {\n                // Allow value to be a function so we have same API as useState\n                const valueToStore = value instanceof Function ? value(prevValue) : value;\n                storage.setItem(key, valueToStore);\n                return valueToStore;\n            });\n        }), [key],\n    );\n\n    return [storedValue, setValue];\n}\n\nexport function useReducerLocalStorage<S, A>(\n    reducer: Reducer<S, A>,\n    key: string,\n    defaultState: S | (() => S),\n) {\n    const [storedValue, setValue] = useLocalStorage(key, defaultState);\n    return useReducer((state: S, action: A): S => {\n        const newState = reducer(state, action);\n        setValue(newState);\n        return newState;\n    }, storedValue);\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport ListItem, { ListItemProps } from '@mui/material/ListItem';\nimport { Link } from 'react-router-dom';\n\nexport default function ListItemLink(props: ListItemProps<Link, { directLink?: boolean }>) {\n    const { directLink, to } = props;\n    if (directLink) {\n        return <ListItem button component=\"a\" href={to} {...props} />;\n    }\n\n    return <ListItem button component={Link} {...props} />;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport List from '@mui/material/List';\nimport ListAltIcon from '@mui/icons-material/ListAlt';\nimport BackupIcon from '@mui/icons-material/Backup';\nimport Brightness6Icon from '@mui/icons-material/Brightness6';\nimport DnsIcon from '@mui/icons-material/Dns';\nimport EditIcon from '@mui/icons-material/Edit';\nimport InfoIcon from '@mui/icons-material/Info';\nimport CachedIcon from '@mui/icons-material/Cached';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemIcon from '@mui/material/ListItemIcon';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Switch from '@mui/material/Switch';\nimport Button from '@mui/material/Button';\nimport IconButton from '@mui/material/IconButton';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport TextField from '@mui/material/TextField';\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport Slider from '@mui/material/Slider';\nimport { DialogTitle, ListItemButton } from '@mui/material';\nimport ViewModuleIcon from '@mui/icons-material/ViewModule';\nimport NavbarContext from '../components/context/NavbarContext';\nimport DarkTheme from '../components/context/DarkTheme';\nimport useLocalStorage from '../util/useLocalStorage';\nimport ListItemLink from '../components/util/ListItemLink';\n\nexport default function Settings() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Settings'); setAction(<></>); }, []);\n\n    const { darkTheme, setDarkTheme } = useContext(DarkTheme);\n    const [serverAddress, setServerAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [showNsfw, setShowNsfw] = useLocalStorage<boolean>('showNsfw', true);\n    const [useCache, setUseCache] = useLocalStorage<boolean>('useCache', true);\n    const [dialogOpen, setDialogOpen] = useState(false);\n    const [dialogValue, setDialogValue] = useState(serverAddress);\n\n    const [dialogOpenItemWidth, setDialogOpenItemWidth] = useState(false);\n    const [ItemWidth, setItemWidth] = useLocalStorage<number>('ItemWidth', 300);\n    const [DialogItemWidth, setDialogItemWidth] = useState(ItemWidth);\n\n    const handleDialogOpen = () => {\n        setDialogValue(serverAddress);\n        setDialogOpen(true);\n    };\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n        setServerAddress(dialogValue);\n    };\n\n    const handleDialogOpenItemWidth = () => {\n        setDialogItemWidth(ItemWidth);\n        setDialogOpenItemWidth(true);\n    };\n\n    const handleDialogCancelItemWidth = () => {\n        setDialogOpenItemWidth(false);\n    };\n\n    const handleDialogSubmitItemWidth = () => {\n        setDialogOpenItemWidth(false);\n        setItemWidth(DialogItemWidth);\n    };\n\n    const handleDialogResetItemWidth = () => {\n        setDialogOpenItemWidth(false);\n        setItemWidth(300);\n    };\n\n    const handleChange = (event: Event, newValue: number | number[]) => {\n        setDialogItemWidth(newValue as number);\n    };\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                <ListItemLink to=\"/settings/categories\">\n                    <ListItemIcon>\n                        <ListAltIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Categories\" />\n                </ListItemLink>\n                <ListItemLink to=\"/settings/backup\">\n                    <ListItemIcon>\n                        <BackupIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Backup\" />\n                </ListItemLink>\n                <ListItem>\n                    <ListItemIcon>\n                        <Brightness6Icon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Dark Theme\" />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={darkTheme}\n                            onChange={() => setDarkTheme(!darkTheme)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItemButton>\n                    <ListItemIcon>\n                        <ViewModuleIcon />\n                    </ListItemIcon>\n                    <ListItemText\n                        primary=\"Manga Item width\"\n                        secondary={`px:${ItemWidth}`}\n                        onClick={() => {\n                            handleDialogOpenItemWidth();\n                        }}\n                    />\n                </ListItemButton>\n                <ListItem>\n                    <ListItemIcon>\n                        <FavoriteIcon />\n                    </ListItemIcon>\n                    <ListItemText\n                        primary=\"Show NSFW\"\n                        secondary=\"Hide NSFW extensions and sources\"\n                    />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={showNsfw}\n                            onChange={() => setShowNsfw(!showNsfw)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemIcon>\n                        <CachedIcon />\n                    </ListItemIcon>\n                    <ListItemText\n                        primary=\"Use image cache\"\n                        secondary=\"Disabling image cache makes images load faster if you have a slow disk,\n                         but uses it much more internet traffic in turn\"\n                    />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={useCache}\n                            onChange={() => setUseCache(!useCache)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemIcon>\n                        <DnsIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Server Address\" secondary={serverAddress} />\n                    <ListItemSecondaryAction>\n                        <IconButton\n                            onClick={() => {\n                                handleDialogOpen();\n                            }}\n                            size=\"large\"\n                        >\n                            <EditIcon />\n                        </IconButton>\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItemLink to=\"/settings/about\">\n                    <ListItemIcon>\n                        <InfoIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"About\" />\n                </ListItemLink>\n            </List>\n\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogContent>\n                    <DialogContentText>\n                        Enter Server Address\n                    </DialogContentText>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Server Address\"\n                        type=\"text\"\n                        fullWidth\n                        value={dialogValue}\n                        placeholder=\"http://127.0.0.1:4567\"\n                        onChange={(e) => setDialogValue(e.target.value)}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        Set\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            <Dialog open={dialogOpenItemWidth} onClose={handleDialogCancelItemWidth}>\n                <DialogTitle>\n                    Manga Item width\n                </DialogTitle>\n                <DialogContent\n                    sx={{\n                        width: '98%',\n                        margin: 'auto',\n                    }}\n                >\n                    <TextField\n                        sx={{\n                            width: '100%',\n                            margin: 'auto',\n                        }}\n                        autoFocus\n                        value={DialogItemWidth}\n                        type=\"number\"\n                        onChange={(e) => setDialogItemWidth(parseInt(e.target.value, 10))}\n                    />\n                    <Slider\n                        aria-label=\"Manga Item width\"\n                        defaultValue={300}\n                        value={DialogItemWidth}\n                        step={10}\n                        min={100}\n                        max={1000}\n                        onChange={handleChange}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogResetItemWidth} color=\"primary\">\n                        Reset to Default\n                    </Button>\n                    <Button onClick={handleDialogCancelItemWidth} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmitItemWidth} color=\"primary\">\n                        OK\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    shouldRender?: boolean | (() => boolean)\n    children?: React.ReactNode\n    component?: string | React.FunctionComponent<any> | React.ComponentClass<any, any>\n    componentProps?: any\n}\n\nexport default function LoadingPlaceholder(props: IProps) {\n    const {\n        children, shouldRender, component, componentProps,\n    } = props;\n\n    let condition = true;\n    if (shouldRender !== undefined) {\n        condition = shouldRender instanceof Function ? shouldRender() : shouldRender;\n    }\n\n    if (condition) {\n        if (component) {\n            return React.createElement(component, componentProps);\n        }\n\n        if (children) {\n            return (\n                <>\n                    {children}\n                </>\n            );\n        }\n    }\n\n    return (\n        <Box sx={{\n            margin: '10px auto',\n            display: 'flex',\n            justifyContent: 'center',\n        }}\n        >\n            <CircularProgress thickness={5} />\n        </Box>\n    );\n}\n","import React, { useContext, useEffect } from 'react';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemLink from 'components/util/ListItemLink';\nimport NavbarContext from 'components/context/NavbarContext';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport { useQuery } from 'util/client';\n\nexport default function About() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    useEffect(() => { setTitle('About'); setAction(<></>); }, []);\n\n    const { data: about } = useQuery<IAbout>('/api/v1/settings/about');\n\n    if (about === undefined) {\n        return <LoadingPlaceholder />;\n    }\n\n    const version = () => {\n        if (about.buildType === 'Stable') return `${about.version}`;\n        return `${about.version}-${about.revision}`;\n    };\n\n    const buildTime = () => new Date(about.buildTime * 1000).toUTCString();\n\n    return (\n        <List>\n            <ListItem>\n                <ListItemText primary=\"Server\" secondary={`${about.name} ${about.buildType}`} />\n            </ListItem>\n            <ListItem>\n                <ListItemText primary=\"Server version\" secondary={version()} />\n            </ListItem>\n            <ListItem>\n                <ListItemText primary=\"Build time\" secondary={buildTime()} />\n            </ListItem>\n            <ListItemLink to={about.github}>\n                <ListItemText primary=\"Github\" secondary={about.github} />\n            </ListItemLink>\n            <ListItemLink to={about.discord}>\n                <ListItemText primary=\"Discord\" secondary={about.discord} />\n            </ListItemLink>\n        </List>\n    );\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, {\n    useMemo, useState, useContext, useEffect,\n} from 'react';\nimport {\n    List,\n    ListItem,\n    ListItemText,\n    ListItemIcon,\n    IconButton,\n} from '@mui/material';\nimport {\n    DragDropContext, Droppable, Draggable, DropResult, DraggingStyle, NotDraggingStyle,\n} from 'react-beautiful-dnd';\nimport DragHandleIcon from '@mui/icons-material/DragHandle';\nimport EditIcon from '@mui/icons-material/Edit';\nimport { useTheme, Palette } from '@mui/material/styles';\nimport Fab from '@mui/material/Fab';\nimport AddIcon from '@mui/icons-material/Add';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client, { useQuery } from 'util/client';\n\nconst getItemStyle = (isDragging: boolean,\n    draggableStyle: DraggingStyle | NotDraggingStyle | undefined, palette: Palette) => ({\n    // styles we need to apply on draggables\n    ...draggableStyle,\n\n    ...(isDragging && {\n        background: palette.mode === 'dark' ? '#424242' : 'rgb(235,235,235)',\n    }),\n});\n\nexport default function Categories() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Categories'); setAction(<></>); }, []);\n\n    const { data, mutate } = useQuery<ICategory[]>('/api/v1/category/');\n    const categories = useMemo(() => {\n        const res = [...data ?? []];\n        if (res.length > 0 && res[0].name === 'Default') {\n            res.shift();\n        }\n        return res;\n    }, [data]);\n\n    const [categoryToEdit, setCategoryToEdit] = useState<number>(-1); // -1 means new category\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n    const [dialogName, setDialogName] = useState<string>('');\n    const [dialogDefault, setDialogDefault] = useState<boolean>(false);\n    const theme = useTheme();\n\n    const categoryReorder = (list: ICategory[], from: number, to: number) => {\n        const newData = [...list];\n        const [removed] = newData.splice(from, 1);\n        newData.splice(to, 0, removed);\n        mutate(newData, { revalidate: false });\n\n        const formData = new FormData();\n        formData.append('from', `${from + 1}`);\n        formData.append('to', `${to + 1}`);\n        client.patch('/api/v1/category/reorder', formData).finally(() => mutate());\n    };\n\n    const onDragEnd = (result: DropResult) => {\n        // dropped outside the list?\n        if (!result.destination) {\n            return;\n        }\n\n        categoryReorder(\n            categories,\n            result.source.index,\n            result.destination.index,\n        );\n    };\n\n    const resetDialog = () => {\n        setDialogName('');\n        setDialogDefault(false);\n        setCategoryToEdit(-1);\n    };\n\n    const handleDialogOpen = () => {\n        resetDialog();\n        setDialogOpen(true);\n    };\n\n    const handleEditDialogOpen = (index:number) => {\n        setDialogName(categories[index].name);\n        setDialogDefault(categories[index].default);\n        setCategoryToEdit(index);\n        setDialogOpen(true);\n    };\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n\n        const formData = new FormData();\n        formData.append('name', dialogName);\n        formData.append('default', dialogDefault.toString());\n\n        if (categoryToEdit === -1) {\n            client.post('/api/v1/category/', formData)\n                .finally(() => mutate());\n        } else {\n            const category = categories[categoryToEdit];\n            client.patch(`/api/v1/category/${category.id}`, formData)\n                .finally(() => mutate());\n        }\n    };\n\n    const deleteCategory = (index:number) => {\n        const category = categories[index];\n        client.delete(`/api/v1/category/${category.id}`)\n            .finally(() => mutate());\n    };\n\n    return (\n        <>\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <List ref={provided.innerRef}>\n                            {categories.map((item, index) => (\n                                <Draggable\n                                    key={item.id}\n                                    draggableId={item.id.toString()}\n                                    index={index}\n                                >\n                                    {(provided, snapshot) => (\n                                        <ListItem\n                                            ContainerProps={{ ref: provided.innerRef } as any}\n                                            {...provided.draggableProps}\n                                            {...provided.dragHandleProps}\n                                            style={getItemStyle(\n                                                snapshot.isDragging,\n                                                provided.draggableProps.style,\n                                                theme.palette,\n                                            )}\n                                            ref={provided.innerRef}\n                                        >\n                                            <ListItemIcon>\n                                                <DragHandleIcon />\n                                            </ListItemIcon>\n                                            <ListItemText\n                                                primary={item.name}\n                                            />\n                                            <IconButton\n                                                onClick={() => {\n                                                    handleEditDialogOpen(index);\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <EditIcon />\n                                            </IconButton>\n                                            <IconButton\n                                                onClick={() => {\n                                                    deleteCategory(index);\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <DeleteIcon />\n                                            </IconButton>\n                                        </ListItem>\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </List>\n                    )}\n                </Droppable>\n            </DragDropContext>\n            <Fab\n                color=\"primary\"\n                aria-label=\"add\"\n                style={{\n                    position: 'absolute',\n                    bottom: theme.spacing(2),\n                    right: theme.spacing(2),\n                }}\n                onClick={handleDialogOpen}\n            >\n                <AddIcon />\n            </Fab>\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogTitle id=\"form-dialog-title\">\n                    {categoryToEdit === -1 ? 'New Catalog' : 'Edit Catalog'}\n                </DialogTitle>\n                <DialogContent>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Category Name\"\n                        type=\"text\"\n                        fullWidth\n                        value={dialogName}\n                        onChange={(e) => setDialogName(e.target.value)}\n                    />\n                    <FormControlLabel\n                        control={(\n                            <Checkbox\n                                checked={dialogDefault}\n                                onChange={(e) => setDialogDefault(e.target.checked)}\n                                color=\"default\"\n                            />\n                        )}\n                        label=\"Default category when adding new manga to library\"\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        Submit\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport ReactDOM from 'react-dom';\nimport React from 'react';\nimport Slide, { SlideProps } from '@mui/material/Slide';\nimport Snackbar from '@mui/material/Snackbar';\nimport MuiAlert, { AlertColor as Severity } from '@mui/material/Alert';\n\nfunction removeToast(id: string) {\n    const container = document.querySelector(`#${id}`)!!;\n    ReactDOM.unmountComponentAtNode(container);\n    document.body.removeChild(container);\n}\n\nfunction Transition(props: SlideProps) {\n    return <Slide {...props} direction=\"up\" />;\n}\n\ninterface IToastProps{\n    message: string\n    severity: Severity\n}\n\nexport function Toast(props: IToastProps) {\n    const { message, severity } = props;\n    const [open, setOpen] = React.useState(true);\n\n    const handleClose = () => {\n        setOpen(false);\n    };\n\n    return (\n        <Snackbar\n            open={open}\n            onClose={handleClose}\n            autoHideDuration={3000}\n            TransitionComponent={Transition}\n            message=\"I love snacks\"\n        >\n            <MuiAlert elevation={6} variant=\"filled\" onClose={handleClose} severity={severity}>\n                {message}\n            </MuiAlert>\n        </Snackbar>\n    );\n}\n\nexport default function makeToast(message: string, severity: Severity) {\n    const id = Math.floor(Math.random() * 1000);\n    const container = document.createElement('div');\n    container.id = `alert-${id}`;\n\n    document.body.appendChild(container);\n\n    ReactDOM.render(<Toast message={message} severity={severity} />, container);\n\n    setTimeout(() => removeToast(container.id), 3500);\n}\n\nexport function makeToaster(\n    [toasts, setToasts] : [React.ReactElement[],\n        (arg0: React.ReactElement[]) => void],\n): [React.ReactElement[], ((message: string, severity: Severity) => void)] {\n    return [toasts, (message: string, severity: Severity) => {\n        setToasts([<Toast\n            key={Math.floor(Math.random() * 1000) + 1}\n            message={message}\n            severity={severity}\n        />]);\n    }];\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport { fromEvent } from 'file-selector';\nimport client from 'util/client';\nimport makeToast from 'components/util/Toast';\nimport ListItemLink from '../../components/util/ListItemLink';\nimport NavbarContext from '../../components/context/NavbarContext';\n\nexport default function Backup() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Backup'); setAction(<></>); }, []);\n\n    const { baseURL } = client.defaults;\n\n    const submitBackup = (file: File) => {\n        if (file.name.toLowerCase().endsWith('proto.gz')) {\n            const formData = new FormData();\n            formData.append('backup.proto.gz', file);\n\n            makeToast('Restoring backup....', 'info');\n            client.post('/api/v1/backup/import/file',\n                formData, { headers: { 'Content-Type': 'multipart/form-data' } })\n                .then(() => makeToast('Backup restore finished!', 'success'))\n                .catch(() => makeToast('Backup restore failed!', 'error'));\n        } else if (file.name.toLowerCase().endsWith('json')) {\n            makeToast('legacy backups are not supported!', 'error');\n        } else {\n            makeToast('invalid file type!', 'error');\n        }\n    };\n\n    const dropHandler = async (e: Event) => {\n        e.preventDefault();\n        const files = await fromEvent(e);\n\n        submitBackup(files[0] as File);\n    };\n\n    const dragOverHandler = (e: Event) => {\n        e.preventDefault();\n    };\n\n    useEffect(() => {\n        document.addEventListener('drop', dropHandler);\n        document.addEventListener('dragover', dragOverHandler);\n\n        const input = document.getElementById('backup-file');\n        input?.addEventListener('change', async (evt) => {\n            const files = await fromEvent(evt);\n            submitBackup(files[0] as File);\n        });\n\n        return () => {\n            document.removeEventListener('drop', dropHandler);\n            document.removeEventListener('dragover', dragOverHandler);\n        };\n    }, []);\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                <ListItemLink to={`${baseURL}/api/v1/backup/export/file`} directLink>\n                    <ListItemText\n                        primary=\"Create Backup\"\n                        secondary=\"Backup library as a Tachiyomi backup\"\n                    />\n                </ListItemLink>\n                <ListItem button onClick={() => document.getElementById('backup-file')?.click()}>\n                    <ListItemText\n                        primary=\"Restore Backup\"\n                        secondary=\"You can also drag and drop the backup file here to restore\"\n                    />\n                </ListItem>\n            </List>\n            <input\n                type=\"file\"\n                id=\"backup-file\"\n                style={{ display: 'none' }}\n            />\n        </>\n\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n// adopted from: https://github.com/tachiyomiorg/tachiyomi/blob/master/app/src/main/java/eu/kanade/tachiyomi/widget/EmptyView.kt\n\nimport React, { useMemo } from 'react';\nimport Typography from '@mui/material/Typography';\nimport { useTheme } from '@mui/material/styles';\nimport { useMediaQuery } from '@mui/material';\nimport { Box } from '@mui/system';\n\nconst ERROR_FACES = [\n    '(o;)',\n    '(_)',\n    '_',\n    '(_)',\n    '()',\n    '(',\n];\n\nfunction getRandomErrorFace() {\n    const randIndex = Math.floor(Math.random() * ERROR_FACES.length);\n    return ERROR_FACES[randIndex];\n}\n\ninterface IProps {\n    message: string\n    messageExtra?: JSX.Element\n}\n\nexport default function EmptyView({ message, messageExtra }: IProps) {\n    const theme = useTheme();\n    const isMobileWidth = useMediaQuery(theme.breakpoints.down('sm'));\n\n    const errorFace = useMemo(() => getRandomErrorFace(), []);\n\n    return (\n        <Box sx={{\n            position: 'absolute',\n            left: `calc(50% + ${isMobileWidth ? '0px' : theme.spacing(8 / 2)})`,\n            top: '50%',\n            transform: 'translate(-50%, -50%)',\n            textAlign: 'center',\n        }}\n        >\n            <Typography variant=\"h3\" gutterBottom>\n                {errorFace}\n            </Typography>\n            <Typography variant=\"h5\">\n                {message}\n            </Typography>\n            {messageExtra}\n        </Box>\n    );\n}\n\nEmptyView.defaultProps = {\n    messageExtra: undefined,\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ninterface IProps {\n    children: React.ReactNode;\n    index: any;\n    currentIndex: any;\n}\n\nexport default function TabPanel(props: IProps) {\n    const {\n        children, index, currentIndex,\n    } = props;\n\n    return (\n        <div\n            role=\"tabpanel\"\n            hidden={index !== currentIndex}\n            id={`simple-tabpanel-${index}`}\n        >\n            {currentIndex === index && children}\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext } from 'react';\n\ntype ContextType = {\n    options: LibraryOptions;\n    setOptions: React.Dispatch<React.SetStateAction<LibraryOptions>>;\n};\n\nexport const DefaultLibraryOptions: LibraryOptions = {\n    showDownloadBadge: false,\n    showUnreadBadge: false,\n    gridLayout: 0,\n    SourcegridLayout: 0,\n\n    downloaded: undefined,\n    sortDesc: undefined,\n    sorts: undefined,\n    unread: undefined,\n};\n\nconst LibraryOptionsContext = React.createContext<ContextType>({\n    options: DefaultLibraryOptions,\n    setOptions: () => {},\n});\n\nexport default LibraryOptionsContext;\n\nexport function useLibraryOptionsContext() {\n    return useContext(LibraryOptionsContext);\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { Checkbox, CheckboxProps, FormControlLabel } from '@mui/material';\nimport React from 'react';\n\ninterface IProps extends CheckboxProps {\n    label?: string\n}\n\nconst CheckboxInput: React.FC<IProps> = ({\n    label, sx, ...rest\n}) => (\n    <FormControlLabel\n        control={(\n            <Checkbox {...rest} />\n        )}\n        label={label}\n        sx={sx}\n    />\n);\n\nexport default CheckboxInput;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { FormControlLabel, Radio, RadioProps } from '@mui/material';\nimport React from 'react';\n\nexport interface RadioInputProps extends RadioProps {\n    label?: string\n}\n\nconst RadioInput: React.FC<RadioInputProps> = ({\n    label, sx, ...rest\n}) => (\n    <FormControlLabel\n        control={(\n            <Radio {...rest} />\n        )}\n        label={label}\n        sx={sx}\n    />\n);\n\nexport default RadioInput;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport ArrowDownward from '@mui/icons-material/ArrowDownward';\nimport ArrowUpward from '@mui/icons-material/ArrowUpward';\nimport React from 'react';\nimport RadioInput, { RadioInputProps } from './RadioInput';\n\ninterface IProps extends RadioInputProps {\n    sortDescending?: boolean | null | undefined\n}\n\nconst SortRadioInput: React.FC<IProps> = ({\n    sortDescending, ...rest\n}) => (\n    <RadioInput\n        checkedIcon={sortDescending ? <ArrowDownward color=\"primary\" /> : <ArrowUpward color=\"primary\" />}\n        {...rest}\n    />\n);\n\nexport default SortRadioInput;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { DisabledByDefaultRounded } from '@mui/icons-material';\nimport { Checkbox, CheckboxProps } from '@mui/material';\nimport React, { useCallback } from 'react';\n\ntype CheckState = boolean | undefined | null;\n\nfunction nextState(state: CheckState): CheckState {\n    if (state === true) return false;\n    if (state === false) return undefined;\n    return true;\n}\n\nexport interface ThreeStateCheckboxProps extends Omit<CheckboxProps, 'checked' | 'onChange'> {\n    checked?: boolean | undefined | null\n    onChange?: (checked: boolean | undefined | null) => void\n}\n\n/**\n * When checked is true, checkbox contains checkmark\n * When checked is false, checkbox contains cross\n * When checked is null or undefined, checkbox is empty\n */\nconst ThreeStateCheckbox: React.FC<ThreeStateCheckboxProps> = ({ checked, onChange, ...rest }) => {\n    const handleChange = useCallback(() => {\n        if (onChange) {\n            const newState = nextState(checked);\n            onChange(newState);\n        }\n    }, [onChange]);\n\n    return (\n        <Checkbox\n            indeterminateIcon={<DisabledByDefaultRounded />}\n            checked={checked === true}\n            indeterminate={checked === false}\n            onChange={handleChange}\n            {...rest}\n        />\n    );\n};\nexport default ThreeStateCheckbox;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { FormControlLabel } from '@mui/material';\nimport React from 'react';\nimport ThreeStateCheckbox, { ThreeStateCheckboxProps } from './ThreeStateCheckbox';\n\ninterface IProps extends ThreeStateCheckboxProps {\n    label?: string\n}\n\nconst ThreeStateCheckboxInput: React.FC<IProps> = ({\n    label, sx, ...rest\n}) => (\n    <FormControlLabel\n        control={(\n            <ThreeStateCheckbox {...rest} />\n        )}\n        label={label}\n        sx={sx}\n    />\n);\n\nexport default ThreeStateCheckboxInput;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport {\n    Drawer,\n} from '@mui/material';\nimport { Box } from '@mui/system';\nimport React from 'react';\n\ninterface IProps {\n    open: boolean\n    onClose: () => void\n    children: React.ReactNode\n    minHeight?: number\n}\n\nconst OptionsPanel: React.FC<IProps> = ({\n    open, onClose, children, minHeight,\n}) => (\n    <Drawer\n        anchor=\"bottom\"\n        open={open}\n        onClose={onClose}\n        PaperProps={{\n            style: {\n                maxWidth: 600,\n                marginLeft: 'auto',\n                marginRight: 'auto',\n                minHeight,\n            },\n        }}\n    >\n        <Box>\n            {children}\n        </Box>\n    </Drawer>\n);\n\nOptionsPanel.defaultProps = {\n    minHeight: undefined,\n};\n\nexport default OptionsPanel;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Stack, Tab, Tabs } from '@mui/material';\nimport TabPanel from 'components/util/TabPanel';\nimport React, { useState } from 'react';\nimport OptionsPanel from './OptionsPanel';\n\ninterface IProps<T = string>{\n    open: boolean\n    onClose: () => void\n    tabs: T[]\n    tabTitle: (key: T) => React.ReactNode\n    tabContent: (key: T) => React.ReactNode\n    minHeight?: number\n}\n\nconst OptionsTabs = <T extends string = string>({\n    open, onClose, tabs, tabTitle, tabContent, minHeight,\n}: IProps<T>) => {\n    const [tabNum, setTabNum] = useState(0);\n\n    return (\n        <OptionsPanel\n            open={open}\n            onClose={onClose}\n            minHeight={minHeight}\n        >\n            <Tabs\n                value={tabNum}\n                variant=\"fullWidth\"\n                onChange={(e, newTab) => setTabNum(newTab)}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n            >\n                {tabs.map((tab, tabIndex) => (\n                    <Tab key={tab} value={tabIndex} label={tabTitle(tab)} />\n                ))}\n            </Tabs>\n            {tabs.map((tab, tabIndex) => (\n                <TabPanel key={tab} index={tabIndex} currentIndex={tabNum}>\n                    <Stack sx={{ px: 3, py: 1, minHeight }}>\n                        {tabContent(tab)}\n                    </Stack>\n                </TabPanel>\n            ))}\n        </OptionsPanel>\n    );\n};\n\nOptionsTabs.defaultProps = {\n    minHeight: undefined,\n};\n\nexport default OptionsTabs;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { FormLabel, RadioGroup } from '@mui/material';\nimport CheckboxInput from 'components/atoms/CheckboxInput';\nimport RadioInput from 'components/atoms/RadioInput';\nimport SortRadioInput from 'components/atoms/SortRadioInput';\nimport ThreeStateCheckboxInput from 'components/atoms/ThreeStateCheckboxInput';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport OptionsTabs from 'components/molecules/OptionsTabs';\nimport React from 'react';\n\nconst TITLES = {\n    filter: 'Filter',\n    sort: 'Sort',\n    display: 'Display',\n};\n\nconst SORT_OPTIONS: [LibrarySortMode, string][] = [\n    ['sortToRead', 'By Unread chapters'],\n    ['sortAlph', 'Alphabetically'],\n    ['sortID', 'By ID'],\n];\n\ninterface IProps {\n    open: boolean,\n    onClose: () => void,\n}\n\nconst LibraryOptionsPanel: React.FC<IProps> = ({ open, onClose }) => {\n    const { options, setOptions } = useLibraryOptionsContext();\n\n    const handleFilterChange = <T extends keyof LibraryOptions>(\n        key: T,\n        value: LibraryOptions[T],\n    ) => {\n        setOptions((v) => ({ ...v, [key]: value }));\n    };\n\n    return (\n        <OptionsTabs<'filter' | 'sort' | 'display'>\n            open={open}\n            onClose={onClose}\n            tabs={['filter', 'sort', 'display']}\n            tabTitle={(key) => TITLES[key]}\n            tabContent={(key) => {\n                if (key === 'filter') {\n                    return (\n                        <>\n                            <ThreeStateCheckboxInput label=\"Unread\" checked={options.unread} onChange={(c) => handleFilterChange('unread', c)} />\n                            <ThreeStateCheckboxInput label=\"Downloaded\" checked={options.downloaded} onChange={(c) => handleFilterChange('downloaded', c)} />\n                        </>\n                    );\n                }\n                if (key === 'sort') {\n                    return SORT_OPTIONS.map(([mode, label]) => (\n                        <SortRadioInput\n                            key={mode}\n                            label={label}\n                            checked={options.sorts === mode}\n                            sortDescending={options.sortDesc}\n                            onClick={() => (mode !== options.sorts\n                                ? handleFilterChange('sorts', mode)\n                                : handleFilterChange('sortDesc', !options.sortDesc))}\n                        />\n                    ));\n                }\n                if (key === 'display') {\n                    const { gridLayout, showDownloadBadge, showUnreadBadge } = options;\n                    return (\n                        <>\n                            <FormLabel>Display mode</FormLabel>\n                            <RadioGroup\n                                onChange={(e) => handleFilterChange('gridLayout', Number(e.target.value))}\n                                value={gridLayout}\n                            >\n                                <RadioInput label=\"Compact grid\" value={0} checked={gridLayout == null || gridLayout === 0} />\n                                <RadioInput label=\"Comfortable grid\" value={1} checked={gridLayout === 1} />\n                                <RadioInput label=\"List\" value={2} checked={gridLayout === 2} />\n                            </RadioGroup>\n\n                            <FormLabel sx={{ mt: 2 }}>Badges</FormLabel>\n                            <CheckboxInput\n                                label=\"Unread Badges\"\n                                checked={showUnreadBadge === true}\n                                onChange={() => handleFilterChange('showUnreadBadge', !showUnreadBadge)}\n                            />\n                            <CheckboxInput\n                                label=\"Download Badges\"\n                                checked={showDownloadBadge === true}\n                                onChange={() => handleFilterChange('showDownloadBadge', !showDownloadBadge)}\n                            />\n                        </>\n                    );\n                }\n                return null;\n            }}\n        />\n    );\n};\n\nexport default LibraryOptionsPanel;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport FilterList from '@mui/icons-material/FilterList';\nimport { IconButton } from '@mui/material';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport React, { useState } from 'react';\nimport LibraryOptionsPanel from './LibraryOptionsPanel';\n\nconst LibraryToolbarMenu: React.FC = () => {\n    const [open, setOpen] = useState(false);\n    const { options } = useLibraryOptionsContext();\n    const active = options.downloaded != null || options.unread != null;\n\n    return (\n        <>\n            <IconButton\n                onClick={() => setOpen(!open)}\n                color={active ? 'warning' : 'default'}\n            >\n                <FilterList />\n            </IconButton>\n            <LibraryOptionsPanel open={open} onClose={() => setOpen(false)} />\n        </>\n    );\n};\n\nexport default LibraryToolbarMenu;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState, CSSProperties } from 'react';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport Box from '@mui/system/Box';\nimport { Theme } from '@mui/system/createTheme';\nimport { SxProps } from '@mui/system/styleFunctionSx';\n\ninterface IProps {\n    src: string\n    alt: string\n\n    imgRef?: React.RefObject<HTMLImageElement>\n\n    spinnerStyle?: SxProps<Theme>\n    imgStyle?: CSSProperties\n\n    onImageLoad?: () => void\n}\n\nexport default function SpinnerImage(props: IProps) {\n    const {\n        src, alt, onImageLoad, imgRef, spinnerStyle, imgStyle,\n    } = props;\n    const [imageSrc, setImagsrc] = useState<string>('');\n\n    useEffect(() => {\n        const img = new Image();\n        img.src = src;\n\n        img.onload = () => {\n            setImagsrc(src);\n            onImageLoad?.();\n        };\n\n        img.onerror = () => {\n            // Setting to an actual image so CSS styling works consistently\n            setImagsrc('/notFound.svg');\n        };\n\n        return () => {\n            img.onload = null;\n            img.onerror = null;\n        };\n    }, [src]);\n\n    if (imageSrc.length === 0) {\n        return (\n            <Box sx={spinnerStyle}>\n                <CircularProgress thickness={5} />\n            </Box>\n        );\n    }\n\n    if (imageSrc === 'Not Found') {\n        return <Box sx={spinnerStyle} />;\n    }\n\n    return (\n        <img\n            style={imgStyle}\n            ref={imgRef}\n            src={imageSrc}\n            alt={alt}\n        />\n    );\n}\n\nSpinnerImage.defaultProps = {\n    spinnerStyle: {},\n    imgStyle: {},\n    onImageLoad: () => {},\n    imgRef: undefined,\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport Card from '@mui/material/Card';\nimport CardActionArea from '@mui/material/CardActionArea';\nimport Typography from '@mui/material/Typography';\nimport { Link } from 'react-router-dom';\nimport { Avatar, CardContent, Grid } from '@mui/material';\nimport useLocalStorage from 'util/useLocalStorage';\nimport SpinnerImage from 'components/util/SpinnerImage';\nimport { Box, styled } from '@mui/system';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport { BACK } from 'util/useBackTo';\n\nconst BottomGradient = styled('div')({\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: '30%',\n    background: 'linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%)',\n});\n\nconst BottomGradientDoubledDown = styled('div')({\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: '20%',\n    background: 'linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%)',\n});\n\nconst MangaTitle = styled(Typography)({\n    position: 'absolute',\n    bottom: 0,\n    padding: '0.5em',\n    color: 'white',\n    fontSize: '1.05rem',\n    textShadow: '0px 0px 3px #000000',\n});\n\nconst BadgeContainer = styled('div')({\n    display: 'flex',\n    position: 'absolute',\n    top: 5,\n    left: 5,\n    height: 'fit-content',\n    borderRadius: '5px',\n    overflow: 'hidden',\n    '& p': {\n        color: 'white',\n        padding: '0.1em',\n        paddingInline: '0.2em',\n        fontSize: '1.05rem',\n    },\n});\n\nconst truncateText = (str: string, maxLength: number) => {\n    const ending = '...';\n    // trim the string to the maximum length\n    const trimmedString = str.substr(0, maxLength - ending.length);\n\n    if (trimmedString.length < str.length) {\n        return trimmedString + ending;\n    }\n    return str;\n};\n\ninterface IProps {\n    manga: IMangaCard\n    gridLayout: number | undefined\n    dimensions: number\n    inLibraryIndicator?: boolean\n}\nconst MangaCard = React.forwardRef<HTMLDivElement, IProps>((props: IProps, ref) => {\n    const {\n        manga: {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            id, title, thumbnailUrl, downloadCount, unreadCount: unread, inLibrary,\n        },\n        gridLayout,\n        dimensions,\n        inLibraryIndicator,\n    } = props;\n    const { options: { showUnreadBadge, showDownloadBadge } } = useLibraryOptionsContext();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n    const [ItemWidth] = useLocalStorage<number>('ItemWidth', 300);\n\n    const mangaLinkTo = { pathname: `/manga/${id}/`, state: { backLink: BACK } };\n\n    if (gridLayout !== 2) {\n        const colomns = Math.round(dimensions / ItemWidth);\n        return (\n            // @ts-ignore gridsize type isnt allowed to be a decimal but it works fine\n            <Grid item xs={12 / colomns} sm={12 / colomns} md={12 / colomns} lg={12 / colomns}>\n                <Link to={mangaLinkTo} style={(gridLayout === 1) ? { textDecoration: 'none' } : {}}>\n                    <Box\n                        sx={{\n                            display: 'flex',\n                            flexDirection: 'column',\n                        }}\n                    >\n                        <Card\n                            sx={{\n                            // force standard aspect ratio of manga covers\n                                aspectRatio: '225/350',\n                                display: 'flex',\n                            }}\n                            ref={ref}\n                        >\n                            <CardActionArea\n                                sx={{\n                                    position: 'relative',\n                                    height: '100%',\n                                }}\n                            >\n\n                                <BadgeContainer>\n                                    {inLibraryIndicator && inLibrary && (\n                                        <Typography\n                                            sx={{ backgroundColor: 'primary.dark', zIndex: '1' }}\n                                        >\n                                            In library\n                                        </Typography>\n                                    )}\n                                    { showUnreadBadge && unread! > 0 && (\n                                        <Typography\n                                            sx={{ backgroundColor: 'primary.dark' }}\n                                        >\n                                            {unread}\n                                        </Typography>\n                                    )}\n                                    { showDownloadBadge && downloadCount! > 0 && (\n                                        <Typography sx={{\n                                            backgroundColor: 'success.dark',\n                                        }}\n                                        >\n                                            {downloadCount}\n                                        </Typography>\n                                    )}\n                                </BadgeContainer>\n                                <SpinnerImage\n                                    alt={title}\n                                    src={`${serverAddress}${thumbnailUrl}?useCache=${useCache}`}\n                                    imgStyle={inLibraryIndicator && inLibrary\n                                        ? {\n                                            height: '100%',\n                                            width: '100%',\n                                            objectFit: 'cover',\n                                            filter: 'brightness(0.4)',\n                                        }\n                                        : {\n                                            height: '100%',\n                                            width: '100%',\n                                            objectFit: 'cover',\n                                        }}\n                                    spinnerStyle={{\n                                        display: 'grid',\n                                        placeItems: 'center',\n                                    }}\n                                />\n                                {(gridLayout === 1) ? (<></>) : (\n                                    <>\n                                        <BottomGradient />\n                                        <BottomGradientDoubledDown />\n                                    </>\n                                )}\n                                {(gridLayout === 1) ? (\n                                    <></>\n                                ) : (\n                                    <MangaTitle>\n                                        {truncateText(title, 61)}\n                                    </MangaTitle>\n                                )}\n                            </CardActionArea>\n                        </Card>\n                        {(gridLayout === 1) ? (\n                            <MangaTitle\n                                sx={{\n                                    position: 'relative',\n                                }}\n                            >\n                                {truncateText(title, 61)}\n                            </MangaTitle>\n                        ) : (<></>)}\n                    </Box>\n                </Link>\n            </Grid>\n        );\n    }\n    return (\n        <Grid item xs={12} sm={12} md={12} lg={12}>\n            <Link to={mangaLinkTo} style={{ textDecoration: 'none', color: 'unset' }}>\n                <CardContent sx={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    padding: 2,\n                    '&:hover': {\n                        backgroundColor: 'action.hover',\n                        transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                    },\n                    '&:active': {\n                        backgroundColor: 'action.selected',\n                        transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                    },\n                    position: 'relative',\n                }}\n                >\n                    <Avatar\n                        variant=\"rounded\"\n                        sx={inLibrary\n                            ? {\n                                width: 56,\n                                height: 56,\n                                flex: '0 0 auto',\n                                marginRight: 2,\n                                imageRendering: 'pixelated',\n                                filter: 'brightness(0.4)',\n                            }\n                            : {\n                                width: 56,\n                                height: 56,\n                                flex: '0 0 auto',\n                                marginRight: 2,\n                                imageRendering: 'pixelated',\n                            }}\n                        src={`${serverAddress}${thumbnailUrl}?useCache=${useCache}`}\n                    />\n                    <Box\n                        sx={{\n                            display: 'flex',\n                            flexDirection: 'row',\n                            flexGrow: 1,\n                            width: 'min-content',\n                        }}\n                    >\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {truncateText(title, 61)}\n                        </Typography>\n                    </Box>\n                    <BadgeContainer sx={{ position: 'relative' }}>\n                        {inLibrary && (\n                            <Typography\n                                sx={{ backgroundColor: 'primary.dark', zIndex: '1' }}\n                            >\n                                In library\n                            </Typography>\n                        )}\n                        { showUnreadBadge && unread! > 0 && (\n                            <Typography\n                                sx={{ backgroundColor: 'primary.dark' }}\n                            >\n                                {unread}\n                            </Typography>\n                        )}\n                        { showDownloadBadge && downloadCount! > 0 && (\n                            <Typography sx={{\n                                backgroundColor: 'success.dark',\n                            }}\n                            >\n                                {downloadCount}\n                            </Typography>\n                        )}\n                    </BadgeContainer>\n                </CardContent>\n            </Link>\n        </Grid>\n    );\n});\n\nexport default MangaCard;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, {\n    useEffect, useLayoutEffect, useRef, useState,\n} from 'react';\nimport Grid from '@mui/material/Grid';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport { Typography } from '@mui/material';\nimport { Box } from '@mui/system';\nimport MangaCard from './MangaCard';\n\nexport interface IMangaGridProps{\n    mangas: IMangaCard[]\n    isLoading: boolean\n    message?: string\n    messageExtra?: JSX.Element\n    hasNextPage: boolean\n    lastPageNum: number\n    setLastPageNum: (lastPageNum: number) => void\n    gridLayout?: number | undefined\n    horisontal?: boolean | undefined\n    noFaces?: boolean | undefined\n    inLibraryIndicator?: boolean\n}\n\nconst MangaGrid: React.FC<IMangaGridProps> = (props) => {\n    const {\n        mangas, isLoading, message, messageExtra,\n        hasNextPage, lastPageNum, setLastPageNum, gridLayout, horisontal, noFaces,\n        inLibraryIndicator,\n    } = props;\n    let mapped;\n    const lastManga = useRef<HTMLDivElement>(null);\n\n    const scrollHandler = () => {\n        if (lastManga.current) {\n            const rect = lastManga.current.getBoundingClientRect();\n            if (((rect.y + rect.height) / window.innerHeight < 2) && hasNextPage) {\n                setLastPageNum(lastPageNum + 1);\n            }\n        }\n    };\n    useEffect(() => {\n        window.addEventListener('scroll', scrollHandler, true);\n        return () => {\n            window.removeEventListener('scroll', scrollHandler, true);\n        };\n    }, [hasNextPage, mangas]);\n\n    const [dimensions, setDimensions] = useState(1);\n\n    const gridRef = useRef<HTMLDivElement>(null);\n\n    const TestDimensions = () => {\n        setDimensions(gridRef.current ? gridRef.current.offsetWidth : 0);\n    };\n\n    useLayoutEffect(TestDimensions, []);\n\n    let movementTimer: NodeJS.Timeout;\n\n    window.addEventListener('resize', () => {\n        clearInterval(movementTimer);\n        movementTimer = setTimeout(TestDimensions, 100);\n    });\n\n    if (mangas.length === 0) {\n        if (isLoading) {\n            mapped = (\n                <LoadingPlaceholder />\n            );\n        } else {\n            mapped = noFaces ? (\n                <Box\n                    sx={{\n                        margin: 'auto',\n                    }}\n                >\n                    <Typography variant=\"h5\">\n                        {message}\n                    </Typography>\n                    {messageExtra}\n                </Box>\n            ) : (\n                <EmptyView message={message!} messageExtra={messageExtra} />\n            );\n        }\n    } else {\n        mapped = mangas.map((it, idx) => (\n            <MangaCard\n                key={it.id}\n                manga={it}\n                ref={idx === mangas.length - 1 ? lastManga : undefined}\n                gridLayout={gridLayout}\n                dimensions={dimensions}\n                inLibraryIndicator={inLibraryIndicator}\n            />\n        ));\n    }\n\n    return (\n        <div ref={gridRef}>\n            <Grid\n                container\n                spacing={1}\n                style={horisontal ? {\n                    margin: 0,\n                    width: '100%',\n                    padding: '5px',\n                    overflowX: 'scroll',\n                    display: '-webkit-inline-box',\n                    flexWrap: 'nowrap',\n                } : {\n                    margin: 0,\n                    width: '100%',\n                    padding: '5px',\n                }}\n            >\n                {mapped}\n            </Grid>\n        </div>\n    );\n};\n\nMangaGrid.defaultProps = {\n    message: '',\n    messageExtra: undefined,\n};\n\nexport default MangaGrid;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React, { useMemo } from 'react';\nimport MangaGrid, { IMangaGridProps } from 'components/MangaGrid';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport { StringParam, useQueryParam } from 'use-query-params';\n\nconst FILTERED_OUT_MESSAGE = 'There are no Manga matching this filter';\n\nconst unreadFilter = (unread: NullAndUndefined<boolean>, { unreadCount }: IMangaCard): boolean => {\n    switch (unread) {\n        case true:\n            return !!unreadCount && unreadCount >= 1;\n        case false:\n            return unreadCount === 0;\n        default:\n            return true;\n    }\n};\n\nconst downloadedFilter = (downloaded: NullAndUndefined<boolean>,\n    { downloadCount }: IMangaCard): boolean => {\n    switch (downloaded) {\n        case true:\n            return !!downloadCount && downloadCount >= 1;\n        case false:\n            return downloadCount === 0;\n        default:\n            return true;\n    }\n};\n\nconst queryFilter = (query: NullAndUndefined<string>, { title }: IMangaCard): boolean => {\n    if (!query) return true;\n    return title.toLowerCase().includes(query.toLowerCase());\n};\n\nconst filterManga = (\n    manga: IMangaCard[],\n    query: NullAndUndefined<string>,\n    unread: NullAndUndefined<boolean>,\n    downloaded: NullAndUndefined<boolean>,\n): IMangaCard[] => manga.filter((m) => downloadedFilter(downloaded, m)\n        && unreadFilter(unread, m)\n        && queryFilter(query, m));\n\nconst sortByUnread = (a: IMangaCard, b: IMangaCard): number =>\n    // eslint-disable-next-line implicit-arrow-linebreak\n    (a.unreadCount ?? 0) - (b.unreadCount ?? 0);\n\nconst sortByTitle = (a: IMangaCard, b: IMangaCard): number => a.title.localeCompare(b.title);\n\nconst sortById = (a: IMangaCard, b: IMangaCard): number => a.id - b.id;\n\nconst sortManga = (\n    manga: IMangaCard[],\n    sort: NullAndUndefined<LibrarySortMode>,\n    desc: NullAndUndefined<boolean>,\n): IMangaCard[] => {\n    const result = [...manga];\n\n    switch (sort) {\n        case 'sortAlph': result.sort(sortByTitle); break;\n        case 'sortID': result.sort(sortById); break;\n        case 'sortToRead': result.sort(sortByUnread); break;\n        default: break;\n    }\n\n    if (desc === true) {\n        result.reverse();\n    }\n\n    return result;\n};\n\nconst LibraryMangaGrid: React.FC<IMangaGridProps> = ({\n    mangas, isLoading, hasNextPage, lastPageNum, setLastPageNum, message,\n}) => {\n    const [query] = useQueryParam('query', StringParam);\n    const { options } = useLibraryOptionsContext();\n    const { unread, downloaded } = options;\n\n    const sortedManga = useMemo(() => sortManga(mangas, options.sorts, options.sortDesc),\n        [mangas, options.sorts, options.sortDesc]);\n\n    const filteredManga = useMemo(() => filterManga(sortedManga, query, unread, downloaded),\n        [sortedManga, query, unread, downloaded]);\n\n    const showFilteredOutMessage = (unread != null || downloaded != null || query)\n        && filteredManga.length === 0 && mangas.length > 0;\n\n    return (\n        <MangaGrid\n            mangas={filteredManga}\n            isLoading={isLoading}\n            hasNextPage={hasNextPage}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n            message={showFilteredOutMessage ? FILTERED_OUT_MESSAGE : message}\n            gridLayout={options.gridLayout}\n        />\n    );\n};\n\nexport default LibraryMangaGrid;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { IconButton, Input } from '@mui/material';\nimport CancelIcon from '@mui/icons-material/Cancel';\nimport { useQueryParam, StringParam } from 'use-query-params';\n\ninterface IProps {\n    autoOpen?: boolean\n}\n\nconst defaultProps = {\n    autoOpen: false,\n};\n\nconst AppbarSearch: React.FunctionComponent<IProps> = (props) => {\n    const { autoOpen } = props;\n    const [query, setQuery] = useQueryParam('query', StringParam);\n    const [searchOpen, setSearchOpen] = useState(!!query);\n    const inputRef = React.useRef<HTMLInputElement>();\n\n    function handleChange(e: React.ChangeEvent<HTMLInputElement>) {\n        setQuery(e.target.value === '' ? undefined : e.target.value);\n    }\n    const cancelSearch = () => {\n        setQuery(null);\n        setSearchOpen(false);\n    };\n    const handleBlur = () => { if (!query) setSearchOpen(false); };\n    const openSearch = () => {\n        setSearchOpen(true);\n        // Put Focus Action at the end of the Callstack so Input actually exists on the dom\n        setTimeout(() => {\n            if (inputRef && inputRef.current) inputRef.current.focus();\n        });\n    };\n\n    const handleSearchShortcut = (e: KeyboardEvent) => {\n        if ((e.code === 'F3') || (e.ctrlKey && e.code === 'KeyF')) {\n            e.preventDefault();\n            openSearch();\n        }\n    };\n\n    useEffect(() => {\n        if (autoOpen) {\n            openSearch();\n        }\n    }, []);\n\n    useEffect(() => {\n        window.addEventListener('keydown', handleSearchShortcut);\n\n        return () => {\n            window.removeEventListener('keydown', handleSearchShortcut);\n        };\n    }, [handleSearchShortcut]);\n\n    return (\n        <>\n            {searchOpen\n                ? (\n                    <Input\n                        value={query || ''}\n                        onChange={handleChange}\n                        onBlur={handleBlur}\n                        inputRef={inputRef}\n                        endAdornment={(\n                            <IconButton\n                                onClick={cancelSearch}\n                            >\n                                <CancelIcon />\n                            </IconButton>\n                        )}\n                    />\n                ) : (\n                    <IconButton onClick={openSearch}>\n                        <SearchIcon />\n                    </IconButton>\n                )}\n        </>\n    );\n};\n\nAppbarSearch.defaultProps = defaultProps;\n\nexport default AppbarSearch;\n","import React, { useEffect, useState } from 'react';\nimport IconButton from '@mui/material/IconButton';\nimport RefreshIcon from '@mui/icons-material/Refresh';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport { Box } from '@mui/system';\nimport Typography from '@mui/material/Typography';\nimport client from 'util/client';\nimport makeToast from '../util/Toast';\n\ninterface IProgressProps {\n    progress: number\n}\n\nfunction Progress({ progress }: IProgressProps) {\n    return (\n        <Box sx={{ display: 'grid', placeItems: 'center', position: 'relative' }}>\n            <CircularProgress variant=\"determinate\" value={progress} />\n            <Box sx={{ position: 'absolute' }}>\n                <Typography fontSize=\"0.8rem\">\n                    {`${Math.round(progress)}%`}\n                </Typography>\n            </Box>\n        </Box>\n\n    );\n}\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\n\nfunction UpdateChecker() {\n    const [loading, setLoading] = useState(false);\n    const [progress, setProgress] = useState(0);\n\n    const onClick = async () => {\n        try {\n            setLoading(true);\n            setProgress(0);\n            await client.post('/api/v1/update/fetch');\n        } catch (e) {\n            makeToast('Checking for updates failed!', 'error');\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/update`);\n        wsc.onmessage = (e) => {\n            const data = JSON.parse(e.data) as IUpdateStatus;\n            const { COMPLETE, RUNNING, PENDING } = data.statusMap;\n\n            setLoading(data.running);\n            const currentProgress = 100 * (COMPLETE / (COMPLETE + RUNNING + PENDING));\n\n            setProgress(Number.isNaN(currentProgress) ? 0 : currentProgress);\n        };\n\n        return () => wsc.close();\n    }, []);\n\n    return (\n        <IconButton onClick={onClick} disabled={loading}>\n            {loading ? <Progress progress={progress} /> : <RefreshIcon />}\n        </IconButton>\n    );\n}\n\nexport default UpdateChecker;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Tab, Tabs } from '@mui/material';\nimport React, {\n    useContext, useEffect, useState,\n} from 'react';\nimport NavbarContext from 'components/context/NavbarContext';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport TabPanel from 'components/util/TabPanel';\nimport LibraryToolbarMenu from 'components/library/LibraryToolbarMenu';\nimport LibraryMangaGrid from 'components/library/LibraryMangaGrid';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport { useQueryParam, NumberParam } from 'use-query-params';\nimport { useQuery } from 'util/client';\nimport UpdateChecker from '../components/library/UpdateChecker';\n\nexport default function Library() {\n    const { data: tabsData, error: tabsError, loading } = useQuery<ICategory[]>('/api/v1/category');\n    const tabs = tabsData ?? [];\n\n    const [tabSearchParam, setTabSearchParam] = useQueryParam('tab', NumberParam);\n\n    const activeTab = tabs.find((t) => t.order === tabSearchParam) ?? tabs[0];\n    const {\n        data: mangaData,\n        error: mangaError,\n        loading: mangaLoading,\n    } = useQuery<IManga[]>(`/api/v1/category/${activeTab?.id}`, {\n        isPaused: () => activeTab == null,\n    });\n    const mangas = mangaData ?? [];\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => {\n        setTitle('Library');\n        setAction(\n            <>\n                <AppbarSearch />\n                <LibraryToolbarMenu />\n                <UpdateChecker />\n            </>,\n        );\n        return () => {\n            setTitle('');\n            setAction(<></>);\n        };\n    }, []);\n\n    // a hack so MangaGrid doesn't stop working. I won't change it in case\n    // if I do manga pagination for library..\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n\n    const handleTabChange = (newTab: number) => {\n        setTabSearchParam(newTab === 0 ? undefined : newTab);\n    };\n\n    if (tabsError != null) {\n        return <EmptyView message=\"Could not load categories\" messageExtra={tabsError?.message ?? tabsError} />;\n    }\n\n    if (loading) {\n        return <LoadingPlaceholder />;\n    }\n\n    if (tabs.length === 0) {\n        return <EmptyView message=\"Your Library is empty\" />;\n    }\n\n    if (tabs.length === 1) {\n        return (\n            <LibraryMangaGrid\n                mangas={mangas}\n                hasNextPage={false}\n                lastPageNum={lastPageNum}\n                setLastPageNum={setLastPageNum}\n                message=\"Your Library is empty\"\n                isLoading={activeTab != null && mangaLoading}\n            />\n        );\n    }\n\n    // Visual Hack: 160px is min-width for viewport width of >600\n    const scrollableTabs = window.innerWidth < tabs.length * 160;\n\n    return (\n        <>\n            <Tabs\n                key={activeTab.order}\n                value={activeTab.order}\n                onChange={(e, newTab) => handleTabChange(newTab)}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                centered={!scrollableTabs}\n                variant={scrollableTabs ? 'scrollable' : 'fullWidth'}\n                scrollButtons\n                allowScrollButtonsMobile\n            >\n                {tabs.map((tab) => (\n                    <Tab key={tab.id} label={tab.name} value={tab.order} />\n                ))}\n            </Tabs>\n            {tabs.map((tab) => (\n                <TabPanel key={tab.order} index={tab.order} currentIndex={activeTab.order}>\n                    {tab === activeTab && (mangaError\n                        ? (\n                            <EmptyView message=\"Could not load manga\" messageExtra={mangaError?.message ?? mangaError} />\n                        )\n                        : (\n                            <LibraryMangaGrid\n                                mangas={mangas}\n                                hasNextPage={false}\n                                lastPageNum={lastPageNum}\n                                setLastPageNum={setLastPageNum}\n                                message=\"Category is Empty\"\n                                isLoading={mangaLoading}\n                            />\n                        ))}\n                </TabPanel>\n            ))}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Switch from '@mui/material/Switch';\nimport Checkbox from '@mui/material/Checkbox';\n\nfunction getTwoStateType(type: 'Checkbox' | 'Switch') {\n    if (type === 'Switch') { return Switch; }\n    return Checkbox;\n}\n\nfunction TwoSatePreference(props: TwoStatePreferenceProps) {\n    const {\n        title, summary, currentValue, updateValue, type,\n    } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<boolean>(currentValue);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    return (\n        <ListItem>\n            <ListItemText primary={title} secondary={summary} />\n            <ListItemSecondaryAction>\n                {React.createElement(getTwoStateType(type),\n                    {\n                        edge: 'end',\n                        checked: internalCurrentValue,\n                        onChange: () => {\n                            updateValue(!currentValue);\n\n                            // appear smooth\n                            setInternalCurrentValue(!currentValue);\n                        },\n                    })}\n            </ListItemSecondaryAction>\n        </ListItem>\n    );\n}\n\nexport function CheckBoxPreference(props: CheckBoxPreferenceProps) {\n    return <TwoSatePreference {...props} type=\"Checkbox\" />;\n}\nexport function SwitchPreferenceCompat(props: SwitchPreferenceCompatProps) {\n    return <TwoSatePreference {...props} type=\"Switch\" />;\n}\n\nexport default { CheckBoxPreference, SwitchPreferenceCompat };\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport RadioGroup from '@mui/material/RadioGroup';\nimport Radio from '@mui/material/Radio';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Button from '@mui/material/Button';\n\ninterface IListDialogProps{\n    value: string\n    open: boolean\n    onClose: (arg0: string | null) => void\n    options: string[]\n    title: string\n}\n\nfunction ListDialog(props: IListDialogProps) {\n    const {\n        value: valueProp, open, onClose, options, title,\n    } = props;\n    const [value, setValue] = React.useState(valueProp);\n    const radioGroupRef = React.useRef<HTMLDivElement>(null);\n\n    React.useEffect(() => {\n        if (!open) {\n            setValue(valueProp);\n        }\n    }, [valueProp, open]);\n\n    const handleEntering = () => {\n        if (radioGroupRef.current != null) {\n            radioGroupRef?.current.focus();\n        }\n    };\n\n    const handleCancel = () => {\n        onClose(null);\n    };\n\n    const handleOk = () => {\n        onClose(value);\n    };\n\n    const handleChange = (event: any) => {\n        setValue(event.target.value);\n    };\n\n    return (\n        <Dialog\n            sx={{ '& .MuiDialog-paper': { width: '80%', maxHeight: 435 } }}\n            maxWidth=\"xs\"\n            TransitionProps={{ onEntering: handleEntering }}\n            open={open}\n        >\n            <DialogTitle>{title}</DialogTitle>\n            <DialogContent dividers>\n                <RadioGroup\n                    ref={radioGroupRef}\n                    value={value}\n                    onChange={handleChange}\n                >\n                    {options.map((option) => (\n                        <FormControlLabel\n                            value={option}\n                            key={option}\n                            control={<Radio />}\n                            label={option}\n                        />\n                    ))}\n                </RadioGroup>\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel}>\n                    Cancel\n                </Button>\n                <Button onClick={handleOk}>Ok</Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n\nexport default function ListPreference(props: ListPreferenceProps) {\n    const {\n        title, summary, currentValue, updateValue, entryValues, entries,\n    } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    const findEntryOf = (value: string) => {\n        const idx = entryValues.indexOf(value);\n        return entries[idx];\n    };\n\n    const findEntryValueOf = (value: string) => {\n        const idx = entries.indexOf(value);\n        return entryValues[idx];\n    };\n\n    const getSummary = () => {\n        if (summary === '%s') {\n            return findEntryOf(currentValue);\n        }\n        return summary;\n    };\n\n    const handleDialogClose = (newValue: string | null) => {\n        if (newValue !== null) {\n            updateValue(findEntryValueOf(newValue));\n\n            // appear smooth\n            setInternalCurrentValue(newValue);\n        }\n\n        setDialogOpen(false);\n    };\n\n    return (\n        <>\n            <ListItem\n                button\n                onClick={() => setDialogOpen(true)}\n            >\n                <ListItemText primary={title} secondary={getSummary()} />\n            </ListItem>\n            <ListDialog\n                title={title}\n                open={dialogOpen}\n                onClose={handleDialogClose}\n                value={findEntryOf(internalCurrentValue)}\n                options={entries}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport DialogActions from '@mui/material/DialogActions';\nimport TextField from '@mui/material/TextField';\nimport Button from '@mui/material/Button';\n\nexport default function EditTextPreference(props: EditTextPreferenceProps) {\n    const {\n        title, summary, dialogTitle, dialogMessage, currentValue, updateValue,\n    } = props;\n\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n\n        // reset the dialog\n        setInternalCurrentValue(currentValue);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n\n        updateValue(internalCurrentValue);\n    };\n\n    return (\n        <>\n            <ListItem\n                button\n                onClick={() => setDialogOpen(true)}\n            >\n                <ListItemText\n                    primary={title}\n                    secondary={summary}\n                />\n            </ListItem>\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogTitle>\n                    {dialogTitle}\n                </DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        {dialogMessage}\n                    </DialogContentText>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        type=\"text\"\n                        fullWidth\n                        value={internalCurrentValue}\n                        onChange={(e) => setInternalCurrentValue(e.target.value)}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        OK\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport default function cloneObject<T extends object>(obj: T) {\n    return JSON.parse(JSON.stringify(obj)) as T;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport FormGroup from '@mui/material/FormGroup';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Button from '@mui/material/Button';\nimport cloneObject from 'util/cloneObject';\n\ninterface IListDialogProps{\n    selectedValues: string[]\n    open: boolean\n    onClose: (arg0: string[] | null) => void\n    values: string[]\n    title: string\n}\n\nfunction ListDialog(props: IListDialogProps) {\n    const {\n        selectedValues: selectedValuesProp, open, onClose, values, title,\n    } = props;\n    const [selectedValues, setSelectedValues] = React.useState(selectedValuesProp);\n\n    React.useEffect(() => {\n        if (!open) {\n            setSelectedValues(selectedValuesProp);\n        }\n    }, [selectedValuesProp, open]);\n\n    const handleCancel = () => {\n        onClose(null);\n    };\n\n    const handleOk = () => {\n        onClose(selectedValues);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, value: string) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        const hasEntry = selectedValues.some((selectedValue) => value === selectedValue);\n        if (checked) {\n            if (!hasEntry) {\n                const selectedValuesClone = cloneObject(selectedValues) as string[];\n                selectedValuesClone.push(value);\n                setSelectedValues(selectedValuesClone);\n            }\n        } else if (hasEntry) { // not checked and has entry\n            const selectedValuesClone = cloneObject(selectedValues) as string[];\n            const index = selectedValuesClone.indexOf(value);\n            selectedValuesClone.splice(index, 1);\n            setSelectedValues(selectedValuesClone);\n        }\n    };\n\n    return (\n        <Dialog\n            sx={{ '& .MuiDialog-paper': { width: '80%', maxHeight: 435 } }}\n            maxWidth=\"xs\"\n            open={open}\n        >\n            <DialogTitle>{title}</DialogTitle>\n            <DialogContent dividers>\n                <FormGroup>\n                    {values.map((value) => (\n                        <FormControlLabel\n                            control={(\n                                <Checkbox\n                                    checked={selectedValues.some(\n                                        (selectedValue) => value === selectedValue,\n                                    )}\n                                    onChange={(e) => handleChange(e, value)}\n                                    color=\"default\"\n                                />\n                            )}\n                            label={value}\n                            key={value}\n                        />\n                    ))}\n                </FormGroup>\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel}>\n                    Cancel\n                </Button>\n                <Button onClick={handleOk}>Ok</Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n\nexport default function MultiSelectListPreference(props: MultiSelectListPreferenceProps) {\n    const {\n        title, summary, currentValue, updateValue, entryValues, entries,\n    } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string[]>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    const findEntriesOf = (values: string[]) => values.map((value) => {\n        const idx = entryValues.indexOf(value);\n        return entries[idx];\n    });\n\n    const findEntryValuesOf = (values: string[]) => values.map((value) => {\n        const idx = entries.indexOf(value);\n        return entryValues[idx];\n    });\n\n    const getSummary = () => summary;\n\n    const handleDialogClose = (newValue: string[] | null) => {\n        if (newValue !== null) {\n            // console.log(newValue);\n            updateValue(findEntryValuesOf(newValue));\n\n            // appear smooth\n            setInternalCurrentValue(newValue);\n        }\n\n        setDialogOpen(false);\n    };\n\n    return (\n        <>\n            <ListItem\n                button\n                onClick={() => setDialogOpen(true)}\n            >\n                <ListItemText primary={title} secondary={getSummary()} />\n            </ListItem>\n            <ListDialog\n                title={title}\n                open={dialogOpen}\n                onClose={handleDialogClose}\n                selectedValues={findEntriesOf(internalCurrentValue)}\n                values={entries}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\nimport NavbarContext from 'components/context/NavbarContext';\nimport { useParams } from 'react-router-dom';\nimport client, { useQuery } from 'util/client';\nimport { SwitchPreferenceCompat, CheckBoxPreference } from 'components/sourceConfiguration/TwoStatePreference';\nimport ListPreference from 'components/sourceConfiguration/ListPreference';\nimport EditTextPreference from 'components/sourceConfiguration/EditTextPreference';\nimport MultiSelectListPreference from 'components/sourceConfiguration/MultiSelectListPreference';\nimport List from '@mui/material/List';\nimport cloneObject from 'util/cloneObject';\n\nfunction getPrefComponent(type: string) {\n    switch (type) {\n        case 'CheckBoxPreference':\n            return CheckBoxPreference;\n        case 'SwitchPreferenceCompat':\n            return SwitchPreferenceCompat;\n        case 'ListPreference':\n            return ListPreference;\n        case 'EditTextPreference':\n            return EditTextPreference;\n        case 'MultiSelectListPreference':\n            return MultiSelectListPreference;\n        default:\n            return CheckBoxPreference;\n    }\n}\n\nexport default function SourceConfigure() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    useEffect(() => { setTitle('Source Configuration'); setAction(<></>); }, []);\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const { data: sourcePreferences = [], mutate } = useQuery<SourcePreferences[]>(`/api/v1/source/${sourceId}/preferences`);\n\n    const convertToString = (position: number, value: any): string => {\n        switch (sourcePreferences[position].props.defaultValueType) {\n            case 'Set<String>':\n                return JSON.stringify(value);\n            default:\n                return value.toString();\n        }\n    };\n\n    const updateValue = (position: number) => (\n        (value: any) => {\n            client.post(`/api/v1/source/${sourceId}/preferences`,\n                JSON.stringify({ position, value: convertToString(position, value) }))\n                .then(() => mutate());\n        }\n    );\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                {sourcePreferences.map(\n                    (it, index) => {\n                        const props = cloneObject(it.props);\n                        props.updateValue = updateValue(index);\n                        props.key = index;\n\n                        // TypeScript is dumb in detecting extra props\n                        // @ts-ignore\n                        return React.createElement(getPrefComponent(it.type), props);\n                    },\n                )}\n            </List>\n        </>\n    );\n}\n","import { useEffect, useState } from 'react';\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\n\nconst useSubscription = <T>(path: string, callback?: (newValue: T) => boolean | void) => {\n    const [state, setState] = useState<T | undefined>();\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}${path}`);\n\n        wsc.onmessage = (e) => {\n            const data = JSON.parse(e.data) as T;\n            if (callback) {\n                // If callback is specified, only update state if callback returns true\n                // This is so that useSubscription can be used without causing rerender\n                if (callback(data) === true) {\n                    setState(data);\n                }\n            } else {\n                setState(data);\n            }\n        };\n\n        return () => wsc.close();\n    }, [path]);\n\n    return { data: state };\n};\n\nexport default useSubscription;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport BookmarkIcon from '@mui/icons-material/Bookmark';\nimport BookmarkAdd from '@mui/icons-material/BookmarkAdd';\nimport BookmarkRemove from '@mui/icons-material/BookmarkRemove';\nimport CheckBoxOutlineBlank from '@mui/icons-material/CheckBoxOutlineBlank';\nimport Delete from '@mui/icons-material/Delete';\nimport Done from '@mui/icons-material/Done';\nimport DoneAll from '@mui/icons-material/DoneAll';\nimport Download from '@mui/icons-material/Download';\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\nimport RemoveDone from '@mui/icons-material/RemoveDone';\nimport {\n    LinearProgress,\n    Checkbox, ListItemIcon, ListItemText, Stack,\n} from '@mui/material';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport IconButton from '@mui/material/IconButton';\nimport Menu from '@mui/material/Menu';\nimport MenuItem from '@mui/material/MenuItem';\nimport { useTheme } from '@mui/material/styles';\nimport Typography from '@mui/material/Typography';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport client from 'util/client';\nimport { BACK } from 'util/useBackTo';\n\ninterface IProps{\n    chapter: IChapter\n    triggerChaptersUpdate: () => void\n    downloadChapter: IDownloadChapter | undefined\n    showChapterNumber: boolean\n    onSelect: (selected: boolean) => void\n    selected: boolean | null\n}\n\nconst ChapterCard: React.FC<IProps> = (props: IProps) => {\n    const theme = useTheme();\n\n    const {\n        chapter, triggerChaptersUpdate, downloadChapter: dc, showChapterNumber, onSelect, selected,\n    } = props;\n    const isSelecting = selected !== null;\n\n    const dateStr = chapter.uploadDate && new Date(chapter.uploadDate).toLocaleDateString();\n\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n    const handleMenuClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        // prevent parent tags from getting the event\n        event.stopPropagation();\n        event.preventDefault();\n\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const sendChange = (key: string, value: any) => {\n        handleClose();\n\n        const formData = new FormData();\n        formData.append(key, value);\n        if (key === 'read') { formData.append('lastPageRead', '1'); }\n        client.patch(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`, formData)\n            .then(() => triggerChaptersUpdate());\n    };\n\n    const downloadChapter = () => {\n        client.get(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`);\n        handleClose();\n    };\n\n    const deleteChapter = () => {\n        client.delete(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`)\n            .then(() => triggerChaptersUpdate());\n        handleClose();\n    };\n\n    const handleSelect = () => {\n        onSelect(true);\n        handleClose();\n    };\n\n    const handleClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n        if (isSelecting) {\n            event.preventDefault();\n            event.stopPropagation();\n            onSelect(!selected);\n        }\n    };\n\n    const isDownloaded = chapter.downloaded;\n    const canBeDownloaded = !chapter.downloaded && dc === undefined;\n\n    return (\n        <li>\n            <Card\n                sx={{\n                    position: 'relative',\n                    margin: 1,\n                    ':hover': {\n                        backgroundColor: 'action.hover',\n                        transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                        cursor: 'pointer',\n                    },\n                    ':active': {\n                        backgroundColor: 'action.selected',\n                        transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                    },\n                }}\n            >\n                <Link\n                    to={{ pathname: `/manga/${chapter.mangaId}/chapter/${chapter.index}`, state: { backLink: BACK } }}\n                    style={{\n                        textDecoration: 'none',\n                        color: theme.palette.text[chapter.read ? 'disabled' : 'primary'],\n                    }}\n                    onClick={handleClick}\n                >\n                    <CardContent\n                        sx={{\n                            display: 'flex',\n                            justifyContent: 'space-between',\n                            alignItems: 'center',\n                            padding: 2,\n                            '&:last-child': { pb: 2 },\n                        }}\n                    >\n                        <Stack direction=\"column\" flex={1}>\n                            <Typography variant=\"h5\" component=\"h2\">\n                                {chapter.bookmarked && (\n                                    <BookmarkIcon color=\"primary\" sx={{ mr: 0.5, position: 'relative', top: '0.15em' }} />\n                                )}\n                                { showChapterNumber ? `Chapter ${chapter.chapterNumber}` : chapter.name}\n                            </Typography>\n                            <Typography variant=\"caption\">\n                                {chapter.scanlator}\n                            </Typography>\n                            <Typography variant=\"caption\">\n                                {dateStr}\n                                {isDownloaded && '  Downloaded'}\n                                {dc && `  Downloading (${(dc.progress * 100).toFixed(2)}%)`}\n                            </Typography>\n                        </Stack>\n\n                        {selected === null ? (\n                            <IconButton aria-label=\"more\" onClick={handleMenuClick} size=\"large\">\n                                <MoreVertIcon />\n                            </IconButton>\n                        ) : (\n                            <Checkbox checked={selected} />\n                        )}\n                    </CardContent>\n                </Link>\n                {dc != null && (\n                    <LinearProgress\n                        sx={{\n                            position: 'absolute', bottom: 0, width: '100%', opacity: 0.5,\n                        }}\n                        variant=\"determinate\"\n                        value={dc.progress * 100}\n                        color=\"inherit\"\n                    />\n                )}\n                <Menu\n                    anchorEl={anchorEl}\n                    keepMounted\n                    open={Boolean(anchorEl)}\n                    onClose={handleClose}\n                >\n                    <MenuItem onClick={handleSelect}>\n                        <ListItemIcon>\n                            <CheckBoxOutlineBlank fontSize=\"small\" />\n                        </ListItemIcon>\n                        <ListItemText>\n                            Select\n                        </ListItemText>\n                    </MenuItem>\n                    {isDownloaded && (\n                        <MenuItem onClick={deleteChapter}>\n                            <ListItemIcon>\n                                <Delete fontSize=\"small\" />\n                            </ListItemIcon>\n                            <ListItemText>\n                                Delete\n                            </ListItemText>\n                        </MenuItem>\n                    )}\n                    {canBeDownloaded && (\n                        <MenuItem onClick={downloadChapter}>\n                            <ListItemIcon>\n                                <Download fontSize=\"small\" />\n                            </ListItemIcon>\n                            <ListItemText>\n                                Download\n                            </ListItemText>\n                        </MenuItem>\n                    ) }\n                    <MenuItem onClick={() => sendChange('bookmarked', !chapter.bookmarked)}>\n                        <ListItemIcon>\n                            {chapter.bookmarked && <BookmarkRemove fontSize=\"small\" />}\n                            {!chapter.bookmarked && <BookmarkAdd fontSize=\"small\" />}\n                        </ListItemIcon>\n                        <ListItemText>\n                            {chapter.bookmarked && 'Remove bookmark'}\n                            {!chapter.bookmarked && 'Add bookmark'}\n                        </ListItemText>\n                    </MenuItem>\n                    <MenuItem onClick={() => sendChange('read', !chapter.read)}>\n                        <ListItemIcon>\n                            {chapter.read && <RemoveDone fontSize=\"small\" />}\n                            {!chapter.read && <Done fontSize=\"small\" />}\n                        </ListItemIcon>\n                        <ListItemText>\n                            {chapter.read && 'Mark as unread'}\n                            {!chapter.read && 'Mark as read'}\n                        </ListItemText>\n                    </MenuItem>\n                    <MenuItem onClick={() => sendChange('markPrevRead', true)}>\n                        <ListItemIcon>\n                            <DoneAll fontSize=\"small\" />\n                        </ListItemIcon>\n                        <ListItemText>\n                            Mark previous as Read\n                        </ListItemText>\n                    </MenuItem>\n                </Menu>\n            </Card>\n        </li>\n    );\n};\n\nexport default ChapterCard;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Fab } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport { PlayArrow } from '@mui/icons-material';\nimport { BACK } from 'util/useBackTo';\n\ninterface ResumeFABProps{\n    chapter: IChapter\n    mangaId: string\n}\n\nexport default function ResumeFab(props: ResumeFABProps) {\n    const { chapter: { index, lastPageRead }, mangaId } = props;\n    return (\n        <Fab\n            sx={{ position: 'fixed', bottom: '2em', right: '3em' }}\n            component={Link}\n            variant=\"extended\"\n            color=\"primary\"\n            to={{ pathname: `/manga/${mangaId}/chapter/${index}/page/${lastPageRead}`, state: { backLink: BACK } }}\n        >\n            <PlayArrow />\n            {index === 1 ? 'Start' : 'Resume' }\n        </Fab>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { useReducerLocalStorage } from 'util/useLocalStorage';\n\nconst defaultChapterOptions: ChapterListOptions = {\n    active: false,\n    unread: undefined,\n    downloaded: undefined,\n    bookmarked: undefined,\n    reverse: false,\n    sortBy: 'source',\n    showChapterNumber: false,\n};\n\nfunction chapterOptionsReducer(state: ChapterListOptions,\n    actions: ChapterOptionsReducerAction)\n    : ChapterListOptions {\n    switch (actions.type) {\n        case 'filter':\n            // eslint-disable-next-line no-case-declarations\n            const active = state.unread !== false\n            && state.downloaded !== false\n            && state.bookmarked !== false;\n            return {\n                ...state,\n                active,\n                [actions.filterType!]: actions.filterValue,\n            };\n        case 'sortBy':\n            return { ...state, sortBy: actions.sortBy };\n        case 'sortReverse':\n            return { ...state, reverse: !state.reverse };\n        case 'showChapterNumber':\n            return { ...state, showChapterNumber: !state.showChapterNumber };\n        default:\n            throw Error('This is not a valid Action');\n    }\n}\n\nexport function unreadFilter(unread: NullAndUndefined<boolean>, { read: isChapterRead }: IChapter) {\n    switch (unread) {\n        case true:\n            return !isChapterRead;\n        case false:\n            return isChapterRead;\n        default:\n            return true;\n    }\n}\n\nfunction downloadFilter(downloaded: NullAndUndefined<boolean>,\n    { downloaded: chapterDownload }: IChapter) {\n    switch (downloaded) {\n        case true:\n            return chapterDownload;\n        case false:\n            return !chapterDownload;\n        default:\n            return true;\n    }\n}\n\nfunction bookmarkedFilter(bookmarked: NullAndUndefined<boolean>,\n    { bookmarked: chapterBookmarked }: IChapter) {\n    switch (bookmarked) {\n        case true:\n            return chapterBookmarked;\n        case false:\n            return !chapterBookmarked;\n        default:\n            return true;\n    }\n}\n\nexport function filterAndSortChapters(chapters: IChapter[], options: ChapterListOptions)\n    : IChapter[] {\n    const filtered = options.active\n        ? chapters.filter((chp) => unreadFilter(options.unread, chp)\n    && downloadFilter(options.downloaded, chp)\n    && bookmarkedFilter(options.bookmarked, chp))\n        : [...chapters];\n    const Sorted = options.sortBy === 'fetchedAt'\n        ? filtered.sort((a, b) => a.fetchedAt - b.fetchedAt)\n        : filtered;\n    if (options.reverse) {\n        Sorted.reverse();\n    }\n    return Sorted;\n}\n\nexport const useChapterOptions = (mangaId: string) => useReducerLocalStorage<\nChapterListOptions,\nChapterOptionsReducerAction\n>(\n    chapterOptionsReducer,\n    `${mangaId}filterOptions`, defaultChapterOptions,\n);\n\nexport const SORT_OPTIONS: [ChapterSortMode, string][] = [\n    ['source', 'By Source'],\n    ['fetchedAt', 'By Fetch date'],\n];\n\nexport const isFilterActive = (options: ChapterListOptions) => {\n    const { unread, downloaded, bookmarked } = options;\n    return unread != null || downloaded != null || bookmarked != null;\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\n// eslint-disable-next-line import/prefer-default-export\nexport const pluralize = (count: number, input: string | { one: string, many: string }) => {\n    if (typeof input === 'string') {\n        return `${input}${count === 1 ? '' : 's'}`;\n    }\n    return input[count === 1 ? 'one' : 'many'];\n};\n\nexport const interpolate = (count: number, input: { one: string, many: string }) => {\n    const text = count === 1 ? input.one : input.many;\n    return text.replaceAll('%count%', count.toString());\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { RadioGroup } from '@mui/material';\nimport RadioInput from 'components/atoms/RadioInput';\nimport SortRadioInput from 'components/atoms/SortRadioInput';\nimport ThreeStateCheckboxInput from 'components/atoms/ThreeStateCheckboxInput';\nimport OptionsTabs from 'components/molecules/OptionsTabs';\nimport React from 'react';\nimport { SORT_OPTIONS } from './util';\n\ninterface IProps {\n    open: boolean\n    onClose: () => void\n    options: ChapterListOptions\n    optionsDispatch: React.Dispatch<ChapterOptionsReducerAction>\n}\n\nconst TITLES = {\n    filter: 'Filter',\n    sort: 'Sort',\n    display: 'Display',\n};\n\nconst ChapterOptions: React.FC<IProps> = ({\n    open, onClose, options, optionsDispatch,\n}) => (\n    <OptionsTabs<'filter' | 'sort' | 'display'>\n        open={open}\n        onClose={onClose}\n        minHeight={150}\n        tabs={['filter', 'sort', 'display']}\n        tabTitle={(key) => TITLES[key]}\n        tabContent={(key) => {\n            if (key === 'filter') {\n                return (\n                    <>\n                        <ThreeStateCheckboxInput label=\"Unread\" checked={options.unread} onChange={(c) => optionsDispatch({ type: 'filter', filterType: 'unread', filterValue: c })} />\n                        <ThreeStateCheckboxInput label=\"Downloaded\" checked={options.downloaded} onChange={(c) => optionsDispatch({ type: 'filter', filterType: 'downloaded', filterValue: c })} />\n                        <ThreeStateCheckboxInput label=\"Bookmarked\" checked={options.bookmarked} onChange={(c) => optionsDispatch({ type: 'filter', filterType: 'bookmarked', filterValue: c })} />\n                    </>\n                );\n            }\n            if (key === 'sort') {\n                return SORT_OPTIONS.map(([mode, label]) => (\n                    <SortRadioInput\n                        key={mode}\n                        label={label}\n                        checked={options.sortBy === mode}\n                        sortDescending={options.reverse}\n                        onClick={() => (mode !== options.sortBy\n                            ? optionsDispatch({ type: 'sortBy', sortBy: mode })\n                            : optionsDispatch({ type: 'sortReverse' }))}\n                    />\n                ));\n            }\n            if (key === 'display') {\n                return (\n                    <RadioGroup onChange={() => optionsDispatch({ type: 'showChapterNumber' })} value={options.showChapterNumber}>\n                        <RadioInput label=\"Source Title\" value={false} />\n                        <RadioInput label=\"Chapter Number\" value />\n                    </RadioGroup>\n                );\n            }\n            return null;\n        }}\n    />\n);\n\nexport default ChapterOptions;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport FilterList from '@mui/icons-material/FilterList';\nimport { Badge, IconButton } from '@mui/material';\nimport * as React from 'react';\nimport ChapterOptions from './ChapterOptions';\nimport { isFilterActive } from './util';\n\ninterface IProps {\n    options: ChapterListOptions\n    optionsDispatch: React.Dispatch<ChapterOptionsReducerAction>\n}\n\nconst ChaptersToolbarMenu = ({ options, optionsDispatch }: IProps) => {\n    const [open, setOpen] = React.useState(false);\n    const isFiltered = isFilterActive(options);\n\n    return (\n        <>\n            <IconButton onClick={() => setOpen(true)}>\n                <Badge color=\"primary\" variant=\"dot\" invisible={!isFiltered}>\n                    <FilterList />\n                </Badge>\n            </IconButton>\n            <ChapterOptions\n                open={open}\n                onClose={() => setOpen(false)}\n                options={options}\n                optionsDispatch={optionsDispatch}\n            />\n        </>\n    );\n};\n\nexport default ChaptersToolbarMenu;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport BookmarkAdd from '@mui/icons-material/BookmarkAdd';\nimport BookmarkRemove from '@mui/icons-material/BookmarkRemove';\nimport Delete from '@mui/icons-material/Delete';\nimport Done from '@mui/icons-material/Done';\nimport Download from '@mui/icons-material/Download';\nimport RemoveDone from '@mui/icons-material/RemoveDone';\nimport { ListItemIcon, ListItemText, MenuItem } from '@mui/material';\nimport React from 'react';\nimport type { IChapterWithMeta } from './ChapterList';\nimport type { SelectionAction } from './SelectionFAB';\n\ninterface IProps {\n    action: SelectionAction\n    matchingChapters: IChapterWithMeta[]\n    title: string\n    onClick: (action: SelectionAction, chapters: IChapterWithMeta[]) => void\n}\n\nconst ICONS = {\n    download: Download,\n    delete: Delete,\n    bookmark: BookmarkAdd,\n    unbookmark: BookmarkRemove,\n    mark_as_read: Done,\n    mark_as_unread: RemoveDone,\n};\n\nconst SelectionFABActionItem: React.FC<IProps> = ({\n    action, matchingChapters, onClick, title,\n}) => {\n    const count = matchingChapters.length;\n    const Icon = ICONS[action];\n    return (\n        <MenuItem\n            onClick={() => onClick(action, matchingChapters)}\n            disabled={count === 0}\n        >\n            <ListItemIcon>\n                <Icon fontSize=\"small\" />\n            </ListItemIcon>\n            <ListItemText>\n                {title}\n                {count > 0 ? ` (${count})` : ''}\n            </ListItemText>\n        </MenuItem>\n    );\n};\n\nexport default SelectionFABActionItem;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport MoreHoriz from '@mui/icons-material/MoreHoriz';\nimport {\n    Fab, Menu,\n} from '@mui/material';\nimport { Box } from '@mui/system';\nimport { pluralize } from 'components/util/helpers';\nimport React, { useRef, useState } from 'react';\nimport type { IChapterWithMeta } from './ChapterList';\nimport SelectionFABActionItem from './SelectionFABActionItem';\n\nexport type SelectionAction = 'download' | 'delete' | 'bookmark' | 'unbookmark' | 'mark_as_read' | 'mark_as_unread';\n\ninterface SelectionFABProps{\n    selectedChapters: IChapterWithMeta[]\n    onAction: (action: SelectionAction, chapters: IChapterWithMeta[]) => void\n}\n\nconst SelectionFAB: React.FC<SelectionFABProps> = (props) => {\n    const { selectedChapters, onAction } = props;\n    const count = selectedChapters.length;\n\n    const anchorEl = useRef<HTMLElement>();\n    const [open, setOpen] = useState(false);\n    const handleClose = () => setOpen(false);\n\n    const handleAction = (action: SelectionAction, chapters: IChapterWithMeta[]) => {\n        onAction(action, chapters);\n        handleClose();\n    };\n\n    return (\n        <Box\n            sx={{\n                position: 'fixed', bottom: '2em', right: '3em', pt: 1,\n            }}\n            ref={anchorEl}\n        >\n            <Fab\n                variant=\"extended\"\n                color=\"primary\"\n                id=\"selectionMenuButton\"\n                onClick={() => setOpen(true)}\n            >\n                {`${count} ${pluralize(count, 'chapter')}`}\n                <MoreHoriz sx={{ ml: 1 }} />\n            </Fab>\n            <Menu\n                id=\"selectionMenu\"\n                anchorEl={anchorEl.current}\n                open={open}\n                onClose={handleClose}\n                anchorOrigin={{ horizontal: 'right', vertical: 'top' }}\n                transformOrigin={{ horizontal: 'right', vertical: 'bottom' }}\n                MenuListProps={{\n                    'aria-labelledby': 'selectionMenuButton',\n                }}\n            >\n                <SelectionFABActionItem\n                    action=\"download\"\n                    matchingChapters={selectedChapters.filter(\n                        ({ chapter: c, downloadChapter: dc }) => !c.downloaded && dc === undefined,\n                    )}\n                    onClick={handleAction}\n                    title=\"Download selected\"\n                />\n                <SelectionFABActionItem\n                    action=\"delete\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => chapter.downloaded)}\n                    onClick={handleAction}\n                    title=\"Delete selected\"\n                />\n                <SelectionFABActionItem\n                    action=\"bookmark\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => !chapter.bookmarked)}\n                    onClick={handleAction}\n                    title=\"Bookmark selected\"\n                />\n                <SelectionFABActionItem\n                    action=\"unbookmark\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => chapter.bookmarked)}\n                    onClick={handleAction}\n                    title=\"Remove bookmarks from selected\"\n                />\n                <SelectionFABActionItem\n                    action=\"mark_as_read\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => !chapter.read)}\n                    onClick={handleAction}\n                    title=\"Mark selected as read\"\n                />\n                <SelectionFABActionItem\n                    action=\"mark_as_unread\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => chapter.read)}\n                    onClick={handleAction}\n                    title=\"Mark selected as unread\"\n                />\n            </Menu>\n        </Box>\n    );\n};\n\nexport default SelectionFAB;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport {\n    Button, CircularProgress, Stack,\n} from '@mui/material';\nimport Typography from '@mui/material/Typography';\nimport { styled } from '@mui/system';\nimport useSubscription from 'components/library/useSubscription';\nimport ChapterCard from 'components/manga/ChapterCard';\nimport ResumeFab from 'components/manga/ResumeFAB';\nimport { filterAndSortChapters, useChapterOptions } from 'components/manga/util';\nimport EmptyView from 'components/util/EmptyView';\nimport { interpolate } from 'components/util/helpers';\nimport makeToast from 'components/util/Toast';\nimport React, {\n    ComponentProps,\n    useEffect, useMemo, useRef, useState,\n} from 'react';\nimport { Virtuoso } from 'react-virtuoso';\nimport client, { useQuery } from 'util/client';\nimport ChaptersToolbarMenu from './ChaptersToolbarMenu';\nimport SelectionFAB from './SelectionFAB';\n\nconst StyledVirtuoso = styled(Virtuoso)(({ theme }) => ({\n    listStyle: 'none',\n    padding: 0,\n    minHeight: '200px',\n    [theme.breakpoints.up('md')]: {\n        width: '50vw',\n        // 64px for the Appbar, 48px for the ChapterCount Header\n        height: 'calc(100vh - 64px - 48px)',\n        margin: 0,\n    },\n}));\n\nconst actionsStrings = {\n    download: {\n        success: { one: 'Download added', many: '%count% downloads added' },\n        error: { one: 'Error adding download', many: 'Error adding downloads' },\n    },\n    delete: {\n        success: { one: 'Chapter deleted', many: '%count% chapters deleted' },\n        error: { one: 'Error deleting chapter', many: 'Error deleting chapters' },\n    },\n    bookmark: {\n        success: { one: 'Chapter bookmarked', many: '%count% chapters bookmarked' },\n        error: { one: 'Error bookmarking chapter', many: 'Error bookmarking chapters' },\n    },\n    unbookmark: {\n        success: { one: 'Chapter bookmark removed', many: '%count% chapter bookmarks removed' },\n        error: { one: 'Error removing bookmark', many: 'Error removing bookmarks' },\n    },\n    mark_as_read: {\n        success: { one: 'Chapter marked as read', many: '%count% chapters marked as read' },\n        error: { one: 'Error marking chapter as read', many: 'Error marking chapters as read' },\n    },\n    mark_as_unread: {\n        success: { one: 'Chapter marked as unread', many: '%count% chapters marked as unread' },\n        error: { one: 'Error marking chapter as unread', many: 'Error marking chapters as unread' },\n    },\n};\n\nexport interface IChapterWithMeta {\n    chapter: IChapter\n    downloadChapter: IDownloadChapter | undefined\n    selected: boolean | null\n}\n\ninterface IProps {\n    mangaId: string\n}\n\nconst ChapterList: React.FC<IProps> = ({ mangaId }) => {\n    const [selection, setSelection] = useState<number[] | null>(null);\n    const prevQueueRef = useRef<IDownloadChapter[]>();\n    const queue = useSubscription<IQueue>('/api/v1/downloads').data?.queue;\n\n    const [options, dispatch] = useChapterOptions(mangaId);\n    const {\n        data: chaptersData,\n        mutate,\n        loading,\n    } = useQuery<IChapter[]>(`/api/v1/manga/${mangaId}/chapters?onlineFetch=false`);\n    const chapters = useMemo(() => chaptersData ?? [], [chaptersData]);\n\n    useEffect(() => {\n        if (prevQueueRef.current && queue) {\n            const prevQueue = prevQueueRef.current;\n            const changedDownloads = queue.filter((cd) => {\n                const prevChapterDownload = prevQueue\n                    .find((pcd) => cd.chapterIndex === pcd.chapterIndex\n                        && cd.mangaId === pcd.mangaId);\n                if (!prevChapterDownload) return true;\n                return cd.state !== prevChapterDownload.state;\n            });\n\n            if (changedDownloads.length > 0) {\n                mutate();\n            }\n        }\n\n        prevQueueRef.current = queue;\n    }, [queue]);\n\n    const visibleChapters = useMemo(() => filterAndSortChapters(chapters, options), //\n        [chapters, options]);\n\n    const firstUnreadChapter = useMemo(() => visibleChapters.slice()\n        .reverse()\n        .find((c) => c.read === false),\n    [visibleChapters]);\n\n    const handleSelection = (index: number) => {\n        const chapter = visibleChapters[index];\n        if (!chapter) return;\n\n        if (selection === null) {\n            setSelection([chapter.id]);\n        } else if (selection.includes(chapter.id)) {\n            const newSelection = selection.filter((cid) => cid !== chapter.id);\n            setSelection(newSelection.length > 0 ? newSelection : null);\n        } else {\n            setSelection([...selection, chapter.id]);\n        }\n    };\n\n    const handleSelectAll = () => {\n        if (selection === null) return;\n        setSelection(visibleChapters.map((c) => c.id));\n    };\n\n    const handleClear = () => {\n        if (selection === null) return;\n        setSelection(null);\n    };\n\n    const handleFabAction: ComponentProps<typeof SelectionFAB>['onAction'] = (action, actionChapters) => {\n        if (actionChapters.length === 0) return;\n        const chapterIds = actionChapters.map(({ chapter }) => chapter.id);\n\n        let actionPromise: Promise<any>;\n\n        if (action === 'download') {\n            actionPromise = client.post('/api/v1/download/batch', { chapterIds });\n        } else {\n            const change: BatchChaptersChange = {};\n\n            if (action === 'delete') change.delete = true;\n            else if (action === 'bookmark') change.isBookmarked = true;\n            else if (action === 'unbookmark') change.isBookmarked = false;\n            else if (action === 'mark_as_read') change.isRead = true;\n            else if (action === 'mark_as_unread') change.isRead = false;\n\n            actionPromise = client.post('/api/v1/chapter/batch', { chapterIds, change });\n        }\n\n        actionPromise\n            .then(() => makeToast(interpolate(chapterIds.length, actionsStrings[action].success), 'success'))\n            .then(() => mutate())\n            .catch(() => makeToast(interpolate(chapterIds.length, actionsStrings[action].error), 'error'));\n    };\n\n    if (loading) {\n        return (\n            <div style={{\n                margin: '10px auto',\n                display: 'flex',\n                justifyContent: 'center',\n            }}\n            >\n                <CircularProgress thickness={5} />\n            </div>\n        );\n    }\n\n    const noChaptersFound = chapters.length === 0;\n    const noChaptersMatchingFilter = !noChaptersFound && visibleChapters.length === 0;\n\n    const chaptersWithMeta: IChapterWithMeta[] = visibleChapters.map((chapter) => {\n        const downloadChapter = queue?.find(\n            (cd) => cd.chapterIndex === chapter.index\n                && cd.mangaId === chapter.mangaId,\n        );\n        const selected = selection?.includes(chapter.id) ?? null;\n        return {\n            chapter,\n            downloadChapter,\n            selected,\n        };\n    });\n\n    const selectedChapters = (selection === null)\n        ? null\n        : chaptersWithMeta.filter(({ chapter }) => selection.includes(chapter.id));\n\n    return (\n        <>\n            <Stack direction=\"column\" sx={{ position: 'relative' }}>\n                <Stack\n                    direction=\"row\"\n                    alignItems=\"center\"\n                    justifyContent=\"space-between\"\n                    sx={{\n                        m: 1, mb: 0, mr: 2, minHeight: 40,\n                    }}\n                >\n                    <Typography variant=\"h5\">\n                        {`${visibleChapters.length} Chapter${visibleChapters.length === 1 ? '' : 's'}`}\n                    </Typography>\n\n                    {selection === null ? (\n                        <ChaptersToolbarMenu options={options} optionsDispatch={dispatch} />\n                    ) : (\n                        <Stack direction=\"row\">\n                            <Button size=\"small\" onClick={handleSelectAll}>Select all</Button>\n                            <Button size=\"small\" onClick={handleClear}>Clear</Button>\n                        </Stack>\n                    )}\n                </Stack>\n\n                {noChaptersFound && (\n                    <EmptyView message=\"No chapters found\" />\n                )}\n                {noChaptersMatchingFilter && (\n                    <EmptyView message=\"No chapters matching filter\" />\n                )}\n\n                <StyledVirtuoso\n                    style={{ // override Virtuoso default values and set them with class\n                        height: 'undefined',\n                        // 900 is the md breakpoint in MUI\n                        overflowY: window.innerWidth < 900 ? 'visible' : 'auto',\n                    }}\n                    totalCount={visibleChapters.length}\n                    itemContent={(index:number) => (\n                        <ChapterCard\n                            {...chaptersWithMeta[index]}\n                            showChapterNumber={options.showChapterNumber}\n                            triggerChaptersUpdate={() => mutate()}\n                            onSelect={() => handleSelection(index)}\n                        />\n                    )}\n                    useWindowScroll={window.innerWidth < 900}\n                    overscan={window.innerHeight * 0.5}\n                />\n            </Stack>\n            {selectedChapters !== null ? (\n                <SelectionFAB\n                    selectedChapters={selectedChapters}\n                    onAction={handleFabAction}\n                />\n            ) : (\n                firstUnreadChapter && <ResumeFab chapter={firstUnreadChapter} mangaId={mangaId} />\n            )}\n        </>\n    );\n};\n\nexport default ChapterList;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport FavoriteBorderIcon from '@mui/icons-material/FavoriteBorder';\nimport PublicIcon from '@mui/icons-material/Public';\nimport { Typography } from '@mui/material';\nimport IconButton from '@mui/material/IconButton';\nimport { Theme } from '@mui/material/styles';\nimport makeStyles from '@mui/styles/makeStyles';\nimport React from 'react';\nimport { mutate } from 'swr';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\n\nconst useStyles = (inLibrary: boolean) => makeStyles((theme: Theme) => ({\n    root: {\n        width: '100%',\n        [theme.breakpoints.up('md')]: {\n            position: 'sticky',\n            top: '64px',\n            left: '0px',\n            width: '50vw',\n            height: 'calc(100vh - 64px)',\n            alignSelf: 'flex-start',\n            overflowY: 'auto',\n        },\n    },\n    top: {\n        padding: '10px',\n        // [theme.breakpoints.up('md')]: {\n        //     minWidth: '50%',\n        // },\n    },\n    leftRight: {\n        display: 'flex',\n    },\n    leftSide: {\n        '& img': {\n            borderRadius: 4,\n            maxWidth: '100%',\n            minWidth: '100%',\n            height: 'auto',\n        },\n        maxWidth: '50%',\n        // [theme.breakpoints.up('md')]: {\n        //     minWidth: '100px',\n        // },\n    },\n    rightSide: {\n        marginLeft: 15,\n        maxWidth: '100%',\n        '& span': {\n            fontWeight: '400',\n        },\n        [theme.breakpoints.up('lg')]: {\n            fontSize: '1.3em',\n        },\n    },\n    buttons: {\n        display: 'flex',\n        justifyContent: 'space-around',\n        '& button': {\n            color: inLibrary ? '#2196f3' : 'inherit',\n        },\n        '& a': {\n            textDecoration: 'none',\n            color: '#858585',\n            '& button': {\n                color: 'inherit',\n            },\n        },\n    },\n    bottom: {\n        paddingLeft: '10px',\n        paddingRight: '10px',\n        [theme.breakpoints.up('md')]: {\n            fontSize: '1.2em',\n            // maxWidth: '50%',\n        },\n        [theme.breakpoints.up('lg')]: {\n            fontSize: '1.3em',\n        },\n    },\n    description: {\n        '& h4': {\n            marginTop: '1em',\n            marginBottom: 0,\n        },\n        '& p': {\n            textAlign: 'justify',\n            textJustify: 'inter-word',\n        },\n    },\n    genre: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        '& h5': {\n            border: '2px solid #2196f3',\n            borderRadius: '1.13em',\n            marginRight: '1em',\n            marginTop: 0,\n            marginBottom: '10px',\n            padding: '0.3em',\n            color: '#2196f3',\n        },\n    },\n}));\n\ninterface IProps{\n    manga: IManga\n}\n\nfunction getSourceName(source: ISource) {\n    if (source.displayName !== null) {\n        return source.displayName;\n    }\n    return source.id;\n}\n\nfunction getValueOrUnknown(val: string) {\n    return val || 'UNKNOWN';\n}\n\nconst MangaDetails: React.FC<IProps> = ({ manga }) => {\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const classes = useStyles(manga.inLibrary)();\n\n    const addToLibrary = () => {\n        mutate(`/api/v1/manga/${manga.id}/?onlineFetch=false`, { ...manga, inLibrary: true }, { revalidate: false });\n        client.get(`/api/v1/manga/${manga.id}/library/`)\n            .then(() => mutate(`/api/v1/manga/${manga.id}/?onlineFetch=false`));\n    };\n\n    const removeFromLibrary = () => {\n        mutate(`/api/v1/manga/${manga.id}/?onlineFetch=false`, { ...manga, inLibrary: false }, { revalidate: false });\n        client.delete(`/api/v1/manga/${manga.id}/library/`)\n            .then(() => mutate(`/api/v1/manga/${manga.id}/?onlineFetch=false`));\n    };\n\n    return (\n        <div className={classes.root}>\n            <div className={classes.top}>\n                <div className={classes.leftRight}>\n                    <div className={classes.leftSide}>\n                        <img src={`${serverAddress}${manga.thumbnailUrl}?useCache=${useCache}`} alt=\"Manga Thumbnail\" />\n                    </div>\n                    <div className={classes.rightSide}>\n                        <h1>\n                            {manga.title}\n                        </h1>\n                        <h3>\n                            {'Author: '}\n                            <span>{getValueOrUnknown(manga.author)}</span>\n                        </h3>\n                        <h3>\n                            {'Artist: '}\n                            <span>{getValueOrUnknown(manga.artist)}</span>\n                        </h3>\n                        <h3>\n                            {`Status: ${manga.status}`}\n                        </h3>\n                        <h3>\n                            {`Source: ${getSourceName(manga.source)}`}\n                        </h3>\n                    </div>\n                </div>\n                <div className={classes.buttons}>\n                    <div>\n                        <IconButton onClick={manga.inLibrary ? removeFromLibrary : addToLibrary} size=\"large\">\n                            {manga.inLibrary\n                                ? <FavoriteIcon sx={{ mr: 1 }} />\n                                : <FavoriteBorderIcon sx={{ mr: 1 }} />}\n                            <Typography sx={{ fontSize: { xs: '0.75em', sm: '0.85em' } }}>\n                                {manga.inLibrary ? 'In Library' : 'Add To Library'}\n                            </Typography>\n                        </IconButton>\n                    </div>\n                    <a href={manga.realUrl} target=\"_blank\" rel=\"noreferrer\">\n                        <IconButton size=\"large\">\n                            <PublicIcon sx={{ mr: 1 }} />\n                            <Typography sx={{ fontSize: { xs: '0.75em', sm: '0.85em' } }}>\n                                Open Site\n                            </Typography>\n                        </IconButton>\n                    </a>\n                </div>\n            </div>\n            <div className={classes.bottom}>\n                <div className={classes.description}>\n                    <h4>About</h4>\n                    <p>{manga.description}</p>\n                </div>\n                <div className={classes.genre}>\n                    {manga.genre.map((g) => <h5 key={g}>{g}</h5>)}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default MangaDetails;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useMemo } from 'react';\nimport Button from '@mui/material/Button';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport Dialog from '@mui/material/Dialog';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport FormGroup from '@mui/material/FormGroup';\nimport client, { useQuery } from 'util/client';\n\ninterface IProps {\n    open: boolean\n    setOpen: (value: boolean) => void\n    mangaId: number\n}\n\nexport default function CategorySelect(props: IProps) {\n    const { open, setOpen, mangaId } = props;\n\n    const { data: mangaCategoriesData, mutate } = useQuery<ICategory[]>(`/api/v1/manga/${mangaId}/category`);\n    const { data: categoriesData } = useQuery<ICategory[]>('/api/v1/category');\n\n    const allCategories = useMemo(() => {\n        const cats = [...(categoriesData ?? [])]; // make copy\n        if (cats.length > 0 && cats[0].name === 'Default') {\n            cats.shift(); // remove first category if it is 'Default'\n        }\n        return cats;\n    }, [categoriesData]);\n\n    const selectedIds = mangaCategoriesData?.map((c) => c.id) ?? [];\n\n    const handleCancel = () => {\n        setOpen(false);\n    };\n\n    const handleOk = () => {\n        setOpen(false);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, categoryId: number) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        const method = checked ? client.get : client.delete;\n        method(`/api/v1/manga/${mangaId}/category/${categoryId}`)\n            .then(() => mutate());\n    };\n\n    return (\n        <Dialog\n            sx={{\n                '.MuiDialog-paper': {\n                    maxHeight: 435,\n                    width: '80%',\n                },\n            }}\n            maxWidth=\"xs\"\n            open={open}\n        >\n            <DialogTitle>Set categories</DialogTitle>\n            <DialogContent dividers>\n                <FormGroup>\n                    {allCategories.length === 0\n                        && (\n                            <span>\n                                No categories found!\n                                <br />\n                                You should make some from settings.\n                            </span>\n                        )}\n                    {allCategories.map((category) => (\n                        <FormControlLabel\n                            control={(\n                                <Checkbox\n                                    checked={selectedIds.includes(category.id)}\n                                    onChange={(e) => handleChange(e, category.id)}\n                                    color=\"default\"\n                                />\n                            )}\n                            label={category.name}\n                            key={category.id}\n                        />\n                    ))}\n                </FormGroup>\n\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel} color=\"primary\">\n                    Cancel\n                </Button>\n                <Button onClick={handleOk} color=\"primary\">\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport Label from '@mui/icons-material/Label';\nimport MoreHoriz from '@mui/icons-material/MoreHoriz';\nimport Refresh from '@mui/icons-material/Refresh';\nimport {\n    IconButton, ListItemIcon, ListItemText, Menu, MenuItem, Tooltip, useMediaQuery, useTheme,\n} from '@mui/material';\nimport CategorySelect from 'components/navbar/action/CategorySelect';\nimport React, { useState } from 'react';\n\ninterface IProps {\n    manga: IManga;\n    onRefresh: () => any;\n    refreshing: boolean;\n}\n\nconst MangaToolbarMenu = ({ manga, onRefresh, refreshing }: IProps) => {\n    const theme = useTheme();\n    const isLargeScreen = useMediaQuery(theme.breakpoints.up('sm'));\n\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n    const open = Boolean(anchorEl);\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const [editCategories, setEditCategories] = useState(false);\n\n    return (\n        <>\n            {isLargeScreen && (\n                <>\n                    <Tooltip title=\"Reload data from source\">\n                        <IconButton onClick={() => { onRefresh(); }} disabled={refreshing}>\n                            <Refresh />\n                        </IconButton>\n                    </Tooltip>\n                    {manga.inLibrary && (\n                        <Tooltip title=\"Edit manga categories\">\n                            <IconButton onClick={() => { setEditCategories(true); }}>\n                                <Label />\n                            </IconButton>\n                        </Tooltip>\n                    )}\n                </>\n            )}\n            {!isLargeScreen && (\n                <>\n                    <IconButton\n                        id=\"chaptersMenuButton\"\n                        aria-controls={open ? 'chaptersMenu' : undefined}\n                        aria-haspopup=\"true\"\n                        aria-expanded={open ? 'true' : undefined}\n                        onClick={(e) => setAnchorEl(e.currentTarget)}\n                    >\n                        <MoreHoriz />\n                    </IconButton>\n                    <Menu\n                        id=\"chaptersMenu\"\n                        anchorEl={anchorEl}\n                        open={open}\n                        onClose={handleClose}\n                        MenuListProps={{\n                            'aria-labelledby': 'chaptersMenuButton',\n                        }}\n                    >\n                        <MenuItem\n                            onClick={() => { onRefresh(); handleClose(); }}\n                            disabled={refreshing}\n                        >\n                            <ListItemIcon>\n                                <Refresh fontSize=\"small\" />\n                            </ListItemIcon>\n                            <ListItemText>\n                                Reload data from source\n                            </ListItemText>\n                        </MenuItem>\n                        {manga.inLibrary && (\n                            <MenuItem\n                                onClick={() => { setEditCategories(true); handleClose(); }}\n                            >\n                                <ListItemIcon>\n                                    <Label fontSize=\"small\" />\n                                </ListItemIcon>\n                                <ListItemText>\n                                    Edit manga categories\n                                </ListItemText>\n                            </MenuItem>\n                        )}\n                    </Menu>\n                </>\n            )}\n\n            <CategorySelect\n                open={editCategories}\n                setOpen={setEditCategories}\n                mangaId={manga.id}\n            />\n        </>\n    );\n};\n\nexport default MangaToolbarMenu;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Warning } from '@mui/icons-material';\nimport {\n    CircularProgress, IconButton, Stack, Tooltip,\n} from '@mui/material';\nimport { Box } from '@mui/system';\nimport NavbarContext, { useSetDefaultBackTo } from 'components/context/NavbarContext';\nimport ChapterList from 'components/manga/ChapterList';\nimport { useRefreshManga } from 'components/manga/hooks';\nimport MangaDetails from 'components/manga/MangaDetails';\nimport MangaToolbarMenu from 'components/manga/MangaToolbarMenu';\nimport { NavbarToolbar } from 'components/navbar/DefaultNavBar';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport React, {\n    useContext, useEffect, useRef,\n} from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useQuery } from 'util/client';\n\nconst AUTOFETCH_AGE = 60 * 60 * 24; // 24 hours\n\nconst Manga: React.FC = () => {\n    const { setTitle } = useContext(NavbarContext);\n    const { id } = useParams<{ id: string }>();\n    const autofetchedRef = useRef(false);\n\n    const {\n        data: manga, error, loading, isValidating, mutate,\n    } = useQuery<IManga>(`/api/v1/manga/${id}/?onlineFetch=false`);\n\n    const [refresh, { loading: refreshing }] = useRefreshManga(id);\n\n    useSetDefaultBackTo(manga?.inLibrary === false && manga.sourceId != null ? `/sources/${manga.sourceId}/popular` : '/library');\n\n    useEffect(() => {\n        // Automatically fetch manga from source if data is older then 24 hours\n        // Automatic fetch is done only once, to prevent issues when server does\n        // not update age for some reason (ie. error on source side)\n        if (manga == null) return;\n        if (\n            manga.inLibrary\n            && (manga.age > AUTOFETCH_AGE || manga.chaptersAge > AUTOFETCH_AGE)\n            && autofetchedRef.current === false\n        ) {\n            autofetchedRef.current = true;\n            refresh();\n        }\n    }, [manga]);\n\n    useEffect(() => {\n        setTitle(manga?.title ?? 'Manga');\n    }, [manga?.title]);\n\n    if (error && !manga) {\n        return (\n            <EmptyView message=\"Could not load manga\" messageExtra={error.message ?? error} />\n        );\n    }\n    return (\n        <Box sx={{ display: { md: 'flex' }, overflow: 'hidden' }}>\n            <NavbarToolbar>\n                <Stack direction=\"row\" alignItems=\"center\">\n                    {error && !isValidating && !refreshing && (\n                        <Tooltip title={(\n                            <>\n                                Could not fetch manga data\n                                <br />\n                                {error.message ?? error}\n                            </>\n                        )}\n                        >\n                            <IconButton onClick={() => mutate()}>\n                                <Warning color=\"error\" />\n                            </IconButton>\n                        </Tooltip>\n                    )}\n                    {(manga && (refreshing || isValidating)) && (\n                        <IconButton disabled>\n                            <CircularProgress size={16} />\n                        </IconButton>\n                    )}\n                    {manga && (\n                        <MangaToolbarMenu\n                            manga={manga}\n                            onRefresh={refresh}\n                            refreshing={refreshing}\n                        />\n                    )}\n                </Stack>\n            </NavbarToolbar>\n\n            {loading && <LoadingPlaceholder />}\n\n            {manga && <MangaDetails manga={manga} />}\n            <ChapterList mangaId={id} />\n        </Box>\n    );\n};\n\nexport default Manga;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { useCallback, useState } from 'react';\nimport { mutate } from 'swr';\nimport { fetcher } from 'util/client';\n\n// eslint-disable-next-line import/prefer-default-export\nexport const useRefreshManga = (mangaId: string) => {\n    const [fetchingOnline, setFetchingOnline] = useState(false);\n\n    const handleRefresh = useCallback(async () => {\n        setFetchingOnline(true);\n        await Promise.all([\n            fetcher(`/api/v1/manga/${mangaId}/?onlineFetch=true`)\n                .then((res) => mutate(`/api/v1/manga/${mangaId}/?onlineFetch=false`, res, { revalidate: false })),\n            fetcher(`/api/v1/manga/${mangaId}/chapters?onlineFetch=true`)\n                .then((res) => mutate(`/api/v1/manga/${mangaId}/chapters?onlineFetch=false`, res, { revalidate: false })),\n        ]).finally(() => setFetchingOnline(false));\n    }, [mangaId]);\n\n    return [handleRefresh, { loading: fetchingOnline }] as const;\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React from 'react';\nimport MangaGrid, { IMangaGridProps } from 'components/MangaGrid';\n\nconst FILTERED_OUT_MESSAGE = 'There are no Manga matching this filter';\n\nfunction filterManga(mangas: IMangaCard[]): IMangaCard[] {\n    return mangas;\n}\n\nexport default function SourceMangaGrid(props: IMangaGridProps) {\n    const {\n        mangas, isLoading, hasNextPage, lastPageNum,\n        setLastPageNum, message, messageExtra, gridLayout,\n    } = props;\n\n    const filteredManga = filterManga(mangas);\n    const showFilteredOutMessage = filteredManga.length === 0 && mangas.length > 0;\n\n    return (\n        <MangaGrid\n            mangas={filteredManga}\n            isLoading={isLoading}\n            hasNextPage={hasNextPage}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n            message={showFilteredOutMessage ? FILTERED_OUT_MESSAGE : message}\n            messageExtra={messageExtra}\n            gridLayout={gridLayout}\n            inLibraryIndicator\n        />\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport CheckboxInput from 'components/atoms/CheckboxInput';\nimport React from 'react';\n\ninterface Props {\n    state: boolean\n    name: string\n    position: number\n    group: number | undefined\n    updateFilterValue: Function\n    update: any\n}\n\nconst CheckBoxFilter: React.FC<Props> = (props: Props) => {\n    const {\n        state,\n        name,\n        position,\n        group,\n        updateFilterValue,\n        update,\n    } = props;\n    const [val, setval] = React.useState(state);\n\n    const handleChange = (event: { target: { name: any; checked: any; }; }) => {\n        setval(event.target.checked);\n        const upd = update.filter((e: {\n            position: number; group: number | undefined;\n        }) => !(position === e.position && group === e.group));\n        updateFilterValue([...upd, { position, state: event.target.checked.toString(), group }]);\n    };\n\n    if (state !== undefined) {\n        return (\n            <CheckboxInput label={name} checked={val} onChange={handleChange} />\n        );\n    }\n    return null;\n};\n\nexport default CheckBoxFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { Typography } from '@mui/material';\nimport React from 'react';\n\ninterface Props {\n    name: string\n}\n\nconst HeaderFilter: React.FC<Props> = ({ name }) => (<Typography key={name} sx={{ mt: 2 }} variant=\"subtitle2\">{name}</Typography>);\n\nexport default HeaderFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React from 'react';\nimport InputLabel from '@mui/material/InputLabel';\nimport FormControl from '@mui/material/FormControl';\nimport MenuItem from '@mui/material/MenuItem';\nimport Select from '@mui/material/Select';\n\ninterface Props {\n    values: any\n    name: string\n    state: number\n    selected: Selected | undefined\n    position: number\n    updateFilterValue: Function\n    group: number | undefined\n    update: any\n}\n\ninterface Selected {\n    displayname: string\n    value: string\n    _value: string\n}\n\nfunction hasSelect(\n    values: Selected[],\n    name: string,\n    state: number,\n    position: number,\n    updateFilterValue: Function,\n    update: any,\n    group?: number,\n) {\n    const [val, setval] = React.useState(state);\n    if (values) {\n        const handleChange = (event: { target: { name: any; value: any; }; }) => {\n            const vall = values.map((e) => e.displayname).indexOf(`${event.target.value}`);\n            setval(vall);\n            const upd = update.filter((e: {\n                position: number; group: number | undefined;\n            }) => !(position === e.position && group === e.group));\n            updateFilterValue([...upd, { position, state: vall.toString(), group }]);\n        };\n\n        const rett = values.map((e: Selected) => (\n            <MenuItem\n                key={`${name} ${e.displayname}`}\n                value={e.displayname}\n            >\n                {\n                    e.displayname\n                }\n            </MenuItem>\n        ));\n        return (\n            <FormControl sx={{ my: 1 }} variant=\"standard\">\n                <InputLabel>\n                    {name}\n                </InputLabel>\n                <Select\n                    name={name}\n                    value={values[val].displayname}\n                    label={name}\n                    onChange={handleChange}\n                >\n                    {rett}\n                </Select>\n            </FormControl>\n        );\n    }\n    return null;\n}\n\nfunction noSelect(\n    values: string[],\n    name: string,\n    state: number,\n    position: number,\n    updateFilterValue: Function,\n    update: any,\n    group?: number,\n) {\n    const [val, setval] = React.useState(state);\n\n    if (values) {\n        const handleChange = (event: { target: { name: any; value: any; }; }) => {\n            const vall = values.indexOf(`${event.target.value}`);\n            setval(vall);\n            const upd = update.filter((e: {\n                position: number; group: number | undefined;\n            }) => !(position === e.position && group === e.group));\n            updateFilterValue([...upd, { position, state: vall.toString(), group }]);\n        };\n\n        const rett = values.map((value: string) => (<MenuItem key={`${name} ${value}`} value={value}>{value}</MenuItem>));\n        return (\n            <FormControl sx={{ my: 1 }} variant=\"standard\">\n                <InputLabel>\n                    {name}\n                </InputLabel>\n                <Select\n                    name={name}\n                    value={values[val]}\n                    label={name}\n                    onChange={handleChange}\n                >\n                    {rett}\n                </Select>\n            </FormControl>\n        );\n    }\n    return null;\n}\n\nconst SelectFilter: React.FC<Props> = ({\n    values,\n    name,\n    state,\n    selected,\n    position,\n    updateFilterValue,\n    update,\n    group,\n}) => {\n    if (selected === undefined) {\n        return noSelect(\n            values,\n            name,\n            state,\n            position,\n            updateFilterValue,\n            update,\n            group,\n        );\n    }\n\n    return hasSelect(\n        values,\n        name,\n        state,\n        position,\n        updateFilterValue,\n        update,\n        group,\n    );\n};\n\nexport default SelectFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { ExpandLess, ExpandMore } from '@mui/icons-material';\nimport {\n    Collapse, ListItemButton, ListItemText, Stack,\n} from '@mui/material';\nimport { Box } from '@mui/system';\nimport SortRadioInput from 'components/atoms/SortRadioInput';\nimport React from 'react';\n\ninterface Props {\n    values: any\n    name: string\n    state: IState\n    position: number\n    group: number | undefined\n    updateFilterValue: Function\n    update: any\n}\n\nconst SortFilter: React.FC<Props> = (props: Props) => {\n    const {\n        values,\n        name,\n        state,\n        position,\n        group,\n        updateFilterValue,\n        update,\n    } = props;\n    const [val, setval] = React.useState(state);\n\n    const [open, setOpen] = React.useState(false);\n\n    const handleClick = () => {\n        setOpen(!open);\n    };\n\n    if (values) {\n        const handleChange = (index: number) => {\n            const tmp = val;\n            if (tmp.index === index) {\n                tmp.ascending = !tmp.ascending;\n            } else {\n                tmp.ascending = true;\n            }\n            tmp.index = index;\n            setval(tmp);\n            const upd = update.filter((e: {\n                position: number; group: number | undefined;\n            }) => !(position === e.position && group === e.group));\n            updateFilterValue([...upd, { position, state: JSON.stringify(tmp), group }]);\n        };\n\n        return (\n            <Box sx={{ mx: -2 }}>\n                <ListItemButton onClick={handleClick}>\n                    <ListItemText primary={name} />\n                    {open ? <ExpandLess /> : <ExpandMore />}\n                </ListItemButton>\n                <Collapse in={open}>\n                    <Stack sx={{ mx: 4 }}>\n                        {values.map((value: string, index: number) => (\n                            <SortRadioInput\n                                key={`${name} ${value}`}\n                                label={value}\n                                checked={val.index === index}\n                                sortDescending={!val.ascending}\n                                onClick={() => handleChange(index)}\n                            />\n                        ))}\n                    </Stack>\n                </Collapse>\n            </Box>\n        );\n    }\n    return null;\n};\n\nexport default SortFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport SearchIcon from '@mui/icons-material/Search';\nimport {\n    FormControl, Input, InputAdornment, InputLabel,\n} from '@mui/material';\nimport React from 'react';\n\ninterface Props {\n    state: string\n    name: string\n    position: number\n    group: number | undefined\n    updateFilterValue: Function\n    update: any\n}\n\nconst TextFilter: React.FC<Props> = (props) => {\n    const {\n        state,\n        name,\n        position,\n        group,\n        updateFilterValue,\n        update,\n    } = props;\n    const [Search, setsearch] = React.useState(state || '');\n    let typingTimer: NodeJS.Timeout;\n\n    function doneTyping(e: React.ChangeEvent<HTMLInputElement>) {\n        const upd = update.filter((el: {\n            position: number; group: number | undefined;\n        }) => !(position === el.position && group === el.group));\n        updateFilterValue([...upd, { position, state: e.target.value, group }]);\n    }\n\n    function handleChange(e: React.ChangeEvent<HTMLInputElement>) {\n        setsearch(e.target.value);\n\n        clearTimeout(typingTimer);\n        typingTimer = setTimeout(() => { doneTyping(e); }, 2500);\n    }\n\n    if (state !== undefined) {\n        return (\n            <FormControl sx={{ my: 1 }} variant=\"standard\">\n                <InputLabel>\n                    {name}\n                </InputLabel>\n                <Input\n                    name={name}\n                    value={Search || ''}\n                    onChange={handleChange}\n                    endAdornment={(\n                        <InputAdornment position=\"end\">\n                            <SearchIcon />\n                        </InputAdornment>\n                    )}\n                />\n            </FormControl>\n        );\n    }\n    return (<></>);\n};\n\nexport default TextFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport ThreeStateCheckboxInput from 'components/atoms/ThreeStateCheckboxInput';\nimport React from 'react';\n\ninterface Props {\n    state: number\n    name: string\n    position: number\n    group: number | undefined\n    updateFilterValue: Function\n    update: any\n}\n\nconst TriStateFilter: React.FC<Props> = (props) => {\n    const {\n        state,\n        name,\n        position,\n        group,\n        updateFilterValue,\n        update,\n    } = props;\n    const [val, setval] = React.useState<number>(Number(state));\n\n    const handleChange = (checked: boolean | null | undefined) => {\n        // eslint-disable-next-line no-nested-ternary\n        const newState = checked === undefined ? 0 : checked ? 1 : 2;\n        setval(newState);\n        const upd = update.filter((e: {\n            position: number; group: number | undefined;\n        }) => !(position === e.position && group === e.group));\n        updateFilterValue([...upd, {\n            position,\n            state: newState.toString(),\n            group,\n        }]);\n    };\n\n    if (state !== undefined) {\n        return (\n            <ThreeStateCheckboxInput\n                label={name}\n                checked={[undefined, true, false][val]}\n                onChange={(checked) => handleChange(checked)}\n            />\n        );\n    }\n    return (<></>);\n};\n\nexport default TriStateFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { ExpandLess, ExpandMore } from '@mui/icons-material';\nimport {\n    Collapse, ListItemButton, ListItemText, Stack,\n} from '@mui/material';\nimport { Box } from '@mui/system';\nimport React from 'react';\n// eslint-disable-next-line import/no-cycle\nimport { Options } from '../SourceOptions';\n\ninterface Props {\n    state: ISourceFilters[]\n    name: string\n    position: number\n    updateFilterValue: Function\n    update: any\n}\n\nconst GroupFilter: React.FC<Props> = (props: Props) => {\n    const {\n        state,\n        name,\n        position,\n        updateFilterValue,\n        update,\n    } = props;\n\n    const [open, setOpen] = React.useState(false);\n\n    return (\n        <Box sx={{ mx: -2 }}>\n            <ListItemButton onClick={() => setOpen(!open)}>\n                <ListItemText primary={name} />\n                {open ? <ExpandLess /> : <ExpandMore />}\n            </ListItemButton>\n            <Collapse in={open}>\n                {/* Container is moved outside 2, so content has to go inside 4 */}\n                <Stack sx={{ mx: 4 }}>\n                    <Options\n                        sourceFilter={state}\n                        group={position}\n                        updateFilterValue={updateFilterValue}\n                        update={update}\n                    />\n                </Stack>\n            </Collapse>\n        </Box>\n    );\n};\n\nexport default GroupFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { Divider } from '@mui/material';\nimport React from 'react';\n\ninterface Props {\n    name: string\n}\n\nconst SeparatorFilter: React.FC<Props> = ({ name }) => (<Divider key={name} sx={{ my: 1 }} textAlign=\"center\">{name}</Divider>);\n\nexport default SeparatorFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport { Button, Fab, Stack } from '@mui/material';\nimport { Box } from '@mui/system';\nimport OptionsPanel from 'components/molecules/OptionsPanel';\nimport React from 'react';\nimport CheckBoxFilter from './filters/CheckBoxFilter';\nimport HeaderFilter from './filters/HeaderFilter';\nimport SelectFilter from './filters/SelectFilter';\nimport SortFilter from './filters/SortFilter';\nimport TextFilter from './filters/TextFilter';\nimport TriStateFilter from './filters/TriStateFilter';\n// this can only cycle once, so should be fine\n// eslint-disable-next-line import/no-cycle\nimport GroupFilter from './filters/GroupFilter';\nimport SeperatorFilter from './filters/SeparatorFilter';\n\ninterface IFilters {\n    sourceFilter: ISourceFilters[]\n    updateFilterValue: Function\n    group: number | undefined\n    update: any\n}\n\ninterface IFilters1 {\n    sourceFilter: ISourceFilters[]\n    updateFilterValue: Function\n    resetFilterValue: Function\n    setTriggerUpdate: Function\n    setSearch: Function\n    update: any\n}\n\nexport function Options({\n    sourceFilter,\n    group,\n    updateFilterValue,\n    update,\n}: IFilters) {\n    return (\n        <Stack key={`filters ${group}`}>\n            { sourceFilter.map((e: ISourceFilters, index) => {\n                let checkif = update.find((el: {\n                    group: number | undefined; position: number;\n                }) => el.group === group && el.position === index);\n                checkif = checkif ? checkif.state : checkif;\n                switch (e.type) {\n                    case 'CheckBox':\n                        return (\n                            <CheckBoxFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                state={checkif === 'false' || e.filter.state as boolean}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'Group':\n                        return (\n                            <GroupFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                state={e.filter.state as ISourceFilters[]}\n                                position={index}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'Header':\n                        return (\n                            <HeaderFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                            />\n                        );\n                    case 'Select':\n                        return (\n                            <SelectFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                values={e.filter.displayValues}\n                                state={parseInt(checkif, 10) || e.filter.state as number}\n                                selected={e.filter.selected}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'Separator':\n                        return (\n                            <SeperatorFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                            />\n                        );\n                    case 'Sort':\n                        return (\n                            <SortFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                values={e.filter.values}\n                                state={checkif ? JSON.parse(checkif) : e.filter.state as IState}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'Text':\n                        return (\n                            <TextFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                state={checkif || e.filter.state as string}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'TriState':\n                        return (\n                            <TriStateFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                state={parseInt(checkif, 10) || e.filter.state as number}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    default:\n                        return (<Box key={`${e.filter.name}null`} />);\n                }\n            })}\n        </Stack>\n    );\n}\n\nexport default function SourceOptions({\n    sourceFilter,\n    updateFilterValue,\n    resetFilterValue,\n    setTriggerUpdate,\n    setSearch,\n    update,\n}: IFilters1) {\n    const [FilterOptions, setFilterOptions] = React.useState(false);\n\n    function handleReset() {\n        resetFilterValue(0);\n        setFilterOptions(false);\n    }\n\n    function handleSubmit() {\n        setTriggerUpdate(0);\n        setSearch(true);\n        setFilterOptions(false);\n    }\n\n    return (\n        <>\n            <Fab\n                sx={{ position: 'fixed', bottom: '2em', right: '3em' }}\n                onClick={() => setFilterOptions(!FilterOptions)}\n                variant=\"extended\"\n                color=\"primary\"\n            >\n                <FilterListIcon />\n                Filter\n            </Fab>\n\n            <OptionsPanel\n                open={FilterOptions}\n                onClose={() => setFilterOptions(false)}\n            >\n                <Box sx={{ display: 'flex', p: 2, pb: 0 }}>\n                    <Button\n                        onClick={handleReset}\n                    >\n                        Reset\n                    </Button>\n                    <Button\n                        sx={{ marginLeft: 'auto' }}\n                        variant=\"contained\"\n                        onClick={handleSubmit}\n                    >\n                        Submit\n                    </Button>\n                </Box>\n                <Box\n                    sx={{\n                        pb: 2,\n                        mx: 2,\n                    }}\n                >\n                    <Options\n                        sourceFilter={sourceFilter}\n                        updateFilterValue={updateFilterValue}\n                        group={undefined}\n                        update={update}\n                    />\n                </Box>\n            </OptionsPanel>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport {\n    IconButton, Menu, MenuItem, FormControlLabel, Radio,\n} from '@mui/material';\nimport React from 'react';\nimport ViewModuleIcon from '@mui/icons-material/ViewModule';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\n\nexport default function SourceGridLayout() {\n    const { options, setOptions } = useLibraryOptionsContext();\n\n    const [anchorEl, setAnchorEl] = React.useState(null);\n    const open = Boolean(anchorEl);\n    const handleClick = (event: any) => {\n        setAnchorEl(event.currentTarget);\n    };\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    function setGridContextOptions(\n        e: React.ChangeEvent<HTMLInputElement>,\n        checked: boolean,\n    ) {\n        if (checked) {\n            setOptions((prev: any) => ({ ...prev, SourcegridLayout: parseInt(e.target.name, 10) }));\n        }\n    }\n\n    return (\n        <>\n            <IconButton\n                onClick={handleClick}\n                size=\"small\"\n                sx={{ ml: 2 }}\n                aria-controls={open ? 'account-menu' : undefined}\n                aria-haspopup=\"true\"\n                aria-expanded={open ? 'true' : undefined}\n            >\n                <ViewModuleIcon />\n            </IconButton>\n            <Menu\n                id=\"basic-menu\"\n                anchorEl={anchorEl}\n                open={open}\n                onClose={handleClose}\n                MenuListProps={{ 'aria-labelledby': 'basic-button' }}\n            >\n                <MenuItem onClick={handleClose}>\n                    <FormControlLabel\n                        label=\"Compact grid\"\n                        control={(\n                            <Radio\n                                name=\"0\"\n                                // eslint-disable-next-line max-len\n                                checked={options.SourcegridLayout === 0 || options.SourcegridLayout === undefined}\n                                onChange={setGridContextOptions}\n                            />\n                        )}\n                    />\n                </MenuItem>\n                <MenuItem onClick={handleClose}>\n                    <FormControlLabel\n                        label=\"Comfortable grid\"\n                        control={(\n                            <Radio\n                                name=\"1\"\n                                checked={options.SourcegridLayout === 1}\n                                onChange={setGridContextOptions}\n                            />\n                        )}\n                    />\n                </MenuItem>\n                <MenuItem onClick={handleClose}>\n                    <FormControlLabel\n                        label=\"List\"\n                        control={(\n                            <Radio\n                                name=\"2\"\n                                checked={options.SourcegridLayout === 2}\n                                onChange={setGridContextOptions}\n                            />\n                        )}\n                    />\n                </MenuItem>\n            </Menu>\n\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport IconButton from '@mui/material/IconButton';\nimport SourceMangaGrid from 'components/source/SourceMangaGrid';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport SettingsIcon from '@mui/icons-material/Settings';\nimport SourceOptions from 'components/source/SourceOptions';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport { useQueryParam, StringParam } from 'use-query-params';\nimport SourceGridLayout from 'components/source/GridLayouts';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\n\ninterface IPos {\n    position: number\n    state: any\n    group?: number\n}\n\nexport default function SourceMangas(props: { popular: boolean }) {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const history = useHistory();\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const [isConfigurable, setIsConfigurable] = useState<boolean>(false);\n    const [mangas, setMangas] = useState<IMangaCard[]>([]);\n    const [hasNextPage, setHasNextPage] = useState<boolean>(false);\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n    const [fetched, setFetched] = useState<boolean>(false);\n\n    const [Search, setSearch] = useState<boolean>();\n    const [query, setquery] = useQueryParam('query', StringParam);\n    const [reset, setReset] = React.useState(2);\n    const [update, setUpdate] = useState<IPos[]>([]);\n    const [triggerUpdate, setTriggerUpdate] = useState<number>(2);\n    const [Data, SetData] = useState<ISourceFilters[]>();\n\n    const [Init, setInit] = useState<undefined | null>();\n    const [Noreset, setNoreset] = useQueryParam('R');\n\n    const { options } = useLibraryOptionsContext();\n\n    function makeFilters() {\n        client.get(`/api/v1/source/${sourceId}/filters`)\n            .then((response) => response.data)\n            .then((data: ISourceFilters[]) => {\n                SetData(data);\n            });\n    }\n\n    useEffect(() => {\n        setTitle('Source'); // title is later set after a fetch but we set it here once\n    }, []);\n\n    useEffect(() => {\n        client.get(`/api/v1/source/${sourceId}`)\n            .then((response) => response.data)\n            .then((data: ISource) => {\n                setTitle(data.displayName);\n                setIsConfigurable(data.isConfigurable);\n            });\n    }, []);\n\n    useEffect(() => {\n        if (triggerUpdate === 2) {\n            return;\n        }\n        if (triggerUpdate === 0) {\n            setTriggerUpdate(1);\n            return;\n        }\n        if (update.length > 0) {\n            const rep = update;\n            setUpdate([]);\n            client.post(`/api/v1/source/${sourceId}/filters`,\n                rep.map((e: IPos) => {\n                    const { position, state, group }: IPos = e;\n                    return group === undefined ? {\n                        position,\n                        state,\n                    } : {\n                        position: group,\n                        state: JSON.stringify({\n                            position,\n                            state,\n                        }),\n                    };\n                }))\n                .then(() => {\n                    setTriggerUpdate(0);\n                    makeFilters();\n                });\n        } else {\n            setFetched(false);\n            setMangas([]);\n            setLastPageNum(0);\n            if (Noreset === undefined && Search) { setNoreset(null); }\n        }\n    }, [triggerUpdate]);\n\n    useEffect(() => {\n        if (reset === 0) {\n            setquery(undefined);\n            setNoreset(undefined);\n            setReset(1);\n        } else if (Noreset === undefined) {\n            client.get(`/api/v1/source/${sourceId}/filters?reset=true`)\n                .then(() => {\n                    makeFilters();\n                    setSearch(false);\n                    if (reset === 1) {\n                        setTriggerUpdate(0);\n                    }\n                });\n            return;\n        }\n        makeFilters();\n    }, [reset]);\n\n    useEffect(() => {\n        setAction(\n            <>\n                <SourceGridLayout />\n                <AppbarSearch />\n                {isConfigurable && (\n                    <IconButton\n                        onClick={() => history.push(`/sources/${sourceId}/configure/`)}\n                        aria-label=\"display more actions\"\n                        edge=\"end\"\n                        color=\"inherit\"\n                        size=\"large\"\n                    >\n                        <SettingsIcon />\n                    </IconButton>\n                )}\n            </>\n            ,\n        );\n\n        return () => {\n            setAction(<></>);\n        };\n    }, [isConfigurable]);\n\n    useEffect(() => {\n        if (query) {\n            setSearch(true);\n        } else { setSearch(false); }\n        if (Noreset === undefined) { setInit(null); }\n    }, [query]);\n\n    useEffect(() => {\n        if (Search !== undefined && query !== undefined && Init === null) {\n            const delayDebounceFn = setTimeout(() => {\n                setTriggerUpdate(0);\n            }, 1000);\n            return () => clearTimeout(delayDebounceFn);\n        }\n        if (Search !== undefined) { setInit(null); }\n        return () => {};\n    }, [Search, query]);\n\n    useEffect(() => {\n        if (lastPageNum !== 0) {\n            const sourceType = props.popular ? 'popular' : 'latest';\n            client.get(`/api/v1/source/${sourceId}/${query !== undefined || Search || Noreset === null ? 'search' : sourceType}${query !== undefined || Search || Noreset === null ? `?searchTerm=${query || ''}&pageNum=${lastPageNum}` : `/${lastPageNum}`}`)\n                .then((response) => response.data)\n                .then((data: { mangaList: IManga[], hasNextPage: boolean }) => {\n                    setMangas([\n                        ...mangas,\n                        ...data.mangaList.map((it) => ({\n                            title: it.title,\n                            thumbnailUrl: it.thumbnailUrl,\n                            id: it.id,\n                            inLibrary: it.inLibrary,\n                        }))]);\n                    setHasNextPage(data.hasNextPage);\n                    setFetched(true);\n                });\n        } else { setLastPageNum(1); }\n    }, [lastPageNum]);\n\n    let message;\n    let messageExtra;\n\n    if (fetched) {\n        message = 'No manga was found!';\n        if (sourceId === '0') {\n            messageExtra = (\n                <>\n                    <span>Check out </span>\n                    <a href=\"https://github.com/Suwayomi/Tachidesk-Server/wiki/Local-Source\">Local source guide</a>\n                </>\n            );\n        }\n    }\n\n    return (\n        <>\n            <SourceMangaGrid\n                mangas={mangas}\n                hasNextPage={hasNextPage}\n                lastPageNum={lastPageNum}\n                setLastPageNum={setLastPageNum}\n                message={message}\n                messageExtra={messageExtra}\n                isLoading={!fetched}\n                gridLayout={options.SourcegridLayout}\n            />\n            {Data !== undefined && (\n                <SourceOptions\n                    sourceFilter={Data}\n                    updateFilterValue={setUpdate}\n                    resetFilterValue={setReset}\n                    setTriggerUpdate={setTriggerUpdate}\n                    setSearch={setSearch}\n                    update={update}\n                />\n            )}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useRef } from 'react';\nimport SpinnerImage from 'components/util/SpinnerImage';\nimport useLocalStorage from 'util/useLocalStorage';\nimport Box from '@mui/system/Box';\n\nfunction imageStyle(settings: IReaderSettings): any {\n    const [dimensions, setDimensions] = React.useState({\n        height: window.innerHeight,\n        width: window.innerWidth,\n    });\n    React.useEffect(() => {\n        function handleResize() {\n            setDimensions({\n                height: window.innerHeight,\n                width: window.innerWidth,\n            });\n        }\n        window.addEventListener('resize', handleResize);\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        };\n    }, []);\n    if (settings.readerType === 'DoubleLTR'\n    || settings.readerType === 'DoubleRTL'\n    || settings.readerType === 'ContinuesHorizontalLTR'\n    || settings.readerType === 'ContinuesHorizontalRTL') {\n        return {\n            display: 'block',\n            marginLeft: '7px',\n            marginRight: '7px',\n            width: 'auto',\n            minHeight: '99vh',\n            height: 'auto',\n            maxHeight: '99vh',\n            objectFit: 'contain',\n            pointerEvents: 'none',\n        };\n    }\n\n    return {\n        display: 'block',\n        marginBottom: settings.readerType === 'ContinuesVertical' ? '15px' : 0,\n        minWidth: '50vw',\n        width: dimensions.width < dimensions.height ? '100vw' : '100%',\n        maxWidth: '100%',\n    };\n}\n\ninterface IProps {\n    src: string\n    index: number\n    onImageLoad: () => void\n    settings: IReaderSettings\n}\n\nconst Page = React.forwardRef((props: IProps, ref: any) => {\n    const {\n        src, index, onImageLoad, settings,\n    } = props;\n\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const imgRef = useRef<HTMLImageElement>(null);\n\n    const imgStyle = imageStyle(settings);\n\n    return (\n        <Box ref={ref} sx={{ margin: 'auto' }}>\n            <SpinnerImage\n                src={`${src}?useCache=${useCache}`}\n                onImageLoad={onImageLoad}\n                alt={`Page #${index}`}\n                imgRef={imgRef}\n                spinnerStyle={{\n                    ...imgStyle,\n                    height: '100vh',\n                    width: '70vw',\n                    padding: '50px calc(50% - 20px)',\n                    backgroundColor: '#525252',\n                    marginBottom: 10,\n                }}\n                imgStyle={imgStyle}\n            />\n        </Box>\n    );\n});\n\nexport default Page;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from '../Page';\n\nconst findCurrentPageIndex = (wrapper: HTMLDivElement): number => {\n    for (let i = 0; i < wrapper.children.length; i++) {\n        const child = wrapper.children.item(i);\n        if (child) {\n            const { left, right } = child.getBoundingClientRect();\n            if (left <= window.innerWidth / 2 && right > window.innerWidth / 2) return i;\n        }\n    }\n    return -1;\n};\n\nconst isAtEnd = () => window.innerWidth + window.scrollX >= document.body.scrollWidth;\nconst isAtStart = () => window.scrollX <= 0;\n\nexport default function HorizontalPager(props: IReaderProps) {\n    const {\n        pages, curPage, initialPage, settings, setCurPage, prevChapter, nextChapter,\n    } = props;\n\n    const currentPageRef = useRef(initialPage);\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLDivElement[]>([]);\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            pagesRef.current[curPage + 1]?.scrollIntoView({ inline: 'center' });\n            setCurPage((page) => page + 1);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            pagesRef.current[curPage - 1]?.scrollIntoView({ inline: 'center' });\n            setCurPage(curPage - 1);\n        } else if (curPage === 0) {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            prevPage();\n        } else {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    const mouseXPos = useRef<number>(0);\n\n    function dragScreen(e: MouseEvent) {\n        window.scrollBy(mouseXPos.current - e.pageX, 0);\n    }\n\n    function dragControl(e:MouseEvent) {\n        mouseXPos.current = e.pageX;\n        selfRef.current?.addEventListener('mousemove', dragScreen);\n    }\n\n    function removeDragControl() {\n        selfRef.current?.removeEventListener('mousemove', dragScreen);\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX >= window.innerWidth * 0.85) {\n            goRight();\n        } else if (e.clientX <= window.innerWidth * 0.15) {\n            goLeft();\n        }\n    }\n\n    const handleLoadNextonEnding = () => {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            if (window.scrollX + window.innerWidth >= document.body.scrollWidth) {\n                nextChapter();\n            }\n        } else if (settings.readerType === 'ContinuesHorizontalRTL') {\n            if (window.scrollX <= window.innerWidth) {\n                nextChapter();\n            }\n        }\n    };\n\n    useEffect(() => {\n        // Delay scrolling to next cycle\n        setTimeout(() => {\n            // scroll last read page into view when initialPage changes\n            pagesRef.current[initialPage]?.scrollIntoView({ inline: 'center' });\n        }, 0);\n    }, [initialPage]);\n\n    useEffect(() => {\n        selfRef.current?.addEventListener('mousedown', dragControl);\n        selfRef.current?.addEventListener('mouseup', removeDragControl);\n\n        return () => {\n            selfRef.current?.removeEventListener('mousedown', dragControl);\n            selfRef.current?.removeEventListener('mouseup', removeDragControl);\n        };\n    }, [selfRef]);\n\n    useEffect(() => {\n        if (settings.loadNextonEnding) {\n            document.addEventListener('scroll', handleLoadNextonEnding);\n        }\n        selfRef.current?.addEventListener('mousedown', clickControl);\n\n        return () => {\n            document.removeEventListener('scroll', handleLoadNextonEnding);\n            selfRef.current?.removeEventListener('mousedown', clickControl);\n        };\n    }, [selfRef, curPage]);\n\n    useEffect(() => {\n        const handleScroll = () => {\n            if (!selfRef.current) return;\n\n            // Update current page in parent\n            const currentPage = findCurrentPageIndex(selfRef.current);\n            if (currentPage !== currentPageRef.current) {\n                currentPageRef.current = currentPage;\n                setCurPage(currentPage);\n            }\n\n            // Special case if scroll is moved all the way to the edge\n            // This handles cases when last page is show, but is smaller then\n            // window, in which case it would never get marked as read.\n            // See https://github.com/Suwayomi/Tachidesk-WebUI/issues/14 for more info\n            if (settings.readerType === 'ContinuesHorizontalLTR' ? isAtEnd() : isAtStart()) {\n                currentPageRef.current = pages.length - 1;\n                setCurPage(currentPageRef.current);\n            }\n        };\n        window.addEventListener('scroll', handleScroll);\n        return () => window.removeEventListener('scroll', handleScroll);\n    }, [settings.readerType]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: (settings.readerType === 'ContinuesHorizontalLTR') ? 'row' : 'row-reverse',\n                justifyContent: (settings.readerType === 'ContinuesHorizontalLTR') ? 'flex-start' : 'flex-end',\n                margin: '0 auto',\n                width: 'auto',\n                height: 'auto',\n                overflowX: 'visible',\n                userSelect: 'none',\n            }}\n        >\n            {\n                pages.map((page) => (\n                    <Page\n                        key={page.index}\n                        index={page.index}\n                        src={page.src}\n                        onImageLoad={() => {}}\n                        settings={settings}\n                        ref={(e:HTMLDivElement) => { pagesRef.current[page.index] = e; }}\n                    />\n                ))\n            }\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    settings: IReaderSettings\n    curPage: number\n    pageCount: number\n}\n\nexport default function PageNumber(props: IProps) {\n    const { settings, curPage, pageCount } = props;\n\n    return (\n        <Box sx={{\n            display: settings.showPageNumber ? 'block' : 'none',\n            position: 'fixed',\n            bottom: '50px',\n            right: settings.staticNav ? 'calc((100vw - 325px)/2)' : 'calc((100vw - 25px)/2)',\n            padding: '2px',\n            paddingLeft: '4px',\n            paddingRight: '4px',\n            textAlign: 'center',\n            backgroundColor: 'rgba(0, 0, 0, 0.3)',\n            borderRadius: '10px',\n        }}\n        >\n            {`${curPage + 1} / ${pageCount}`}\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from '../Page';\n\nexport default function PagedReader(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, curPage, nextChapter, prevChapter,\n    } = props;\n\n    const selfRef = useRef<HTMLDivElement>(null);\n\n    const changePage = (newPage: number) => {\n        setCurPage(newPage);\n        window.scroll({ top: 0 });\n    };\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            changePage(curPage + 1);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            changePage(curPage - 1);\n        } else {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'SingleLTR') {\n            prevPage();\n        } else if (settings.readerType === 'SingleRTL') {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'SingleLTR') {\n            nextPage();\n        } else if (settings.readerType === 'SingleRTL') {\n            prevPage();\n        }\n    }\n\n    function keyboardControl(e:KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                goRight();\n                break;\n            case 'ArrowLeft':\n                goLeft();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            goRight();\n        } else {\n            goLeft();\n        }\n    }\n\n    useEffect(() => {\n        document.addEventListener('keydown', keyboardControl);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage, settings.readerType]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: 'row',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: '100%',\n                height: '100vh',\n            }}\n        >\n            <Page\n                key={curPage}\n                index={curPage}\n                onImageLoad={() => {}}\n                src={pages[curPage].src}\n                settings={settings}\n            />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Box, styled } from '@mui/system';\n\nconst Image = styled('img')({\n    marginBottom: 0,\n    width: 'auto',\n    minHeight: '99vh',\n    height: 'auto',\n    maxHeight: '99vh',\n    objectFit: 'contain',\n});\n\ninterface IProps {\n    index: number\n    image1src: string\n    image2src: string\n    settings: IReaderSettings\n}\n\nconst DoublePage = React.forwardRef((props: IProps, ref: any) => {\n    const {\n        image1src, image2src, index, settings,\n    } = props;\n\n    return (\n        <Box\n            ref={ref}\n            sx={{\n                display: 'flex',\n                flexDirection: settings.readerType === 'DoubleLTR' ? 'row' : 'row-reverse',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: 'auto',\n                height: 'auto',\n                overflowX: 'scroll',\n            }}\n        >\n            <Image\n                src={image1src}\n                alt={`Page #${index}`}\n            />\n            <Image\n                src={image2src}\n                alt={`Page #${index + 1}`}\n            />\n        </Box>\n    );\n});\n\nexport default DoublePage;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Box } from '@mui/system';\nimport Page from '../Page';\nimport DoublePage from '../DoublePage';\n\nexport default function DoublePagedPager(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, curPage, nextChapter, prevChapter,\n    } = props;\n\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLImageElement[]>([]);\n\n    const pagesDisplayed = useRef<number>(0);\n    const pageLoaded = useRef<boolean[]>(Array(pages.length).fill(false));\n\n    function setPagesToDisplay() {\n        pagesDisplayed.current = 0;\n        if (curPage < pages.length && pagesRef.current[curPage]) {\n            if (pageLoaded.current[curPage]) {\n                pagesDisplayed.current = 1;\n                const imgElem = pagesRef.current[curPage];\n                const aspectRatio = imgElem.height / imgElem.width;\n                if (aspectRatio < 1) {\n                    return;\n                }\n            }\n        }\n        if (curPage + 1 < pages.length && pagesRef.current[curPage + 1]) {\n            if (pageLoaded.current[curPage + 1]) {\n                const imgElem = pagesRef.current[curPage + 1];\n                const aspectRatio = imgElem.height / imgElem.width;\n                if (aspectRatio < 1) {\n                    return;\n                }\n                pagesDisplayed.current = 2;\n            }\n        }\n    }\n\n    function displayPages() {\n        if (pagesDisplayed.current === 2) {\n            ReactDOM.render(\n                <DoublePage\n                    key={curPage}\n                    index={curPage}\n                    image1src={pages[curPage].src}\n                    image2src={pages[curPage + 1].src}\n                    settings={settings}\n                />,\n                document.getElementById('display'),\n            );\n        } else {\n            ReactDOM.render(\n                <Page\n                    key={curPage}\n                    index={curPage}\n                    src={(pagesDisplayed.current === 1) ? pages[curPage].src : ''}\n                    onImageLoad={() => {}}\n                    settings={settings}\n                />,\n                document.getElementById('display'),\n            );\n        }\n    }\n\n    function pagesToGoBack() {\n        for (let i = 1; i <= 2; i++) {\n            if (curPage - i > 0 && pagesRef.current[curPage - i]) {\n                if (pageLoaded.current[curPage - i]) {\n                    const imgElem = pagesRef.current[curPage - i];\n                    const aspectRatio = imgElem.height / imgElem.width;\n                    if (aspectRatio < 1) {\n                        return 1;\n                    }\n                }\n            }\n        }\n        return 2;\n    }\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            const nextCurPage = curPage + pagesDisplayed.current;\n            setCurPage((nextCurPage >= pages.length) ? pages.length - 1 : nextCurPage);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            const nextCurPage = curPage - pagesToGoBack();\n            setCurPage((nextCurPage < 0) ? 0 : nextCurPage);\n        } else {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'DoubleLTR') {\n            prevPage();\n        } else {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'DoubleLTR') {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    function keyboardControl(e:KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                goRight();\n                break;\n            case 'ArrowLeft':\n                goLeft();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            goRight();\n        } else {\n            goLeft();\n        }\n    }\n\n    function handleImageLoad(index: number) {\n        return () => {\n            pageLoaded.current[index] = true;\n        };\n    }\n\n    useEffect(() => {\n        const retryDisplay = setInterval(() => {\n            const isLastPage = (curPage === pages.length - 1);\n            if ((!isLastPage && pageLoaded.current[curPage] && pageLoaded.current[curPage + 1])\n                || pageLoaded.current[curPage]) {\n                setPagesToDisplay();\n                displayPages();\n                clearInterval(retryDisplay);\n            }\n        }, 50);\n\n        document.addEventListener('keydown', keyboardControl);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            clearInterval(retryDisplay);\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage, settings.readerType]);\n\n    return (\n        <Box ref={selfRef}>\n            <Box id=\"preload\" sx={{ display: 'none' }}>\n                {\n                    pages.map((page) => (\n                        <img\n                            ref={(e:HTMLImageElement) => { pagesRef.current[page.index] = e; }}\n                            key={`${page.index}`}\n                            src={page.src}\n                            onLoad={handleImageLoad(page.index)}\n                            alt={`${page.index}`}\n                        />\n                    ))\n                }\n            </Box>\n            <Box\n                id=\"display\"\n                sx={{\n                    display: 'flex',\n                    flexDirection: (settings.readerType === 'DoubleLTR') ? 'row' : 'row-reverse',\n                    justifyContent: 'center',\n                    margin: '0 auto',\n                    width: 'auto',\n                    height: 'auto',\n                    overflowX: 'scroll',\n                }}\n            />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useCallback, useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from '../Page';\n\nconst findCurrentPageIndex = (wrapper: HTMLDivElement): number => {\n    for (let i = 0; i < wrapper.children.length; i++) {\n        const child = wrapper.children.item(i);\n        if (child) {\n            const { top, bottom } = child.getBoundingClientRect();\n            if (top <= window.innerHeight && bottom > 1) return i;\n        }\n    }\n    return -1;\n};\n\n// TODO: make configurable?\nconst SCROLL_OFFSET = 0.95;\nconst SCROLL_BEHAVIOR: ScrollBehavior = 'smooth';\n\nconst isAtBottom = () => window.innerHeight + window.scrollY >= document.body.offsetHeight;\nconst isAtTop = () => window.scrollY <= 0;\n\nexport default function VerticalPager(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, initialPage, nextChapter, prevChapter,\n    } = props;\n\n    const currentPageRef = useRef(initialPage);\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLDivElement[]>([]);\n\n    useEffect(() => {\n        const handleScroll = () => {\n            if (!selfRef.current) return;\n\n            if (isAtBottom()) {\n                // If scroll is moved all the way to the bottom\n                // This handles cases when last page is show, but is smaller then\n                // window, in which case it would never get marked as read.\n                // See https://github.com/Suwayomi/Tachidesk-WebUI/issues/14 for more info\n                currentPageRef.current = pages.length - 1;\n                setCurPage(currentPageRef.current);\n\n                // Go to next chapter if configured to and at bottom\n                if (settings.loadNextonEnding) {\n                    nextChapter();\n                }\n            } else {\n                // Update current page in parent\n                const currentPage = findCurrentPageIndex(selfRef.current);\n                if (currentPage !== currentPageRef.current) {\n                    currentPageRef.current = currentPage;\n                    setCurPage(currentPage);\n                }\n            }\n        };\n\n        window.addEventListener('scroll', handleScroll);\n        return () => {\n            window.removeEventListener('scroll', handleScroll);\n        };\n    }, [settings.loadNextonEnding]);\n\n    const go = useCallback((direction: 'up' | 'down') => {\n        if (direction === 'down' && isAtBottom()) {\n            nextChapter();\n            return;\n        }\n\n        if (direction === 'up' && isAtTop()) {\n            prevChapter();\n            return;\n        }\n\n        window.scroll({\n            top: window.scrollY + (window.innerHeight * SCROLL_OFFSET) * (direction === 'up' ? -1 : 1),\n            behavior: SCROLL_BEHAVIOR,\n        });\n    }, [nextChapter, prevChapter]);\n\n    useEffect(() => {\n        const handleKeyboard = (e:KeyboardEvent) => {\n            switch (e.code) {\n                case 'Space':\n                case 'ArrowRight':\n                    e.preventDefault();\n                    go('down');\n                    break;\n                case 'ArrowLeft':\n                    e.preventDefault();\n                    go('up');\n                    break;\n                default:\n                    break;\n            }\n        };\n\n        document.addEventListener('keydown', handleKeyboard, false);\n        return () => {\n            document.removeEventListener('keydown', handleKeyboard);\n        };\n    }, []);\n\n    useEffect(() => {\n        // Delay scrolling to next cycle\n        setTimeout(() => {\n            // scroll last read page into view when initialPage changes\n            pagesRef.current[initialPage]?.scrollIntoView();\n        }, 0);\n    }, [initialPage]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: 'column',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: '100%',\n            }}\n            onClick={(e) => go(e.clientX > window.innerWidth / 2 ? 'down' : 'up')}\n        >\n            {\n                pages.map((page) => (\n                    <Page\n                        key={page.index}\n                        index={page.index}\n                        src={page.src}\n                        onImageLoad={() => {}}\n                        settings={settings}\n                        ref={(e:HTMLDivElement) => { pagesRef.current[page.index] = e; }}\n                    />\n                ))\n            }\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport IconButton from '@mui/material/IconButton';\nimport CloseIcon from '@mui/icons-material/Close';\nimport KeyboardArrowLeftIcon from '@mui/icons-material/KeyboardArrowLeft';\nimport KeyboardArrowRightIcon from '@mui/icons-material/KeyboardArrowRight';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport React, { useEffect, useState } from 'react';\nimport Typography from '@mui/material/Typography';\nimport { useHistory, Link } from 'react-router-dom';\nimport Slide from '@mui/material/Slide';\nimport Fade from '@mui/material/Fade';\nimport Zoom from '@mui/material/Zoom';\nimport { Switch } from '@mui/material';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport MenuItem from '@mui/material/MenuItem';\nimport Select from '@mui/material/Select';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Collapse from '@mui/material/Collapse';\nimport Button from '@mui/material/Button';\nimport { styled } from '@mui/system';\nimport useBackTo from 'util/useBackTo';\n\nconst Root = styled('div')(({ theme }) => ({\n    top: 0,\n    left: 0,\n    width: '300px',\n    minWidth: '300px',\n    height: '100vh',\n    overflowY: 'auto',\n    backgroundColor: theme.palette.background.default,\n\n    '& header': {\n        backgroundColor:\n        theme.palette.mode === 'dark' ? theme.palette.grey[800] : theme.palette.grey[100],\n        display: 'flex',\n        alignItems: 'center',\n        minHeight: '64px',\n        paddingLeft: '24px',\n        paddingRight: '24px',\n\n        transition: 'left 2s ease',\n\n        '& button': {\n            flexGrow: 0,\n            flexShrink: 0,\n        },\n\n        '& button:nth-child(1)': {\n            marginRight: '16px',\n        },\n\n        '& h1': {\n            fontSize: '1.25rem',\n            flexGrow: 1,\n        },\n    },\n    '& hr': {\n        margin: '0 16px',\n        height: '1px',\n        border: '0',\n        backgroundColor: theme.palette.mode === 'dark' ? theme.palette.grey[800] : theme.palette.grey[100],\n    },\n}));\n\nconst Navigation = styled('div')({\n    margin: '0 16px',\n    '& > span:nth-child(1)': {\n        textAlign: 'center',\n        display: 'block',\n        marginTop: '16px',\n    },\n});\n\nconst ChapterNavigation = styled('div')({\n    display: 'grid',\n    gridTemplateColumns: '1fr 1fr',\n    gridTemplateAreas: '\"prev next\"',\n    gridColumnGap: '5px',\n    margin: '10px 0',\n\n    '& a': {\n        flexGrow: 1,\n        textDecoration: 'none',\n\n        '& button': {\n            width: '100%',\n            padding: '5px 8px',\n            textTransform: 'none',\n        },\n    },\n});\n\nconst OpenDrawerButton = styled(IconButton)(({ theme }) => ({\n    position: 'fixed',\n    top: 0 + 20,\n    left: 10 + 20,\n    height: '40px',\n    width: '40px',\n    borderRadius: 5,\n    backgroundColor: theme.palette.mode === 'dark' ? 'black' : 'white',\n    '&:hover': {\n        backgroundColor: theme.palette.mode === 'dark' ? theme.palette.grey[900] : theme.palette.grey[100],\n    },\n}));\n\nexport const defaultReaderSettings = () => ({\n    staticNav: false,\n    showPageNumber: true,\n    continuesPageGap: false,\n    loadNextonEnding: false,\n    readerType: 'ContinuesVertical',\n} as IReaderSettings);\n\ninterface IProps {\n    settings: IReaderSettings\n    setSettings: React.Dispatch<React.SetStateAction<IReaderSettings>>\n    manga: IManga | IMangaCard\n    chapter: IChapter\n    curPage: number\n}\n\nexport default function ReaderNavBar(props: IProps) {\n    const history = useHistory();\n    const backTo = useBackTo();\n\n    const {\n        settings, setSettings, manga, chapter, curPage,\n    } = props;\n\n    const [drawerOpen, setDrawerOpen] = useState(false || settings.staticNav);\n    const [hideOpenButton, setHideOpenButton] = useState(false);\n    const [prevScrollPos, setPrevScrollPos] = useState(0);\n    const [settingsCollapseOpen, setSettingsCollapseOpen] = useState(true);\n\n    const setSettingValue = (key: string, value: any) => setSettings({ ...settings, [key]: value });\n\n    const handleScroll = () => {\n        const currentScrollPos = window.pageYOffset;\n\n        if (Math.abs(currentScrollPos - prevScrollPos) > 20) {\n            setHideOpenButton(currentScrollPos > prevScrollPos);\n            setPrevScrollPos(currentScrollPos);\n        }\n    };\n\n    useEffect(() => {\n        window.addEventListener('scroll', handleScroll);\n\n        const rootEl:HTMLDivElement = document.querySelector('#root')!;\n        const mainContainer:HTMLDivElement = document.querySelector('#appMainContainer')!;\n\n        // main container and root div need to change styles...\n        rootEl.style.display = 'flex';\n        mainContainer.style.display = 'none';\n\n        return () => {\n            rootEl.style.display = 'block';\n            mainContainer.style.display = 'block';\n            window.removeEventListener('scroll', handleScroll);\n        };\n    }, [handleScroll]);// handleScroll changes on every render\n\n    const handleClose = () => {\n        if (backTo.back) history.goBack();\n        else if (backTo.url) history.push(backTo.url);\n        else history.push(`/manga/${manga.id}`);\n    };\n\n    return (\n        <>\n            <Slide\n                direction=\"right\"\n                in={drawerOpen}\n                timeout={200}\n                appear={false}\n                mountOnEnter\n                unmountOnExit\n            >\n                <Root sx={{\n                    position: settings.staticNav ? 'sticky' : 'fixed',\n                }}\n                >\n                    <header>\n                        {!settings.staticNav\n                        && (\n                            <IconButton\n                                edge=\"start\"\n                                color=\"inherit\"\n                                aria-label=\"menu\"\n                                disableRipple\n                                onClick={() => setDrawerOpen(false)}\n                                size=\"large\"\n                            >\n                                <KeyboardArrowLeftIcon />\n                            </IconButton>\n                        )}\n                        <Typography variant=\"h1\" textOverflow=\"ellipsis\" overflow=\"hidden\" sx={{ py: 1 }}>\n                            {chapter.name}\n                        </Typography>\n                        <IconButton\n                            edge=\"start\"\n                            color=\"inherit\"\n                            aria-label=\"menu\"\n                            disableRipple\n                            onClick={handleClose}\n                            size=\"large\"\n                            sx={{ mr: -1 }}\n                        >\n                            <CloseIcon />\n                        </IconButton>\n                    </header>\n                    <ListItem\n                        ContainerComponent=\"div\"\n                        sx={{\n                            '& span': {\n                                fontWeight: 'bold',\n                            },\n                        }}\n                    >\n                        <ListItemText primary=\"Reader Settings\" />\n                        <ListItemSecondaryAction>\n                            <IconButton\n                                edge=\"start\"\n                                color=\"inherit\"\n                                aria-label=\"menu\"\n                                disableRipple\n                                disableFocusRipple\n                                onClick={() => setSettingsCollapseOpen(!settingsCollapseOpen)}\n                                size=\"large\"\n                            >\n                                {settingsCollapseOpen && <KeyboardArrowUpIcon />}\n                                {!settingsCollapseOpen && <KeyboardArrowDownIcon />}\n                            </IconButton>\n                        </ListItemSecondaryAction>\n                    </ListItem>\n                    <Collapse in={settingsCollapseOpen} timeout=\"auto\" unmountOnExit>\n                        <List>\n                            <ListItem>\n                                <ListItemText primary=\"Static Navigation\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.staticNav}\n                                        onChange={(e) => setSettingValue('staticNav', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Show page number\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.showPageNumber}\n                                        onChange={(e) => setSettingValue('showPageNumber', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Load next chapter at ending\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.loadNextonEnding}\n                                        onChange={(e) => setSettingValue('loadNextonEnding', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Reader Type\" />\n                                <Select\n                                    variant=\"standard\"\n                                    value={settings.readerType}\n                                    onChange={(e) => setSettingValue('readerType', e.target.value)}\n                                    sx={{ p: 0 }}\n                                >\n                                    <MenuItem value=\"SingleLTR\">\n                                        Single Page (LTR)\n                                    </MenuItem>\n                                    <MenuItem value=\"SingleRTL\">\n                                        Single Page (RTL)\n                                    </MenuItem>\n                                    {/* <MenuItem value=\"SingleVertical\">\n                                       Vertical(WIP)\n                                    </MenuItem> */}\n                                    <MenuItem value=\"DoubleLTR\">\n                                        Double Page (LTR)\n                                    </MenuItem>\n                                    <MenuItem value=\"DoubleRTL\">\n                                        Double Page (RTL)\n                                    </MenuItem>\n                                    <MenuItem value=\"Webtoon\">\n                                        Webtoon\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesVertical\">\n                                        Continues Vertical\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesHorizontalLTR\">\n                                        Horizontal (LTR)\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesHorizontalRTL\">\n                                        Horizontal (RTL)\n                                    </MenuItem>\n                                </Select>\n                            </ListItem>\n                        </List>\n                    </Collapse>\n                    <hr />\n                    <Navigation>\n                        <span>\n                            {`Currently on page ${curPage + 1} of ${chapter.pageCount}`}\n                        </span>\n                        <ChapterNavigation>\n                            {chapter.index > 1\n                        && (\n                            <Link\n                                replace\n                                to={{ pathname: `/manga/${manga.id}/chapter/${chapter.index - 1}`, state: history.location.state }}\n                            >\n                                <Button\n                                    variant=\"outlined\"\n                                    sx={{ gridArea: 'prev' }}\n                                    startIcon={<KeyboardArrowLeftIcon />}\n                                >\n                                    Prev. Chapter\n                                </Button>\n                            </Link>\n                        )}\n                            {chapter.index < chapter.chapterCount\n                        && (\n                            <Link\n                                replace\n                                style={{ gridArea: 'next' }}\n                                to={{ pathname: `/manga/${manga.id}/chapter/${chapter.index + 1}`, state: history.location.state }}\n                            >\n                                <Button\n                                    variant=\"outlined\"\n                                    endIcon={<KeyboardArrowRightIcon />}\n                                >\n                                    Next Chapter\n                                </Button>\n                            </Link>\n                        )}\n                        </ChapterNavigation>\n                    </Navigation>\n                </Root>\n            </Slide>\n            <Zoom in={!drawerOpen}>\n                <Fade in={!hideOpenButton}>\n                    <OpenDrawerButton\n                        edge=\"start\"\n                        color=\"inherit\"\n                        aria-label=\"menu\"\n                        disableRipple\n                        disableFocusRipple\n                        onClick={() => setDrawerOpen(true)}\n                        size=\"large\"\n                    >\n                        <KeyboardArrowRightIcon />\n                    </OpenDrawerButton>\n                </Fade>\n            </Zoom>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport CircularProgress from '@mui/material/CircularProgress';\nimport React, {\n    useCallback, useContext, useEffect, useState,\n} from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport HorizontalPager from 'components/reader/pager/HorizontalPager';\nimport PageNumber from 'components/reader/PageNumber';\nimport PagedPager from 'components/reader/pager/PagedPager';\nimport DoublePagedPager from 'components/reader/pager/DoublePagedPager';\nimport VerticalPager from 'components/reader/pager/VerticalPager';\nimport ReaderNavBar, { defaultReaderSettings } from 'components/navbar/ReaderNavBar';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport cloneObject from 'util/cloneObject';\nimport { Box } from '@mui/system';\n\nconst getReaderComponent = (readerType: ReaderType) => {\n    switch (readerType) {\n        case 'ContinuesVertical':\n        case 'Webtoon':\n            return VerticalPager;\n            break;\n        case 'SingleVertical':\n        case 'SingleRTL':\n        case 'SingleLTR':\n            return PagedPager;\n            break;\n        case 'DoubleVertical':\n        case 'DoubleRTL':\n        case 'DoubleLTR':\n            return DoublePagedPager;\n            break;\n        case 'ContinuesHorizontalLTR':\n        case 'ContinuesHorizontalRTL':\n            return HorizontalPager;\n        default:\n            return VerticalPager;\n            break;\n    }\n};\n\nconst range = (n:number) => Array.from({ length: n }, (value, key) => key);\nconst initialChapter = () => ({\n    pageCount: -1,\n    index: -1,\n    chapterCount: 0,\n    lastPageRead: 0,\n    name: 'Loading...',\n});\n\nexport default function Reader() {\n    const [settings, setSettings] = useLocalStorage<IReaderSettings>('readerSettings', defaultReaderSettings);\n\n    const history = useHistory();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const { chapterIndex, mangaId } = useParams<{ chapterIndex: string, mangaId: string }>();\n    const [manga, setManga] = useState<IMangaCard | IManga>({ id: +mangaId, title: '', thumbnailUrl: '' });\n    const [chapter, setChapter] = useState<IChapter | IPartialChapter>(initialChapter());\n    const [curPage, setCurPage] = useState<number>(0);\n    const { setOverride, setTitle } = useContext(NavbarContext);\n\n    useEffect(() => {\n        // make sure settings has all the keys\n        const settingsClone = cloneObject(settings) as any;\n        const defualtSettings = defaultReaderSettings();\n        let shouldUpdateSettings = false;\n        Object.keys(defualtSettings).forEach((key) => {\n            const keyOf = key as keyof IReaderSettings;\n            if (settings[keyOf] === undefined) {\n                settingsClone[keyOf] = defualtSettings[keyOf];\n                shouldUpdateSettings = true;\n            }\n        });\n        if (shouldUpdateSettings) { setSettings(settingsClone); }\n\n        // set the custom navbar\n        setOverride(\n            {\n                status: true,\n                value: (\n                    <ReaderNavBar\n                        settings={settings}\n                        setSettings={setSettings}\n                        manga={manga}\n                        chapter={chapter as IChapter}\n                        curPage={curPage}\n                    />\n                ),\n            },\n        );\n\n        // clean up for when we leave the reader\n        return () => setOverride({ status: false, value: <div /> });\n    }, [manga, chapter, settings, curPage, chapterIndex]);\n\n    useEffect(() => {\n        setTitle('Reader');\n        client.get(`/api/v1/manga/${mangaId}/`)\n            .then((response) => response.data)\n            .then((data: IManga) => {\n                setManga(data);\n                setTitle(data.title);\n            });\n    }, [chapterIndex]);\n\n    useEffect(() => {\n        setChapter(initialChapter);\n        client.get(`/api/v1/manga/${mangaId}/chapter/${chapterIndex}`)\n            .then((response) => response.data)\n            .then((data:IChapter) => {\n                setChapter(data);\n\n                if (data.lastPageRead === data.pageCount - 1) {\n                    // last page, also probably read = true, we will load the first page.\n                    setCurPage(0);\n                } else setCurPage(data.lastPageRead);\n            });\n    }, [chapterIndex]);\n\n    useEffect(() => {\n        if (curPage !== -1) {\n            const formData = new FormData();\n            formData.append('lastPageRead', curPage.toString());\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formData);\n        }\n\n        if (curPage === chapter.pageCount - 1) {\n            const formDataRead = new FormData();\n            formDataRead.append('read', 'true');\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formDataRead);\n        }\n    }, [curPage]);\n\n    const nextChapter = useCallback(() => {\n        if (chapter.index < chapter.chapterCount) {\n            const formData = new FormData();\n            formData.append('lastPageRead', `${chapter.pageCount - 1}`);\n            formData.append('read', 'true');\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formData);\n\n            history.replace({ pathname: `/manga/${manga.id}/chapter/${chapter.index + 1}`, state: history.location.state });\n        }\n    }, [chapter.index, chapter.chapterCount, chapter.pageCount, manga.id]);\n\n    const prevChapter = useCallback(() => {\n        if (chapter.index > 1) {\n            history.replace({ pathname: `/manga/${manga.id}/chapter/${chapter.index - 1}`, state: history.location.state });\n        }\n    }, [chapter.index, manga.id]);\n\n    // return spinner while chpater data is loading\n    if (chapter.pageCount === -1) {\n        return (\n            <Box sx={{\n                height: '100vh', width: '100vw', display: 'grid', placeItems: 'center',\n            }}\n            >\n                <CircularProgress thickness={5} />\n            </Box>\n        );\n    }\n\n    const pages = range(chapter.pageCount).map((index) => ({\n        index,\n        src: `${serverAddress}/api/v1/manga/${mangaId}/chapter/${chapterIndex}/page/${index}`,\n    }));\n\n    const ReaderComponent = getReaderComponent(settings.readerType);\n\n    // last page, also probably read = true, we will load the first page.\n    const initialPage = (chapter.lastPageRead === chapter.pageCount - 1) ? 0 : chapter.lastPageRead;\n\n    return (\n        <Box sx={{ width: settings.staticNav ? 'calc(100vw - 300px)' : '100vw' }}>\n            <PageNumber\n                settings={settings}\n                curPage={curPage}\n                pageCount={chapter.pageCount}\n            />\n            <ReaderComponent\n                pages={pages}\n                pageCount={chapter.pageCount}\n                setCurPage={setCurPage}\n                initialPage={initialPage}\n                curPage={curPage}\n                settings={settings}\n                manga={manga}\n                chapter={chapter}\n                nextChapter={nextChapter}\n                prevChapter={prevChapter}\n            />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, {\n    useContext, useEffect, useState, useRef,\n} from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport IconButton from '@mui/material/IconButton';\nimport DownloadIcon from '@mui/icons-material/Download';\nimport Avatar from '@mui/material/Avatar';\nimport Typography from '@mui/material/Typography';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport { Box } from '@mui/system';\n\nfunction epochToDate(epoch: number) {\n    const date = new Date(0); // The 0 there is the key, which sets the date to the epoch\n    date.setUTCSeconds(epoch);\n    return date;\n}\n\nfunction isTheSameDay(first:Date, second:Date) {\n    return first.getDate() === second.getDate()\n    && first.getMonth() === second.getMonth()\n    && first.getFullYear() === second.getFullYear();\n}\n\nfunction getDateString(date: Date) {\n    const today = new Date();\n    if (isTheSameDay(today, date)) return 'TODAY';\n    // calculate yesterday\n    const yesterday = new Date();\n    yesterday.setDate(today.getDate() - 1);\n    if (isTheSameDay(yesterday, date)) return 'YESTERDAY';\n    return date.toLocaleDateString();\n}\n\nfunction groupByDate(updates: IMangaChapter[]):\n[string, { item: IMangaChapter, globalIdx: number }[] ][] {\n    if (updates.length === 0) return [];\n\n    const groups = {};\n    updates.forEach((item, globalIdx) => {\n        const key = getDateString(epochToDate(item.chapter.fetchedAt));\n        // @ts-ignore\n        if (groups[key] === undefined) groups[key] = [];\n        // @ts-ignore\n        groups[key].push({ item, globalIdx });\n    });\n\n    // @ts-ignore\n    return Object.keys(groups).map((key) => [key, groups[key]]);\n}\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\nexport default function Updates() {\n    const history = useHistory();\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [updateEntries, setUpdateEntries] = useState<IMangaChapter[]>([]);\n    const [hasNextPage, setHasNextPage] = useState(true);\n    const [fetched, setFetched] = useState(false);\n    const [lastPageNum, setLastPageNum] = useState(0);\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const [, setWsClient] = useState<WebSocket>();\n    const [{ queue }, setQueueState] = useState<IQueue>(initialQueue);\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/downloads`);\n        wsc.onmessage = (e) => {\n            const data = JSON.parse(e.data) as IQueue;\n            setQueueState(data);\n        };\n\n        setWsClient(wsc);\n\n        return () => wsc.close();\n    }, []);\n\n    useEffect(() => {\n        setTitle('Updates');\n\n        setAction(<></>);\n    }, []);\n\n    useEffect(() => {\n        if (hasNextPage) {\n            client.get(`/api/v1/update/recentChapters/${lastPageNum}`)\n                .then((response) => response.data)\n                .then(({ hasNextPage: fetchedHasNextPage, page }: PaginatedList<IMangaChapter>) => {\n                    setUpdateEntries([\n                        ...updateEntries,\n                        ...page,\n                    ]);\n                    setHasNextPage(fetchedHasNextPage);\n                    setFetched(true);\n                });\n        }\n    }, [lastPageNum]);\n\n    const lastEntry = useRef<HTMLDivElement>(null);\n\n    const scrollHandler = () => {\n        if (lastEntry.current) {\n            const rect = lastEntry.current.getBoundingClientRect();\n            if (((rect.y + rect.height) / window.innerHeight < 2) && hasNextPage) {\n                setLastPageNum(lastPageNum + 1);\n            }\n        }\n    };\n    useEffect(() => {\n        window.addEventListener('scroll', scrollHandler, true);\n        return () => {\n            window.removeEventListener('scroll', scrollHandler, true);\n        };\n    }, [hasNextPage, updateEntries]);\n\n    if (!fetched) { return <LoadingPlaceholder />; }\n    if (fetched && updateEntries.length === 0) { return <EmptyView message=\"You don't have any updates yet.\" />; }\n\n    const downloadStatusStringFor = (chapter: IChapter) => {\n        let rtn = '';\n        if (chapter.downloaded) {\n            rtn = '  Downloaded';\n        }\n        queue.forEach((q) => {\n            if (chapter.index === q.chapterIndex && chapter.mangaId === q.mangaId) {\n                rtn = `  Downloading (${(q.progress * 100).toFixed(2)}%)`;\n            }\n        });\n        return rtn;\n    };\n\n    const downloadChapter = (chapter: IChapter) => {\n        client.get(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`);\n    };\n\n    return (\n        <>\n            {groupByDate(updateEntries).map((dateGroup) => (\n                <div key={dateGroup[0]}>\n                    <Typography\n                        variant=\"h5\"\n                        sx={{\n                            ml: 3,\n                            my: 2,\n                            fontWeight: 700,\n                        }}\n                    >\n                        {dateGroup[0]}\n                    </Typography>\n                    {dateGroup[1].map(({ item: { chapter, manga }, globalIdx }) => (\n                        <Card\n                            ref={globalIdx === updateEntries.length - 1 ? lastEntry : undefined}\n                            key={globalIdx}\n                            sx={{\n                                margin: '10px',\n                                '&:hover': {\n                                    backgroundColor: 'action.hover',\n                                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                },\n                                '&:active': {\n                                    backgroundColor: 'action.selected',\n                                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                },\n                            }}\n                            onClick={() => history.push({ pathname: `/manga/${chapter.mangaId}/chapter/${chapter.index}`, state: history.location.state })}\n                        >\n                            <CardContent sx={{\n                                display: 'flex',\n                                justifyContent: 'space-between',\n                                alignItems: 'center',\n                                padding: 2,\n                            }}\n                            >\n                                <Box sx={{ display: 'flex' }}>\n                                    <Avatar\n                                        variant=\"rounded\"\n                                        sx={{\n                                            width: 56,\n                                            height: 56,\n                                            flex: '0 0 auto',\n                                            marginRight: 2,\n                                            imageRendering: 'pixelated',\n                                        }}\n                                        src={`${serverAddress}${manga.thumbnailUrl}?useCache=${useCache}`}\n                                    />\n                                    <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n                                        <Typography variant=\"h5\" component=\"h2\">\n                                            {manga.title}\n                                        </Typography>\n                                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                            {chapter.name}\n                                            {downloadStatusStringFor(chapter)}\n                                        </Typography>\n                                    </Box>\n                                </Box>\n                                {downloadStatusStringFor(chapter) === ''\n                                        && (\n                                            <IconButton\n                                                onClick={(e) => {\n                                                    downloadChapter(chapter);\n                                                    // prevent parent tags from getting the event\n                                                    e.stopPropagation();\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <DownloadIcon />\n                                            </IconButton>\n                                        )}\n                            </CardContent>\n                        </Card>\n                    ))}\n                </div>\n            ))}\n        </>\n    );\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport NavbarContext from 'components/context/NavbarContext';\nimport React, { useContext, useEffect } from 'react';\nimport PlayArrowIcon from '@mui/icons-material/PlayArrow';\nimport PauseIcon from '@mui/icons-material/Pause';\nimport IconButton from '@mui/material/IconButton';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport client from 'util/client';\nimport {\n    DragDropContext, Draggable, DraggingStyle, Droppable, DropResult, NotDraggingStyle,\n} from 'react-beautiful-dnd';\nimport { useTheme, Palette } from '@mui/material/styles';\nimport List from '@mui/material/List';\nimport DragHandleIcon from '@mui/icons-material/DragHandle';\nimport ListItem from '@mui/material/ListItem';\nimport { ListItemIcon } from '@mui/material';\nimport EmptyView from 'components/util/EmptyView';\n\nimport { Box } from '@mui/system';\nimport Typography from '@mui/material/Typography';\nimport { useHistory } from 'react-router-dom';\nimport useSubscription from 'components/library/useSubscription';\n\nconst getItemStyle = (isDragging: boolean,\n    draggableStyle: DraggingStyle | NotDraggingStyle | undefined, palette: Palette) => ({\n    // styles we need to apply on draggables\n    ...draggableStyle,\n\n    ...(isDragging && {\n        background: palette.mode === 'dark' ? '#424242' : 'rgb(235,235,235)',\n    }),\n});\n\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\nexport default function DownloadQueue() {\n    const { data: queueState } = useSubscription<IQueue>('/api/v1/downloads');\n    const { queue, status } = queueState ?? initialQueue;\n\n    const history = useHistory();\n\n    const theme = useTheme();\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const toggleQueueStatus = () => {\n        if (status === 'Stopped') {\n            client.get('/api/v1/downloads/start');\n        } else {\n            client.get('/api/v1/downloads/stop');\n        }\n    };\n\n    useEffect(() => {\n        setTitle('Download Queue');\n\n        setAction(() => {\n            if (status === 'Stopped') {\n                return (\n                    <IconButton onClick={toggleQueueStatus} size=\"large\">\n                        <PlayArrowIcon />\n                    </IconButton>\n                );\n            }\n            return (\n                <IconButton onClick={toggleQueueStatus} size=\"large\">\n                    <PauseIcon />\n                </IconButton>\n            );\n        });\n    }, [status]);\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const onDragEnd = (result: DropResult) => {\n    };\n\n    if (queue.length === 0) {\n        return <EmptyView message=\"No downloads\" />;\n    }\n\n    const callDeleteServer = (chapter: IChapter) => {\n        // remove from download queue\n        client.delete(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`);\n\n        // delete partial download, should be handle server side?\n        // bug: The folder and the last image downloaded are not deleted\n        client.delete(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`);\n    };\n\n    const deleteChapterQueue = (chapter: IChapter) => {\n        // required to stop before deleting otherwise the download kept going. Server issue?\n        client.get('/api/v1/downloads/stop')\n            .then(() => callDeleteServer(chapter));\n    };\n\n    return (\n        <>\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <List ref={provided.innerRef}>\n                            {queue.map((item, index) => (\n                                <Draggable\n                                    key={`${item.mangaId}-${item.chapterIndex}`}\n                                    draggableId={`${item.mangaId}-${item.chapterIndex}`}\n                                    index={index}\n                                >\n                                    {(provided, snapshot) => (\n                                        <ListItem\n                                            ContainerProps={{ ref: provided.innerRef } as any}\n                                            sx={{\n                                                display: 'flex',\n                                                justifyContent: 'flex-start',\n                                                alignItems: 'flex-start',\n                                                padding: 2,\n                                                margin: '10px',\n                                                '&:hover': {\n                                                    backgroundColor: 'action.hover',\n                                                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                                },\n                                                '&:active': {\n                                                    backgroundColor: 'action.selected',\n                                                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                                },\n                                            }}\n                                            onClick={() => history.push(`/manga/${item.chapter.mangaId}`)}\n                                            {...provided.draggableProps}\n                                            {...provided.dragHandleProps}\n                                            style={getItemStyle(\n                                                snapshot.isDragging,\n                                                provided.draggableProps.style,\n                                                theme.palette,\n                                            )}\n                                            ref={provided.innerRef}\n                                        >\n                                            <ListItemIcon sx={{ margin: 'auto 0' }}>\n                                                <DragHandleIcon />\n                                            </ListItemIcon>\n                                            <Box sx={{ display: 'flex' }}>\n                                                <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n                                                    <Typography variant=\"h5\" component=\"h2\">\n                                                        {item.manga.title}\n                                                    </Typography>\n                                                    <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                                        {`${item.chapter.name} `\n                                                        + `(${(item.progress * 100).toFixed(2)}%)`\n                                                        + ` => state: ${item.state}`}\n                                                    </Typography>\n                                                </Box>\n                                            </Box>\n                                            <IconButton\n                                                sx={{ marginLeft: 'auto' }}\n                                                onClick={(e) => {\n                                                    // deleteCategory(index);\n                                                    // prevent parent tags from getting the event\n                                                    e.stopPropagation();\n\n                                                    // delete chapter from download queue\n                                                    deleteChapterQueue(item.chapter);\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <DeleteIcon />\n                                            </IconButton>\n                                        </ListItem>\n                                    )}\n                                </Draggable>\n\n                            ))}\n                            {provided.placeholder}\n                        </List>\n                    )}\n                </Droppable>\n            </DragDropContext>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport const ISOLanguages = [\n    { code: 'all', name: 'All', nativeName: 'All' },\n    { code: 'installed', name: 'Installed', nativeName: 'Installed' },\n    { code: 'updates pending', name: 'Updates pending', nativeName: 'Updates pending' },\n\n    { code: 'other', name: 'other langs?', nativeName: 'Other' },\n\n    { code: 'localsourcelang', name: 'Local source', nativeName: 'Local source' },\n\n    // full list: https://github.com/meikidd/iso-639-1/blob/master/src/data.js\n    { code: 'en', name: 'English', nativeName: 'English' },\n    { code: 'ca', name: 'Catalan; Valencian', nativeName: 'Catal' },\n    { code: 'de', name: 'German', nativeName: 'Deutsch' },\n    { code: 'es', name: 'Spanish; Castilian', nativeName: 'Espaol' },\n    { code: 'es-419', name: 'Spanish; Castilian', nativeName: 'Espaol (Latinoamrica)' },\n    { code: 'fr', name: 'French', nativeName: 'Franais' },\n    { code: 'id', name: 'Indonesian', nativeName: 'Indonesia' },\n    { code: 'it', name: 'Italian', nativeName: 'Italiano' },\n    { code: 'pt', name: 'Portuguese', nativeName: 'Portugus' },\n    { code: 'pt-pt', name: 'Portuguese', nativeName: 'Portugus (Portugal)' },\n    { code: 'pt-br', name: 'Portuguese; Brasil', nativeName: 'Portugus (Brasil)' },\n    { code: 'vi', name: 'Vietnamese', nativeName: 'Ting Vit' },\n    { code: 'tr', name: 'Turkish', nativeName: 'Trke' },\n    { code: 'ru', name: 'Russian', nativeName: '' },\n    { code: 'ar', name: 'Arabic', nativeName: '' },\n    { code: 'hi', name: 'Hindi', nativeName: '' },\n    { code: 'th', name: 'Thai', nativeName: '' },\n    { code: 'zh', name: 'Chinese', nativeName: '' },\n    { code: 'zh-hans', name: 'Chinese', nativeName: ' (HANS)' },\n    { code: 'zh-hant', name: 'Chinese', nativeName: ' (HANT)' },\n    { code: 'zh-rhk', name: 'Chinese', nativeName: ' (RHK)' },\n    { code: 'zh-rtw', name: 'Chinese', nativeName: ' (RTW)' },\n\n    { code: 'ja', name: 'Japanese', nativeName: '' },\n    { code: 'ko', name: 'Korean', nativeName: '' },\n    { code: 'zu', name: 'Zulu', nativeName: 'isiZulu' },\n    { code: 'xh', name: 'Xhosa', nativeName: 'isiXhosa' },\n    { code: 'uk', name: 'Ukrainian', nativeName: '' },\n    { code: 'ro', name: 'Romanian', nativeName: 'Romn' },\n    { code: 'bg', name: 'Bulgarian', nativeName: '' },\n    { code: 'cs', name: 'Czech', nativeName: 'etina' },\n    { code: 'pl', name: 'Polish', nativeName: 'polski' },\n    { code: 'no', name: 'Norwegian', nativeName: 'Norsk' },\n    { code: 'nl', name: 'Dutch', nativeName: 'Nederlands' },\n    { code: 'my', name: 'Burmese', nativeName: '' },\n    { code: 'ms', name: 'Malay', nativeName: 'Malaysia' },\n    { code: 'mn', name: 'Mongolian', nativeName: '' },\n    { code: 'ml', name: 'Malayalam', nativeName: '' },\n    { code: 'ku', name: 'Kurdish', nativeName: 'Kurd' },\n    { code: 'hu', name: 'Hungarian', nativeName: 'Magyar' },\n    { code: 'hr', name: 'Croatian', nativeName: 'Hrvatski' },\n    { code: 'he', name: 'Hebrew', nativeName: '' },\n    { code: 'fil', name: 'Filipino', nativeName: 'Filipino' },\n    { code: 'fi', name: 'Finnish', nativeName: 'suomi' },\n    { code: 'fa', name: 'Persian', nativeName: '' },\n    { code: 'eu', name: 'Basque', nativeName: 'euskara' },\n    { code: 'el', name: 'Greek', nativeName: '' },\n    { code: 'da', name: 'Danish', nativeName: 'dansk' },\n    { code: 'bn', name: 'Bengali', nativeName: '' },\n    { code: 'lt', name: 'Lithuanian', nativeName: 'lietuvi kalba' },\n    { code: 'sh', name: 'Serbo-Croatian', nativeName: 'srpskohrvatski' },\n\n    { code: 'af', name: 'Afrikaans', nativeName: 'Afrikaans' },\n    { code: 'am', name: 'Amharic', nativeName: '' },\n    { code: 'az', name: 'Azerbaijani', nativeName: 'Azrbaycan' },\n    { code: 'be', name: 'Belarusian', nativeName: '' },\n    { code: 'bs', name: 'Bosnian', nativeName: 'bosanski' },\n    { code: 'sv', name: 'Swedish', nativeName: 'svenska' },\n    { code: 'sv', name: 'Swedish', nativeName: 'svenska' },\n\n];\n\nexport function langCodeToName(code: string): string {\n    const whereToCut = code.indexOf('-') !== -1 ? code.indexOf('-') : code.length;\n\n    const proccessedCode = code.toLocaleLowerCase().substring(0, whereToCut);\n    let result = `language with code: ${code}`;\n\n    for (let i = 0; i < ISOLanguages.length; i++) {\n        if (ISOLanguages[i].code === proccessedCode\n            || ISOLanguages[i].code === code.toLocaleLowerCase()) {\n            result = ISOLanguages[i].nativeName;\n        }\n    }\n\n    return result;\n}\n\nfunction defaultNativeLang() {\n    return 'en'; // TODO: infer from the browser\n}\n\nexport function extensionDefaultLangs() {\n    return [\n        defaultNativeLang(),\n        'all',\n    ];\n}\n\nexport function sourceDefualtLangs() {\n    return [\n        defaultNativeLang(),\n        'localsourcelang',\n    ];\n}\n\nexport function sourceForcedDefaultLangs(): string[] {\n    return [\n        'localsourcelang',\n    ];\n}\n\nexport const langSortCmp = (a: string, b: string) => {\n    // puts english first for convience\n    const aLang = langCodeToName(a);\n    const bLang = langCodeToName(b);\n\n    if (a === 'en') return -1;\n    if (b === 'en') return 1;\n    if (a === 'localSourceLang') return 1;\n    if (b === 'localSourceLang') return -1;\n\n    return aLang > bLang ? 1 : -1;\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Button from '@mui/material/Button';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport Dialog from '@mui/material/Dialog';\nimport Switch from '@mui/material/Switch';\nimport IconButton from '@mui/material/IconButton';\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport { List, ListItemSecondaryAction, ListItemText } from '@mui/material';\nimport ListItem from '@mui/material/ListItem';\nimport { langCodeToName } from 'util/language';\nimport cloneObject from 'util/cloneObject';\n\nfunction removeAll(firstList: any[], secondList: any[]) {\n    secondList.forEach((item) => {\n        const index = firstList.indexOf(item);\n        if (index !== -1) {\n            firstList.splice(index, 1);\n        }\n    });\n\n    return firstList;\n}\n\ninterface IProps {\n    shownLangs: string[]\n    setShownLangs: (arg0: string[]) => void\n    allLangs: string[]\n    forcedLangs?: string[]\n}\n\nexport default function LangSelect(props: IProps) {\n    const {\n        shownLangs, setShownLangs, allLangs, forcedLangs,\n    } = props;\n    // hold a copy and only sate state on parent when OK pressed, improves performance\n    const [mShownLangs, setMShownLangs] = useState(\n        removeAll(cloneObject(shownLangs), forcedLangs!),\n    );\n    const [open, setOpen] = useState<boolean>(false);\n\n    const handleCancel = () => {\n        setOpen(false);\n    };\n\n    const handleOk = () => {\n        setOpen(false);\n        setShownLangs(mShownLangs);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, lang: string) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        if (checked) {\n            setMShownLangs([...mShownLangs, lang]);\n        } else {\n            const clone = cloneObject(mShownLangs);\n            clone.splice(clone.indexOf(lang), 1);\n            setMShownLangs(clone);\n        }\n    };\n\n    return (\n        <>\n            <IconButton\n                onClick={() => setOpen(true)}\n                aria-label=\"display more actions\"\n                edge=\"end\"\n                color=\"inherit\"\n                size=\"large\"\n            >\n                <FilterListIcon />\n            </IconButton>\n            <Dialog\n                sx={{\n                    '.MuiDialog-paper': {\n                        maxHeight: 435,\n                        width: '80%',\n                    },\n                }}\n                maxWidth=\"xs\"\n                open={open}\n            >\n                <DialogTitle>Enabled Languages</DialogTitle>\n                <DialogContent dividers sx={{ padding: 0 }}>\n                    <List>\n                        {allLangs.map((lang) => (\n                            <ListItem key={lang}>\n                                <ListItemText primary={langCodeToName(lang)} />\n\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        checked={mShownLangs.indexOf(lang) !== -1}\n                                        onChange={(e) => handleChange(e, lang)}\n                                    />\n                                </ListItemSecondaryAction>\n\n                            </ListItem>\n                        ))}\n                    </List>\n\n                </DialogContent>\n                <DialogActions>\n                    <Button autoFocus onClick={handleCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleOk} color=\"primary\">\n                        Ok\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n\nLangSelect.defaultProps = {\n    forcedLangs: [] as string[],\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport { useHistory } from 'react-router-dom';\nimport Button from '@mui/material/Button';\nimport Avatar from '@mui/material/Avatar';\nimport Typography from '@mui/material/Typography';\nimport useLocalStorage from 'util/useLocalStorage';\nimport { langCodeToName } from 'util/language';\nimport { Box, styled } from '@mui/system';\n\nconst MobileWidthButtons = styled('div')(({ theme }) => ({\n    display: 'flex',\n    [theme.breakpoints.up('sm')]: {\n        display: 'none',\n    },\n}));\n\nconst WiderWidthButtons = styled('div')(({ theme }) => ({\n    display: 'flex',\n    [theme.breakpoints.down('sm')]: {\n        display: 'none',\n    },\n\n    '& .MuiButton-root': {\n        marginLeft: '20px',\n    },\n}));\n\ninterface IProps {\n    source: ISource\n}\n\nexport default function SourceCard(props: IProps) {\n    const {\n        source: {\n            id, name, lang, iconUrl, supportsLatest, isNsfw,\n        },\n    } = props;\n\n    const history = useHistory();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const redirectTo = (e: any, to: string) => {\n        history.push(to);\n\n        // prevent parent tags from getting the event\n        e.stopPropagation();\n    };\n\n    return (\n        <Card\n            sx={{\n                margin: '10px',\n                '&:hover': {\n                    backgroundColor: 'action.hover',\n                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                },\n                '&:active': {\n                    backgroundColor: 'action.selected',\n                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                },\n            }}\n            onClick={(e) => redirectTo(e, `/sources/${id}/popular/`)}\n        >\n            <CardContent sx={{\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center',\n                padding: 2,\n            }}\n            >\n\n                <Box sx={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        alt={name}\n                        sx={{\n                            width: 56,\n                            height: 56,\n                            flex: '0 0 auto',\n                            mr: 2,\n                        }}\n                        src={`${serverAddress}${iconUrl}?useCache=${useCache}`}\n                    />\n                    <Box sx={{ display: 'flex', flexDirection: 'column', justifyContent: 'center' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        {id !== '0' && (\n                            <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                {langCodeToName(lang)}\n                                {isNsfw && (\n                                    <Typography variant=\"caption\" display=\"inline\" gutterBottom color=\"red\">\n                                        {' 18+'}\n                                    </Typography>\n                                )}\n                            </Typography>\n                        )}\n                    </Box>\n                </Box>\n                <>\n                    <MobileWidthButtons>\n                        {supportsLatest && (\n                            <Button\n                                variant=\"outlined\"\n                                onClick={(e) => redirectTo(e, `/sources/${id}/latest/`)}\n                            >\n                                Latest\n                            </Button>\n                        )}\n                    </MobileWidthButtons>\n                    <WiderWidthButtons>\n                        {supportsLatest && (\n                            <Button\n                                variant=\"outlined\"\n                                onClick={(e) => redirectTo(e, `/sources/${id}/latest/`)}\n                            >\n                                Latest\n                            </Button>\n                        )}\n                        <Button\n                            variant=\"outlined\"\n                            onClick={(e: any) => redirectTo(e, `/sources/${id}/popular/`)}\n                        >\n                            Browse\n                        </Button>\n                    </WiderWidthButtons>\n                </>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\nimport LangSelect from 'components/navbar/action/LangSelect';\nimport SourceCard from 'components/SourceCard';\nimport NavbarContext from 'components/context/NavbarContext';\nimport {\n    sourceDefualtLangs, sourceForcedDefaultLangs, langCodeToName, langSortCmp,\n} from 'util/language';\nimport useLocalStorage from 'util/useLocalStorage';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport { IconButton } from '@mui/material';\nimport TravelExploreIcon from '@mui/icons-material/TravelExplore';\nimport { useHistory } from 'react-router-dom';\nimport { useQuery } from 'util/client';\n\nfunction sourceToLangList(sources: ISource[]) {\n    const result: string[] = [];\n\n    sources.forEach((source) => {\n        if (result.indexOf(source.lang) === -1) { result.push(source.lang); }\n    });\n\n    result.sort(langSortCmp);\n    return result;\n}\n\nfunction groupByLang(sources: ISource[]) {\n    const result = {} as any;\n    sources.forEach((source) => {\n        if (result[source.lang] === undefined) { result[source.lang] = [] as ISource[]; }\n        result[source.lang].push(source);\n    });\n\n    return result;\n}\n\nexport default function Sources() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownSourceLangs', sourceDefualtLangs());\n    const [showNsfw] = useLocalStorage<boolean>('showNsfw', true);\n\n    const { data: sources, loading } = useQuery<ISource[]>('/api/v1/source/list');\n\n    const history = useHistory();\n\n    useEffect(() => {\n        // make sure all of forcedDefaultLangs() exists in shownLangs\n        sourceForcedDefaultLangs().forEach((forcedLang) => {\n            let hasLang = false;\n            shownLangs.forEach((lang) => {\n                if (lang === forcedLang) hasLang = true;\n            });\n            if (!hasLang) {\n                setShownLangs((shownLangsCopy) => {\n                    shownLangsCopy.push(forcedLang);\n                    return shownLangsCopy;\n                });\n            }\n        });\n    }, []);\n\n    useEffect(() => {\n        setTitle('Sources');\n        setAction(\n            <>\n                <IconButton\n                    onClick={() => history.push('/sources/all/search/')}\n                    size=\"large\"\n                >\n                    <TravelExploreIcon />\n                </IconButton>\n                <LangSelect\n                    shownLangs={shownLangs}\n                    setShownLangs={setShownLangs}\n                    allLangs={sourceToLangList(sources ?? [])}\n                    forcedLangs={sourceForcedDefaultLangs()}\n                />\n            </>,\n        );\n    }, [shownLangs, sources]);\n\n    if (loading) return <LoadingPlaceholder />;\n\n    if (sources?.length === 0) {\n        return (<h3>No sources found. Install Some Extensions first.</h3>);\n    }\n\n    return (\n        <>\n            {/* eslint-disable-next-line max-len */}\n            {Object.entries(groupByLang(sources ?? [])).sort((a, b) => langSortCmp(a[0], b[0])).map(([lang, list]) => (\n                shownLangs.indexOf(lang) !== -1 && (\n                    <React.Fragment key={lang}>\n                        <h1 key={lang} style={{ marginLeft: 25 }}>{langCodeToName(lang)}</h1>\n                        {(list as ISource[])\n                            .filter((source) => showNsfw || !source.isNsfw)\n                            .map((source) => (\n                                <SourceCard\n                                    key={source.id}\n                                    source={source}\n                                />\n                            ))}\n                    </React.Fragment>\n                )\n            ))}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport Button from '@mui/material/Button';\nimport Avatar from '@mui/material/Avatar';\nimport Typography from '@mui/material/Typography';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    extension: IExtension\n    notifyInstall: () => void\n}\n\nexport default function ExtensionCard(props: IProps) {\n    const {\n        extension: {\n            name, lang, versionName, installed, hasUpdate, obsolete, pkgName, iconUrl, isNsfw,\n        },\n        notifyInstall,\n    } = props;\n    const [installedState, setInstalledState] = useState<string>(\n        () => {\n            if (obsolete) { return 'obsolete'; }\n            if (hasUpdate) { return 'update'; }\n            return (installed ? 'uninstall' : 'install');\n        },\n    );\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const langPress = lang === 'all' ? 'All' : lang.toUpperCase();\n\n    function install() {\n        setInstalledState('installing');\n        client.get(`/api/v1/extension/install/${pkgName}`)\n            .then(() => {\n                setInstalledState('uninstall');\n                notifyInstall();\n            });\n    }\n\n    function update() {\n        setInstalledState('updating');\n        client.get(`/api/v1/extension/update/${pkgName}`)\n            .then(() => {\n                setInstalledState('uninstall');\n                notifyInstall();\n            });\n    }\n\n    function uninstall() {\n        setInstalledState('uninstalling');\n        client.get(`/api/v1/extension/uninstall/${pkgName}`)\n            .then(() => {\n                // setInstalledState('install');\n                notifyInstall();\n            });\n    }\n\n    function handleButtonClick() {\n        switch (installedState) {\n            case 'install':\n                install();\n                break;\n            case 'update':\n                update();\n                break;\n            case 'obsolete':\n                uninstall();\n                setTimeout(() => window.location.reload(), 3000);\n                break;\n            case 'uninstall':\n                uninstall();\n                break;\n            default:\n                break;\n        }\n    }\n\n    return (\n        <Card sx={{ margin: '10px' }}>\n            <CardContent sx={{\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center',\n                p: 2,\n            }}\n            >\n                <Box sx={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        sx={{\n                            width: 56,\n                            height: 56,\n                            flex: '0 0 auto',\n                            mr: 2,\n                        }}\n                        alt={name}\n                        src={`${serverAddress}${iconUrl}?useCache=${useCache}`}\n                    />\n                    <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                            {langPress}\n                            {' '}\n                            {versionName}\n                            {isNsfw && (\n                                <Typography variant=\"caption\" display=\"inline\" gutterBottom color=\"red\">\n                                    {' 18+'}\n                                </Typography>\n                            )}\n                        </Typography>\n                    </Box>\n                </Box>\n\n                <Button\n                    variant=\"outlined\"\n                    sx={{ color: installedState === 'obsolete' ? 'red' : 'inherit' }}\n                    onClick={() => handleButtonClick()}\n                >\n                    {installedState}\n\n                </Button>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, {\n    useContext, useEffect, useState, useMemo, useRef,\n} from 'react';\nimport { fromEvent } from 'file-selector';\nimport IconButton from '@mui/material/IconButton';\nimport AddIcon from '@mui/icons-material/Add';\nimport ExtensionCard from 'components/ExtensionCard';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client, { useQuery } from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport LangSelect from 'components/navbar/action/LangSelect';\nimport { extensionDefaultLangs, langCodeToName, langSortCmp } from 'util/language';\nimport { makeToaster } from 'components/util/Toast';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport { useQueryParam, StringParam } from 'use-query-params';\nimport { Virtuoso } from 'react-virtuoso';\nimport { Typography, useMediaQuery, useTheme } from '@mui/material';\n\nconst LANGUAGE = 0;\nconst EXTENSIONS = 1;\n\nconst allLangs: string[] = [];\n\ninterface GroupedExtension {\n    [key: string]: IExtension[]\n}\n\nfunction groupExtensions(extensions: IExtension[]) {\n    allLangs.length = 0; // empty the array\n    const sortedExtenions: GroupedExtension = { installed: [], 'updates pending': [], all: [] };\n    extensions.forEach((extension) => {\n        if (sortedExtenions[extension.lang] === undefined) {\n            sortedExtenions[extension.lang] = [];\n            if (extension.lang !== 'all') { allLangs.push(extension.lang); }\n        }\n        if (extension.installed) {\n            if (extension.hasUpdate) {\n                sortedExtenions['updates pending'].push(extension);\n            } else {\n                sortedExtenions.installed.push(extension);\n            }\n        } else {\n            sortedExtenions[extension.lang].push(extension);\n        }\n    });\n\n    allLangs.sort(langSortCmp);\n    const result: [string, IExtension[]][] = [\n        ['updates pending', sortedExtenions['updates pending']],\n        ['installed', sortedExtenions.installed],\n        ['all', sortedExtenions.all],\n    ];\n\n    const langExt: [string, IExtension[]][] = allLangs.map((lang) => [lang, sortedExtenions[lang]]);\n\n    return result.concat(langExt);\n}\n\nexport default function MangaExtensions() {\n    const inputRef = useRef<HTMLInputElement>(null);\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownExtensionLangs', extensionDefaultLangs());\n    const [showNsfw] = useLocalStorage<boolean>('showNsfw', true);\n    const theme = useTheme();\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\n    const [query] = useQueryParam('query', StringParam);\n\n    useEffect(() => {\n        setTitle('Extensions');\n        setAction(\n            <>\n                <AppbarSearch />\n                <IconButton\n                    onClick={() => inputRef.current?.click()}\n                    size=\"large\"\n                >\n                    <AddIcon />\n                </IconButton>\n                <LangSelect\n                    shownLangs={shownLangs}\n                    setShownLangs={setShownLangs}\n                    allLangs={allLangs}\n                />\n            </>,\n        );\n    }, [shownLangs]);\n\n    const { data: allExtensions, mutate, loading } = useQuery<IExtension[]>('/api/v1/extension/list');\n\n    const filteredExtensions = useMemo(() => (allExtensions ?? []).filter((ext) => {\n        const nsfwFilter = showNsfw || !ext.isNsfw;\n        if (!query) return nsfwFilter;\n        return nsfwFilter && ext.name.toLowerCase().includes(query.toLowerCase());\n    }), [allExtensions, showNsfw, query]);\n\n    const groupedExtensions = useMemo(() => groupExtensions(filteredExtensions)\n        .filter((group) => group[EXTENSIONS].length > 0)\n        .filter((group) => ['installed', 'updates pending', 'all', ...shownLangs].includes(group[LANGUAGE])), [shownLangs, filteredExtensions]);\n\n    const flatRenderItems: (IExtension | string)[] = groupedExtensions.flat(2);\n\n    const [toasts, makeToast] = makeToaster(useState<React.ReactElement[]>([]));\n\n    const submitExternalExtension = (file: File) => {\n        if (file.name.toLowerCase().endsWith('apk')) {\n            const formData = new FormData();\n            formData.append('file', file);\n\n            if (inputRef.current) {\n                inputRef.current.value = '';\n            }\n\n            makeToast('Installing Extension File....', 'info');\n            client.post('/api/v1/extension/install',\n                formData, { headers: { 'Content-Type': 'multipart/form-data' } })\n                .then(() => {\n                    makeToast('Installed extension successfully!', 'success');\n                    mutate();\n                })\n                .catch(() => makeToast('Extension installion failed!', 'error'));\n        } else {\n            makeToast('invalid file type!', 'error');\n        }\n    };\n\n    useEffect(() => {\n        const dropHandler = async (e: Event) => {\n            e.preventDefault();\n            const files = await fromEvent(e);\n            submitExternalExtension(files[0] as File);\n        };\n\n        const dragOverHandler = (e: Event) => {\n            e.preventDefault();\n        };\n\n        document.addEventListener('drop', dropHandler);\n        document.addEventListener('dragover', dragOverHandler);\n\n        return () => {\n            document.removeEventListener('drop', dropHandler);\n            document.removeEventListener('dragover', dragOverHandler);\n        };\n    }, []);\n\n    if (loading) {\n        return <LoadingPlaceholder />;\n    }\n\n    return (\n        <>\n            {toasts}\n            <input\n                type=\"file\"\n                style={{ display: 'none' }}\n                ref={inputRef}\n                onChange={(e) => {\n                    const file = e.target.files?.[0];\n                    if (file) {\n                        submitExternalExtension(file);\n                    }\n                }}\n            />\n            <Virtuoso\n                style={{\n                    height: isMobile ? 'calc(100vh - 64px - 64px)' : 'calc(100vh - 64px)',\n                }}\n                totalCount={flatRenderItems.length}\n                itemContent={(index) => {\n                    if (typeof (flatRenderItems[index]) === 'string') {\n                        const item = flatRenderItems[index] as string;\n                        return (\n                            <Typography\n                                key={item}\n                                variant=\"h2\"\n                                style={{\n                                    paddingLeft: 25,\n                                    paddingBottom: '0.83em',\n                                    paddingTop: '0.83em',\n                                    backgroundColor: 'rgb(18, 18, 18)',\n                                    fontSize: '2em',\n                                    fontWeight: 'bold',\n                                }}\n                            >\n                                {langCodeToName(item)}\n                            </Typography>\n                        );\n                    }\n                    const item = flatRenderItems[index] as IExtension;\n\n                    return (\n                        <ExtensionCard\n                            key={item.apkName}\n                            extension={item}\n                            notifyInstall={() => {\n                                mutate();\n                            }}\n                        />\n                    );\n                }}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Tabs from '@mui/material/Tabs';\nimport Tab from '@mui/material/Tab';\nimport TabPanel from 'components/util/TabPanel';\nimport Sources from 'screens/Sources';\nimport Extensions from 'screens/Extensions';\n\nexport default function Browse() {\n    const [tabNum, setTabNum] = useState<number>(0);\n\n    return (\n        <>\n            <Tabs\n                value={tabNum}\n                onChange={(e, newTab) => setTabNum(newTab)}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                centered\n                variant=\"fullWidth\"\n                scrollButtons\n                allowScrollButtonsMobile\n            >\n                <Tab sx={{ textTransform: 'none' }} label=\"Sources\" />\n                <Tab sx={{ textTransform: 'none' }} label=\"Extensions\" />\n            </Tabs>\n            <TabPanel index={0} currentIndex={tabNum}>\n                <Sources />\n            </TabPanel>\n            <TabPanel index={1} currentIndex={tabNum}>\n                <Extensions />\n            </TabPanel>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport NavBarContext from 'components/context/NavbarContext';\n\ninterface IProps{\n    children: React.ReactNode\n}\n\nexport default function NavBarProvider({ children }:IProps) {\n    const [defaultBackTo, setDefaultBackTo] = useState<string | undefined>();\n    const [title, setTitle] = useState<string>('Tachidesk');\n    const [action, setAction] = useState<any>(<div />);\n    const [override, setOverride] = useState<INavbarOverride>({\n        status: false,\n        value: <div />,\n    });\n\n    const value = {\n        defaultBackTo,\n        setDefaultBackTo,\n        title,\n        setTitle,\n        action,\n        setAction,\n        override,\n        setOverride,\n    };\n    return (\n        <NavBarContext.Provider value={value}>\n            {children}\n        </NavBarContext.Provider>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport LibraryOptionsContext, { DefaultLibraryOptions } from 'components/context/LibraryOptionsContext';\nimport React from 'react';\nimport useLocalStorage from 'util/useLocalStorage';\n\ninterface IProps {\n    children: React.ReactNode;\n}\n\nconst LibraryOptionsContextProvider: React.FC<IProps> = ({ children }) => {\n    const [options, setOptions] = useLocalStorage<LibraryOptions>('libraryOptions', DefaultLibraryOptions);\n\n    return (\n        <LibraryOptionsContext.Provider value={{ options, setOptions }}>\n            {children}\n        </LibraryOptionsContext.Provider>\n    );\n};\n\nexport default LibraryOptionsContextProvider;\n","/*\n* Copyright (C) Contributors to the Suwayomi project\n*\n* This Source Code Form is subject to the terms of the Mozilla Public\n* License, v. 2.0. If a copy of the MPL was not distributed with this\n* file, You can obtain one at https://mozilla.org/MPL/2.0/.\n*/\n\nimport { Card } from '@mui/material';\nimport { useHistory } from 'react-router-dom';\nimport NavbarContext from 'components/context/NavbarContext';\nimport MangaGrid from 'components/MangaGrid';\nimport LangSelect from 'components/navbar/action/LangSelect';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useQueryParam, StringParam } from 'use-query-params';\nimport client from 'util/client';\nimport {\n    langCodeToName, langSortCmp, sourceDefualtLangs, sourceForcedDefaultLangs,\n} from 'util/language';\nimport useLocalStorage from 'util/useLocalStorage';\nimport PQueue from 'p-queue/dist/index';\n\nfunction sourceToLangList(sources: ISource[]) {\n    const result: string[] = [];\n\n    sources.forEach((source) => {\n        if (result.indexOf(source.lang) === -1) { result.push(source.lang); }\n    });\n\n    result.sort(langSortCmp);\n    return result;\n}\n\nexport default function SearchAll() {\n    const [query] = useQueryParam('query', StringParam);\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [triggerUpdate, setTriggerUpdate] = useState<number>(2);\n    const [mangas, setMangas] = useState<any>({});\n\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownSourceLangs', sourceDefualtLangs());\n    const [showNsfw] = useLocalStorage<boolean>('showNsfw', true);\n\n    const [sources, setSources] = useState<ISource[]>([]);\n    const [fetched, setFetched] = useState<any>({});\n    const [FetchedSources, setFetchedSources] = useState<any>({});\n\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n\n    const [ResetUI, setResetUI] = useState<number>(0);\n\n    const limit = new PQueue({ concurrency: 5 });\n\n    useEffect(() => {\n        setTitle('Global Search');\n        setAction(\n            <>\n                <AppbarSearch />\n            </>\n            ,\n        );\n    }, []);\n\n    useEffect(() => {\n        client.get('/api/v1/source/list')\n            .then((response) => response.data)\n            .then((data) => {\n                setSources(data.sort((a: { displayName: string; }, b: { displayName: string; }) => {\n                    if (a.displayName < b.displayName) { return -1; }\n                    if (a.displayName > b.displayName) { return 1; }\n                    return 0;\n                })); setFetchedSources(true);\n            });\n    }, []);\n\n    async function doIT(elem: any[]) {\n        elem.map((ele) => limit.add(async () => {\n            const response = await client.get(`/api/v1/source/${ele.id}/search?searchTerm=${query || ''}&pageNum=1`);\n            const data = await response.data;\n            const tmp = mangas;\n            tmp[ele.id] = data.mangaList;\n            setMangas(tmp);\n            const tmp2 = fetched;\n            tmp2[ele.id] = true;\n            setFetched(tmp2);\n            setResetUI(1);\n        }));\n    }\n\n    useEffect(() => {\n        if (triggerUpdate === 2) {\n            return;\n        }\n        if (triggerUpdate === 0) {\n            setTriggerUpdate(1);\n            return;\n        }\n        setFetched({});\n        setMangas({});\n        // eslint-disable-next-line max-len\n        doIT(sources.filter(({ lang }) => shownLangs.indexOf(lang) !== -1).filter((source) => showNsfw || !source.isNsfw));\n    }, [triggerUpdate]);\n\n    useEffect(() => {\n        if (ResetUI === 1) {\n            setResetUI(0);\n        }\n    }, [ResetUI]);\n\n    useEffect(() => {\n        if (query && FetchedSources) {\n            const delayDebounceFn = setTimeout(() => {\n                setTriggerUpdate(0);\n            }, 1000);\n            return () => clearTimeout(delayDebounceFn);\n        }\n        return () => {};\n    }, [query, shownLangs, sources]);\n\n    useEffect(() => {\n        // make sure all of forcedDefaultLangs() exists in shownLangs\n        sourceForcedDefaultLangs().forEach((forcedLang) => {\n            let hasLang = false;\n            shownLangs.forEach((lang) => {\n                if (lang === forcedLang) hasLang = true;\n            });\n            if (!hasLang) {\n                setShownLangs((shownLangsCopy) => {\n                    shownLangsCopy.push(forcedLang);\n                    return shownLangsCopy;\n                });\n            }\n        });\n    }, []);\n\n    useEffect(() => {\n        setTitle('Sources');\n        setAction(\n            <>\n                <AppbarSearch\n                    autoOpen\n                />\n                <LangSelect\n                    shownLangs={shownLangs}\n                    setShownLangs={setShownLangs}\n                    allLangs={sourceToLangList(sources)}\n                    forcedLangs={sourceForcedDefaultLangs()}\n                />\n            </>,\n        );\n    }, [shownLangs, sources]);\n\n    const history = useHistory();\n\n    const redirectTo = (e: any, to: string) => {\n        history.push(to);\n\n        // prevent parent tags from getting the event\n        e.stopPropagation();\n    };\n    if (query) {\n        return (\n            <>\n                {/* eslint-disable-next-line max-len */}\n                {sources.filter(({ lang }) => shownLangs.indexOf(lang) !== -1).filter((source) => showNsfw || !source.isNsfw).sort((a, b) => {\n                    const af = fetched[a.id];\n                    const bf = fetched[b.id];\n                    if (af && !bf) { return -1; }\n                    if (!af && bf) { return 1; }\n                    if (!af && !bf) { return 0; }\n\n                    const al = mangas[a.id].length === 0;\n                    const bl = mangas[b.id].length === 0;\n                    if (al && !bl) { return 1; }\n                    if (bl && !al) { return -1; }\n                    return 0;\n                }).map(({ lang, id, displayName }) => (\n                    (\n                        <>\n                            <Card\n                                sx={{\n                                    margin: '10px',\n                                    '&:hover': {\n                                        backgroundColor: 'action.hover',\n                                        transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                    },\n                                    '&:active': {\n                                        backgroundColor: 'action.selected',\n                                        transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                    },\n                                }}\n                                onClick={(e) => redirectTo(e, `/sources/${id}/popular/?R&query=${query}`)}\n                            >\n                                <h1\n                                    key={lang}\n                                    style={{ margin: '25px 0px 0px 25px' }}\n                                >\n                                    {displayName}\n                                </h1>\n                                <p\n                                    style={{ margin: '0px 0px 25px 25px' }}\n                                >\n                                    {langCodeToName(lang)}\n                                </p>\n                            </Card>\n                            <MangaGrid\n                                mangas={mangas[id] || []}\n                                isLoading={!fetched[id]}\n                                hasNextPage={false}\n                                lastPageNum={lastPageNum}\n                                setLastPageNum={setLastPageNum}\n                                horisontal\n                                noFaces\n                                message={fetched[id] ? 'No manga was found!' : undefined}\n                                inLibraryIndicator\n                            />\n                        </>\n                    )\n                ))}\n\n            </>\n        );\n    }\n    return (<></>);\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Redirect,\n} from 'react-router-dom';\nimport { QueryParamProvider } from 'use-query-params';\nimport { Container } from '@mui/material';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport {\n    createTheme,\n    ThemeProvider,\n    Theme,\n    StyledEngineProvider,\n} from '@mui/material/styles';\nimport { SWRConfig } from 'swr';\nimport { fetcher } from 'util/client';\nimport DefaultNavBar from 'components/navbar/DefaultNavBar';\nimport DarkTheme from 'components/context/DarkTheme';\nimport useLocalStorage from 'util/useLocalStorage';\nimport Settings from 'screens/Settings';\nimport About from 'screens/settings/About';\nimport Categories from 'screens/settings/Categories';\nimport Backup from 'screens/settings/Backup';\nimport Library from 'screens/Library';\nimport SourceConfigure from 'screens/SourceConfigure';\nimport Manga from 'screens/Manga';\nimport SourceMangas from 'screens/SourceMangas';\nimport Reader from 'screens/Reader';\nimport Updates from 'screens/Updates';\nimport DownloadQueue from 'screens/DownloadQueue';\nimport Browse from 'screens/Browse';\nimport Sources from 'screens/Sources';\nimport Extensions from 'screens/Extensions';\nimport NavBarContextProvider from 'components/navbar/NavBarContextProvider';\nimport LibraryOptionsContextProvider from 'components/library/LibraryOptionsProvider';\nimport SearchAll from 'screens/SearchAll';\n\ndeclare module '@mui/styles/defaultTheme' {\n    // eslint-disable-next-line @typescript-eslint/no-empty-interface\n    interface DefaultTheme extends Theme {}\n}\n\nexport default function App() {\n    const [darkTheme, setDarkTheme] = useLocalStorage<boolean>(\n        'darkTheme',\n        true,\n    );\n\n    const darkThemeContext = {\n        darkTheme,\n        setDarkTheme,\n    };\n\n    const theme = React.useMemo(\n        () => createTheme({\n            palette: {\n                mode: darkTheme ? 'dark' : 'light',\n            },\n            components: {\n                MuiCssBaseline: {\n                    styleOverrides: `\n                        *::-webkit-scrollbar {\n                            width: 10px;\n                            background: ${darkTheme ? '#222' : '#e1e1e1'};   \n                        }\n                        \n                        *::-webkit-scrollbar-thumb {\n                            background: ${darkTheme ? '#111' : '#aaa'};\n                            border-radius: 5px;\n                        }\n                    `,\n                },\n            },\n        }),\n        [darkTheme],\n    );\n\n    return (\n        <SWRConfig value={{ fetcher }}>\n            <Router>\n                <StyledEngineProvider injectFirst>\n                    <ThemeProvider theme={theme}>\n                        <QueryParamProvider ReactRouterRoute={Route}>\n                            <LibraryOptionsContextProvider>\n                                <NavBarContextProvider>\n                                    <CssBaseline />\n                                    <DefaultNavBar />\n                                    <Container\n                                        id=\"appMainContainer\"\n                                        maxWidth={false}\n                                        disableGutters\n                                        sx={{\n                                            mt: 8,\n                                            ml: { sm: 8 },\n                                            mb: { xs: 8, sm: 0 },\n                                            width: 'auto',\n                                            overflow: 'auto',\n                                        }}\n                                    >\n                                        <Switch>\n                                            {/* General Routes */}\n                                            <Route\n                                                exact\n                                                path=\"/\"\n                                                render={() => (\n                                                    <Redirect to=\"/library\" />\n                                                )}\n                                            />\n                                            <Route path=\"/settings/about\">\n                                                <About />\n                                            </Route>\n                                            <Route path=\"/settings/categories\">\n                                                <Categories />\n                                            </Route>\n                                            <Route path=\"/settings/backup\">\n                                                <Backup />\n                                            </Route>\n                                            <Route path=\"/settings\">\n                                                <DarkTheme.Provider\n                                                    value={darkThemeContext}\n                                                >\n                                                    <Settings />\n                                                </DarkTheme.Provider>\n                                            </Route>\n\n                                            {/* Manga Routes */}\n\n                                            <Route path=\"/sources/:sourceId/popular/\">\n                                                <SourceMangas popular />\n                                            </Route>\n                                            <Route path=\"/sources/:sourceId/latest/\">\n                                                <SourceMangas popular={false} />\n                                            </Route>\n                                            <Route path=\"/sources/:sourceId/configure/\">\n                                                <SourceConfigure />\n                                            </Route>\n                                            <Route path=\"/sources/all/search/\">\n                                                <SearchAll />\n                                            </Route>\n                                            <Route path=\"/downloads\">\n                                                <DownloadQueue />\n                                            </Route>\n                                            <Route path=\"/manga/:mangaId/chapter/:chapterNum\">\n                                                <></>\n                                            </Route>\n                                            <Route path=\"/manga/:id\">\n                                                <Manga />\n                                            </Route>\n                                            <Route path=\"/library\">\n                                                <Library />\n                                            </Route>\n                                            <Route path=\"/updates\">\n                                                <Updates />\n                                            </Route>\n                                            <Route path=\"/sources\">\n                                                <Sources />\n                                            </Route>\n                                            <Route path=\"/extensions\">\n                                                <Extensions />\n                                            </Route>\n                                            <Route path=\"/browse\">\n                                                <Browse />\n                                            </Route>\n                                        </Switch>\n                                    </Container>\n                                    <Switch>\n                                        <Route\n                                            path=\"/manga/:mangaId/chapter/:chapterIndex\"\n                                            // passing a key re-mounts the reader\n                                            // when changing chapters\n                                            render={(props: any) => (\n                                                <Reader\n                                                    key={\n                                                        props.match.params\n                                                            .chapterIndex\n                                                    }\n                                                />\n                                            )}\n                                        />\n                                    </Switch>\n                                </NavBarContextProvider>\n                            </LibraryOptionsContextProvider>\n                        </QueryParamProvider>\n                    </ThemeProvider>\n                </StyledEngineProvider>\n            </Router>\n        </SWRConfig>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n// roboto font\nimport '@fontsource/roboto';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n"],"sourceRoot":""}