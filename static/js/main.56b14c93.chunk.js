(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{291:function(e,t,n){},293:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(31),i=n.n(c),o=n(3),s=n(23),l=n(28),u=n(29),d=n(426),j=n(380),b=n(223),h=n(379),f=n(428),p=n(47),x=n(21),O=n.n(x),m=n(14),g=n(25),v=n(183),y=n.n(v);var C,k={getItem:function(e,t){try{var n=window.localStorage.getItem(e);if(null!==n)return JSON.parse(n);window.localStorage.setItem(e,JSON.stringify(t))}finally{}return t},setItem:function(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}finally{}}},w=window.location,S=w.hostname,L=w.port,N=w.protocol;C="3000"===L?"4567":L;var E=k.getItem("serverBaseURL","".concat(N,"//").concat(S,":").concat(C)),T=y.a.create({baseURL:E});T.interceptors.request.use((function(e){return e.data instanceof FormData&&Object.assign(e.headers,{"Content-Type":"multipart/form-data"}),e}));var R=T;function I(e){return F.apply(this,arguments)}function F(){return(F=Object(g.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.get(t);case 2:if(200===(n=e.sent).status){e.next=5;break}throw new Error(n.statusText);case 5:if("application/json"===n.headers["content-type"]){e.next=7;break}throw new Error("Response is not json");case 7:return e.abrupt("return",n.data);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=function(e,t){var n=Object(p.b)(e,t);return Object(m.a)(Object(m.a)({},n),{},{loading:null==n.data&&null==n.error})},P=n(399),B=n(401),z=n(107),A=n(402),M=n(362),W=n(24),H=n(188),V=n.n(H),U=n(189),_=n.n(U),J=n(190),G=n.n(J),X=n(191),Y=n.n(X),q=n(153),K=n.n(q),Z=n(154),Q=n.n(Z),$=n(192),ee=n.n($),te=n(193),ne=n.n(te),ae=n(194),re=n.n(ae),ce=n(100),ie=n.n(ce),oe=n(195),se=n.n(oe),le=n(0),ue=r.a.createContext({defaultBackTo:void 0,setDefaultBackTo:function(){},title:"Tachidesk",setTitle:function(){},action:Object(le.jsx)("div",{}),setAction:function(){},override:{status:!1,value:Object(le.jsx)("div",{})},setOverride:function(){}}),de=ue,je=function(){return Object(a.useContext)(ue)},be=r.a.createContext({darkTheme:!0,setDarkTheme:function(){}}),he=n(22),fe=Object(he.a)(Object(le.jsx)("path",{d:"M 11 1 C 9.3550302 1 8 2.3550302 8 4 L 4 4 C 2.9069372 4 2 4.9069372 2 6 L 2 12 L 4 12 C 4.5650302 12 5 12.43497 5 13 C 5 13.56503 4.5650302 14 4 14 L 2 14 L 2 20 C 2 21.093063 2.9069372 22 4 22 L 10 22 L 10 20 C 10 19.43497 10.43497 19 11 19 C 11.56503 19 12 19.43497 12 20 L 12 22 L 18 22 C 19.093063 22 20 21.093063 20 20 L 20 16 C 21.64497 16 23 14.64497 23 13 C 23 11.35503 21.64497 10 20 10 L 20 6 C 20 4.9069372 19.093063 4 18 4 L 14 4 C 14 2.3550302 12.64497 1 11 1 z M 11 3 C 11.56503 3 12 3.4349698 12 4 L 12 6 L 18 6 L 18 12 L 20 12 C 20.56503 12 21 12.43497 21 13 C 21 13.56503 20.56503 14 20 14 L 18 14 L 18 20 L 14 20 C 14 18.35503 12.64497 17 11 17 C 9.3550302 17 8 18.35503 8 20 L 4 20 L 4 16 C 5.6449698 16 7 14.64497 7 13 C 7 11.35503 5.6449698 10 4 10 L 4 6 L 10 6 L 10 4 C 10 3.4349698 10.43497 3 11 3 z"}),"CustomExtensionOutlined"),pe=n(427),xe="__BACK__",Oe=function(){var e,t,n=Object(l.h)(),a=je().defaultBackTo,r=null!==(e=null===(t=n.state)||void 0===t?void 0:t.backLink)&&void 0!==e?e:a;return{url:r===xe?void 0:r,back:r===xe}},me=n(397),ge=n(359),ve=n(381),ye=n(358),Ce=Object(ye.a)("div")((function(e){var t=e.theme;return{height:"100vh",width:t.spacing(8),backgroundColor:"light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[900],position:"fixed",top:0,left:0,paddingTop:t.spacing(8),display:"flex",flexDirection:"column"}}));function ke(e){var t=e.navBarItems,n=Object(l.h)(),a=Object(W.a)(),r=function(e,t,r){return n.pathname===e?Object(le.jsx)(r,{sx:{color:"primary.main"},fontSize:"large"}):Object(le.jsx)(t,{sx:{color:"dark"===a.palette.mode?"grey.A400":"grey.600"},fontSize:"large"})};return Object(le.jsx)(Ce,{children:t.map((function(e){var t=e.path,n=e.title,a=e.IconComponent,c=e.SelectedIconComponent;return Object(le.jsx)(s.b,{to:t,style:{color:"inherit",textDecoration:"none"},children:Object(le.jsx)(me.a,{disableRipple:!0,button:!0,children:Object(le.jsx)(ge.a,{sx:{minWidth:"0"},children:Object(le.jsx)(ve.a,{placement:"right",title:n,children:r(t,a,c)})})},n)},t)}))})}var we=Object(ye.a)("div")((function(e){var t=e.theme;return{bottom:0,left:0,height:t.spacing(7),width:"100vw",backgroundColor:"light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[900],position:"fixed",display:"flex",flexDirection:"row",justifyContent:"space-evenly",alignItems:"center",zIndex:1100}})),Se=Object(ye.a)(s.b)({textDecoration:"none",flex:1});function Le(e){var t=e.navBarItems,n=Object(l.h)(),a=Object(W.a)(),r=function(e,t,r){return n.pathname===e?Object(le.jsx)(r,{sx:{color:"primary.main"},fontSize:"medium"}):Object(le.jsx)(t,{sx:{color:"dark"===a.palette.mode?"grey.A400":"grey.600"},fontSize:"medium"})};return Object(le.jsx)(we,{children:t.map((function(e){var t=e.path,c=e.title,i=e.IconComponent,o=e.SelectedIconComponent;return Object(le.jsx)(Se,{to:t,children:Object(le.jsx)(me.a,{disableRipple:!0,button:!0,sx:{justifyContent:"center",padding:"8px"},children:Object(le.jsxs)(pe.a,{display:"flex",flexDirection:"column",alignItems:"center",children:[r(t,i,o),Object(le.jsx)(pe.a,{sx:{fontSize:"0.65rem",color:n.pathname===t?"primary.main":"dark"===a.palette.mode?"grey.A400":"grey.600"},children:c})]})},c)},t)}))})}var Ne=[{path:"/library",title:"Library",SelectedIconComponent:V.a,IconComponent:_.a,show:"both"},{path:"/updates",title:"Updates",SelectedIconComponent:G.a,IconComponent:Y.a,show:"both"},{path:"/extensions",title:"Extensions",SelectedIconComponent:ee.a,IconComponent:fe,show:"desktop"},{path:"/sources",title:"Sources",SelectedIconComponent:K.a,IconComponent:Q.a,show:"desktop"},{path:"/browse",title:"Browse",SelectedIconComponent:K.a,IconComponent:Q.a,show:"mobile"},{path:"/downloads",title:"Downloads",SelectedIconComponent:ne.a,IconComponent:re.a,show:"both"},{path:"/settings",title:"Settings",SelectedIconComponent:ie.a,IconComponent:ie.a,show:"both"}];function Ee(){var e=Object(a.useContext)(de),t=e.title,n=e.action,r=e.override,c=Oe(),i=Object(a.useContext)(be).darkTheme,o=Object(W.a)(),u=Object(l.g)(),d=Object(M.a)(o.breakpoints.down("sm")),j=Ne.some((function(e){return e.path===u.location.pathname}));if(r.status)return r.value;var b=Object(le.jsx)(le.Fragment,{});d?j&&(b=Object(le.jsx)(Le,{navBarItems:Ne.filter((function(e){return"desktop"!==e.show}))})):b=Object(le.jsx)(ke,{navBarItems:Ne.filter((function(e){return"mobile"!==e.show}))});return Object(le.jsxs)(pe.a,{sx:{flexGrow:1},children:[Object(le.jsx)(P.a,{position:"fixed",color:i?"default":"primary",children:Object(le.jsxs)(B.a,{children:[!j&&Object(le.jsx)(A.a,{component:c.url?s.b:"button",to:c.url,edge:"start",sx:{marginRight:o.spacing(2)},color:"inherit","aria-label":"menu",disableRipple:!0,size:"large",onClick:function(){null==c.url&&u.goBack()},children:Object(le.jsx)(se.a,{})}),Object(le.jsx)(z.a,{variant:d?"h6":"h5",sx:{flexGrow:1},noWrap:!0,textOverflow:"ellipsis",children:t}),n,Object(le.jsx)("div",{id:"navbarToolbar"})]})}),b]})}var Te=function(e){var t=e.children,n=document.getElementById("navbarToolbar");return n?Object(c.createPortal)(t,n):null};function Re(e,t){var n=t instanceof Function?t():t,r=Object(a.useState)(k.getItem(e,n)),c=Object(o.a)(r,2),i=c[0],s=c[1];return[i,Object(a.useCallback)((function(t){s((function(n){var a=t instanceof Function?t(n):t;return k.setItem(e,a),a}))}),[e])]}var Ie=n(403),Fe=n(196),De=n.n(Fe),Pe=n(197),Be=n.n(Pe),ze=n(198),Ae=n.n(ze),Me=n(200),We=n.n(Me),He=n(120),Ve=n.n(He),Ue=n(201),_e=n.n(Ue),Je=n(199),Ge=n.n(Je),Xe=n(363),Ye=n(398),qe=n(404),Ke=n(413),Ze=n(405),Qe=n(412),$e=n(406),et=n(407),tt=n(391),nt=n(119),at=n.n(nt),rt=n(388),ct=n(364),it=n(368),ot=n(118),st=n.n(ot);function lt(e){var t=e.directLink,n=e.to;return t?Object(le.jsx)(me.a,Object(m.a)({button:!0,component:"a",href:n},e)):Object(le.jsx)(me.a,Object(m.a)({button:!0,component:s.b},e))}function ut(){var e=Object(a.useContext)(de),t=e.setTitle,n=e.setAction;Object(a.useEffect)((function(){t("Settings"),n(Object(le.jsx)(le.Fragment,{}))}),[]);var r=Object(a.useContext)(be),c=r.darkTheme,i=r.setDarkTheme,s=Re("serverBaseURL",""),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Re("showNsfw",!0),b=Object(o.a)(j,2),h=b[0],f=b[1],p=Re("useCache",!0),x=Object(o.a)(p,2),O=x[0],m=x[1],g=Object(a.useState)(!1),v=Object(o.a)(g,2),y=v[0],C=v[1],k=Object(a.useState)(u),w=Object(o.a)(k,2),S=w[0],L=w[1],N=Object(a.useState)(!1),E=Object(o.a)(N,2),T=E[0],R=E[1],I=Re("ItemWidth",300),F=Object(o.a)(I,2),D=F[0],P=F[1],B=Object(a.useState)(D),z=Object(o.a)(B,2),M=z[0],W=z[1],H=function(){C(!1)},V=function(){R(!1)};return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsxs)(Ie.a,{sx:{padding:0},children:[Object(le.jsxs)(lt,{to:"/settings/categories",children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(De.a,{})}),Object(le.jsx)(Xe.a,{primary:"Categories"})]}),Object(le.jsxs)(lt,{to:"/settings/backup",children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(Be.a,{})}),Object(le.jsx)(Xe.a,{primary:"Backup"})]}),Object(le.jsxs)(me.a,{children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(Ae.a,{})}),Object(le.jsx)(Xe.a,{primary:"Dark Theme"}),Object(le.jsx)(Ye.a,{children:Object(le.jsx)(qe.a,{edge:"end",checked:c,onChange:function(){return i(!c)}})})]}),Object(le.jsxs)(ct.a,{children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(st.a,{})}),Object(le.jsx)(Xe.a,{primary:"Manga Item width",secondary:"px:".concat(D),onClick:function(){W(D),R(!0)}})]}),Object(le.jsxs)(me.a,{children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(at.a,{})}),Object(le.jsx)(Xe.a,{primary:"Show NSFW",secondary:"Hide NSFW extensions and sources"}),Object(le.jsx)(Ye.a,{children:Object(le.jsx)(qe.a,{edge:"end",checked:h,onChange:function(){return f(!h)}})})]}),Object(le.jsxs)(me.a,{children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(Ge.a,{})}),Object(le.jsx)(Xe.a,{primary:"Use image cache",secondary:"Disabling image cache makes images load faster if you have a slow disk, but uses it much more internet traffic in turn"}),Object(le.jsx)(Ye.a,{children:Object(le.jsx)(qe.a,{edge:"end",checked:O,onChange:function(){return m(!O)}})})]}),Object(le.jsxs)(me.a,{children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(We.a,{})}),Object(le.jsx)(Xe.a,{primary:"Server Address",secondary:u}),Object(le.jsx)(Ye.a,{children:Object(le.jsx)(A.a,{onClick:function(){L(u),C(!0)},size:"large",children:Object(le.jsx)(Ve.a,{})})})]}),Object(le.jsxs)(lt,{to:"/settings/about",children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(_e.a,{})}),Object(le.jsx)(Xe.a,{primary:"About"})]})]}),Object(le.jsxs)(Ze.a,{open:y,onClose:H,children:[Object(le.jsxs)($e.a,{children:[Object(le.jsx)(et.a,{children:"Enter Server Address"}),Object(le.jsx)(tt.a,{autoFocus:!0,margin:"dense",id:"name",label:"Server Address",type:"text",fullWidth:!0,value:S,placeholder:"http://127.0.0.1:4567",onChange:function(e){return L(e.target.value)}})]}),Object(le.jsxs)(Qe.a,{children:[Object(le.jsx)(Ke.a,{onClick:H,color:"primary",children:"Cancel"}),Object(le.jsx)(Ke.a,{onClick:function(){C(!1),d(S)},color:"primary",children:"Set"})]})]}),Object(le.jsxs)(Ze.a,{open:T,onClose:V,children:[Object(le.jsx)(it.a,{children:"Manga Item width"}),Object(le.jsxs)($e.a,{sx:{width:"98%",margin:"auto"},children:[Object(le.jsx)(tt.a,{sx:{width:"100%",margin:"auto"},autoFocus:!0,value:M,type:"number",onChange:function(e){return W(parseInt(e.target.value,10))}}),Object(le.jsx)(rt.a,{"aria-label":"Manga Item width",defaultValue:300,value:M,step:10,min:100,max:1e3,onChange:function(e,t){W(t)}})]}),Object(le.jsxs)(Qe.a,{children:[Object(le.jsx)(Ke.a,{onClick:function(){R(!1),P(300)},color:"primary",children:"Reset to Default"}),Object(le.jsx)(Ke.a,{onClick:V,color:"primary",children:"Cancel"}),Object(le.jsx)(Ke.a,{onClick:function(){R(!1),P(M)},color:"primary",children:"OK"})]})]})]})}var dt=n(414);function jt(e){var t=e.children,n=e.shouldRender,a=e.component,c=e.componentProps,i=!0;if(void 0!==n&&(i=n instanceof Function?n():n),i){if(a)return r.a.createElement(a,c);if(t)return Object(le.jsx)(le.Fragment,{children:t})}return Object(le.jsx)(pe.a,{sx:{margin:"10px auto",display:"flex",justifyContent:"center"},children:Object(le.jsx)(dt.a,{thickness:5})})}function bt(){var e=Object(a.useContext)(de),t=e.setTitle,n=e.setAction;Object(a.useEffect)((function(){t("About"),n(Object(le.jsx)(le.Fragment,{}))}),[]);var r=D("/api/v1/settings/about").data;if(void 0===r)return Object(le.jsx)(jt,{});return Object(le.jsxs)(Ie.a,{children:[Object(le.jsx)(me.a,{children:Object(le.jsx)(Xe.a,{primary:"Server",secondary:"".concat(r.name," ").concat(r.buildType)})}),Object(le.jsx)(me.a,{children:Object(le.jsx)(Xe.a,{primary:"Server version",secondary:"Stable"===r.buildType?"".concat(r.version):"".concat(r.version,"-").concat(r.revision)})}),Object(le.jsx)(me.a,{children:Object(le.jsx)(Xe.a,{primary:"Build time",secondary:new Date(1e3*r.buildTime).toUTCString()})}),Object(le.jsx)(lt,{to:r.github,children:Object(le.jsx)(Xe.a,{primary:"Github",secondary:r.github})}),Object(le.jsx)(lt,{to:r.discord,children:Object(le.jsx)(Xe.a,{primary:"Discord",secondary:r.discord})})]})}var ht=n(15),ft=n(71),pt=n(123),xt=n.n(pt),Ot=n(415),mt=n(124),gt=n.n(mt),vt=n(68),yt=n.n(vt),Ct=n(389),kt=n(416);function wt(){var e=Object(a.useContext)(de),t=e.setTitle,n=e.setAction;Object(a.useEffect)((function(){t("Categories"),n(Object(le.jsx)(le.Fragment,{}))}),[]);var r=D("/api/v1/category/"),c=r.data,i=r.mutate,s=Object(a.useMemo)((function(){var e=Object(ht.a)(null!==c&&void 0!==c?c:[]);return e.length>0&&"Default"===e[0].name&&e.shift(),e}),[c]),l=Object(a.useState)(-1),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(a.useState)(!1),h=Object(o.a)(b,2),f=h[0],p=h[1],x=Object(a.useState)(""),O=Object(o.a)(x,2),g=O[0],v=O[1],y=Object(a.useState)(!1),C=Object(o.a)(y,2),k=C[0],w=C[1],S=Object(W.a)(),L=function(){p(!1)};return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(ft.a,{onDragEnd:function(e){e.destination&&function(e,t,n){var a=Object(ht.a)(e),r=a.splice(t,1),c=Object(o.a)(r,1)[0];a.splice(n,0,c),i(a,{revalidate:!1});var s=new FormData;s.append("from","".concat(t+1)),s.append("to","".concat(n+1)),R.patch("/api/v1/category/reorder",s).finally((function(){return i()}))}(s,e.source.index,e.destination.index)},children:Object(le.jsx)(ft.c,{droppableId:"droppable",children:function(e){return Object(le.jsxs)(Ie.a,{ref:e.innerRef,children:[s.map((function(e,t){return Object(le.jsx)(ft.b,{draggableId:e.id.toString(),index:t,children:function(n,a){return Object(le.jsxs)(me.a,Object(m.a)(Object(m.a)(Object(m.a)({ContainerProps:{ref:n.innerRef}},n.draggableProps),n.dragHandleProps),{},{style:(r=a.isDragging,c=n.draggableProps.style,o=S.palette,Object(m.a)(Object(m.a)({},c),r&&{background:"dark"===o.mode?"#424242":"rgb(235,235,235)"})),ref:n.innerRef,children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(xt.a,{})}),Object(le.jsx)(Xe.a,{primary:e.name}),Object(le.jsx)(A.a,{onClick:function(){!function(e){v(s[e].name),w(s[e].default),j(e),p(!0)}(t)},size:"large",children:Object(le.jsx)(Ve.a,{})}),Object(le.jsx)(A.a,{onClick:function(){!function(e){var t=s[e];R.delete("/api/v1/category/".concat(t.id)).finally((function(){return i()}))}(t)},size:"large",children:Object(le.jsx)(yt.a,{})})]}));var r,c,o}},e.id)})),e.placeholder]})}})}),Object(le.jsx)(Ot.a,{color:"primary","aria-label":"add",style:{position:"absolute",bottom:S.spacing(2),right:S.spacing(2)},onClick:function(){v(""),w(!1),j(-1),p(!0)},children:Object(le.jsx)(gt.a,{})}),Object(le.jsxs)(Ze.a,{open:f,onClose:L,children:[Object(le.jsx)(it.a,{id:"form-dialog-title",children:-1===d?"New Catalog":"Edit Catalog"}),Object(le.jsxs)($e.a,{children:[Object(le.jsx)(tt.a,{autoFocus:!0,margin:"dense",id:"name",label:"Category Name",type:"text",fullWidth:!0,value:g,onChange:function(e){return v(e.target.value)}}),Object(le.jsx)(kt.a,{control:Object(le.jsx)(Ct.a,{checked:k,onChange:function(e){return w(e.target.checked)},color:"default"}),label:"Default category when adding new manga to library"})]}),Object(le.jsxs)(Qe.a,{children:[Object(le.jsx)(Ke.a,{onClick:L,color:"primary",children:"Cancel"}),Object(le.jsx)(Ke.a,{onClick:function(){p(!1);var e=new FormData;if(e.append("name",g),e.append("default",k.toString()),-1===d)R.post("/api/v1/category/",e).finally((function(){return i()}));else{var t=s[d];R.patch("/api/v1/category/".concat(t.id),e).finally((function(){return i()}))}},color:"primary",children:"Submit"})]})]})]})}var St=n(102),Lt=n(369),Nt=n(390),Et=n(384);function Tt(e){return Object(le.jsx)(Lt.a,Object(m.a)(Object(m.a)({},e),{},{direction:"up"}))}function Rt(e){var t=e.message,n=e.severity,a=r.a.useState(!0),c=Object(o.a)(a,2),i=c[0],s=c[1],l=function(){s(!1)};return Object(le.jsx)(Nt.a,{open:i,onClose:l,autoHideDuration:3e3,TransitionComponent:Tt,message:"I love snacks",children:Object(le.jsx)(Et.a,{elevation:6,variant:"filled",onClose:l,severity:n,children:t})})}function It(e,t){var n=Math.floor(1e3*Math.random()),a=document.createElement("div");a.id="alert-".concat(n),document.body.appendChild(a),i.a.render(Object(le.jsx)(Rt,{message:e,severity:t}),a),setTimeout((function(){return function(e){var t=document.querySelector("#".concat(e));i.a.unmountComponentAtNode(t),document.body.removeChild(t)}(a.id)}),3500)}function Ft(){var e=Object(a.useContext)(de),t=e.setTitle,n=e.setAction;Object(a.useEffect)((function(){t("Backup"),n(Object(le.jsx)(le.Fragment,{}))}),[]);var r=R.defaults.baseURL,c=function(e){if(e.name.toLowerCase().endsWith("proto.gz")){var t=new FormData;t.append("backup.proto.gz",e),It("Restoring backup....","info"),R.post("/api/v1/backup/import/file",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){return It("Backup restore finished!","success")})).catch((function(){return It("Backup restore failed!","error")}))}else e.name.toLowerCase().endsWith("json")?It("legacy backups are not supported!","error"):It("invalid file type!","error")},i=function(){var e=Object(g.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,Object(St.a)(t);case 3:n=e.sent,c(n[0]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(e){e.preventDefault()};return Object(a.useEffect)((function(){document.addEventListener("drop",i),document.addEventListener("dragover",o);var e=document.getElementById("backup-file");return null===e||void 0===e||e.addEventListener("change",function(){var e=Object(g.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(St.a)(t);case 2:n=e.sent,c(n[0]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){document.removeEventListener("drop",i),document.removeEventListener("dragover",o)}}),[]),Object(le.jsxs)(le.Fragment,{children:[Object(le.jsxs)(Ie.a,{sx:{padding:0},children:[Object(le.jsx)(lt,{to:"".concat(r,"/api/v1/backup/export/file"),directLink:!0,children:Object(le.jsx)(Xe.a,{primary:"Create Backup",secondary:"Backup library as a Tachiyomi backup"})}),Object(le.jsx)(me.a,{button:!0,onClick:function(){var e;return null===(e=document.getElementById("backup-file"))||void 0===e?void 0:e.click()},children:Object(le.jsx)(Xe.a,{primary:"Restore Backup",secondary:"You can also drag and drop the backup file here to restore"})})]}),Object(le.jsx)("input",{type:"file",id:"backup-file",style:{display:"none"}})]})}var Dt=n(383),Pt=n(418),Bt=["(\uff65o\uff65;)","\u03a3(\u0ca0_\u0ca0)","\u0ca5_\u0ca5","(\u02d8\uff65_\uff65\u02d8)","(\uff1b\uffe3\u0414\uffe3)","(\uff65\u0414\uff65\u3002"];function zt(e){var t=e.message,n=e.messageExtra,r=Object(W.a)(),c=Object(M.a)(r.breakpoints.down("sm")),i=Object(a.useMemo)((function(){return function(){var e=Math.floor(Math.random()*Bt.length);return Bt[e]}()}),[]);return Object(le.jsxs)(pe.a,{sx:{position:"absolute",left:"calc(50% + ".concat(c?"0px":r.spacing(4),")"),top:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[Object(le.jsx)(z.a,{variant:"h3",gutterBottom:!0,children:i}),Object(le.jsx)(z.a,{variant:"h5",children:t}),n]})}function At(e){var t=e.children,n=e.index,a=e.currentIndex;return Object(le.jsx)("div",{role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(n),children:a===n&&t})}zt.defaultProps={messageExtra:void 0};var Mt=n(69),Wt=n.n(Mt),Ht={showDownloadBadge:!1,showUnreadBadge:!1,gridLayout:0,SourcegridLayout:0,downloaded:void 0,sortDesc:void 0,sorts:void 0,unread:void 0},Vt=r.a.createContext({options:Ht,setOptions:function(){}}),Ut=Vt;function _t(){return Object(a.useContext)(Vt)}var Jt=n(4),Gt=n(367),Xt=n(372),Yt=n(54),qt=["label","sx"],Kt=function(e){var t=e.label,n=e.sx,a=Object(Yt.a)(e,qt);return Object(le.jsx)(kt.a,{control:Object(le.jsx)(Ct.a,Object(m.a)({},a)),label:t,sx:n})},Zt=n(386),Qt=["label","sx"],$t=function(e){var t=e.label,n=e.sx,a=Object(Yt.a)(e,Qt);return Object(le.jsx)(kt.a,{control:Object(le.jsx)(Zt.a,Object(m.a)({},a)),label:t,sx:n})},en=n(203),tn=n.n(en),nn=n(204),an=n.n(nn),rn=["sortDescending"],cn=function(e){var t=e.sortDescending,n=Object(Yt.a)(e,rn);return Object(le.jsx)($t,Object(m.a)({checkedIcon:t?Object(le.jsx)(tn.a,{color:"primary"}):Object(le.jsx)(an.a,{color:"primary"})},n))},on=n(370),sn=["checked","onChange"];var ln=function(e){var t=e.checked,n=e.onChange,r=Object(Yt.a)(e,sn),c=Object(a.useCallback)((function(){if(n){var e=!0!==(a=t)&&(!1!==a||void 0);n(e)}var a}),[n]);return Object(le.jsx)(Ct.a,Object(m.a)({indeterminateIcon:Object(le.jsx)(on.a,{}),checked:!0===t,indeterminate:!1===t,onChange:c},r))},un=["label","sx"],dn=function(e){var t=e.label,n=e.sx,a=Object(Yt.a)(e,un);return Object(le.jsx)(kt.a,{control:Object(le.jsx)(ln,Object(m.a)({},a)),label:t,sx:n})},jn=n(371),bn=n(417),hn=function(e){var t=e.open,n=e.onClose,a=e.children,r=e.minHeight;return Object(le.jsx)(bn.a,{anchor:"bottom",open:t,onClose:n,PaperProps:{style:{maxWidth:600,marginLeft:"auto",marginRight:"auto",minHeight:r}},children:Object(le.jsx)(pe.a,{children:a})})};hn.defaultProps={minHeight:void 0};var fn=hn,pn=function(e){var t=e.open,n=e.onClose,r=e.tabs,c=e.tabTitle,i=e.tabContent,s=e.minHeight,l=Object(a.useState)(0),u=Object(o.a)(l,2),d=u[0],j=u[1];return Object(le.jsxs)(fn,{open:t,onClose:n,minHeight:s,children:[Object(le.jsx)(Dt.a,{value:d,variant:"fullWidth",onChange:function(e,t){return j(t)},indicatorColor:"primary",textColor:"primary",children:r.map((function(e,t){return Object(le.jsx)(Pt.a,{value:t,label:c(e)},e)}))}),r.map((function(e,t){return Object(le.jsx)(At,{index:t,currentIndex:d,children:Object(le.jsx)(jn.a,{sx:{px:3,py:1,minHeight:s},children:i(e)})},e)}))]})};pn.defaultProps={minHeight:void 0};var xn=pn,On={filter:"Filter",sort:"Sort",display:"Display"},mn=[["sortToRead","By Unread chapters"],["sortAlph","Alphabetically"],["sortID","By ID"]],gn=function(e){var t=e.open,n=e.onClose,a=_t(),r=a.options,c=a.setOptions,i=function(e,t){c((function(n){return Object(m.a)(Object(m.a)({},n),{},Object(Jt.a)({},e,t))}))};return Object(le.jsx)(xn,{open:t,onClose:n,tabs:["filter","sort","display"],tabTitle:function(e){return On[e]},tabContent:function(e){if("filter"===e)return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(dn,{label:"Unread",checked:r.unread,onChange:function(e){return i("unread",e)}}),Object(le.jsx)(dn,{label:"Downloaded",checked:r.downloaded,onChange:function(e){return i("downloaded",e)}})]});if("sort"===e)return mn.map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(le.jsx)(cn,{label:a,checked:r.sorts===n,sortDescending:r.sortDesc,onClick:function(){return n!==r.sorts?i("sorts",n):i("sortDesc",!r.sortDesc)}},n)}));if("display"===e){var t=r.gridLayout,n=r.showDownloadBadge,a=r.showUnreadBadge;return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Gt.a,{children:"Display mode"}),Object(le.jsxs)(Xt.a,{onChange:function(e){return i("gridLayout",Number(e.target.value))},value:t,children:[Object(le.jsx)($t,{label:"Compact grid",value:0,checked:null==t||0===t}),Object(le.jsx)($t,{label:"Comfortable grid",value:1,checked:1===t}),Object(le.jsx)($t,{label:"List",value:2,checked:2===t})]}),Object(le.jsx)(Gt.a,{sx:{mt:2},children:"Badges"}),Object(le.jsx)(Kt,{label:"Unread Badges",checked:!0===a,onChange:function(){return i("showUnreadBadge",!a)}}),Object(le.jsx)(Kt,{label:"Download Badges",checked:!0===n,onChange:function(){return i("showDownloadBadge",!n)}})]})}return null}})},vn=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],r=t[1],c=_t().options,i=null!=c.downloaded||null!=c.unread;return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(A.a,{onClick:function(){return r(!n)},color:i?"warning":"default",children:Object(le.jsx)(Wt.a,{})}),Object(le.jsx)(gn,{open:n,onClose:function(){return r(!1)}})]})},yn=n(395),Cn=n(419),kn=n(420),wn=n(421),Sn=n(396);function Ln(e){var t=e.src,n=e.alt,r=e.onImageLoad,c=e.imgRef,i=e.spinnerStyle,s=e.imgStyle,l=Object(a.useState)(""),u=Object(o.a)(l,2),d=u[0],j=u[1];return Object(a.useEffect)((function(){var e=new Image;return e.src=t,e.onload=function(){j(t),null===r||void 0===r||r()},e.onerror=function(){j("/notFound.svg")},function(){e.onload=null,e.onerror=null}}),[t]),0===d.length?Object(le.jsx)(pe.a,{sx:i,children:Object(le.jsx)(dt.a,{thickness:5})}):"Not Found"===d?Object(le.jsx)(pe.a,{sx:i}):Object(le.jsx)("img",{style:s,ref:c,src:d,alt:n})}Ln.defaultProps={spinnerStyle:{},imgStyle:{},onImageLoad:function(){},imgRef:void 0};var Nn=Object(ye.a)("div")({position:"absolute",bottom:0,width:"100%",height:"30%",background:"linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%)"}),En=Object(ye.a)("div")({position:"absolute",bottom:0,width:"100%",height:"20%",background:"linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%)"}),Tn=Object(ye.a)(z.a)({position:"absolute",bottom:0,padding:"0.5em",color:"white",fontSize:"1.05rem",textShadow:"0px 0px 3px #000000"}),Rn=Object(ye.a)("div")({display:"flex",position:"absolute",top:5,left:5,height:"fit-content",borderRadius:"5px",overflow:"hidden","& p":{color:"white",padding:"0.1em",paddingInline:"0.2em",fontSize:"1.05rem"}}),In=function(e,t){var n=e.substr(0,t-"...".length);return n.length<e.length?n+"...":e},Fn=r.a.forwardRef((function(e,t){var n=e.manga,a=n.id,r=n.title,c=n.thumbnailUrl,i=n.downloadCount,l=n.unreadCount,u=n.inLibrary,d=e.gridLayout,j=e.dimensions,b=e.inLibraryIndicator,h=_t().options,f=h.showUnreadBadge,p=h.showDownloadBadge,x=Re("serverBaseURL",""),O=Object(o.a)(x,1)[0],m=Re("useCache",!0),g=Object(o.a)(m,1)[0],v=Re("ItemWidth",300),y=Object(o.a)(v,1)[0],C={pathname:"/manga/".concat(a,"/"),state:{backLink:xe}};if(2!==d){var k=Math.round(j/y);return Object(le.jsx)(yn.a,{item:!0,xs:12/k,sm:12/k,md:12/k,lg:12/k,children:Object(le.jsx)(s.b,{to:C,style:1===d?{textDecoration:"none"}:{},children:Object(le.jsxs)(pe.a,{sx:{display:"flex",flexDirection:"column"},children:[Object(le.jsx)(Cn.a,{sx:{aspectRatio:"225/350",display:"flex"},ref:t,children:Object(le.jsxs)(kn.a,{sx:{position:"relative",height:"100%"},children:[Object(le.jsxs)(Rn,{children:[b&&u&&Object(le.jsx)(z.a,{sx:{backgroundColor:"primary.dark",zIndex:"1"},children:"In library"}),f&&l>0&&Object(le.jsx)(z.a,{sx:{backgroundColor:"primary.dark"},children:l}),p&&i>0&&Object(le.jsx)(z.a,{sx:{backgroundColor:"success.dark"},children:i})]}),Object(le.jsx)(Ln,{alt:r,src:"".concat(O).concat(c,"?useCache=").concat(g),imgStyle:b&&u?{height:"100%",width:"100%",objectFit:"cover",filter:"brightness(0.4)"}:{height:"100%",width:"100%",objectFit:"cover"},spinnerStyle:{display:"grid",placeItems:"center"}}),1===d?Object(le.jsx)(le.Fragment,{}):Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Nn,{}),Object(le.jsx)(En,{})]}),1===d?Object(le.jsx)(le.Fragment,{}):Object(le.jsx)(Tn,{children:In(r,61)})]})}),1===d?Object(le.jsx)(Tn,{sx:{position:"relative"},children:In(r,61)}):Object(le.jsx)(le.Fragment,{})]})})})}return Object(le.jsx)(yn.a,{item:!0,xs:12,sm:12,md:12,lg:12,children:Object(le.jsx)(s.b,{to:C,style:{textDecoration:"none",color:"unset"},children:Object(le.jsxs)(wn.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:2,"&:hover":{backgroundColor:"action.hover",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"},"&:active":{backgroundColor:"action.selected",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"},position:"relative"},children:[Object(le.jsx)(Sn.a,{variant:"rounded",sx:u?{width:56,height:56,flex:"0 0 auto",marginRight:2,imageRendering:"pixelated",filter:"brightness(0.4)"}:{width:56,height:56,flex:"0 0 auto",marginRight:2,imageRendering:"pixelated"},src:"".concat(O).concat(c,"?useCache=").concat(g)}),Object(le.jsx)(pe.a,{sx:{display:"flex",flexDirection:"row",flexGrow:1,width:"min-content"},children:Object(le.jsx)(z.a,{variant:"h5",component:"h2",children:In(r,61)})}),Object(le.jsxs)(Rn,{sx:{position:"relative"},children:[u&&Object(le.jsx)(z.a,{sx:{backgroundColor:"primary.dark",zIndex:"1"},children:"In library"}),f&&l>0&&Object(le.jsx)(z.a,{sx:{backgroundColor:"primary.dark"},children:l}),p&&i>0&&Object(le.jsx)(z.a,{sx:{backgroundColor:"success.dark"},children:i})]})]})})})})),Dn=function(e){var t,n=e.mangas,r=e.isLoading,c=e.message,i=e.messageExtra,s=e.hasNextPage,l=e.lastPageNum,u=e.setLastPageNum,d=e.gridLayout,j=e.horisontal,b=e.noFaces,h=e.inLibraryIndicator,f=Object(a.useRef)(null),p=function(){if(f.current){var e=f.current.getBoundingClientRect();(e.y+e.height)/window.innerHeight<2&&s&&u(l+1)}};Object(a.useEffect)((function(){return window.addEventListener("scroll",p,!0),function(){window.removeEventListener("scroll",p,!0)}}),[s,n]);var x,O=Object(a.useState)(1),m=Object(o.a)(O,2),g=m[0],v=m[1],y=Object(a.useRef)(null),C=function(){v(y.current?y.current.offsetWidth:0)};return Object(a.useLayoutEffect)(C,[]),window.addEventListener("resize",(function(){clearInterval(x),x=setTimeout(C,100)})),t=0===n.length?r?Object(le.jsx)(jt,{}):b?Object(le.jsxs)(pe.a,{sx:{margin:"auto"},children:[Object(le.jsx)(z.a,{variant:"h5",children:c}),i]}):Object(le.jsx)(zt,{message:c,messageExtra:i}):n.map((function(e,t){return Object(le.jsx)(Fn,{manga:e,ref:t===n.length-1?f:void 0,gridLayout:d,dimensions:g,inLibraryIndicator:h},e.id)})),Object(le.jsx)("div",{ref:y,children:Object(le.jsx)(yn.a,{container:!0,spacing:1,style:j?{margin:0,width:"100%",padding:"5px",overflowX:"scroll",display:"-webkit-inline-box",flexWrap:"nowrap"}:{margin:0,width:"100%",padding:"5px"},children:t})})};Dn.defaultProps={message:"",messageExtra:void 0};var Pn=Dn,Bn=function(e,t){var n,a;return(null!==(n=e.unreadCount)&&void 0!==n?n:0)-(null!==(a=t.unreadCount)&&void 0!==a?a:0)},zn=function(e,t){return e.title.localeCompare(t.title)},An=function(e,t){return e.id-t.id},Mn=function(e){var t=e.mangas,n=e.isLoading,r=e.hasNextPage,c=e.lastPageNum,i=e.setLastPageNum,s=e.message,l=Object(u.d)("query",u.c),d=Object(o.a)(l,1)[0],j=_t().options,b=j.unread,h=j.downloaded,f=Object(a.useMemo)((function(){return function(e,t,n){var a=Object(ht.a)(e);switch(t){case"sortAlph":a.sort(zn);break;case"sortID":a.sort(An);break;case"sortToRead":a.sort(Bn)}return!0===n&&a.reverse(),a}(t,j.sorts,j.sortDesc)}),[t,j.sorts,j.sortDesc]),p=Object(a.useMemo)((function(){return function(e,t,n,a){return e.filter((function(e){return function(e,t){var n=t.downloadCount;switch(e){case!0:return!!n&&n>=1;case!1:return 0===n;default:return!0}}(a,e)&&function(e,t){var n=t.unreadCount;switch(e){case!0:return!!n&&n>=1;case!1:return 0===n;default:return!0}}(n,e)&&function(e,t){var n=t.title;return!e||n.toLowerCase().includes(e.toLowerCase())}(t,e)}))}(f,d,b,h)}),[f,d,b,h]),x=(null!=b||null!=h||d)&&0===p.length&&t.length>0;return Object(le.jsx)(Pn,{mangas:p,isLoading:n,hasNextPage:r,lastPageNum:c,setLastPageNum:i,message:x?"There are no Manga matching this filter":s,gridLayout:j.gridLayout})},Wn=n(126),Hn=n.n(Wn),Vn=n(408),Un=n(205),_n=n.n(Un),Jn=function(e){var t=e.autoOpen,n=Object(u.d)("query",u.c),c=Object(o.a)(n,2),i=c[0],s=c[1],l=Object(a.useState)(!!i),d=Object(o.a)(l,2),j=d[0],b=d[1],h=r.a.useRef();var f=function(){b(!0),setTimeout((function(){h&&h.current&&h.current.focus()}))},p=function(e){("F3"===e.code||e.ctrlKey&&"KeyF"===e.code)&&(e.preventDefault(),f())};return Object(a.useEffect)((function(){t&&f()}),[]),Object(a.useEffect)((function(){return window.addEventListener("keydown",p),function(){window.removeEventListener("keydown",p)}}),[p]),Object(le.jsx)(le.Fragment,{children:j?Object(le.jsx)(Vn.a,{value:i||"",onChange:function(e){s(""===e.target.value?void 0:e.target.value)},onBlur:function(){i||b(!1)},inputRef:h,endAdornment:Object(le.jsx)(A.a,{onClick:function(){s(null),b(!1)},children:Object(le.jsx)(_n.a,{})})}):Object(le.jsx)(A.a,{onClick:f,children:Object(le.jsx)(Hn.a,{})})})};Jn.defaultProps={autoOpen:!1};var Gn=Jn,Xn=n(101),Yn=n.n(Xn);function qn(e){var t=e.progress;return Object(le.jsxs)(pe.a,{sx:{display:"grid",placeItems:"center",position:"relative"},children:[Object(le.jsx)(dt.a,{variant:"determinate",value:t}),Object(le.jsx)(pe.a,{sx:{position:"absolute"},children:Object(le.jsx)(z.a,{fontSize:"0.8rem",children:"".concat(Math.round(t),"%")})})]})}var Kn=JSON.parse(window.localStorage.getItem("serverBaseURL")).replace("http","ws");var Zn=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(0),i=Object(o.a)(c,2),s=i[0],l=i[1],u=function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),l(0),e.next=5,R.post("/api/v1/update/fetch");case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),It("Checking for updates failed!","error"),r(!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=new WebSocket("".concat(Kn,"/api/v1/update"));return e.onmessage=function(e){var t=JSON.parse(e.data),n=t.statusMap,a=n.COMPLETE,c=n.RUNNING,i=n.PENDING;r(t.running);var o=a/(a+c+i)*100;l(Number.isNaN(o)?0:o)},function(){return e.close()}}),[]),Object(le.jsx)(A.a,{onClick:u,disabled:n,children:n?Object(le.jsx)(qn,{progress:s}):Object(le.jsx)(Yn.a,{})})};function Qn(){var e,t=D("/api/v1/category"),n=t.data,r=t.error,c=t.loading,i=null!==n&&void 0!==n?n:[],s=Object(u.d)("tab",u.a),l=Object(o.a)(s,2),d=l[0],j=l[1],b=null!==(e=i.find((function(e){return e.order===d})))&&void 0!==e?e:i[0],h=D("/api/v1/category/".concat(null===b||void 0===b?void 0:b.id),{isPaused:function(){return null==b}}),f=h.data,p=h.error,x=h.loading,O=null!==f&&void 0!==f?f:[],m=Object(a.useContext)(de),g=m.setTitle,v=m.setAction;Object(a.useEffect)((function(){return g("Library"),v(Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Gn,{}),Object(le.jsx)(vn,{}),Object(le.jsx)(Zn,{})]})),function(){g(""),v(Object(le.jsx)(le.Fragment,{}))}}),[]);var y,C=Object(a.useState)(1),k=Object(o.a)(C,2),w=k[0],S=k[1];if(null!=r)return Object(le.jsx)(zt,{message:"Could not load categories",messageExtra:null!==(y=null===r||void 0===r?void 0:r.message)&&void 0!==y?y:r});if(c)return Object(le.jsx)(jt,{});if(0===i.length)return Object(le.jsx)(zt,{message:"Your Library is empty"});if(1===i.length)return Object(le.jsx)(Mn,{mangas:O,hasNextPage:!1,lastPageNum:w,setLastPageNum:S,message:"Your Library is empty",isLoading:null!=b&&x});var L=window.innerWidth<160*i.length;return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Dt.a,{value:b.order,onChange:function(e,t){return function(e){j(0===e?void 0:e)}(t)},indicatorColor:"primary",textColor:"primary",centered:!L,variant:L?"scrollable":"fullWidth",scrollButtons:!0,allowScrollButtonsMobile:!0,children:i.map((function(e){return Object(le.jsx)(Pt.a,{label:e.name,value:e.order},e.id)}))},b.order),i.map((function(e){var t;return Object(le.jsx)(At,{index:e.order,currentIndex:b.order,children:e===b&&(p?Object(le.jsx)(zt,{message:"Could not load manga",messageExtra:null!==(t=null===p||void 0===p?void 0:p.message)&&void 0!==t?t:p}):Object(le.jsx)(Mn,{mangas:O,hasNextPage:!1,lastPageNum:w,setLastPageNum:S,message:"Category is Empty",isLoading:x}))},e.order)}))]})}function $n(e){return"Switch"===e?qe.a:Ct.a}function ea(e){var t=e.title,n=e.summary,c=e.currentValue,i=e.updateValue,s=e.type,l=Object(a.useState)(c),u=Object(o.a)(l,2),d=u[0],j=u[1];return Object(a.useEffect)((function(){j(c)}),[c]),Object(le.jsxs)(me.a,{children:[Object(le.jsx)(Xe.a,{primary:t,secondary:n}),Object(le.jsx)(Ye.a,{children:r.a.createElement($n(s),{edge:"end",checked:d,onChange:function(){i(!c),j(!c)}})})]})}function ta(e){return Object(le.jsx)(ea,Object(m.a)(Object(m.a)({},e),{},{type:"Checkbox"}))}function na(e){return Object(le.jsx)(ea,Object(m.a)(Object(m.a)({},e),{},{type:"Switch"}))}function aa(e){var t=e.value,n=e.open,a=e.onClose,c=e.options,i=e.title,s=r.a.useState(t),l=Object(o.a)(s,2),u=l[0],d=l[1],j=r.a.useRef(null);r.a.useEffect((function(){n||d(t)}),[t,n]);return Object(le.jsxs)(Ze.a,{sx:{"& .MuiDialog-paper":{width:"80%",maxHeight:435}},maxWidth:"xs",TransitionProps:{onEntering:function(){null!=j.current&&(null===j||void 0===j||j.current.focus())}},open:n,children:[Object(le.jsx)(it.a,{children:i}),Object(le.jsx)($e.a,{dividers:!0,children:Object(le.jsx)(Xt.a,{ref:j,value:u,onChange:function(e){d(e.target.value)},children:c.map((function(e){return Object(le.jsx)(kt.a,{value:e,control:Object(le.jsx)(Zt.a,{}),label:e},e)}))})}),Object(le.jsxs)(Qe.a,{children:[Object(le.jsx)(Ke.a,{autoFocus:!0,onClick:function(){a(null)},children:"Cancel"}),Object(le.jsx)(Ke.a,{onClick:function(){a(u)},children:"Ok"})]})]})}function ra(e){var t=e.title,n=e.summary,r=e.currentValue,c=e.updateValue,i=e.entryValues,s=e.entries,l=Object(a.useState)(r),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(a.useState)(!1),h=Object(o.a)(b,2),f=h[0],p=h[1];Object(a.useEffect)((function(){j(r)}),[r]);var x=function(e){var t=i.indexOf(e);return s[t]};return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(me.a,{button:!0,onClick:function(){return p(!0)},children:Object(le.jsx)(Xe.a,{primary:t,secondary:"%s"===n?x(r):n})}),Object(le.jsx)(aa,{title:t,open:f,onClose:function(e){null!==e&&(c(function(e){var t=s.indexOf(e);return i[t]}(e)),j(e)),p(!1)},value:x(d),options:s})]})}function ca(e){var t=e.title,n=e.summary,r=e.dialogTitle,c=e.dialogMessage,i=e.currentValue,s=e.updateValue,l=Object(a.useState)(i),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(a.useState)(!1),h=Object(o.a)(b,2),f=h[0],p=h[1],x=function(){p(!1),j(i)};return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(me.a,{button:!0,onClick:function(){return p(!0)},children:Object(le.jsx)(Xe.a,{primary:t,secondary:n})}),Object(le.jsxs)(Ze.a,{open:f,onClose:x,children:[Object(le.jsx)(it.a,{children:r}),Object(le.jsxs)($e.a,{children:[Object(le.jsx)(et.a,{children:c}),Object(le.jsx)(tt.a,{autoFocus:!0,margin:"dense",id:"name",type:"text",fullWidth:!0,value:d,onChange:function(e){return j(e.target.value)}})]}),Object(le.jsxs)(Qe.a,{children:[Object(le.jsx)(Ke.a,{onClick:x,color:"primary",children:"Cancel"}),Object(le.jsx)(Ke.a,{onClick:function(){p(!1),s(d)},color:"primary",children:"OK"})]})]})]})}var ia=n(307);function oa(e){return JSON.parse(JSON.stringify(e))}function sa(e){var t=e.selectedValues,n=e.open,a=e.onClose,c=e.values,i=e.title,s=r.a.useState(t),l=Object(o.a)(s,2),u=l[0],d=l[1];r.a.useEffect((function(){n||d(t)}),[t,n]);return Object(le.jsxs)(Ze.a,{sx:{"& .MuiDialog-paper":{width:"80%",maxHeight:435}},maxWidth:"xs",open:n,children:[Object(le.jsx)(it.a,{children:i}),Object(le.jsx)($e.a,{dividers:!0,children:Object(le.jsx)(ia.a,{children:c.map((function(e){return Object(le.jsx)(kt.a,{control:Object(le.jsx)(Ct.a,{checked:u.some((function(t){return e===t})),onChange:function(t){return function(e,t){var n=e.target.checked,a=u.some((function(e){return t===e}));if(n){if(!a){var r=oa(u);r.push(t),d(r)}}else if(a){var c=oa(u),i=c.indexOf(t);c.splice(i,1),d(c)}}(t,e)},color:"default"}),label:e},e)}))})}),Object(le.jsxs)(Qe.a,{children:[Object(le.jsx)(Ke.a,{autoFocus:!0,onClick:function(){a(null)},children:"Cancel"}),Object(le.jsx)(Ke.a,{onClick:function(){a(u)},children:"Ok"})]})]})}function la(e){var t=e.title,n=e.summary,r=e.currentValue,c=e.updateValue,i=e.entryValues,s=e.entries,l=Object(a.useState)(r),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(a.useState)(!1),h=Object(o.a)(b,2),f=h[0],p=h[1];Object(a.useEffect)((function(){j(r)}),[r]);var x;return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(me.a,{button:!0,onClick:function(){return p(!0)},children:Object(le.jsx)(Xe.a,{primary:t,secondary:n})}),Object(le.jsx)(sa,{title:t,open:f,onClose:function(e){null!==e&&(c(e.map((function(e){var t=s.indexOf(e);return i[t]}))),j(e)),p(!1)},selectedValues:(x=d,x.map((function(e){var t=i.indexOf(e);return s[t]}))),values:s})]})}function ua(){var e=Object(a.useContext)(de),t=e.setTitle,n=e.setAction;Object(a.useEffect)((function(){t("Source Configuration"),n(Object(le.jsx)(le.Fragment,{}))}),[]);var c=Object(l.i)().sourceId,i=D("/api/v1/source/".concat(c,"/preferences")),o=i.data,s=void 0===o?[]:o,u=i.mutate,d=function(e,t){switch(s[e].props.defaultValueType){case"Set<String>":return JSON.stringify(t);default:return t.toString()}};return Object(le.jsx)(le.Fragment,{children:Object(le.jsx)(Ie.a,{sx:{padding:0},children:s.map((function(e,t){var n,a=oa(e.props);return a.updateValue=(n=t,function(e){R.post("/api/v1/source/".concat(c,"/preferences"),JSON.stringify({position:n,value:d(n,e)})).then((function(){return u()}))}),a.key=t,r.a.createElement(function(e){switch(e){case"CheckBoxPreference":return ta;case"SwitchPreferenceCompat":return na;case"ListPreference":return ra;case"EditTextPreference":return ca;case"MultiSelectListPreference":return la;default:return ta}}(e.type),a)}))})})}var da=n(374),ja=JSON.parse(window.localStorage.getItem("serverBaseURL")).replace("http","ws"),ba=function(e,t){var n=Object(a.useState)(),r=Object(o.a)(n,2),c=r[0],i=r[1];return Object(a.useEffect)((function(){var n=new WebSocket("".concat(ja).concat(e));return n.onmessage=function(e){var n=JSON.parse(e.data);t?!0===t(n)&&i(n):i(n)},function(){return n.close()}}),[e]),{data:c}},ha=n(206),fa=n.n(ha),pa=n(128),xa=n.n(pa),Oa=n(127),ma=n.n(Oa),ga=n(209),va=n.n(ga),ya=n(130),Ca=n.n(ya),ka=n(210),wa=n.n(ka),Sa=n(85),La=n.n(Sa),Na=n(207),Ea=n.n(Na),Ta=n(129),Ra=n.n(Ta),Ia=n(422),Fa=n(224),Da=n(423),Pa=function(e){var t=Object(W.a)(),n=e.chapter,a=e.triggerChaptersUpdate,c=e.downloadChapter,i=e.showChapterNumber,l=e.onSelect,u=e.selected,d=null!==u,j=n.uploadDate&&new Date(n.uploadDate).toLocaleDateString(),b=r.a.useState(null),h=Object(o.a)(b,2),f=h[0],p=h[1],x=function(){p(null)},O=function(e,t){x();var r=new FormData;r.append(e,t),"read"===e&&r.append("lastPageRead","1"),R.patch("/api/v1/manga/".concat(n.mangaId,"/chapter/").concat(n.index),r).then((function(){return a()}))},m=n.downloaded,g=!n.downloaded&&void 0===c;return Object(le.jsx)("li",{children:Object(le.jsxs)(Cn.a,{sx:{position:"relative",margin:1,":hover":{backgroundColor:"action.hover",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",cursor:"pointer"},":active":{backgroundColor:"action.selected",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"}},children:[Object(le.jsx)(s.b,{to:{pathname:"/manga/".concat(n.mangaId,"/chapter/").concat(n.index),state:{backLink:xe}},style:{textDecoration:"none",color:t.palette.text[n.read?"disabled":"primary"]},onClick:function(e){d&&(e.preventDefault(),e.stopPropagation(),l(!u))},children:Object(le.jsxs)(wn.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:2,"&:last-child":{pb:2}},children:[Object(le.jsxs)(jn.a,{direction:"column",flex:1,children:[Object(le.jsxs)(z.a,{variant:"h5",component:"h2",children:[n.bookmarked&&Object(le.jsx)(fa.a,{color:"primary",sx:{mr:.5,position:"relative",top:"0.15em"}}),i?"Chapter ".concat(n.chapterNumber):n.name]}),Object(le.jsx)(z.a,{variant:"caption",children:n.scanlator}),Object(le.jsxs)(z.a,{variant:"caption",children:[j,m&&" \u2022 Downloaded",c&&" \u2022 Downloading (".concat((100*c.progress).toFixed(2),"%)")]})]}),null===u?Object(le.jsx)(A.a,{"aria-label":"more",onClick:function(e){e.stopPropagation(),e.preventDefault(),p(e.currentTarget)},size:"large",children:Object(le.jsx)(Ea.a,{})}):Object(le.jsx)(Ct.a,{checked:u})]})}),null!=c&&Object(le.jsx)(Ia.a,{sx:{position:"absolute",bottom:0,width:"100%",opacity:.5},variant:"determinate",value:100*c.progress,color:"inherit"}),Object(le.jsxs)(Fa.a,{anchorEl:f,keepMounted:!0,open:Boolean(f),onClose:x,children:[Object(le.jsxs)(Da.a,{onClick:function(){l(!0),x()},children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(va.a,{fontSize:"small"})}),Object(le.jsx)(Xe.a,{children:"Select"})]}),m&&Object(le.jsxs)(Da.a,{onClick:function(){R.delete("/api/v1/manga/".concat(n.mangaId,"/chapter/").concat(n.index)).then((function(){return a()})),x()},children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(yt.a,{fontSize:"small"})}),Object(le.jsx)(Xe.a,{children:"Delete"})]}),g&&Object(le.jsxs)(Da.a,{onClick:function(){R.get("/api/v1/download/".concat(n.mangaId,"/chapter/").concat(n.index)),x()},children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(La.a,{fontSize:"small"})}),Object(le.jsx)(Xe.a,{children:"Download"})]}),Object(le.jsxs)(Da.a,{onClick:function(){return O("bookmarked",!n.bookmarked)},children:[Object(le.jsxs)(ge.a,{children:[n.bookmarked&&Object(le.jsx)(ma.a,{fontSize:"small"}),!n.bookmarked&&Object(le.jsx)(xa.a,{fontSize:"small"})]}),Object(le.jsxs)(Xe.a,{children:[n.bookmarked&&"Remove bookmark",!n.bookmarked&&"Add bookmark"]})]}),Object(le.jsxs)(Da.a,{onClick:function(){return O("read",!n.read)},children:[Object(le.jsxs)(ge.a,{children:[n.read&&Object(le.jsx)(Ra.a,{fontSize:"small"}),!n.read&&Object(le.jsx)(Ca.a,{fontSize:"small"})]}),Object(le.jsxs)(Xe.a,{children:[n.read&&"Mark as unread",!n.read&&"Mark as read"]})]}),Object(le.jsxs)(Da.a,{onClick:function(){return O("markPrevRead",!0)},children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(wa.a,{fontSize:"small"})}),Object(le.jsx)(Xe.a,{children:"Mark previous as Read"})]})]})]})})},Ba=n(373);function za(e){var t=e.chapter,n=t.index,a=t.lastPageRead,r=e.mangaId;return Object(le.jsxs)(Ot.a,{sx:{position:"fixed",bottom:"2em",right:"3em"},component:s.b,variant:"extended",color:"primary",to:{pathname:"/manga/".concat(r,"/chapter/").concat(n,"/page/").concat(a),state:{backLink:xe}},children:[Object(le.jsx)(Ba.a,{}),1===n?"Start":"Resume"]})}var Aa={active:!1,unread:void 0,downloaded:void 0,bookmarked:void 0,reverse:!1,sortBy:"source",showChapterNumber:!1};function Ma(e,t){switch(t.type){case"filter":var n=!1!==e.unread&&!1!==e.downloaded&&!1!==e.bookmarked;return Object(m.a)(Object(m.a)({},e),{},Object(Jt.a)({active:n},t.filterType,t.filterValue));case"sortBy":return Object(m.a)(Object(m.a)({},e),{},{sortBy:t.sortBy});case"sortReverse":return Object(m.a)(Object(m.a)({},e),{},{reverse:!e.reverse});case"showChapterNumber":return Object(m.a)(Object(m.a)({},e),{},{showChapterNumber:!e.showChapterNumber});default:throw Error("This is not a valid Action")}}var Wa=function(e){return function(e,t,n){var r=Re(t,n),c=Object(o.a)(r,2),i=c[0],s=c[1];return Object(a.useReducer)((function(t,n){var a=e(t,n);return s(a),a}),i)}(Ma,"".concat(e,"filterOptions"),Aa)},Ha=[["source","By Source"],["fetchedAt","By Fetch date"]],Va=function(e,t){return"string"===typeof t?"".concat(t).concat(1===e?"":"s"):t[1===e?"one":"many"]},Ua=function(e,t){return(1===e?t.one:t.many).replaceAll("%count%",e.toString())},_a=n(132),Ja=n(392),Ga={filter:"Filter",sort:"Sort",display:"Display"},Xa=function(e){var t=e.open,n=e.onClose,a=e.options,r=e.optionsDispatch;return Object(le.jsx)(xn,{open:t,onClose:n,minHeight:150,tabs:["filter","sort","display"],tabTitle:function(e){return Ga[e]},tabContent:function(e){return"filter"===e?Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(dn,{label:"Unread",checked:a.unread,onChange:function(e){return r({type:"filter",filterType:"unread",filterValue:e})}}),Object(le.jsx)(dn,{label:"Downloaded",checked:a.downloaded,onChange:function(e){return r({type:"filter",filterType:"downloaded",filterValue:e})}}),Object(le.jsx)(dn,{label:"Bookmarked",checked:a.bookmarked,onChange:function(e){return r({type:"filter",filterType:"bookmarked",filterValue:e})}})]}):"sort"===e?Ha.map((function(e){var t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(le.jsx)(cn,{label:c,checked:a.sortBy===n,sortDescending:a.reverse,onClick:function(){return n!==a.sortBy?r({type:"sortBy",sortBy:n}):r({type:"sortReverse"})}},n)})):"display"===e?Object(le.jsxs)(Xt.a,{onChange:function(){return r({type:"showChapterNumber"})},value:a.showChapterNumber,children:[Object(le.jsx)($t,{label:"Source Title",value:!1}),Object(le.jsx)($t,{label:"Chapter Number",value:!0})]}):null}})},Ya=function(e){var t=e.options,n=e.optionsDispatch,r=a.useState(!1),c=Object(o.a)(r,2),i=c[0],s=c[1],l=function(e){var t=e.unread,n=e.downloaded,a=e.bookmarked;return null!=t||null!=n||null!=a}(t);return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(A.a,{onClick:function(){return s(!0)},children:Object(le.jsx)(Ja.a,{color:"primary",variant:"dot",invisible:!l,children:Object(le.jsx)(Wt.a,{})})}),Object(le.jsx)(Xa,{open:i,onClose:function(){return s(!1)},options:t,optionsDispatch:n})]})},qa=n(131),Ka=n.n(qa),Za={download:La.a,delete:yt.a,bookmark:xa.a,unbookmark:ma.a,mark_as_read:Ca.a,mark_as_unread:Ra.a},Qa=function(e){var t=e.action,n=e.matchingChapters,a=e.onClick,r=e.title,c=n.length,i=Za[t];return Object(le.jsxs)(Da.a,{onClick:function(){return a(t,n)},disabled:0===c,children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(i,{fontSize:"small"})}),Object(le.jsxs)(Xe.a,{children:[r,c>0?" (".concat(c,")"):""]})]})},$a=function(e){var t=e.selectedChapters,n=e.onAction,r=t.length,c=Object(a.useRef)(),i=Object(a.useState)(!1),s=Object(o.a)(i,2),l=s[0],u=s[1],d=function(){return u(!1)},j=function(e,t){n(e,t),d()};return Object(le.jsxs)(pe.a,{sx:{position:"fixed",bottom:"2em",right:"3em",pt:1},ref:c,children:[Object(le.jsxs)(Ot.a,{variant:"extended",color:"primary",id:"selectionMenuButton",onClick:function(){return u(!0)},children:["".concat(r," ").concat(Va(r,"chapter")),Object(le.jsx)(Ka.a,{sx:{ml:1}})]}),Object(le.jsxs)(Fa.a,{id:"selectionMenu",anchorEl:c.current,open:l,onClose:d,anchorOrigin:{horizontal:"right",vertical:"top"},transformOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{"aria-labelledby":"selectionMenuButton"},children:[Object(le.jsx)(Qa,{action:"download",matchingChapters:t.filter((function(e){var t=e.chapter,n=e.downloadChapter;return!t.downloaded&&void 0===n})),onClick:j,title:"Download selected"}),Object(le.jsx)(Qa,{action:"delete",matchingChapters:t.filter((function(e){return e.chapter.downloaded})),onClick:j,title:"Delete selected"}),Object(le.jsx)(Qa,{action:"bookmark",matchingChapters:t.filter((function(e){return!e.chapter.bookmarked})),onClick:j,title:"Bookmark selected"}),Object(le.jsx)(Qa,{action:"unbookmark",matchingChapters:t.filter((function(e){return e.chapter.bookmarked})),onClick:j,title:"Remove bookmarks from selected"}),Object(le.jsx)(Qa,{action:"mark_as_read",matchingChapters:t.filter((function(e){return!e.chapter.read})),onClick:j,title:"Mark selected as read"}),Object(le.jsx)(Qa,{action:"mark_as_unread",matchingChapters:t.filter((function(e){return e.chapter.read})),onClick:j,title:"Mark selected as unread"})]})]})},er=Object(ye.a)(_a.a)((function(e){var t=e.theme;return Object(Jt.a)({listStyle:"none",padding:0,minHeight:"200px"},t.breakpoints.up("md"),{width:"50vw",height:"calc(100vh - 64px - 48px)",margin:0})})),tr={download:{success:{one:"Download added",many:"%count% downloads added"},error:{one:"Error adding download",many:"Error adding downloads"}},delete:{success:{one:"Chapter deleted",many:"%count% chapters deleted"},error:{one:"Error deleting chapter",many:"Error deleting chapters"}},bookmark:{success:{one:"Chapter bookmarked",many:"%count% chapters bookmarked"},error:{one:"Error bookmarking chapter",many:"Error bookmarking chapters"}},unbookmark:{success:{one:"Chapter bookmark removed",many:"%count% chapter bookmarks removed"},error:{one:"Error removing bookmark",many:"Error removing bookmarks"}},mark_as_read:{success:{one:"Chapter marked as read",many:"%count% chapters marked as read"},error:{one:"Error marking chapter as read",many:"Error marking chapters as read"}},mark_as_unread:{success:{one:"Chapter marked as unread",many:"%count% chapters marked as unread"},error:{one:"Error marking chapter as unread",many:"Error marking chapters as unread"}}},nr=function(e){var t,n=e.mangaId,r=Object(a.useState)(null),c=Object(o.a)(r,2),i=c[0],s=c[1],l=Object(a.useRef)(),u=null===(t=ba("/api/v1/downloads").data)||void 0===t?void 0:t.queue,d=Wa(n),j=Object(o.a)(d,2),b=j[0],h=j[1],f=D("/api/v1/manga/".concat(n,"/chapters?onlineFetch=false")),p=f.data,x=f.mutate,O=f.loading,g=Object(a.useMemo)((function(){return null!==p&&void 0!==p?p:[]}),[p]);Object(a.useEffect)((function(){if(l.current&&u){var e=l.current;u.filter((function(t){var n=e.find((function(e){return t.chapterIndex===e.chapterIndex&&t.mangaId===e.mangaId}));return!n||t.state!==n.state})).length>0&&x()}l.current=u}),[u]);var v=Object(a.useMemo)((function(){return function(e,t){var n=t.active?e.filter((function(e){return function(e,t){var n=t.read;switch(e){case!0:return!n;case!1:return n;default:return!0}}(t.unread,e)&&function(e,t){var n=t.downloaded;switch(e){case!0:return n;case!1:return!n;default:return!0}}(t.downloaded,e)&&function(e,t){var n=t.bookmarked;switch(e){case!0:return n;case!1:return!n;default:return!0}}(t.bookmarked,e)})):Object(ht.a)(e),a="fetchedAt"===t.sortBy?n.sort((function(e,t){return e.fetchedAt-t.fetchedAt})):n;return t.reverse&&a.reverse(),a}(g,b)}),[g,b]),y=Object(a.useMemo)((function(){return v.slice().reverse().find((function(e){return!1===e.read}))}),[v]);if(O)return Object(le.jsx)("div",{style:{margin:"10px auto",display:"flex",justifyContent:"center"},children:Object(le.jsx)(dt.a,{thickness:5})});var C=0===g.length,k=!C&&0===v.length,w=v.map((function(e){var t,n=null===u||void 0===u?void 0:u.find((function(t){return t.chapterIndex===e.index&&t.mangaId===e.mangaId})),a=null!==(t=null===i||void 0===i?void 0:i.includes(e.id))&&void 0!==t?t:null;return{chapter:e,downloadChapter:n,selected:a}})),S=null===i?null:w.filter((function(e){var t=e.chapter;return i.includes(t.id)}));return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsxs)(jn.a,{direction:"column",sx:{position:"relative"},children:[Object(le.jsxs)(jn.a,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{m:1,mb:0,mr:2,minHeight:40},children:[Object(le.jsx)(z.a,{variant:"h5",children:"".concat(v.length," Chapter").concat(1===v.length?"":"s")}),null===i?Object(le.jsx)(Ya,{options:b,optionsDispatch:h}):Object(le.jsxs)(jn.a,{direction:"row",children:[Object(le.jsx)(Ke.a,{size:"small",onClick:function(){null!==i&&s(v.map((function(e){return e.id})))},children:"Select all"}),Object(le.jsx)(Ke.a,{size:"small",onClick:function(){null!==i&&s(null)},children:"Clear"})]})]}),C&&Object(le.jsx)(zt,{message:"No chapters found"}),k&&Object(le.jsx)(zt,{message:"No chapters matching filter"}),Object(le.jsx)(er,{style:{height:"undefined",overflowY:window.innerWidth<900?"visible":"auto"},totalCount:v.length,itemContent:function(e){return Object(le.jsx)(Pa,Object(m.a)(Object(m.a)({},w[e]),{},{showChapterNumber:b.showChapterNumber,triggerChaptersUpdate:function(){return x()},onSelect:function(){return function(e){var t=v[e];if(t)if(null===i)s([t.id]);else if(i.includes(t.id)){var n=i.filter((function(e){return e!==t.id}));s(n.length>0?n:null)}else s([].concat(Object(ht.a)(i),[t.id]))}(e)}}))},useWindowScroll:window.innerWidth<900,overscan:.5*window.innerHeight})]}),null!==S?Object(le.jsx)($a,{selectedChapters:S,onAction:function(e,t){if(0!==t.length){var n,a=t.map((function(e){return e.chapter.id}));if("download"===e)n=R.post("/api/v1/download/batch",{chapterIds:a});else{var r={};"delete"===e?r.delete=!0:"bookmark"===e?r.isBookmarked=!0:"unbookmark"===e?r.isBookmarked=!1:"mark_as_read"===e?r.isRead=!0:"mark_as_unread"===e&&(r.isRead=!1),n=R.post("/api/v1/chapter/batch",{chapterIds:a,change:r})}n.then((function(){return It(Ua(a.length,tr[e].success),"success")})).then((function(){return x()})).catch((function(){return It(Ua(a.length,tr[e].error),"error")}))}}}):y&&Object(le.jsx)(za,{chapter:y,mangaId:n})]})},ar=n(213),rr=n.n(ar),cr=n(214),ir=n.n(cr),or=n(382);function sr(e){return e||"UNKNOWN"}var lr=function(e){var t,n,a=e.manga,r=Re("serverBaseURL",""),c=Object(o.a)(r,1)[0],i=Re("useCache",!0),s=Object(o.a)(i,1)[0],l=(t=a.inLibrary,Object(or.a)((function(e){var n;return{root:Object(Jt.a)({width:"100%"},e.breakpoints.up("md"),{position:"sticky",top:"64px",left:"0px",width:"50vw",height:"calc(100vh - 64px)",alignSelf:"flex-start",overflowY:"auto"}),top:{padding:"10px"},leftRight:{display:"flex"},leftSide:{"& img":{borderRadius:4,maxWidth:"100%",minWidth:"100%",height:"auto"},maxWidth:"50%"},rightSide:Object(Jt.a)({marginLeft:15,maxWidth:"100%","& span":{fontWeight:"400"}},e.breakpoints.up("lg"),{fontSize:"1.3em"}),buttons:{display:"flex",justifyContent:"space-around","& button":{color:t?"#2196f3":"inherit"},"& a":{textDecoration:"none",color:"#858585","& button":{color:"inherit"}}},bottom:(n={paddingLeft:"10px",paddingRight:"10px"},Object(Jt.a)(n,e.breakpoints.up("md"),{fontSize:"1.2em"}),Object(Jt.a)(n,e.breakpoints.up("lg"),{fontSize:"1.3em"}),n),description:{"& h4":{marginTop:"1em",marginBottom:0},"& p":{textAlign:"justify",textJustify:"inter-word"}},genre:{display:"flex",flexWrap:"wrap","& h5":{border:"2px solid #2196f3",borderRadius:"1.13em",marginRight:"1em",marginTop:0,marginBottom:"10px",padding:"0.3em",color:"#2196f3"}}}})))();return Object(le.jsxs)("div",{className:l.root,children:[Object(le.jsxs)("div",{className:l.top,children:[Object(le.jsxs)("div",{className:l.leftRight,children:[Object(le.jsx)("div",{className:l.leftSide,children:Object(le.jsx)("img",{src:"".concat(c).concat(a.thumbnailUrl,"?useCache=").concat(s),alt:"Manga Thumbnail"})}),Object(le.jsxs)("div",{className:l.rightSide,children:[Object(le.jsx)("h1",{children:a.title}),Object(le.jsxs)("h3",{children:["Author: ",Object(le.jsx)("span",{children:sr(a.author)})]}),Object(le.jsxs)("h3",{children:["Artist: ",Object(le.jsx)("span",{children:sr(a.artist)})]}),Object(le.jsx)("h3",{children:"Status: ".concat(a.status)}),Object(le.jsx)("h3",{children:"Source: ".concat((n=a.source,null!==n.displayName?n.displayName:n.id))})]})]}),Object(le.jsxs)("div",{className:l.buttons,children:[Object(le.jsx)("div",{children:Object(le.jsxs)(A.a,{onClick:a.inLibrary?function(){Object(p.c)("/api/v1/manga/".concat(a.id,"/?onlineFetch=false"),Object(m.a)(Object(m.a)({},a),{},{inLibrary:!1}),{revalidate:!1}),R.delete("/api/v1/manga/".concat(a.id,"/library/")).then((function(){return Object(p.c)("/api/v1/manga/".concat(a.id,"/?onlineFetch=false"))}))}:function(){Object(p.c)("/api/v1/manga/".concat(a.id,"/?onlineFetch=false"),Object(m.a)(Object(m.a)({},a),{},{inLibrary:!0}),{revalidate:!1}),R.get("/api/v1/manga/".concat(a.id,"/library/")).then((function(){return Object(p.c)("/api/v1/manga/".concat(a.id,"/?onlineFetch=false"))}))},size:"large",children:[a.inLibrary?Object(le.jsx)(at.a,{sx:{mr:1}}):Object(le.jsx)(rr.a,{sx:{mr:1}}),Object(le.jsx)(z.a,{sx:{fontSize:{xs:"0.75em",sm:"0.85em"}},children:a.inLibrary?"In Library":"Add To Library"})]})}),Object(le.jsx)("a",{href:a.realUrl,target:"_blank",rel:"noreferrer",children:Object(le.jsxs)(A.a,{size:"large",children:[Object(le.jsx)(ir.a,{sx:{mr:1}}),Object(le.jsx)(z.a,{sx:{fontSize:{xs:"0.75em",sm:"0.85em"}},children:"Open Site"})]})})]})]}),Object(le.jsxs)("div",{className:l.bottom,children:[Object(le.jsxs)("div",{className:l.description,children:[Object(le.jsx)("h4",{children:"About"}),Object(le.jsx)("p",{children:a.description})]}),Object(le.jsx)("div",{className:l.genre,children:a.genre.map((function(e){return Object(le.jsx)("h5",{children:e},e)}))})]})]})},ur=n(155),dr=n.n(ur);function jr(e){var t,n=e.open,r=e.setOpen,c=e.mangaId,i=D("/api/v1/manga/".concat(c,"/category")),o=i.data,s=i.mutate,l=D("/api/v1/category").data,u=Object(a.useMemo)((function(){var e=Object(ht.a)(null!==l&&void 0!==l?l:[]);return e.length>0&&"Default"===e[0].name&&e.shift(),e}),[l]),d=null!==(t=null===o||void 0===o?void 0:o.map((function(e){return e.id})))&&void 0!==t?t:[];return Object(le.jsxs)(Ze.a,{sx:{".MuiDialog-paper":{maxHeight:435,width:"80%"}},maxWidth:"xs",open:n,children:[Object(le.jsx)(it.a,{children:"Set categories"}),Object(le.jsx)($e.a,{dividers:!0,children:Object(le.jsxs)(ia.a,{children:[0===u.length&&Object(le.jsxs)("span",{children:["No categories found!",Object(le.jsx)("br",{}),"You should make some from settings."]}),u.map((function(e){return Object(le.jsx)(kt.a,{control:Object(le.jsx)(Ct.a,{checked:d.includes(e.id),onChange:function(t){return n=t,a=e.id,void(n.target.checked?R.get:R.delete)("/api/v1/manga/".concat(c,"/category/").concat(a)).then((function(){return s()}));var n,a},color:"default"}),label:e.name},e.id)}))]})}),Object(le.jsxs)(Qe.a,{children:[Object(le.jsx)(Ke.a,{autoFocus:!0,onClick:function(){r(!1)},color:"primary",children:"Cancel"}),Object(le.jsx)(Ke.a,{onClick:function(){r(!1)},color:"primary",children:"Ok"})]})]})}var br=function(e){var t=e.manga,n=e.onRefresh,c=e.refreshing,i=Object(W.a)(),s=Object(M.a)(i.breakpoints.up("sm")),l=r.a.useState(null),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Boolean(d),h=function(){j(null)},f=Object(a.useState)(!1),p=Object(o.a)(f,2),x=p[0],O=p[1];return Object(le.jsxs)(le.Fragment,{children:[s&&Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(ve.a,{title:"Reload data from source",children:Object(le.jsx)(A.a,{onClick:function(){n()},disabled:c,children:Object(le.jsx)(Yn.a,{})})}),t.inLibrary&&Object(le.jsx)(ve.a,{title:"Edit manga categories",children:Object(le.jsx)(A.a,{onClick:function(){O(!0)},children:Object(le.jsx)(dr.a,{})})})]}),!s&&Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(A.a,{id:"chaptersMenuButton","aria-controls":b?"chaptersMenu":void 0,"aria-haspopup":"true","aria-expanded":b?"true":void 0,onClick:function(e){return j(e.currentTarget)},children:Object(le.jsx)(Ka.a,{})}),Object(le.jsxs)(Fa.a,{id:"chaptersMenu",anchorEl:d,open:b,onClose:h,MenuListProps:{"aria-labelledby":"chaptersMenuButton"},children:[Object(le.jsxs)(Da.a,{onClick:function(){n(),h()},disabled:c,children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(Yn.a,{fontSize:"small"})}),Object(le.jsx)(Xe.a,{children:"Reload data from source"})]}),t.inLibrary&&Object(le.jsxs)(Da.a,{onClick:function(){O(!0),h()},children:[Object(le.jsx)(ge.a,{children:Object(le.jsx)(dr.a,{fontSize:"small"})}),Object(le.jsx)(Xe.a,{children:"Edit manga categories"})]})]})]}),Object(le.jsx)(jr,{open:x,setOpen:O,mangaId:t.id})]})},hr=function(){var e,t,n=Object(a.useContext)(de).setTitle,r=Object(l.i)().id,c=Object(a.useRef)(!1),i=D("/api/v1/manga/".concat(r,"/?onlineFetch=false")),s=i.data,u=i.error,d=i.loading,j=i.isValidating,b=i.mutate,h=function(e){var t=Object(a.useState)(!1),n=Object(o.a)(t,2),r=n[0],c=n[1];return[Object(a.useCallback)(Object(g.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c(!0),t.next=3,Promise.all([I("/api/v1/manga/".concat(e,"/?onlineFetch=true")).then((function(t){return Object(p.c)("/api/v1/manga/".concat(e,"/?onlineFetch=false"),t,{revalidate:!1})})),I("/api/v1/manga/".concat(e,"/chapters?onlineFetch=true")).then((function(t){return Object(p.c)("/api/v1/manga/".concat(e,"/chapters?onlineFetch=false"),t,{revalidate:!1})}))]).finally((function(){return c(!1)}));case 3:case"end":return t.stop()}}),t)}))),[e]),{loading:r}]}(r),f=Object(o.a)(h,2),x=f[0],m=f[1].loading;return function(e){var t=je().setDefaultBackTo;Object(a.useEffect)((function(){return t(e),function(){return t(void 0)}}),[e])}(!1===(null===s||void 0===s?void 0:s.inLibrary)&&null!=s.sourceId?"/sources/".concat(s.sourceId,"/popular"):"/library"),Object(a.useEffect)((function(){null!=s&&s.inLibrary&&(s.age>86400||s.chaptersAge>86400)&&!1===c.current&&(c.current=!0,x())}),[s]),Object(a.useEffect)((function(){var e;n(null!==(e=null===s||void 0===s?void 0:s.title)&&void 0!==e?e:"Manga")}),[null===s||void 0===s?void 0:s.title]),u&&!s?Object(le.jsx)(zt,{message:"Could not load manga",messageExtra:null!==(t=u.message)&&void 0!==t?t:u}):Object(le.jsxs)(pe.a,{sx:{display:{md:"flex"},overflow:"hidden"},children:[Object(le.jsx)(Te,{children:Object(le.jsxs)(jn.a,{direction:"row",alignItems:"center",children:[u&&!j&&!m&&Object(le.jsx)(ve.a,{title:Object(le.jsxs)(le.Fragment,{children:["Could not fetch manga data",Object(le.jsx)("br",{}),null!==(e=u.message)&&void 0!==e?e:u]}),children:Object(le.jsx)(A.a,{onClick:function(){return b()},children:Object(le.jsx)(da.a,{color:"error"})})}),s&&(m||j)&&Object(le.jsx)(A.a,{disabled:!0,children:Object(le.jsx)(dt.a,{size:16})}),s&&Object(le.jsx)(br,{manga:s,onRefresh:x,refreshing:m})]})}),d&&Object(le.jsx)(jt,{}),s&&Object(le.jsx)(lr,{manga:s}),Object(le.jsx)(nr,{mangaId:r})]})};function fr(e){var t=e.mangas,n=e.isLoading,a=e.hasNextPage,r=e.lastPageNum,c=e.setLastPageNum,i=e.message,o=e.messageExtra,s=e.gridLayout,l=t,u=0===l.length&&t.length>0;return Object(le.jsx)(Pn,{mangas:l,isLoading:n,hasNextPage:a,lastPageNum:r,setLastPageNum:c,message:u?"There are no Manga matching this filter":i,messageExtra:o,gridLayout:s,inLibraryIndicator:!0})}var pr=function(e){var t=e.state,n=e.name,a=e.position,c=e.group,i=e.updateFilterValue,s=e.update,l=r.a.useState(t),u=Object(o.a)(l,2),d=u[0],j=u[1];return void 0!==t?Object(le.jsx)(Kt,{label:n,checked:d,onChange:function(e){j(e.target.checked);var t=s.filter((function(e){return!(a===e.position&&c===e.group)}));i([].concat(Object(ht.a)(t),[{position:a,state:e.target.checked.toString(),group:c}]))}}):null},xr=function(e){var t=e.name;return Object(le.jsx)(z.a,{sx:{mt:2},variant:"subtitle2",children:t},t)},Or=n(411),mr=n(410),gr=n(385);var vr=function(e){var t=e.values,n=e.name,a=e.state,c=e.selected,i=e.position,s=e.updateFilterValue,l=e.update,u=e.group;return void 0===c?function(e,t,n,a,c,i,s){var l=r.a.useState(n),u=Object(o.a)(l,2),d=u[0],j=u[1];if(e){var b=e.map((function(e){return Object(le.jsx)(Da.a,{value:e,children:e},"".concat(t," ").concat(e))}));return Object(le.jsxs)(mr.a,{sx:{my:1},variant:"standard",children:[Object(le.jsx)(Or.a,{children:t}),Object(le.jsx)(gr.a,{name:t,value:e[d],label:t,onChange:function(t){var n=e.indexOf("".concat(t.target.value));j(n);var r=i.filter((function(e){return!(a===e.position&&s===e.group)}));c([].concat(Object(ht.a)(r),[{position:a,state:n.toString(),group:s}]))},children:b})]})}return null}(t,n,a,i,s,l,u):function(e,t,n,a,c,i,s){var l=r.a.useState(n),u=Object(o.a)(l,2),d=u[0],j=u[1];if(e){var b=e.map((function(e){return Object(le.jsx)(Da.a,{value:e.displayname,children:e.displayname},"".concat(t," ").concat(e.displayname))}));return Object(le.jsxs)(mr.a,{sx:{my:1},variant:"standard",children:[Object(le.jsx)(Or.a,{children:t}),Object(le.jsx)(gr.a,{name:t,value:e[d].displayname,label:t,onChange:function(t){var n=e.map((function(e){return e.displayname})).indexOf("".concat(t.target.value));j(n);var r=i.filter((function(e){return!(a===e.position&&s===e.group)}));c([].concat(Object(ht.a)(r),[{position:a,state:n.toString(),group:s}]))},children:b})]})}return null}(t,n,a,i,s,l,u)},yr=n(375),Cr=n(376),kr=n(424),wr=function(e){var t=e.values,n=e.name,a=e.state,c=e.position,i=e.group,s=e.updateFilterValue,l=e.update,u=r.a.useState(a),d=Object(o.a)(u,2),j=d[0],b=d[1],h=r.a.useState(!1),f=Object(o.a)(h,2),p=f[0],x=f[1];if(t){return Object(le.jsxs)(pe.a,{sx:{mx:-2},children:[Object(le.jsxs)(ct.a,{onClick:function(){x(!p)},children:[Object(le.jsx)(Xe.a,{primary:n}),p?Object(le.jsx)(yr.a,{}):Object(le.jsx)(Cr.a,{})]}),Object(le.jsx)(kr.a,{in:p,children:Object(le.jsx)(jn.a,{sx:{mx:4},children:t.map((function(e,t){return Object(le.jsx)(cn,{label:e,checked:j.index===t,sortDescending:!j.ascending,onClick:function(){return function(e){var t=j;t.index===e?t.ascending=!t.ascending:t.ascending=!0,t.index=e,b(t);var n=l.filter((function(e){return!(c===e.position&&i===e.group)}));s([].concat(Object(ht.a)(n),[{position:c,state:JSON.stringify(t),group:i}]))}(t)}},"".concat(n," ").concat(e))}))})})]})}return null},Sr=n(425),Lr=function(e){var t,n=e.state,a=e.name,c=e.position,i=e.group,s=e.updateFilterValue,l=e.update,u=r.a.useState(n||""),d=Object(o.a)(u,2),j=d[0],b=d[1];return void 0!==n?Object(le.jsxs)(mr.a,{sx:{my:1},variant:"standard",children:[Object(le.jsx)(Or.a,{children:a}),Object(le.jsx)(Vn.a,{name:a,value:j||"",onChange:function(e){b(e.target.value),clearTimeout(t),t=setTimeout((function(){!function(e){var t=l.filter((function(e){return!(c===e.position&&i===e.group)}));s([].concat(Object(ht.a)(t),[{position:c,state:e.target.value,group:i}]))}(e)}),2500)},endAdornment:Object(le.jsx)(Sr.a,{position:"end",children:Object(le.jsx)(Hn.a,{})})})]}):Object(le.jsx)(le.Fragment,{})},Nr=function(e){var t=e.state,n=e.name,a=e.position,c=e.group,i=e.updateFilterValue,s=e.update,l=r.a.useState(Number(t)),u=Object(o.a)(l,2),d=u[0],j=u[1];return void 0!==t?Object(le.jsx)(dn,{label:n,checked:[void 0,!0,!1][d],onChange:function(e){return function(e){var t=void 0===e?0:e?1:2;j(t);var n=s.filter((function(e){return!(a===e.position&&c===e.group)}));i([].concat(Object(ht.a)(n),[{position:a,state:t.toString(),group:c}]))}(e)}}):Object(le.jsx)(le.Fragment,{})},Er=function(e){var t=e.state,n=e.name,a=e.position,c=e.updateFilterValue,i=e.update,s=r.a.useState(!1),l=Object(o.a)(s,2),u=l[0],d=l[1];return Object(le.jsxs)(pe.a,{sx:{mx:-2},children:[Object(le.jsxs)(ct.a,{onClick:function(){return d(!u)},children:[Object(le.jsx)(Xe.a,{primary:n}),u?Object(le.jsx)(yr.a,{}):Object(le.jsx)(Cr.a,{})]}),Object(le.jsx)(kr.a,{in:u,children:Object(le.jsx)(jn.a,{sx:{mx:4},children:Object(le.jsx)(Ir,{sourceFilter:t,group:a,updateFilterValue:c,update:i})})})]})},Tr=n(377),Rr=function(e){var t=e.name;return Object(le.jsx)(Tr.a,{sx:{my:1},textAlign:"center",children:t},t)};function Ir(e){var t=e.sourceFilter,n=e.group,a=e.updateFilterValue,r=e.update;return Object(le.jsx)(jn.a,{children:t.map((function(e,t){var c=r.find((function(e){return e.group===n&&e.position===t}));switch(c=c?c.state:c,e.type){case"CheckBox":return Object(le.jsx)(pr,{name:e.filter.name,state:"false"===c||e.filter.state,position:t,group:n,updateFilterValue:a,update:r},"filters ".concat(e.filter.name));case"Group":return Object(le.jsx)(Er,{name:e.filter.name,state:e.filter.state,position:t,updateFilterValue:a,update:r},"filters ".concat(e.filter.name));case"Header":return Object(le.jsx)(xr,{name:e.filter.name},"filters ".concat(e.filter.name));case"Select":return Object(le.jsx)(vr,{name:e.filter.name,values:e.filter.displayValues,state:parseInt(c,10)||e.filter.state,selected:e.filter.selected,position:t,group:n,updateFilterValue:a,update:r},"filters ".concat(e.filter.name));case"Separator":return Object(le.jsx)(Rr,{name:e.filter.name},"filters ".concat(e.filter.name));case"Sort":return Object(le.jsx)(wr,{name:e.filter.name,values:e.filter.values,state:c?JSON.parse(c):e.filter.state,position:t,group:n,updateFilterValue:a,update:r},"filters ".concat(e.filter.name));case"Text":return Object(le.jsx)(Lr,{name:e.filter.name,state:c||e.filter.state,position:t,group:n,updateFilterValue:a,update:r},"filters ".concat(e.filter.name));case"TriState":return Object(le.jsx)(Nr,{name:e.filter.name,state:parseInt(c,10)||e.filter.state,position:t,group:n,updateFilterValue:a,update:r},"filters ".concat(e.filter.name));default:return Object(le.jsx)(pe.a,{},"".concat(e.filter.name,"null"))}}))},"filters ".concat(n))}function Fr(e){var t=e.sourceFilter,n=e.updateFilterValue,a=e.resetFilterValue,c=e.setTriggerUpdate,i=e.setSearch,s=e.update,l=r.a.useState(!1),u=Object(o.a)(l,2),d=u[0],j=u[1];return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsxs)(Ot.a,{sx:{position:"fixed",bottom:"2em",right:"3em"},onClick:function(){return j(!d)},variant:"extended",color:"primary",children:[Object(le.jsx)(Wt.a,{}),"Filter"]}),Object(le.jsxs)(fn,{open:d,onClose:function(){return j(!1)},children:[Object(le.jsxs)(pe.a,{sx:{display:"flex",p:2,pb:0},children:[Object(le.jsx)(Ke.a,{onClick:function(){a(0),j(!1)},children:"Reset"}),Object(le.jsx)(Ke.a,{sx:{marginLeft:"auto"},variant:"contained",onClick:function(){c(0),i(!0),j(!1)},children:"Submit"})]}),Object(le.jsx)(pe.a,{sx:{pb:2,mx:2},children:Object(le.jsx)(Ir,{sourceFilter:t,updateFilterValue:n,group:void 0,update:s})})]})]})}function Dr(){var e=_t(),t=e.options,n=e.setOptions,a=r.a.useState(null),c=Object(o.a)(a,2),i=c[0],s=c[1],l=Boolean(i),u=function(){s(null)};function d(e,t){t&&n((function(t){return Object(m.a)(Object(m.a)({},t),{},{SourcegridLayout:parseInt(e.target.name,10)})}))}return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(A.a,{onClick:function(e){s(e.currentTarget)},size:"small",sx:{ml:2},"aria-controls":l?"account-menu":void 0,"aria-haspopup":"true","aria-expanded":l?"true":void 0,children:Object(le.jsx)(st.a,{})}),Object(le.jsxs)(Fa.a,{id:"basic-menu",anchorEl:i,open:l,onClose:u,MenuListProps:{"aria-labelledby":"basic-button"},children:[Object(le.jsx)(Da.a,{onClick:u,children:Object(le.jsx)(kt.a,{label:"Compact grid",control:Object(le.jsx)(Zt.a,{name:"0",checked:0===t.SourcegridLayout||void 0===t.SourcegridLayout,onChange:d})})}),Object(le.jsx)(Da.a,{onClick:u,children:Object(le.jsx)(kt.a,{label:"Comfortable grid",control:Object(le.jsx)(Zt.a,{name:"1",checked:1===t.SourcegridLayout,onChange:d})})}),Object(le.jsx)(Da.a,{onClick:u,children:Object(le.jsx)(kt.a,{label:"List",control:Object(le.jsx)(Zt.a,{name:"2",checked:2===t.SourcegridLayout,onChange:d})})})]})]})}function Pr(e){var t,n,c=Object(a.useContext)(de),i=c.setTitle,s=c.setAction,d=Object(l.g)(),j=Object(l.i)().sourceId,b=Object(a.useState)(!1),h=Object(o.a)(b,2),f=h[0],p=h[1],x=Object(a.useState)([]),O=Object(o.a)(x,2),m=O[0],g=O[1],v=Object(a.useState)(!1),y=Object(o.a)(v,2),C=y[0],k=y[1],w=Object(a.useState)(1),S=Object(o.a)(w,2),L=S[0],N=S[1],E=Object(a.useState)(!1),T=Object(o.a)(E,2),I=T[0],F=T[1],D=Object(a.useState)(),P=Object(o.a)(D,2),B=P[0],z=P[1],M=Object(u.d)("query",u.c),W=Object(o.a)(M,2),H=W[0],V=W[1],U=r.a.useState(2),_=Object(o.a)(U,2),J=_[0],G=_[1],X=Object(a.useState)([]),Y=Object(o.a)(X,2),q=Y[0],K=Y[1],Z=Object(a.useState)(2),Q=Object(o.a)(Z,2),$=Q[0],ee=Q[1],te=Object(a.useState)(),ne=Object(o.a)(te,2),ae=ne[0],re=ne[1],ce=Object(a.useState)(),oe=Object(o.a)(ce,2),se=oe[0],ue=oe[1],je=Object(u.d)("R"),be=Object(o.a)(je,2),he=be[0],fe=be[1],pe=_t().options;function xe(){R.get("/api/v1/source/".concat(j,"/filters")).then((function(e){return e.data})).then((function(e){re(e)}))}return Object(a.useEffect)((function(){i("Source")}),[]),Object(a.useEffect)((function(){R.get("/api/v1/source/".concat(j)).then((function(e){return e.data})).then((function(e){i(e.displayName),p(e.isConfigurable)}))}),[]),Object(a.useEffect)((function(){if(2!==$)if(0!==$)if(q.length>0){var e=q;K([]),R.post("/api/v1/source/".concat(j,"/filters"),e.map((function(e){var t=e.position,n=e.state,a=e.group;return void 0===a?{position:t,state:n}:{position:a,state:JSON.stringify({position:t,state:n})}}))).then((function(){ee(0),xe()}))}else F(!1),g([]),N(0),void 0===he&&B&&fe(null);else ee(1)}),[$]),Object(a.useEffect)((function(){if(0===J)V(void 0),fe(void 0),G(1);else if(void 0===he)return void R.get("/api/v1/source/".concat(j,"/filters?reset=true")).then((function(){xe(),z(!1),1===J&&ee(0)}));xe()}),[J]),Object(a.useEffect)((function(){return s(Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Dr,{}),Object(le.jsx)(Gn,{}),f&&Object(le.jsx)(A.a,{onClick:function(){return d.push("/sources/".concat(j,"/configure/"))},"aria-label":"display more actions",edge:"end",color:"inherit",size:"large",children:Object(le.jsx)(ie.a,{})})]})),function(){s(Object(le.jsx)(le.Fragment,{}))}}),[f]),Object(a.useEffect)((function(){z(!!H),void 0===he&&ue(null)}),[H]),Object(a.useEffect)((function(){if(void 0!==B&&void 0!==H&&null===se){var e=setTimeout((function(){ee(0)}),1e3);return function(){return clearTimeout(e)}}return void 0!==B&&ue(null),function(){}}),[B,H]),Object(a.useEffect)((function(){if(0!==L){var t=e.popular?"popular":"latest";R.get("/api/v1/source/".concat(j,"/").concat(void 0!==H||B||null===he?"search":t).concat(void 0!==H||B||null===he?"?searchTerm=".concat(H||"","&pageNum=").concat(L):"/".concat(L))).then((function(e){return e.data})).then((function(e){g([].concat(Object(ht.a)(m),Object(ht.a)(e.mangaList.map((function(e){return{title:e.title,thumbnailUrl:e.thumbnailUrl,id:e.id,inLibrary:e.inLibrary}}))))),k(e.hasNextPage),F(!0)}))}else N(1)}),[L]),I&&(t="No manga was found!","0"===j&&(n=Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)("span",{children:"Check out "}),Object(le.jsx)("a",{href:"https://github.com/Suwayomi/Tachidesk-Server/wiki/Local-Source",children:"Local source guide"})]}))),Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(fr,{mangas:m,hasNextPage:C,lastPageNum:L,setLastPageNum:N,message:t,messageExtra:n,isLoading:!I,gridLayout:pe.SourcegridLayout}),void 0!==ae&&Object(le.jsx)(Fr,{sourceFilter:ae,updateFilterValue:K,resetFilterValue:G,setTriggerUpdate:ee,setSearch:z,update:q})]})}var Br=r.a.forwardRef((function(e,t){var n=e.src,c=e.index,i=e.onImageLoad,s=e.settings,l=Re("useCache",!0),u=Object(o.a)(l,1)[0],d=Object(a.useRef)(null),j=function(e){var t=r.a.useState({height:window.innerHeight,width:window.innerWidth}),n=Object(o.a)(t,2),a=n[0],c=n[1];return r.a.useEffect((function(){function e(){c({height:window.innerHeight,width:window.innerWidth})}return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),"DoubleLTR"===e.readerType||"DoubleRTL"===e.readerType||"ContinuesHorizontalLTR"===e.readerType||"ContinuesHorizontalRTL"===e.readerType?{display:"block",marginLeft:"7px",marginRight:"7px",width:"auto",minHeight:"99vh",height:"auto",maxHeight:"99vh",objectFit:"contain",pointerEvents:"none"}:{display:"block",marginBottom:"ContinuesVertical"===e.readerType?"15px":0,minWidth:"50vw",width:a.width<a.height?"100vw":"100%",maxWidth:"100%"}}(s);return Object(le.jsx)(pe.a,{ref:t,sx:{margin:"auto"},children:Object(le.jsx)(Ln,{src:"".concat(n,"?useCache=").concat(u),onImageLoad:i,alt:"Page #".concat(c),imgRef:d,spinnerStyle:Object(m.a)(Object(m.a)({},j),{},{height:"100vh",width:"70vw",padding:"50px calc(50% - 20px)",backgroundColor:"#525252",marginBottom:10}),imgStyle:j})})}));function zr(e){var t=e.pages,n=e.curPage,r=e.initialPage,c=e.settings,i=e.setCurPage,o=e.prevChapter,s=e.nextChapter,l=Object(a.useRef)(r),u=Object(a.useRef)(null),d=Object(a.useRef)([]);function j(){var e;n<t.length-1?(null===(e=d.current[n+1])||void 0===e||e.scrollIntoView({inline:"center"}),i((function(e){return e+1}))):c.loadNextonEnding&&s()}function b(){var e;n>0?(null===(e=d.current[n-1])||void 0===e||e.scrollIntoView({inline:"center"}),i(n-1)):0===n&&o()}var h=Object(a.useRef)(0);function f(e){window.scrollBy(h.current-e.pageX,0)}function p(e){var t;h.current=e.pageX,null===(t=u.current)||void 0===t||t.addEventListener("mousemove",f)}function x(){var e;null===(e=u.current)||void 0===e||e.removeEventListener("mousemove",f)}function O(e){e.clientX>=.85*window.innerWidth?"ContinuesHorizontalLTR"===c.readerType?j():b():e.clientX<=.15*window.innerWidth&&("ContinuesHorizontalLTR"===c.readerType?b():j())}var m=function(){"ContinuesHorizontalLTR"===c.readerType?window.scrollX+window.innerWidth>=document.body.scrollWidth&&s():"ContinuesHorizontalRTL"===c.readerType&&window.scrollX<=window.innerWidth&&s()};return Object(a.useEffect)((function(){setTimeout((function(){var e;null===(e=d.current[r])||void 0===e||e.scrollIntoView({inline:"center"})}),0)}),[r]),Object(a.useEffect)((function(){var e,t;return null===(e=u.current)||void 0===e||e.addEventListener("mousedown",p),null===(t=u.current)||void 0===t||t.addEventListener("mouseup",x),function(){var e,t;null===(e=u.current)||void 0===e||e.removeEventListener("mousedown",p),null===(t=u.current)||void 0===t||t.removeEventListener("mouseup",x)}}),[u]),Object(a.useEffect)((function(){var e;return c.loadNextonEnding&&document.addEventListener("scroll",m),null===(e=u.current)||void 0===e||e.addEventListener("mousedown",O),function(){var e;document.removeEventListener("scroll",m),null===(e=u.current)||void 0===e||e.removeEventListener("mousedown",O)}}),[u,n]),Object(a.useEffect)((function(){var e=function(){if(u.current){var e=function(e){for(var t=0;t<e.children.length;t++){var n=e.children.item(t);if(n){var a=n.getBoundingClientRect(),r=a.left,c=a.right;if(r<=window.innerWidth/2&&c>window.innerWidth/2)return t}}return-1}(u.current);e!==l.current&&(l.current=e,i(e)),("ContinuesHorizontalLTR"===c.readerType?window.innerWidth+window.scrollX>=document.body.scrollWidth:window.scrollX<=0)&&(l.current=t.length-1,i(l.current))}};return window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}}),[c.readerType]),Object(le.jsx)(pe.a,{ref:u,sx:{display:"flex",flexDirection:"ContinuesHorizontalLTR"===c.readerType?"row":"row-reverse",justifyContent:"ContinuesHorizontalLTR"===c.readerType?"flex-start":"flex-end",margin:"0 auto",width:"auto",height:"auto",overflowX:"visible",userSelect:"none"},children:t.map((function(e){return Object(le.jsx)(Br,{index:e.index,src:e.src,onImageLoad:function(){},settings:c,ref:function(t){d.current[e.index]=t}},e.index)}))})}function Ar(e){var t=e.settings,n=e.curPage,a=e.pageCount;return Object(le.jsx)(pe.a,{sx:{display:t.showPageNumber?"block":"none",position:"fixed",bottom:"50px",right:t.staticNav?"calc((100vw - 325px)/2)":"calc((100vw - 25px)/2)",padding:"2px",paddingLeft:"4px",paddingRight:"4px",textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.3)",borderRadius:"10px"},children:"".concat(n+1," / ").concat(a)})}function Mr(e){var t=e.pages,n=e.settings,r=e.setCurPage,c=e.curPage,i=e.nextChapter,o=e.prevChapter,s=Object(a.useRef)(null),l=function(e){r(e),window.scroll({top:0})};function u(){c<t.length-1?l(c+1):n.loadNextonEnding&&i()}function d(){c>0?l(c-1):o()}function j(){"SingleLTR"===n.readerType?d():"SingleRTL"===n.readerType&&u()}function b(){"SingleLTR"===n.readerType?u():"SingleRTL"===n.readerType&&d()}function h(e){switch(e.code){case"Space":e.preventDefault(),u();break;case"ArrowRight":b();break;case"ArrowLeft":j()}}function f(e){e.clientX>window.innerWidth/2?b():j()}return Object(a.useEffect)((function(){var e;return document.addEventListener("keydown",h),null===(e=s.current)||void 0===e||e.addEventListener("click",f),function(){var e;document.removeEventListener("keydown",h),null===(e=s.current)||void 0===e||e.removeEventListener("click",f)}}),[s,c,n.readerType]),Object(le.jsx)(pe.a,{ref:s,sx:{display:"flex",flexDirection:"row",justifyContent:"center",margin:"0 auto",width:"100%",height:"100vh"},children:Object(le.jsx)(Br,{index:c,onImageLoad:function(){},src:t[c].src,settings:n},c)})}var Wr=Object(ye.a)("img")({marginBottom:0,width:"auto",minHeight:"99vh",height:"auto",maxHeight:"99vh",objectFit:"contain"}),Hr=r.a.forwardRef((function(e,t){var n=e.image1src,a=e.image2src,r=e.index,c=e.settings;return Object(le.jsxs)(pe.a,{ref:t,sx:{display:"flex",flexDirection:"DoubleLTR"===c.readerType?"row":"row-reverse",justifyContent:"center",margin:"0 auto",width:"auto",height:"auto",overflowX:"scroll"},children:[Object(le.jsx)(Wr,{src:n,alt:"Page #".concat(r)}),Object(le.jsx)(Wr,{src:a,alt:"Page #".concat(r+1)})]})}));function Vr(e){var t=e.pages,n=e.settings,r=e.setCurPage,c=e.curPage,o=e.nextChapter,s=e.prevChapter,l=Object(a.useRef)(null),u=Object(a.useRef)([]),d=Object(a.useRef)(0),j=Object(a.useRef)(Array(t.length).fill(!1));function b(){if(c<t.length-1){var e=c+d.current;r(e>=t.length?t.length-1:e)}else n.loadNextonEnding&&o()}function h(){if(c>0){var e=c-function(){for(var e=1;e<=2;e++)if(c-e>0&&u.current[c-e]&&j.current[c-e]){var t=u.current[c-e];if(t.height/t.width<1)return 1}return 2}();r(e<0?0:e)}else s()}function f(){"DoubleLTR"===n.readerType?h():b()}function p(){"DoubleLTR"===n.readerType?b():h()}function x(e){switch(e.code){case"Space":e.preventDefault(),b();break;case"ArrowRight":p();break;case"ArrowLeft":f()}}function O(e){e.clientX>window.innerWidth/2?p():f()}return Object(a.useEffect)((function(){var e,a=setInterval((function(){(!(c===t.length-1)&&j.current[c]&&j.current[c+1]||j.current[c])&&(!function(){if(d.current=0,c<t.length&&u.current[c]&&j.current[c]){d.current=1;var e=u.current[c];if(e.height/e.width<1)return}if(c+1<t.length&&u.current[c+1]&&j.current[c+1]){var n=u.current[c+1];if(n.height/n.width<1)return;d.current=2}}(),2===d.current?i.a.render(Object(le.jsx)(Hr,{index:c,image1src:t[c].src,image2src:t[c+1].src,settings:n},c),document.getElementById("display")):i.a.render(Object(le.jsx)(Br,{index:c,src:1===d.current?t[c].src:"",onImageLoad:function(){},settings:n},c),document.getElementById("display")),clearInterval(a))}),50);return document.addEventListener("keydown",x),null===(e=l.current)||void 0===e||e.addEventListener("click",O),function(){var e;clearInterval(a),document.removeEventListener("keydown",x),null===(e=l.current)||void 0===e||e.removeEventListener("click",O)}}),[l,c,n.readerType]),Object(le.jsxs)(pe.a,{ref:l,children:[Object(le.jsx)(pe.a,{id:"preload",sx:{display:"none"},children:t.map((function(e){return Object(le.jsx)("img",{ref:function(t){u.current[e.index]=t},src:e.src,onLoad:(t=e.index,function(){j.current[t]=!0}),alt:"".concat(e.index)},"".concat(e.index));var t}))}),Object(le.jsx)(pe.a,{id:"display",sx:{display:"flex",flexDirection:"DoubleLTR"===n.readerType?"row":"row-reverse",justifyContent:"center",margin:"0 auto",width:"auto",height:"auto",overflowX:"scroll"}})]})}var Ur=function(){return window.innerHeight+window.scrollY>=document.body.offsetHeight};function _r(e){var t=e.pages,n=e.settings,r=e.setCurPage,c=e.initialPage,i=e.nextChapter,o=e.prevChapter,s=Object(a.useRef)(c),l=Object(a.useRef)(null),u=Object(a.useRef)([]);Object(a.useEffect)((function(){var e=function(){if(l.current)if(Ur())s.current=t.length-1,r(s.current),n.loadNextonEnding&&i();else{var e=function(e){for(var t=0;t<e.children.length;t++){var n=e.children.item(t);if(n){var a=n.getBoundingClientRect(),r=a.top,c=a.bottom;if(r<=window.innerHeight&&c>1)return t}}return-1}(l.current);e!==s.current&&(s.current=e,r(e))}};return window.addEventListener("scroll",e),function(){window.removeEventListener("scroll",e)}}),[n.loadNextonEnding]);var d=Object(a.useCallback)((function(e){"down"===e&&Ur()?i():"up"===e&&window.scrollY<=0?o():window.scroll({top:window.scrollY+.95*window.innerHeight*("up"===e?-1:1),behavior:"smooth"})}),[i,o]);return Object(a.useEffect)((function(){var e=function(e){switch(e.code){case"Space":case"ArrowRight":e.preventDefault(),d("down");break;case"ArrowLeft":e.preventDefault(),d("up")}};return document.addEventListener("keydown",e,!1),function(){document.removeEventListener("keydown",e)}}),[]),Object(a.useEffect)((function(){setTimeout((function(){var e;null===(e=u.current[c])||void 0===e||e.scrollIntoView()}),0)}),[c]),Object(le.jsx)(pe.a,{ref:l,sx:{display:"flex",flexDirection:"column",justifyContent:"center",margin:"0 auto",width:"100%"},onClick:function(e){return d(e.clientX>window.innerWidth/2?"down":"up")},children:t.map((function(e){return Object(le.jsx)(Br,{index:e.index,src:e.src,onImageLoad:function(){},settings:n,ref:function(t){u.current[e.index]=t}},e.index)}))})}var Jr=n(215),Gr=n.n(Jr),Xr=n(156),Yr=n.n(Xr),qr=n(157),Kr=n.n(qr),Zr=n(217),Qr=n.n(Zr),$r=n(216),ec=n.n($r),tc=n(365),nc=n(378),ac=Object(ye.a)("div")((function(e){var t=e.theme;return{top:0,left:0,width:"300px",minWidth:"300px",height:"100vh",overflowY:"auto",backgroundColor:t.palette.background.default,"& header":{backgroundColor:"dark"===t.palette.mode?t.palette.grey[800]:t.palette.grey[100],display:"flex",alignItems:"center",minHeight:"64px",paddingLeft:"24px",paddingRight:"24px",transition:"left 2s ease","& button":{flexGrow:0,flexShrink:0},"& button:nth-child(1)":{marginRight:"16px"},"& h1":{fontSize:"1.25rem",flexGrow:1}},"& hr":{margin:"0 16px",height:"1px",border:"0",backgroundColor:"dark"===t.palette.mode?t.palette.grey[800]:t.palette.grey[100]}}})),rc=Object(ye.a)("div")({margin:"0 16px","& > span:nth-child(1)":{textAlign:"center",display:"block",marginTop:"16px"}}),cc=Object(ye.a)("div")({display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateAreas:'"prev next"',gridColumnGap:"5px",margin:"10px 0","& a":{flexGrow:1,textDecoration:"none","& button":{width:"100%",padding:"5px 8px",textTransform:"none"}}}),ic=Object(ye.a)(A.a)((function(e){var t=e.theme;return{position:"fixed",top:20,left:30,height:"40px",width:"40px",borderRadius:5,backgroundColor:"dark"===t.palette.mode?"black":"white","&:hover":{backgroundColor:"dark"===t.palette.mode?t.palette.grey[900]:t.palette.grey[100]}}})),oc=function(){return{staticNav:!1,showPageNumber:!0,continuesPageGap:!1,loadNextonEnding:!1,readerType:"ContinuesVertical"}};function sc(e){var t=Object(l.g)(),n=Oe(),r=e.settings,c=e.setSettings,i=e.manga,u=e.chapter,d=e.curPage,j=Object(a.useState)(r.staticNav),b=Object(o.a)(j,2),h=b[0],f=b[1],p=Object(a.useState)(!1),x=Object(o.a)(p,2),O=x[0],g=x[1],v=Object(a.useState)(0),y=Object(o.a)(v,2),C=y[0],k=y[1],w=Object(a.useState)(!0),S=Object(o.a)(w,2),L=S[0],N=S[1],E=function(e,t){return c(Object(m.a)(Object(m.a)({},r),{},Object(Jt.a)({},e,t)))},T=function(){var e=window.pageYOffset;Math.abs(e-C)>20&&(g(e>C),k(e))};Object(a.useEffect)((function(){window.addEventListener("scroll",T);var e=document.querySelector("#root"),t=document.querySelector("#appMainContainer");return e.style.display="flex",t.style.display="none",function(){e.style.display="block",t.style.display="block",window.removeEventListener("scroll",T)}}),[T]);return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Lt.a,{direction:"right",in:h,timeout:200,appear:!1,mountOnEnter:!0,unmountOnExit:!0,children:Object(le.jsxs)(ac,{sx:{position:r.staticNav?"sticky":"fixed"},children:[Object(le.jsxs)("header",{children:[!r.staticNav&&Object(le.jsx)(A.a,{edge:"start",color:"inherit","aria-label":"menu",disableRipple:!0,onClick:function(){return f(!1)},size:"large",children:Object(le.jsx)(Yr.a,{})}),Object(le.jsx)(z.a,{variant:"h1",textOverflow:"ellipsis",overflow:"hidden",sx:{py:1},children:u.name}),Object(le.jsx)(A.a,{edge:"start",color:"inherit","aria-label":"menu",disableRipple:!0,onClick:function(){n.back?t.goBack():n.url?t.push(n.url):t.push("/manga/".concat(i.id))},size:"large",sx:{mr:-1},children:Object(le.jsx)(Gr.a,{})})]}),Object(le.jsxs)(me.a,{ContainerComponent:"div",sx:{"& span":{fontWeight:"bold"}},children:[Object(le.jsx)(Xe.a,{primary:"Reader Settings"}),Object(le.jsx)(Ye.a,{children:Object(le.jsxs)(A.a,{edge:"start",color:"inherit","aria-label":"menu",disableRipple:!0,disableFocusRipple:!0,onClick:function(){return N(!L)},size:"large",children:[L&&Object(le.jsx)(ec.a,{}),!L&&Object(le.jsx)(Qr.a,{})]})})]}),Object(le.jsx)(kr.a,{in:L,timeout:"auto",unmountOnExit:!0,children:Object(le.jsxs)(Ie.a,{children:[Object(le.jsxs)(me.a,{children:[Object(le.jsx)(Xe.a,{primary:"Static Navigation"}),Object(le.jsx)(Ye.a,{children:Object(le.jsx)(qe.a,{edge:"end",checked:r.staticNav,onChange:function(e){return E("staticNav",e.target.checked)}})})]}),Object(le.jsxs)(me.a,{children:[Object(le.jsx)(Xe.a,{primary:"Show page number"}),Object(le.jsx)(Ye.a,{children:Object(le.jsx)(qe.a,{edge:"end",checked:r.showPageNumber,onChange:function(e){return E("showPageNumber",e.target.checked)}})})]}),Object(le.jsxs)(me.a,{children:[Object(le.jsx)(Xe.a,{primary:"Load next chapter at ending"}),Object(le.jsx)(Ye.a,{children:Object(le.jsx)(qe.a,{edge:"end",checked:r.loadNextonEnding,onChange:function(e){return E("loadNextonEnding",e.target.checked)}})})]}),Object(le.jsxs)(me.a,{children:[Object(le.jsx)(Xe.a,{primary:"Reader Type"}),Object(le.jsxs)(gr.a,{variant:"standard",value:r.readerType,onChange:function(e){return E("readerType",e.target.value)},sx:{p:0},children:[Object(le.jsx)(Da.a,{value:"SingleLTR",children:"Single Page (LTR)"}),Object(le.jsx)(Da.a,{value:"SingleRTL",children:"Single Page (RTL)"}),Object(le.jsx)(Da.a,{value:"DoubleLTR",children:"Double Page (LTR)"}),Object(le.jsx)(Da.a,{value:"DoubleRTL",children:"Double Page (RTL)"}),Object(le.jsx)(Da.a,{value:"Webtoon",children:"Webtoon"}),Object(le.jsx)(Da.a,{value:"ContinuesVertical",children:"Continues Vertical"}),Object(le.jsx)(Da.a,{value:"ContinuesHorizontalLTR",children:"Horizontal (LTR)"}),Object(le.jsx)(Da.a,{value:"ContinuesHorizontalRTL",children:"Horizontal (RTL)"})]})]})]})}),Object(le.jsx)("hr",{}),Object(le.jsxs)(rc,{children:[Object(le.jsx)("span",{children:"Currently on page ".concat(d+1," of ").concat(u.pageCount)}),Object(le.jsxs)(cc,{children:[u.index>1&&Object(le.jsx)(s.b,{replace:!0,to:{pathname:"/manga/".concat(i.id,"/chapter/").concat(u.index-1),state:t.location.state},children:Object(le.jsx)(Ke.a,{variant:"outlined",sx:{gridArea:"prev"},startIcon:Object(le.jsx)(Yr.a,{}),children:"Prev. Chapter"})}),u.index<u.chapterCount&&Object(le.jsx)(s.b,{replace:!0,style:{gridArea:"next"},to:{pathname:"/manga/".concat(i.id,"/chapter/").concat(u.index+1),state:t.location.state},children:Object(le.jsx)(Ke.a,{variant:"outlined",endIcon:Object(le.jsx)(Kr.a,{}),children:"Next Chapter"})})]})]})]})}),Object(le.jsx)(nc.a,{in:!h,children:Object(le.jsx)(tc.a,{in:!O,children:Object(le.jsx)(ic,{edge:"start",color:"inherit","aria-label":"menu",disableRipple:!0,disableFocusRipple:!0,onClick:function(){return f(!0)},size:"large",children:Object(le.jsx)(Kr.a,{})})})})]})}var lc=function(){return{pageCount:-1,index:-1,chapterCount:0,lastPageRead:0,name:"Loading..."}};function uc(){var e=Re("readerSettings",oc),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(l.g)(),i=Re("serverBaseURL",""),s=Object(o.a)(i,1)[0],u=Object(l.i)(),d=u.chapterIndex,j=u.mangaId,b=Object(a.useState)({id:+j,title:"",thumbnailUrl:""}),h=Object(o.a)(b,2),f=h[0],p=h[1],x=Object(a.useState)({pageCount:-1,index:-1,chapterCount:0,lastPageRead:0,name:"Loading..."}),O=Object(o.a)(x,2),m=O[0],g=O[1],v=Object(a.useState)(0),y=Object(o.a)(v,2),C=y[0],k=y[1],w=Object(a.useContext)(de),S=w.setOverride,L=w.setTitle;Object(a.useEffect)((function(){var e=oa(n),t={staticNav:!1,showPageNumber:!0,continuesPageGap:!1,loadNextonEnding:!1,readerType:"ContinuesVertical"},a=!1;return Object.keys(t).forEach((function(r){var c=r;void 0===n[c]&&(e[c]=t[c],a=!0)})),a&&r(e),S({status:!0,value:Object(le.jsx)(sc,{settings:n,setSettings:r,manga:f,chapter:m,curPage:C})}),function(){return S({status:!1,value:Object(le.jsx)("div",{})})}}),[f,m,n,C,d]),Object(a.useEffect)((function(){L("Reader"),R.get("/api/v1/manga/".concat(j,"/")).then((function(e){return e.data})).then((function(e){p(e),L(e.title)}))}),[d]),Object(a.useEffect)((function(){g(lc),R.get("/api/v1/manga/".concat(j,"/chapter/").concat(d)).then((function(e){return e.data})).then((function(e){g(e),e.lastPageRead===e.pageCount-1?k(0):k(e.lastPageRead)}))}),[d]),Object(a.useEffect)((function(){if(-1!==C){var e=new FormData;e.append("lastPageRead",C.toString()),R.patch("/api/v1/manga/".concat(f.id,"/chapter/").concat(m.index),e)}if(C===m.pageCount-1){var t=new FormData;t.append("read","true"),R.patch("/api/v1/manga/".concat(f.id,"/chapter/").concat(m.index),t)}}),[C]);var N=Object(a.useCallback)((function(){if(m.index<m.chapterCount){var e=new FormData;e.append("lastPageRead","".concat(m.pageCount-1)),e.append("read","true"),R.patch("/api/v1/manga/".concat(f.id,"/chapter/").concat(m.index),e),c.replace({pathname:"/manga/".concat(f.id,"/chapter/").concat(m.index+1),state:c.location.state})}}),[m.index,m.chapterCount,m.pageCount,f.id]),E=Object(a.useCallback)((function(){m.index>1&&c.replace({pathname:"/manga/".concat(f.id,"/chapter/").concat(m.index-1),state:c.location.state})}),[m.index,f.id]);if(-1===m.pageCount)return Object(le.jsx)(pe.a,{sx:{height:"100vh",width:"100vw",display:"grid",placeItems:"center"},children:Object(le.jsx)(dt.a,{thickness:5})});var T,I=(T=m.pageCount,Array.from({length:T},(function(e,t){return t}))).map((function(e){return{index:e,src:"".concat(s,"/api/v1/manga/").concat(j,"/chapter/").concat(d,"/page/").concat(e)}})),F=function(e){switch(e){case"ContinuesVertical":case"Webtoon":return _r;case"SingleVertical":case"SingleRTL":case"SingleLTR":return Mr;case"DoubleVertical":case"DoubleRTL":case"DoubleLTR":return Vr;case"ContinuesHorizontalLTR":case"ContinuesHorizontalRTL":return zr;default:return _r}}(n.readerType),D=m.lastPageRead===m.pageCount-1?0:m.lastPageRead;return Object(le.jsxs)(pe.a,{sx:{width:n.staticNav?"calc(100vw - 300px)":"100vw"},children:[Object(le.jsx)(Ar,{settings:n,curPage:C,pageCount:m.pageCount}),Object(le.jsx)(F,{pages:I,pageCount:m.pageCount,setCurPage:k,initialPage:D,curPage:C,settings:n,manga:f,chapter:m,nextChapter:N,prevChapter:E})]})}function dc(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function jc(e){if(0===e.length)return[];var t={};return e.forEach((function(e,n){var a=function(e){var t=new Date;if(dc(t,e))return"TODAY";var n=new Date;return n.setDate(t.getDate()-1),dc(n,e)?"YESTERDAY":e.toLocaleDateString()}(function(e){var t=new Date(0);return t.setUTCSeconds(e),t}(e.chapter.fetchedAt));void 0===t[a]&&(t[a]=[]),t[a].push({item:e,globalIdx:n})})),Object.keys(t).map((function(e){return[e,t[e]]}))}var bc=JSON.parse(window.localStorage.getItem("serverBaseURL")).replace("http","ws"),hc={status:"Stopped",queue:[]};function fc(){var e=Object(l.g)(),t=Object(a.useContext)(de),n=t.setTitle,r=t.setAction,c=Object(a.useState)([]),i=Object(o.a)(c,2),s=i[0],u=i[1],d=Object(a.useState)(!0),j=Object(o.a)(d,2),b=j[0],h=j[1],f=Object(a.useState)(!1),p=Object(o.a)(f,2),x=p[0],O=p[1],m=Object(a.useState)(0),g=Object(o.a)(m,2),v=g[0],y=g[1],C=Re("serverBaseURL",""),k=Object(o.a)(C,1)[0],w=Re("useCache",!0),S=Object(o.a)(w,1)[0],L=Object(a.useState)(),N=Object(o.a)(L,2)[1],E=Object(a.useState)(hc),T=Object(o.a)(E,2),I=T[0].queue,F=T[1];Object(a.useEffect)((function(){var e=new WebSocket("".concat(bc,"/api/v1/downloads"));return e.onmessage=function(e){var t=JSON.parse(e.data);F(t)},N(e),function(){return e.close()}}),[]),Object(a.useEffect)((function(){n("Updates"),r(Object(le.jsx)(le.Fragment,{}))}),[]),Object(a.useEffect)((function(){b&&R.get("/api/v1/update/recentChapters/".concat(v)).then((function(e){return e.data})).then((function(e){var t=e.hasNextPage,n=e.page;u([].concat(Object(ht.a)(s),Object(ht.a)(n))),h(t),O(!0)}))}),[v]);var D=Object(a.useRef)(null),P=function(){if(D.current){var e=D.current.getBoundingClientRect();(e.y+e.height)/window.innerHeight<2&&b&&y(v+1)}};if(Object(a.useEffect)((function(){return window.addEventListener("scroll",P,!0),function(){window.removeEventListener("scroll",P,!0)}}),[b,s]),!x)return Object(le.jsx)(jt,{});if(x&&0===s.length)return Object(le.jsx)(zt,{message:"You don't have any updates yet."});var B=function(e){var t="";return e.downloaded&&(t=" \u2022 Downloaded"),I.forEach((function(n){e.index===n.chapterIndex&&e.mangaId===n.mangaId&&(t=" \u2022 Downloading (".concat((100*n.progress).toFixed(2),"%)"))})),t};return Object(le.jsx)(le.Fragment,{children:jc(s).map((function(t){return Object(le.jsxs)("div",{children:[Object(le.jsx)(z.a,{variant:"h5",sx:{ml:3,my:2,fontWeight:700},children:t[0]}),t[1].map((function(t){var n=t.item,a=n.chapter,r=n.manga,c=t.globalIdx;return Object(le.jsx)(Cn.a,{ref:c===s.length-1?D:void 0,sx:{margin:"10px","&:hover":{backgroundColor:"action.hover",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"},"&:active":{backgroundColor:"action.selected",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"}},onClick:function(){return e.push({pathname:"/manga/".concat(a.mangaId,"/chapter/").concat(a.index),state:e.location.state})},children:Object(le.jsxs)(wn.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:2},children:[Object(le.jsxs)(pe.a,{sx:{display:"flex"},children:[Object(le.jsx)(Sn.a,{variant:"rounded",sx:{width:56,height:56,flex:"0 0 auto",marginRight:2,imageRendering:"pixelated"},src:"".concat(k).concat(r.thumbnailUrl,"?useCache=").concat(S)}),Object(le.jsxs)(pe.a,{sx:{display:"flex",flexDirection:"column"},children:[Object(le.jsx)(z.a,{variant:"h5",component:"h2",children:r.title}),Object(le.jsxs)(z.a,{variant:"caption",display:"block",gutterBottom:!0,children:[a.name,B(a)]})]})]}),""===B(a)&&Object(le.jsx)(A.a,{onClick:function(e){!function(e){R.get("/api/v1/download/".concat(e.mangaId,"/chapter/").concat(e.index))}(a),e.stopPropagation()},size:"large",children:Object(le.jsx)(La.a,{})})]})},c)}))]},t[0])}))})}var pc=n(218),xc=n.n(pc),Oc=n(219),mc=n.n(Oc),gc={status:"Stopped",queue:[]};function vc(){var e=ba("/api/v1/downloads").data,t=null!==e&&void 0!==e?e:gc,n=t.queue,r=t.status,c=Object(l.g)(),i=Object(W.a)(),o=Object(a.useContext)(de),s=o.setTitle,u=o.setAction,d=function(){"Stopped"===r?R.get("/api/v1/downloads/start"):R.get("/api/v1/downloads/stop")};Object(a.useEffect)((function(){s("Download Queue"),u((function(){return"Stopped"===r?Object(le.jsx)(A.a,{onClick:d,size:"large",children:Object(le.jsx)(xc.a,{})}):Object(le.jsx)(A.a,{onClick:d,size:"large",children:Object(le.jsx)(mc.a,{})})}))}),[r]);if(0===n.length)return Object(le.jsx)(zt,{message:"No downloads"});var j=function(e){R.get("/api/v1/downloads/stop").then((function(){return function(e){R.delete("/api/v1/download/".concat(e.mangaId,"/chapter/").concat(e.index)),R.delete("/api/v1/manga/".concat(e.mangaId,"/chapter/").concat(e.index))}(e)}))};return Object(le.jsx)(le.Fragment,{children:Object(le.jsx)(ft.a,{onDragEnd:function(e){},children:Object(le.jsx)(ft.c,{droppableId:"droppable",children:function(e){return Object(le.jsxs)(Ie.a,{ref:e.innerRef,children:[n.map((function(e,t){return Object(le.jsx)(ft.b,{draggableId:"".concat(e.mangaId,"-").concat(e.chapterIndex),index:t,children:function(t,n){return Object(le.jsxs)(me.a,Object(m.a)(Object(m.a)(Object(m.a)({ContainerProps:{ref:t.innerRef},sx:{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",padding:2,margin:"10px","&:hover":{backgroundColor:"action.hover",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"},"&:active":{backgroundColor:"action.selected",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"}},onClick:function(){return c.push("/manga/".concat(e.chapter.mangaId))}},t.draggableProps),t.dragHandleProps),{},{style:(a=n.isDragging,r=t.draggableProps.style,o=i.palette,Object(m.a)(Object(m.a)({},r),a&&{background:"dark"===o.mode?"#424242":"rgb(235,235,235)"})),ref:t.innerRef,children:[Object(le.jsx)(ge.a,{sx:{margin:"auto 0"},children:Object(le.jsx)(xt.a,{})}),Object(le.jsx)(pe.a,{sx:{display:"flex"},children:Object(le.jsxs)(pe.a,{sx:{display:"flex",flexDirection:"column"},children:[Object(le.jsx)(z.a,{variant:"h5",component:"h2",children:e.manga.title}),Object(le.jsx)(z.a,{variant:"caption",display:"block",gutterBottom:!0,children:"".concat(e.chapter.name," ")+"(".concat((100*e.progress).toFixed(2),"%)")+" => state: ".concat(e.state)})]})}),Object(le.jsx)(A.a,{sx:{marginLeft:"auto"},onClick:function(t){t.stopPropagation(),j(e.chapter)},size:"large",children:Object(le.jsx)(yt.a,{})})]}));var a,r,o}},"".concat(e.mangaId,"-").concat(e.chapterIndex))})),e.placeholder]})}})})})}var yc=[{code:"all",name:"All",nativeName:"All"},{code:"installed",name:"Installed",nativeName:"Installed"},{code:"updates pending",name:"Updates pending",nativeName:"Updates pending"},{code:"other",name:"other langs?",nativeName:"Other"},{code:"localsourcelang",name:"Local source",nativeName:"Local source"},{code:"en",name:"English",nativeName:"English"},{code:"ca",name:"Catalan; Valencian",nativeName:"Catal\xe0"},{code:"de",name:"German",nativeName:"Deutsch"},{code:"es",name:"Spanish; Castilian",nativeName:"Espa\xf1ol"},{code:"es-419",name:"Spanish; Castilian",nativeName:"Espa\xf1ol (Latinoam\xe9rica)"},{code:"fr",name:"French",nativeName:"Fran\xe7ais"},{code:"id",name:"Indonesian",nativeName:"Indonesia"},{code:"it",name:"Italian",nativeName:"Italiano"},{code:"pt",name:"Portuguese",nativeName:"Portugu\xeas"},{code:"pt-pt",name:"Portuguese",nativeName:"Portugu\xeas (Portugal)"},{code:"pt-br",name:"Portuguese; Brasil",nativeName:"Portugu\xeas (Brasil)"},{code:"vi",name:"Vietnamese",nativeName:"Ti\u1ebfng Vi\u1ec7t"},{code:"tr",name:"Turkish",nativeName:"T\xfcrk\xe7e"},{code:"ru",name:"Russian",nativeName:"\u0440\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"ar",name:"Arabic",nativeName:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629"},{code:"hi",name:"Hindi",nativeName:"\u0939\u093f\u0928\u094d\u0926\u0940"},{code:"th",name:"Thai",nativeName:"\u0e44\u0e17\u0e22"},{code:"zh",name:"Chinese",nativeName:"\u4e2d\u6587"},{code:"zh-hans",name:"Chinese",nativeName:"\u4e2d\u6587 (HANS)"},{code:"zh-hant",name:"Chinese",nativeName:"\u4e2d\u6587 (HANT)"},{code:"zh-rhk",name:"Chinese",nativeName:"\u4e2d\u6587 (RHK)"},{code:"zh-rtw",name:"Chinese",nativeName:"\u4e2d\u6587 (RTW)"},{code:"ja",name:"Japanese",nativeName:"\u65e5\u672c\u8a9e"},{code:"ko",name:"Korean",nativeName:"\ud55c\uad6d\uc5b4"},{code:"zu",name:"Zulu",nativeName:"isiZulu"},{code:"xh",name:"Xhosa",nativeName:"isiXhosa"},{code:"uk",name:"Ukrainian",nativeName:"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430"},{code:"ro",name:"Romanian",nativeName:"Rom\xe2n\u0103"},{code:"bg",name:"Bulgarian",nativeName:"\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"},{code:"cs",name:"Czech",nativeName:"\u010de\u0161tina"},{code:"pl",name:"Polish",nativeName:"polski"},{code:"no",name:"Norwegian",nativeName:"Norsk"},{code:"nl",name:"Dutch",nativeName:"Nederlands"},{code:"my",name:"Burmese",nativeName:"\u1017\u1019\u102c\u1005\u102c"},{code:"ms",name:"Malay",nativeName:"Malaysia"},{code:"mn",name:"Mongolian",nativeName:"\u041c\u043e\u043d\u0433\u043e\u043b"},{code:"ml",name:"Malayalam",nativeName:"\u0d2e\u0d32\u0d2f\u0d3e\u0d33\u0d02"},{code:"ku",name:"Kurdish",nativeName:"Kurd\xee"},{code:"hu",name:"Hungarian",nativeName:"Magyar"},{code:"hr",name:"Croatian",nativeName:"Hrvatski"},{code:"he",name:"Hebrew",nativeName:"\u05e2\u05d1\u05e8\u05d9\u05ea"},{code:"fil",name:"Filipino",nativeName:"Filipino"},{code:"fi",name:"Finnish",nativeName:"suomi"},{code:"fa",name:"Persian",nativeName:"\u0641\u0627\u0631\u0633\u06cc"},{code:"eu",name:"Basque",nativeName:"euskara"},{code:"el",name:"Greek",nativeName:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac"},{code:"da",name:"Danish",nativeName:"dansk"},{code:"bn",name:"Bengali",nativeName:"\u09ac\u09be\u0982\u09b2\u09be"},{code:"lt",name:"Lithuanian",nativeName:"lietuvi\u0173 kalba"},{code:"sh",name:"Serbo-Croatian",nativeName:"srpskohrvatski"},{code:"af",name:"Afrikaans",nativeName:"Afrikaans"},{code:"am",name:"Amharic",nativeName:"\u12a0\u121b\u122d\u129b"},{code:"az",name:"Azerbaijani",nativeName:"Az\u0259rbaycan"},{code:"be",name:"Belarusian",nativeName:"\u0431\u0435\u043b\u0430\u0440\u0443\u0441\u043a\u0430\u044f"},{code:"bs",name:"Bosnian",nativeName:"bosanski"},{code:"sv",name:"Swedish",nativeName:"svenska"},{code:"sv",name:"Swedish",nativeName:"svenska"}];function Cc(e){for(var t=-1!==e.indexOf("-")?e.indexOf("-"):e.length,n=e.toLocaleLowerCase().substring(0,t),a="language with code: ".concat(e),r=0;r<yc.length;r++)yc[r].code!==n&&yc[r].code!==e.toLocaleLowerCase()||(a=yc[r].nativeName);return a}var kc=function(e,t){var n=Cc(e),a=Cc(t);return"en"===e?-1:"en"===t||"localSourceLang"===e?1:"localSourceLang"===t?-1:n>a?1:-1};function wc(e){var t,n=e.shownLangs,r=e.setShownLangs,c=e.allLangs,i=e.forcedLangs,s=Object(a.useState)((t=oa(n),i.forEach((function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)})),t)),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object(a.useState)(!1),b=Object(o.a)(j,2),h=b[0],f=b[1];return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(A.a,{onClick:function(){return f(!0)},"aria-label":"display more actions",edge:"end",color:"inherit",size:"large",children:Object(le.jsx)(Wt.a,{})}),Object(le.jsxs)(Ze.a,{sx:{".MuiDialog-paper":{maxHeight:435,width:"80%"}},maxWidth:"xs",open:h,children:[Object(le.jsx)(it.a,{children:"Enabled Languages"}),Object(le.jsx)($e.a,{dividers:!0,sx:{padding:0},children:Object(le.jsx)(Ie.a,{children:c.map((function(e){return Object(le.jsxs)(me.a,{children:[Object(le.jsx)(Xe.a,{primary:Cc(e)}),Object(le.jsx)(Ye.a,{children:Object(le.jsx)(qe.a,{checked:-1!==u.indexOf(e),onChange:function(t){return function(e,t){if(e.target.checked)d([].concat(Object(ht.a)(u),[t]));else{var n=oa(u);n.splice(n.indexOf(t),1),d(n)}}(t,e)}})})]},e)}))})}),Object(le.jsxs)(Qe.a,{children:[Object(le.jsx)(Ke.a,{autoFocus:!0,onClick:function(){f(!1)},color:"primary",children:"Cancel"}),Object(le.jsx)(Ke.a,{onClick:function(){f(!1),r(u)},color:"primary",children:"Ok"})]})]})]})}wc.defaultProps={forcedLangs:[]};var Sc=Object(ye.a)("div")((function(e){var t=e.theme;return Object(Jt.a)({display:"flex"},t.breakpoints.up("sm"),{display:"none"})})),Lc=Object(ye.a)("div")((function(e){var t,n=e.theme;return t={display:"flex"},Object(Jt.a)(t,n.breakpoints.down("sm"),{display:"none"}),Object(Jt.a)(t,"& .MuiButton-root",{marginLeft:"20px"}),t}));function Nc(e){var t=e.source,n=t.id,a=t.name,r=t.lang,c=t.iconUrl,i=t.supportsLatest,s=t.isNsfw,u=Object(l.g)(),d=Re("serverBaseURL",""),j=Object(o.a)(d,1)[0],b=Re("useCache",!0),h=Object(o.a)(b,1)[0],f=function(e,t){u.push(t),e.stopPropagation()};return Object(le.jsx)(Cn.a,{sx:{margin:"10px","&:hover":{backgroundColor:"action.hover",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"},"&:active":{backgroundColor:"action.selected",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"}},onClick:function(e){return f(e,"/sources/".concat(n,"/popular/"))},children:Object(le.jsxs)(wn.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:2},children:[Object(le.jsxs)(pe.a,{sx:{display:"flex"},children:[Object(le.jsx)(Sn.a,{variant:"rounded",alt:a,sx:{width:56,height:56,flex:"0 0 auto",mr:2},src:"".concat(j).concat(c,"?useCache=").concat(h)}),Object(le.jsxs)(pe.a,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(le.jsx)(z.a,{variant:"h5",component:"h2",children:a}),"0"!==n&&Object(le.jsxs)(z.a,{variant:"caption",display:"block",gutterBottom:!0,children:[Cc(r),s&&Object(le.jsx)(z.a,{variant:"caption",display:"inline",gutterBottom:!0,color:"red",children:" 18+"})]})]})]}),Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Sc,{children:i&&Object(le.jsx)(Ke.a,{variant:"outlined",onClick:function(e){return f(e,"/sources/".concat(n,"/latest/"))},children:"Latest"})}),Object(le.jsxs)(Lc,{children:[i&&Object(le.jsx)(Ke.a,{variant:"outlined",onClick:function(e){return f(e,"/sources/".concat(n,"/latest/"))},children:"Latest"}),Object(le.jsx)(Ke.a,{variant:"outlined",onClick:function(e){return f(e,"/sources/".concat(n,"/popular/"))},children:"Browse"})]})]})]})})}var Ec=n(220),Tc=n.n(Ec);function Rc(e){var t=[];return e.forEach((function(e){-1===t.indexOf(e.lang)&&t.push(e.lang)})),t.sort(kc),t}function Ic(e){var t={};return e.forEach((function(e){void 0===t[e.lang]&&(t[e.lang]=[]),t[e.lang].push(e)})),t}function Fc(){var e=Object(a.useContext)(de),t=e.setTitle,n=e.setAction,c=Re("shownSourceLangs",["en","localsourcelang"]),i=Object(o.a)(c,2),s=i[0],u=i[1],d=Re("showNsfw",!0),j=Object(o.a)(d,1)[0],b=D("/api/v1/source/list"),h=b.data,f=b.loading,p=Object(l.g)();return Object(a.useEffect)((function(){["localsourcelang"].forEach((function(e){var t=!1;s.forEach((function(n){n===e&&(t=!0)})),t||u((function(t){return t.push(e),t}))}))}),[]),Object(a.useEffect)((function(){t("Sources"),n(Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(A.a,{onClick:function(){return p.push("/sources/all/search/")},size:"large",children:Object(le.jsx)(Tc.a,{})}),Object(le.jsx)(wc,{shownLangs:s,setShownLangs:u,allLangs:Rc(null!==h&&void 0!==h?h:[]),forcedLangs:["localsourcelang"]})]}))}),[s,h]),f?Object(le.jsx)(jt,{}):0===(null===h||void 0===h?void 0:h.length)?Object(le.jsx)("h3",{children:"No sources found. Install Some Extensions first."}):Object(le.jsx)(le.Fragment,{children:Object.entries(Ic(null!==h&&void 0!==h?h:[])).sort((function(e,t){return kc(e[0],t[0])})).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return-1!==s.indexOf(n)&&Object(le.jsxs)(r.a.Fragment,{children:[Object(le.jsx)("h1",{style:{marginLeft:25},children:Cc(n)},n),a.filter((function(e){return j||!e.isNsfw})).map((function(e){return Object(le.jsx)(Nc,{source:e},e.id)}))]},n)}))})}function Dc(e){var t=e.extension,n=t.name,r=t.lang,c=t.versionName,i=t.installed,s=t.hasUpdate,l=t.obsolete,u=t.pkgName,d=t.iconUrl,j=t.isNsfw,b=e.notifyInstall,h=Object(a.useState)((function(){return l?"obsolete":s?"update":i?"uninstall":"install"})),f=Object(o.a)(h,2),p=f[0],x=f[1],O=Re("serverBaseURL",""),m=Object(o.a)(O,1)[0],g=Re("useCache",!0),v=Object(o.a)(g,1)[0],y="all"===r?"All":r.toUpperCase();function C(){x("uninstalling"),R.get("/api/v1/extension/uninstall/".concat(u)).then((function(){b()}))}function k(){switch(p){case"install":x("installing"),R.get("/api/v1/extension/install/".concat(u)).then((function(){x("uninstall"),b()}));break;case"update":x("updating"),R.get("/api/v1/extension/update/".concat(u)).then((function(){x("uninstall"),b()}));break;case"obsolete":C(),setTimeout((function(){return window.location.reload()}),3e3);break;case"uninstall":C()}}return Object(le.jsx)(Cn.a,{sx:{margin:"10px"},children:Object(le.jsxs)(wn.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2},children:[Object(le.jsxs)(pe.a,{sx:{display:"flex"},children:[Object(le.jsx)(Sn.a,{variant:"rounded",sx:{width:56,height:56,flex:"0 0 auto",mr:2},alt:n,src:"".concat(m).concat(d,"?useCache=").concat(v)}),Object(le.jsxs)(pe.a,{sx:{display:"flex",flexDirection:"column"},children:[Object(le.jsx)(z.a,{variant:"h5",component:"h2",children:n}),Object(le.jsxs)(z.a,{variant:"caption",display:"block",gutterBottom:!0,children:[y," ",c,j&&Object(le.jsx)(z.a,{variant:"caption",display:"inline",gutterBottom:!0,color:"red",children:" 18+"})]})]})]}),Object(le.jsx)(Ke.a,{variant:"outlined",sx:{color:"obsolete"===p?"red":"inherit"},onClick:function(){return k()},children:p})]})})}var Pc=[];function Bc(){var e=Object(a.useRef)(null),t=Object(a.useContext)(de),n=t.setTitle,r=t.setAction,c=Re("shownExtensionLangs",["en","all"]),i=Object(o.a)(c,2),s=i[0],l=i[1],d=Re("showNsfw",!0),j=Object(o.a)(d,1)[0],b=Object(W.a)(),h=Object(M.a)(b.breakpoints.down("sm")),f=Object(u.d)("query",u.c),p=Object(o.a)(f,1)[0];Object(a.useEffect)((function(){n("Extensions"),r(Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Gn,{}),Object(le.jsx)(A.a,{onClick:function(){var t;return null===(t=e.current)||void 0===t?void 0:t.click()},size:"large",children:Object(le.jsx)(gt.a,{})}),Object(le.jsx)(wc,{shownLangs:s,setShownLangs:l,allLangs:Pc})]}))}),[s]);var x=D("/api/v1/extension/list"),m=x.data,v=x.mutate,y=x.loading,C=Object(a.useMemo)((function(){return(null!==m&&void 0!==m?m:[]).filter((function(e){var t=j||!e.isNsfw;return p?t&&e.name.toLowerCase().includes(p.toLowerCase()):t}))}),[m,j,p]),k=Object(a.useMemo)((function(){return function(e){Pc.length=0;var t={installed:[],"updates pending":[],all:[]};e.forEach((function(e){void 0===t[e.lang]&&(t[e.lang]=[],"all"!==e.lang&&Pc.push(e.lang)),e.installed?e.hasUpdate?t["updates pending"].push(e):t.installed.push(e):t[e.lang].push(e)})),Pc.sort(kc);var n=[["updates pending",t["updates pending"]],["installed",t.installed],["all",t.all]],a=Pc.map((function(e){return[e,t[e]]}));return n.concat(a)}(C).filter((function(e){return e[1].length>0})).filter((function(e){return["installed","updates pending","all"].concat(Object(ht.a)(s)).includes(e[0])}))}),[s,C]).flat(2),w=function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return[n,function(e,t){a([Object(le.jsx)(Rt,{message:e,severity:t},Math.floor(1e3*Math.random())+1)])}]}(Object(a.useState)([])),S=Object(o.a)(w,2),L=S[0],N=S[1],E=function(t){if(t.name.toLowerCase().endsWith("apk")){var n=new FormData;n.append("file",t),e.current&&(e.current.value=""),N("Installing Extension File....","info"),R.post("/api/v1/extension/install",n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){N("Installed extension successfully!","success"),v()})).catch((function(){return N("Extension installion failed!","error")}))}else N("invalid file type!","error")};return Object(a.useEffect)((function(){var e=function(){var e=Object(g.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,Object(St.a)(t);case 3:n=e.sent,E(n[0]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(e){e.preventDefault()};return document.addEventListener("drop",e),document.addEventListener("dragover",t),function(){document.removeEventListener("drop",e),document.removeEventListener("dragover",t)}}),[]),y?Object(le.jsx)(jt,{}):Object(le.jsxs)(le.Fragment,{children:[L,Object(le.jsx)("input",{type:"file",style:{display:"none"},ref:e,onChange:function(e){var t,n=null===(t=e.target.files)||void 0===t?void 0:t[0];n&&E(n)}}),Object(le.jsx)(_a.a,{style:{height:h?"calc(100vh - 64px - 64px)":"calc(100vh - 64px)"},totalCount:k.length,itemContent:function(e){if("string"===typeof k[e]){var t=k[e];return Object(le.jsx)(z.a,{variant:"h2",style:{paddingLeft:25,paddingBottom:"0.83em",paddingTop:"0.83em",backgroundColor:"rgb(18, 18, 18)",fontSize:"2em",fontWeight:"bold"},children:Cc(t)},t)}var n=k[e];return Object(le.jsx)(Dc,{extension:n,notifyInstall:function(){v()}},n.apkName)}})]})}function zc(){var e=Object(a.useState)(0),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsxs)(Dt.a,{value:n,onChange:function(e,t){return r(t)},indicatorColor:"primary",textColor:"primary",centered:!0,variant:"fullWidth",scrollButtons:!0,allowScrollButtonsMobile:!0,children:[Object(le.jsx)(Pt.a,{sx:{textTransform:"none"},label:"Sources"}),Object(le.jsx)(Pt.a,{sx:{textTransform:"none"},label:"Extensions"})]}),Object(le.jsx)(At,{index:0,currentIndex:n,children:Object(le.jsx)(Fc,{})}),Object(le.jsx)(At,{index:1,currentIndex:n,children:Object(le.jsx)(Bc,{})})]})}function Ac(e){var t=e.children,n=Object(a.useState)(),r=Object(o.a)(n,2),c=r[0],i=r[1],s=Object(a.useState)("Tachidesk"),l=Object(o.a)(s,2),u=l[0],d=l[1],j=Object(a.useState)(Object(le.jsx)("div",{})),b=Object(o.a)(j,2),h=b[0],f=b[1],p=Object(a.useState)({status:!1,value:Object(le.jsx)("div",{})}),x=Object(o.a)(p,2),O={defaultBackTo:c,setDefaultBackTo:i,title:u,setTitle:d,action:h,setAction:f,override:x[0],setOverride:x[1]};return Object(le.jsx)(de.Provider,{value:O,children:t})}var Mc=function(e){var t=e.children,n=Re("libraryOptions",Ht),a=Object(o.a)(n,2),r=a[0],c=a[1];return Object(le.jsx)(Ut.Provider,{value:{options:r,setOptions:c},children:t})},Wc=n(222);function Hc(e){var t=[];return e.forEach((function(e){-1===t.indexOf(e.lang)&&t.push(e.lang)})),t.sort(kc),t}function Vc(){var e=Object(u.d)("query",u.c),t=Object(o.a)(e,1)[0],n=Object(a.useContext)(de),r=n.setTitle,c=n.setAction,i=Object(a.useState)(2),s=Object(o.a)(i,2),d=s[0],j=s[1],b=Object(a.useState)({}),h=Object(o.a)(b,2),f=h[0],p=h[1],x=Re("shownSourceLangs",["en","localsourcelang"]),m=Object(o.a)(x,2),v=m[0],y=m[1],C=Re("showNsfw",!0),k=Object(o.a)(C,1)[0],w=Object(a.useState)([]),S=Object(o.a)(w,2),L=S[0],N=S[1],E=Object(a.useState)({}),T=Object(o.a)(E,2),I=T[0],F=T[1],D=Object(a.useState)({}),P=Object(o.a)(D,2),B=P[0],z=P[1],A=Object(a.useState)(1),M=Object(o.a)(A,2),W=M[0],H=M[1],V=Object(a.useState)(0),U=Object(o.a)(V,2),_=U[0],J=U[1],G=new Wc.a({concurrency:5});function X(){return(X=Object(g.a)(O.a.mark((function e(n){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.map((function(e){return G.add(Object(g.a)(O.a.mark((function n(){var a,r,c,i;return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,R.get("/api/v1/source/".concat(e.id,"/search?searchTerm=").concat(t||"","&pageNum=1"));case 2:return a=n.sent,n.next=5,a.data;case 5:r=n.sent,(c=f)[e.id]=r.mangaList,p(c),(i=I)[e.id]=!0,F(i),J(1);case 13:case"end":return n.stop()}}),n)}))))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){r("Global Search"),c(Object(le.jsx)(le.Fragment,{children:Object(le.jsx)(Gn,{})}))}),[]),Object(a.useEffect)((function(){R.get("/api/v1/source/list").then((function(e){return e.data})).then((function(e){N(e.sort((function(e,t){return e.displayName<t.displayName?-1:e.displayName>t.displayName?1:0}))),z(!0)}))}),[]),Object(a.useEffect)((function(){2!==d&&(0!==d?(F({}),p({}),function(e){X.apply(this,arguments)}(L.filter((function(e){var t=e.lang;return-1!==v.indexOf(t)})).filter((function(e){return k||!e.isNsfw})))):j(1))}),[d]),Object(a.useEffect)((function(){1===_&&J(0)}),[_]),Object(a.useEffect)((function(){if(t&&B){var e=setTimeout((function(){j(0)}),1e3);return function(){return clearTimeout(e)}}return function(){}}),[t,v,L]),Object(a.useEffect)((function(){["localsourcelang"].forEach((function(e){var t=!1;v.forEach((function(n){n===e&&(t=!0)})),t||y((function(t){return t.push(e),t}))}))}),[]),Object(a.useEffect)((function(){r("Sources"),c(Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Gn,{autoOpen:!0}),Object(le.jsx)(wc,{shownLangs:v,setShownLangs:y,allLangs:Hc(L),forcedLangs:["localsourcelang"]})]}))}),[v,L]);var Y=Object(l.g)();return t?Object(le.jsx)(le.Fragment,{children:L.filter((function(e){var t=e.lang;return-1!==v.indexOf(t)})).filter((function(e){return k||!e.isNsfw})).sort((function(e,t){var n=I[e.id],a=I[t.id];if(n&&!a)return-1;if(!n&&a)return 1;if(!n&&!a)return 0;var r=0===f[e.id].length,c=0===f[t.id].length;return r&&!c?1:c&&!r?-1:0})).map((function(e){var n=e.lang,a=e.id,r=e.displayName;return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsxs)(Cn.a,{sx:{margin:"10px","&:hover":{backgroundColor:"action.hover",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"},"&:active":{backgroundColor:"action.selected",transition:"background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"}},onClick:function(e){return function(e,t){Y.push(t),e.stopPropagation()}(e,"/sources/".concat(a,"/popular/?R&query=").concat(t))},children:[Object(le.jsx)("h1",{style:{margin:"25px 0px 0px 25px"},children:r},n),Object(le.jsx)("p",{style:{margin:"0px 0px 25px 25px"},children:Cc(n)})]}),Object(le.jsx)(Pn,{mangas:f[a]||[],isLoading:!I[a],hasNextPage:!1,lastPageNum:W,setLastPageNum:H,horisontal:!0,noFaces:!0,message:I[a]?"No manga was found!":void 0,inLibraryIndicator:!0})]})}))}):Object(le.jsx)(le.Fragment,{})}function Uc(){var e=Re("darkTheme",!0),t=Object(o.a)(e,2),n=t[0],a=t[1],c={darkTheme:n,setDarkTheme:a},i=r.a.useMemo((function(){return Object(b.a)({palette:{mode:n?"dark":"light"},components:{MuiCssBaseline:{styleOverrides:"\n                        *::-webkit-scrollbar {\n                            width: 10px;\n                            background: ".concat(n?"#222":"#e1e1e1",";   \n                        }\n                        \n                        *::-webkit-scrollbar-thumb {\n                            background: ").concat(n?"#111":"#aaa",";\n                            border-radius: 5px;\n                        }\n                    ")}}})}),[n]);return Object(le.jsx)(p.a,{value:{fetcher:I},children:Object(le.jsx)(s.a,{children:Object(le.jsx)(h.a,{injectFirst:!0,children:Object(le.jsx)(f.a,{theme:i,children:Object(le.jsx)(u.b,{ReactRouterRoute:l.b,children:Object(le.jsx)(Mc,{children:Object(le.jsxs)(Ac,{children:[Object(le.jsx)(j.a,{}),Object(le.jsx)(Ee,{}),Object(le.jsx)(d.a,{id:"appMainContainer",maxWidth:!1,disableGutters:!0,sx:{mt:8,ml:{sm:8},mb:{xs:8,sm:0},width:"auto",overflow:"auto"},children:Object(le.jsxs)(l.d,{children:[Object(le.jsx)(l.b,{exact:!0,path:"/",render:function(){return Object(le.jsx)(l.a,{to:"/library"})}}),Object(le.jsx)(l.b,{path:"/settings/about",children:Object(le.jsx)(bt,{})}),Object(le.jsx)(l.b,{path:"/settings/categories",children:Object(le.jsx)(wt,{})}),Object(le.jsx)(l.b,{path:"/settings/backup",children:Object(le.jsx)(Ft,{})}),Object(le.jsx)(l.b,{path:"/settings",children:Object(le.jsx)(be.Provider,{value:c,children:Object(le.jsx)(ut,{})})}),Object(le.jsx)(l.b,{path:"/sources/:sourceId/popular/",children:Object(le.jsx)(Pr,{popular:!0})}),Object(le.jsx)(l.b,{path:"/sources/:sourceId/latest/",children:Object(le.jsx)(Pr,{popular:!1})}),Object(le.jsx)(l.b,{path:"/sources/:sourceId/configure/",children:Object(le.jsx)(ua,{})}),Object(le.jsx)(l.b,{path:"/sources/all/search/",children:Object(le.jsx)(Vc,{})}),Object(le.jsx)(l.b,{path:"/downloads",children:Object(le.jsx)(vc,{})}),Object(le.jsx)(l.b,{path:"/manga/:mangaId/chapter/:chapterNum",children:Object(le.jsx)(le.Fragment,{})}),Object(le.jsx)(l.b,{path:"/manga/:id",children:Object(le.jsx)(hr,{})}),Object(le.jsx)(l.b,{path:"/library",children:Object(le.jsx)(Qn,{})}),Object(le.jsx)(l.b,{path:"/updates",children:Object(le.jsx)(fc,{})}),Object(le.jsx)(l.b,{path:"/sources",children:Object(le.jsx)(Fc,{})}),Object(le.jsx)(l.b,{path:"/extensions",children:Object(le.jsx)(Bc,{})}),Object(le.jsx)(l.b,{path:"/browse",children:Object(le.jsx)(zc,{})})]})}),Object(le.jsx)(l.d,{children:Object(le.jsx)(l.b,{path:"/manga/:mangaId/chapter/:chapterIndex",render:function(e){return Object(le.jsx)(uc,{},e.match.params.chapterIndex)}})})]})})})})})})})}n(291),n(292);i.a.render(Object(le.jsx)(r.a.StrictMode,{children:Object(le.jsx)(Uc,{})}),document.getElementById("root"))}},[[293,1,2]]]);
//# sourceMappingURL=main.56b14c93.chunk.js.map