{"version":3,"sources":["components/context/NavbarContext.tsx","components/context/DarkTheme.tsx","components/util/CustomExtensionOutlinedIcon.tsx","components/navbar/navigation/DesktopSideBar.tsx","components/navbar/navigation/MobileBottomBar.tsx","components/navbar/DefaultNavBar.tsx","util/localStorage.tsx","util/useLocalStorage.tsx","components/util/ListItemLink.tsx","screens/Settings.tsx","util/client.tsx","components/util/LoadingPlaceholder.tsx","screens/settings/About.tsx","screens/settings/Categories.tsx","components/util/Toast.tsx","screens/settings/Backup.tsx","util/cloneObject.tsx","components/util/EmptyView.tsx","components/util/TabPanel.tsx","components/util/ThreeStateCheckbox.tsx","util/useLibraryOptions.ts","components/context/LibraryOptionsContext.tsx","components/library/LibraryOptions.tsx","components/util/SpinnerImage.tsx","components/MangaCard.tsx","components/MangaGrid.tsx","components/library/LibraryMangaGrid.tsx","components/util/AppbarSearch.tsx","screens/Library.tsx","screens/SearchSingle.tsx","components/sourceConfiguration/TwoStatePreference.tsx","components/sourceConfiguration/ListPreference.tsx","components/sourceConfiguration/EditTextPreference.tsx","components/sourceConfiguration/MultiSelectListPreference.tsx","screens/SourceConfigure.tsx","components/navbar/action/CategorySelect.tsx","components/MangaDetails.tsx","components/chapter/ChapterOptions.tsx","components/chapter/ChapterCard.tsx","components/chapter/util.tsx","components/chapter/ResumeFAB.tsx","components/chapter/ChapterList.tsx","components/chapter/useFetchChapters.ts","screens/Manga.tsx","screens/SourceMangas.tsx","components/reader/Page.tsx","components/reader/pager/HorizontalPager.tsx","components/reader/PageNumber.tsx","components/reader/pager/PagedPager.tsx","components/reader/DoublePage.tsx","components/reader/pager/DoublePagedPager.tsx","components/reader/pager/VerticalPager.tsx","components/navbar/ReaderNavBar.tsx","screens/Reader.tsx","screens/Updates.tsx","screens/DownloadQueue.tsx","util/language.tsx","components/navbar/action/LangSelect.tsx","components/SourceCard.tsx","screens/Sources.tsx","components/ExtensionCard.tsx","screens/Extensions.tsx","screens/Browse.tsx","components/navbar/NavBarContextProvider.tsx","components/library/LibraryOptionsProvider.tsx","App.tsx","index.tsx"],"names":["NavBarContext","React","createContext","title","setTitle","action","setAction","override","status","value","setOverride","DarkTheme","darkTheme","setDarkTheme","icon","createSvgIcon","d","SideNavBarContainer","styled","theme","height","width","spacing","backgroundColor","palette","mode","grey","position","top","left","paddingTop","display","flexDirection","DesktopSideBar","navBarItems","location","useLocation","useTheme","iconFor","path","IconComponent","SelectedIconComponent","pathname","sx","color","fontSize","map","to","style","textDecoration","ListItem","disableRipple","button","ListItemIcon","minWidth","Tooltip","placement","BottomNavContainer","bottom","justifyContent","alignItems","zIndex","Link","RRDLink","flex","MobileBottomBar","padding","Box","navbarItems","CollectionsBookmarkIcon","CollectionsOutlinedBookmarkIcon","show","NewReleasesIcon","NewReleasesOutlinedIcon","ExtensionIcon","ExtensionOutlinedIcon","ExploreIcon","ExploreOutlinedIcon","GetAppIcon","GetAppOutlinedIcon","SettingsIcon","DefaultNavBar","useContext","history","useHistory","isMobileWidth","useMediaQuery","breakpoints","down","isMainRoute","some","navbar","filter","it","flexGrow","AppBar","Toolbar","IconButton","edge","marginRight","onClick","length","push","goBack","size","Typography","variant","getItem","key","defaultValue","item","window","localStorage","JSON","parse","setItem","stringify","useLocalStorage","initialState","Function","useState","storage","storedValue","setStoredValue","valueToStore","ListItemLink","props","directLink","component","href","Settings","NavbarContext","useEffect","serverAddress","setServerAddress","showNsfw","setShowNsfw","useCache","setUseCache","dialogOpen","setDialogOpen","dialogValue","setDialogValue","handleDialogCancel","List","ListItemText","primary","ListItemSecondaryAction","Switch","checked","onChange","secondary","Dialog","open","onClose","DialogContent","DialogContentText","TextField","autoFocus","margin","id","label","type","fullWidth","placeholder","e","target","DialogActions","Button","inferredPort","hostname","port","protocol","client","axios","create","baseURL","interceptors","request","use","config","data","FormData","Object","assign","headers","LoadingPlaceholder","children","shouldRender","componentProps","condition","undefined","createElement","CircularProgress","thickness","About","about","setAbout","get","then","response","name","buildType","version","revision","Date","buildTime","toUTCString","github","discord","Categories","categories","setCategories","categoryToEdit","setCategoryToEdit","dialogName","setDialogName","dialogDefault","setDialogDefault","updateTriggerHolder","setUpdateTriggerHolder","triggerUpdate","shift","onDragEnd","result","destination","list","from","formData","append","patch","finally","Array","splice","removed","categoryReorder","source","index","droppableId","provided","ref","innerRef","draggableId","toString","snapshot","ContainerProps","draggableProps","dragHandleProps","isDragging","draggableStyle","background","default","handleEditDialogOpen","category","delete","deleteCategory","Fab","right","DialogTitle","FormControlLabel","control","Checkbox","post","Transition","Slide","direction","Toast","message","severity","setOpen","handleClose","Snackbar","autoHideDuration","TransitionComponent","elevation","makeToast","Math","floor","random","container","document","body","appendChild","ReactDOM","render","setTimeout","querySelector","unmountComponentAtNode","removeChild","removeToast","Backup","defaults","submitBackup","file","toLowerCase","endsWith","catch","dropHandler","a","preventDefault","fromEvent","files","dragOverHandler","addEventListener","input","getElementById","evt","removeEventListener","click","cloneObject","obj","ERROR_FACES","getRandomErrorFace","randIndex","EmptyView","messageExtra","transform","textAlign","gutterBottom","TabPanel","currentIndex","role","hidden","defaultProps","CheckState","useLibraryOptions","useQueryParam","BooleanParam","downloaded","setDownloaded","unread","setUnread","StringParam","query","setQuery","sorts","setSorts","active","sortDesc","setSortDesc","checkedToState","SELECTED","INTERMEDIATE","UNSELECTED","stateTransition","state","ThreeStateCheckbox","localChecked","setLocalChecked","CancelBox","indeterminate","indeterminateIcon","stateToChecked","currentTarget","className","LibraryOptionsContext","options","showDownloadBadge","showUnreadBadge","setOptions","useLibraryOptionsContext","Options","currentTab","setCurrentTab","setContextOptions","prev","Tabs","newTab","indicatorColor","textColor","Tab","Stack","SortOptions","handleSortChange","event","Radio","LibraryOptions","filtersOpen","setFiltersOpen","sortsOpen","setSortsOpen","Drawer","anchor","PaperProps","maxWidth","marginLeft","SpinnerImage","src","alt","onImageLoad","imgRef","spinnerStyle","imgStyle","imageSrc","setImagsrc","img","Image","onload","onerror","BottomGradient","BottomGradientDoubledDown","MangaTitle","textShadow","BadgeContainer","borderRadius","overflow","paddingInline","truncateText","str","maxLength","trimmedString","substr","MangaCard","forwardRef","manga","thumbnailUrl","downloadCount","unreadCount","Grid","xs","sm","md","lg","Card","aspectRatio","CardActionArea","objectFit","placeItems","MangaGrid","mapped","mangas","isLoading","hasNextPage","lastPageNum","setLastPageNum","lastManga","useRef","scrollHandler","current","rect","getBoundingClientRect","y","innerHeight","idx","LibraryMangaGrid","filteredManga","downloadedFilter","unreadFilter","includes","queryFilter","filterManga","sortedManga","sort","b","c","toReadSort","toSortAlph","toSortID","sortManga","showFilteredOutMessage","AppbarSearch","searchOpen","setSearchOpen","inputRef","openSearch","focus","handleSearchShortcut","code","ctrlKey","Input","onBlur","endAdornment","Library","toRender","tabs","setTabs","tabNum","setTabNum","NumberParam","tabSearchParam","setTabSearchParam","handleTabChange","categoryTabs","isFetched","Number","isNaN","order","forEach","tab","tabsClone","tabDefines","tabBodies","scrollableTabs","innerWidth","centered","scrollButtons","allowScrollButtonsMobile","SearchSingle","sourceId","useParams","error","setError","setMangas","setMessage","searchTerm","setSearchTerm","setHasNextPage","setIsLoading","textInput","createRef","processInput","params","pageNum","mangaList","mx","onKeyDown","getTwoStateType","TwoSatePreference","summary","currentValue","updateValue","internalCurrentValue","setInternalCurrentValue","CheckBoxPreference","SwitchPreferenceCompat","ListDialog","valueProp","setValue","radioGroupRef","maxHeight","TransitionProps","onEntering","dividers","RadioGroup","option","ListPreference","entryValues","entries","findEntryOf","indexOf","newValue","findEntryValueOf","EditTextPreference","dialogTitle","dialogMessage","selectedValuesProp","selectedValues","values","setSelectedValues","FormGroup","selectedValue","hasEntry","selectedValuesClone","handleChange","MultiSelectListPreference","SourceConfigure","sourcePreferences","setSourcePreferences","convertToString","defaultValueType","getPrefComponent","CategorySelect","mangaId","categoryInfos","setCategoryInfos","tmpCategoryInfos","selected","categoryId","categoryInfo","getValueOrUnknown","val","MangaDetails","inLibrary","setInLibrary","categoryDialogOpen","setCategoryDialogOpen","classes","makeStyles","root","up","alignSelf","overflowY","leftRight","leftSide","rightSide","fontWeight","buttons","paddingLeft","paddingRight","description","marginTop","marginBottom","textJustify","genre","flexWrap","border","useStyles","handleButtonClick","author","artist","displayName","realUrl","g","SortTab","ChapterOptions","optionsDispatch","filterOptions","useCallback","filterType","filterValue","minHeight","bookmarked","py","sortBy","reverse","ArrowUpward","ArrowDownward","showChapterNumber","ChapterCard","chapter","triggerChaptersUpdate","downloadStatusString","dateStr","uploadDate","toLocaleDateString","anchorEl","setAnchorEl","sendChange","readChapterColor","transition","cursor","read","text","CardContent","dark","chapterNumber","scanlator","stopPropagation","Menu","keepMounted","Boolean","MenuItem","defaultChapterOptions","chapterOptionsReducer","actions","Error","ResumeFab","lastPageRead","PlayArrow","CustomVirtuoso","Virtuoso","listStyle","baseWebsocketUrl","replace","initialQueue","queue","ChapterList","chapters","setChapters","noChaptersFound","setNoChaptersFound","chapterUpdateTriggerer","setChapterUpdateTriggerer","fetchedOnline","setFetchedOnline","fetchedOffline","setFetchedOffline","shouldFetchOnline","useFetchChapters","firstUnreadChapter","setFirstUnreadChapter","filteredChapters","setFilteredChapters","reducer","defaultState","useReducer","newState","useReducerLocalStorage","setWsClient","setQueueState","wsc","WebSocket","onmessage","close","downloadStatusStringFor","rtn","q","chapterIndex","progress","toFixed","filtered","chp","isChapterRead","chapterDownload","downloadFilter","chapterBookmarked","bookmarkdFilter","Sorted","fetchedAt","filterAndSortChapters","findFirstUnreadChapter","px","mt","totalCount","itemContent","useWindowScroll","overscan","Manga","setManga","freshData","SourceMangas","isConfigurable","setIsConfigurable","fetched","setFetched","sourceType","popular","Page","setCurPage","settings","handleVerticalScroll","handleHorizontalScroll","readerType","dimensions","setDimensions","handleResize","pointerEvents","imageStyle","HorizontalPager","pages","curPage","prevChapter","nextChapter","selfRef","pagesRef","nextPage","scrollIntoView","inline","page","loadNextonEnding","prevPage","mouseXPos","dragScreen","scrollBy","pageX","dragControl","removeDragControl","clickControl","clientX","handleLoadNextonEnding","scrollX","scrollWidth","overflowX","userSelect","PageNumber","pageCount","showPageNumber","staticNav","PagedReader","goLeft","goRight","keyboardControl","DoublePage","image1src","image2src","DoublePagedPager","pagesDisplayed","pageLoaded","fill","nextCurPage","i","imgElem","pagesToGoBack","retryDisplay","setInterval","setPagesToDisplay","clearInterval","onLoad","VerticalReader","slice","scrollY","offsetHeight","Root","flexShrink","Navigation","ChapterNavigation","gridTemplateColumns","gridTemplateAreas","gridColumnGap","textTransform","OpenDrawerButton","defaultReaderSettings","continuesPageGap","ReaderNavBar","setSettings","drawerOpen","setDrawerOpen","hideOpenButton","setHideOpenButton","prevScrollPos","setPrevScrollPos","settingsCollapseOpen","setSettingsCollapseOpen","setSettingValue","handleScroll","currentScrollPos","pageYOffset","abs","rootEl","mainContainer","in","timeout","appear","mountOnEnter","unmountOnExit","mr","ContainerComponent","disableFocusRipple","Collapse","Select","p","gridArea","startIcon","chapterCount","endIcon","Zoom","Fade","initialChapter","Reader","setChapter","settingsClone","defualtSettings","shouldUpdateSettings","keys","keyOf","formDataRead","n","ReaderComponent","VerticalPager","PagedPager","getReaderComponent","isTheSameDay","first","second","getDate","getMonth","getFullYear","groupByDate","updates","groups","globalIdx","date","today","yesterday","setDate","getDateString","epoch","setUTCSeconds","epochToDate","Updates","updateEntries","setUpdateEntries","fetchedHasNextPage","lastEntry","dateGroup","ml","my","Avatar","imageRendering","downloadChapter","DownloadQueue","queueState","toggleQueueStatus","ISOLanguages","nativeName","langCodeToName","whereToCut","proccessedCode","toLocaleLowerCase","substring","langSortCmp","aLang","bLang","LangSelect","firstList","shownLangs","setShownLangs","allLangs","forcedLangs","mShownLangs","setMShownLangs","lang","clone","MobileWidthButtons","WiderWidthButtons","SourceCard","iconUrl","supportsLatest","redirectTo","sourceToLangList","sources","groupByLang","Sources","setSources","forcedLang","hasLang","shownLangsCopy","Fragment","isNsfw","ExtensionCard","extension","versionName","installed","hasUpdate","obsolete","pkgName","notifyInstall","installedState","setInstalledState","langPress","toUpperCase","uninstall","reload","MangaExtensions","isMobile","extensionsRaw","setExtensionsRaw","toasts","setToasts","makeToaster","submitExternalExtension","changeHandler","ext","nsfwFilter","combinedShownLangs","flatRenderItems","extensions","sortedExtenions","all","langExt","concat","groupExtensions","group","flat","paddingBottom","apkName","Browse","NavBarProvider","Provider","LibraryOptionsContextProvider","App","darkThemeContext","useMemo","createTheme","components","MuiCssBaseline","styleOverrides","StyledEngineProvider","injectFirst","ThemeProvider","ReactRouterRoute","Route","CssBaseline","Container","disableGutters","mb","exact","match","StrictMode"],"mappings":"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","file":"static/js/main.820605dc.chunk.js","sourcesContent":["/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ntype ContextType = {\n    // AppBar title\n    title: string\n    setTitle: React.Dispatch<React.SetStateAction<string>>\n\n    // AppBar action buttons\n    action: any\n    setAction: React.Dispatch<React.SetStateAction<any>>\n\n    // Allow default navbar to be overrided\n    override: INavbarOverride\n    setOverride: React.Dispatch<React.SetStateAction<INavbarOverride>>\n};\n\nconst NavBarContext = React.createContext<ContextType>({\n    title: 'Tachidesk',\n    setTitle: ():void => {},\n    action: <div />,\n    setAction: ():void => {},\n    override: { status: false, value: <div /> },\n    setOverride: ():void => {},\n});\n\nexport default NavBarContext;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ntype ContextType = {\n    darkTheme: boolean\n    setDarkTheme: React.Dispatch<React.SetStateAction<boolean>>\n};\n\nconst DarkTheme = React.createContext<ContextType>({\n    darkTheme: true,\n    setDarkTheme: ():void => {},\n});\n\nexport default DarkTheme;\n","import React from 'react';\nimport createSvgIcon from '@mui/material/utils/createSvgIcon';\n\nconst d = 'M 11 1 C 9.3550302 1 8 2.3550302 8 4 L 4 4 C 2.9069372 4 2 4.9069372 2 6 L 2 12 L 4 12 C 4.5650302 12 5 12.43497 5 13 C 5 13.56503 4.5650302 14 4 14 L 2 14 L 2 20 C 2 21.093063 2.9069372 22 4 22 L 10 22 L 10 20 C 10 19.43497 10.43497 19 11 19 C 11.56503 19 12 19.43497 12 20 L 12 22 L 18 22 C 19.093063 22 20 21.093063 20 20 L 20 16 C 21.64497 16 23 14.64497 23 13 C 23 11.35503 21.64497 10 20 10 L 20 6 C 20 4.9069372 19.093063 4 18 4 L 14 4 C 14 2.3550302 12.64497 1 11 1 z M 11 3 C 11.56503 3 12 3.4349698 12 4 L 12 6 L 18 6 L 18 12 L 20 12 C 20.56503 12 21 12.43497 21 13 C 21 13.56503 20.56503 14 20 14 L 18 14 L 18 20 L 14 20 C 14 18.35503 12.64497 17 11 17 C 9.3550302 17 8 18.35503 8 20 L 4 20 L 4 16 C 5.6449698 16 7 14.64497 7 13 C 7 11.35503 5.6449698 10 4 10 L 4 6 L 10 6 L 10 4 C 10 3.4349698 10.43497 3 11 3 z';\n\nconst icon = createSvgIcon(<path d={d} />, 'CustomExtensionOutlined');\n\nexport default icon;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { ListItem, ListItemIcon, Tooltip } from '@mui/material';\nimport { Link, useLocation } from 'react-router-dom';\nimport { styled } from '@mui/system';\nimport { useTheme } from '@mui/material/styles';\n\nconst SideNavBarContainer = styled('div')(({ theme }) => ({\n    height: '100vh',\n    width: theme.spacing(8),\n    backgroundColor: theme.palette.mode === 'light' ? theme.palette.grey[100] : theme.palette.grey[900],\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    paddingTop: theme.spacing(8),\n    display: 'flex',\n    flexDirection: 'column',\n}));\n\ninterface IProps {\n    navBarItems: Array<NavbarItem>\n}\n\nexport default function DesktopSideBar({ navBarItems }: IProps) {\n    const location = useLocation();\n    const theme = useTheme();\n\n    const iconFor = (path: string, IconComponent: any, SelectedIconComponent: any) => {\n        if (location.pathname === path) return <SelectedIconComponent sx={{ color: 'primary.main' }} fontSize=\"large\" />;\n        return <IconComponent sx={{ color: (theme.palette.mode === 'dark') ? 'grey.A400' : 'grey.600' }} fontSize=\"large\" />;\n    };\n\n    return (\n        <SideNavBarContainer>\n            {\n                // eslint-disable-next-line react/destructuring-assignment\n                navBarItems.map(({\n                    path, title, IconComponent, SelectedIconComponent,\n                }: NavbarItem) => (\n                    <Link to={path} style={{ color: 'inherit', textDecoration: 'none' }} key={path}>\n                        <ListItem disableRipple button key={title}>\n                            <ListItemIcon sx={{ minWidth: '0' }}>\n                                <Tooltip placement=\"right\" title={title}>\n                                    {iconFor(path, IconComponent, SelectedIconComponent)}\n                                </Tooltip>\n                            </ListItemIcon>\n                        </ListItem>\n                    </Link>\n                ))\n            }\n        </SideNavBarContainer>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { ListItem } from '@mui/material';\nimport { styled, Box } from '@mui/system';\nimport { Link as RRDLink, useLocation } from 'react-router-dom';\nimport { useTheme } from '@mui/material/styles';\n\nconst BottomNavContainer = styled('div')(({ theme }) => ({\n    bottom: 0,\n    left: 0,\n    height: theme.spacing(7),\n    width: '100vw',\n    backgroundColor: theme.palette.mode === 'light' ? theme.palette.grey[100] : theme.palette.grey[900],\n    position: 'fixed',\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-evenly',\n    alignItems: 'center',\n    // For Some reason the theme is throwing and error when accessing the Zindex object,\n    // This is the zIndex of the appBar in the default theme\n    zIndex: 1100,\n}));\n\nconst Link = styled(RRDLink)({\n    textDecoration: 'none',\n    flex: 1,\n});\n\ninterface IProps {\n    navBarItems: Array<NavbarItem>\n}\n\nexport default function MobileBottomBar({ navBarItems }: IProps) {\n    const location = useLocation();\n    const theme = useTheme();\n\n    const iconFor = (path: string, IconComponent: any, SelectedIconComponent: any) => {\n        if (location.pathname === path) return <SelectedIconComponent sx={{ color: 'primary.main' }} fontSize=\"medium\" />;\n        return <IconComponent sx={{ color: (theme.palette.mode === 'dark') ? 'grey.A400' : 'grey.600' }} fontSize=\"medium\" />;\n    };\n\n    return (\n        <BottomNavContainer>\n            {\n                navBarItems.map((\n                    {\n                        path, title, IconComponent, SelectedIconComponent,\n                    }: NavbarItem,\n                ) => (\n                    <Link to={path} key={path}>\n                        <ListItem disableRipple button sx={{ justifyContent: 'center', padding: '8px' }} key={title}>\n                            <Box\n                                display=\"flex\"\n                                flexDirection=\"column\"\n                                alignItems=\"center\"\n                            >\n                                {iconFor(path, IconComponent, SelectedIconComponent)}\n                                <Box sx={{\n                                    fontSize: '0.65rem',\n                                    // eslint-disable-next-line no-nested-ternary\n                                    color: location.pathname === path\n                                        ? 'primary.main'\n                                        : ((theme.palette.mode === 'dark')\n                                            ? 'grey.A400'\n                                            : 'grey.600'),\n                                }}\n                                >\n                                    {title}\n                                </Box>\n                            </Box>\n                        </ListItem>\n                    </Link>\n                ))\n            }\n        </BottomNavContainer>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext } from 'react';\nimport AppBar from '@mui/material/AppBar';\nimport Toolbar from '@mui/material/Toolbar';\nimport Typography from '@mui/material/Typography';\nimport IconButton from '@mui/material/IconButton';\nimport { useMediaQuery } from '@mui/material';\nimport { useTheme } from '@mui/material/styles';\nimport CollectionsBookmarkIcon from '@mui/icons-material/CollectionsBookmark';\nimport CollectionsOutlinedBookmarkIcon from '@mui/icons-material/CollectionsBookmarkOutlined';\nimport NewReleasesIcon from '@mui/icons-material/NewReleases';\nimport NewReleasesOutlinedIcon from '@mui/icons-material/NewReleasesOutlined';\nimport ExploreIcon from '@mui/icons-material/Explore';\nimport ExploreOutlinedIcon from '@mui/icons-material/ExploreOutlined';\nimport ExtensionIcon from '@mui/icons-material/Extension';\nimport GetAppIcon from '@mui/icons-material/GetApp';\nimport GetAppOutlinedIcon from '@mui/icons-material/GetAppOutlined';\nimport SettingsIcon from '@mui/icons-material/Settings';\nimport ArrowBack from '@mui/icons-material/ArrowBack';\nimport { useHistory } from 'react-router-dom';\nimport NavBarContext from 'components/context/NavbarContext';\nimport DarkTheme from 'components/context/DarkTheme';\nimport ExtensionOutlinedIcon from 'components/util/CustomExtensionOutlinedIcon';\nimport { Box } from '@mui/system';\nimport DesktopSideBar from './navigation/DesktopSideBar';\nimport MobileBottomBar from './navigation/MobileBottomBar';\n\nconst navbarItems: Array<NavbarItem> = [\n    {\n        path: '/library',\n        title: 'Library',\n        SelectedIconComponent: CollectionsBookmarkIcon,\n        IconComponent: CollectionsOutlinedBookmarkIcon,\n        show: 'both',\n    }, {\n        path: '/updates',\n        title: 'Updates',\n        SelectedIconComponent: NewReleasesIcon,\n        IconComponent: NewReleasesOutlinedIcon,\n        show: 'both',\n    }, {\n        path: '/extensions',\n        title: 'Extensions',\n        SelectedIconComponent: ExtensionIcon,\n        IconComponent: ExtensionOutlinedIcon,\n        show: 'desktop',\n    }, {\n        path: '/sources',\n        title: 'Sources',\n        SelectedIconComponent: ExploreIcon,\n        IconComponent: ExploreOutlinedIcon,\n        show: 'desktop',\n    }, {\n        path: '/browse',\n        title: 'Browse',\n        SelectedIconComponent: ExploreIcon,\n        IconComponent: ExploreOutlinedIcon,\n        show: 'mobile',\n    }, {\n        path: '/downloads',\n        title: 'Downloads',\n        SelectedIconComponent: GetAppIcon,\n        IconComponent: GetAppOutlinedIcon,\n        show: 'both',\n    }, {\n        path: '/settings',\n        title: 'Settings',\n        SelectedIconComponent: SettingsIcon,\n        IconComponent: SettingsIcon,\n        show: 'both',\n    },\n];\n\nexport default function DefaultNavBar() {\n    const { title, action, override } = useContext(NavBarContext);\n    const { darkTheme } = useContext(DarkTheme);\n\n    const theme = useTheme();\n    const history = useHistory();\n\n    const isMobileWidth = useMediaQuery(theme.breakpoints.down('sm'));\n    const isMainRoute = navbarItems.some(({ path }) => path === history.location.pathname);\n\n    // Allow default navbar to be overrided\n    if (override.status) return override.value;\n\n    let navbar = <></>;\n    if (isMobileWidth) {\n        if (isMainRoute) {\n            navbar = <MobileBottomBar navBarItems={navbarItems.filter((it) => it.show !== 'desktop')} />;\n        }\n    } else {\n        navbar = <DesktopSideBar navBarItems={navbarItems.filter((it) => it.show !== 'mobile')} />;\n    }\n\n    return (\n        <Box sx={{ flexGrow: 1 }}>\n            <AppBar position=\"fixed\" color={darkTheme ? 'default' : 'primary'}>\n                <Toolbar>\n                    {\n                        !navbarItems.some(({ path }) => path === history.location.pathname)\n                            && (\n                                <IconButton\n                                    edge=\"start\"\n                                    sx={{ marginRight: theme.spacing(2) }}\n                                    color=\"inherit\"\n                                    aria-label=\"menu\"\n                                    disableRipple\n                                    // when page is opened in new tab backbutton will\n                                    // take you to the library\n                                    onClick={() => (history.length === 1 ? history.push('/library') : history.goBack())}\n                                    size=\"large\"\n                                >\n                                    <ArrowBack />\n                                </IconButton>\n                            )\n                    }\n                    <Typography variant={isMobileWidth ? 'h6' : 'h5'} sx={{ flexGrow: 1 }}>\n                        {title}\n                    </Typography>\n                    {action}\n                </Toolbar>\n            </AppBar>\n            {navbar}\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nfunction getItem<T>(key: string, defaultValue: T) : T {\n    try {\n        const item = window.localStorage.getItem(key);\n\n        if (item !== null) {\n            return JSON.parse(item);\n        }\n\n        window.localStorage.setItem(key, JSON.stringify(defaultValue));\n\n        /* eslint-disable no-empty */\n    } finally { }\n    return defaultValue;\n}\n\nfunction setItem<T>(key: string, value: T): void {\n    try {\n        window.localStorage.setItem(key, JSON.stringify(value));\n\n        // eslint-disable-next-line no-empty\n    } finally { }\n}\n\nexport default { getItem, setItem };\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, {\n    useState,\n    Dispatch,\n    SetStateAction,\n    useReducer,\n    Reducer,\n} from 'react';\nimport storage from './localStorage';\n\n// eslint-disable-next-line max-len\nexport default function useLocalStorage<T>(\n    key: string,\n    defaultValue: T | (() => T),\n): [T, Dispatch<SetStateAction<T>>] {\n    const initialState = defaultValue instanceof Function ? defaultValue() : defaultValue;\n    const [storedValue, setStoredValue] = useState<T>(\n        storage.getItem(key, initialState),\n    );\n\n    const setValue = ((value: T | ((prevState: T) => T)) => {\n        // Allow value to be a function so we have same API as useState\n        const valueToStore = value instanceof Function ? value(storedValue) : value;\n        setStoredValue(valueToStore);\n        storage.setItem(key, valueToStore);\n    }) as React.Dispatch<React.SetStateAction<T>>;\n\n    return [storedValue, setValue];\n}\n\nexport function useReducerLocalStorage<S, A>(\n    reducer: Reducer<S, A>,\n    key: string,\n    defaultState: S | (() => S),\n) {\n    const [storedValue, setValue] = useLocalStorage(key, defaultState);\n    return useReducer((state: S, action: A): S => {\n        const newState = reducer(state, action);\n        setValue(newState);\n        return newState;\n    }, storedValue);\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport ListItem, { ListItemProps } from '@mui/material/ListItem';\nimport { Link } from 'react-router-dom';\n\nexport default function ListItemLink(props: ListItemProps<Link, { directLink?: boolean }>) {\n    const { directLink, to } = props;\n    if (directLink) {\n        // eslint-disable-next-line react/jsx-props-no-spreading\n        return <ListItem button component=\"a\" href={to} {...props} />;\n    }\n\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <ListItem button component={Link} {...props} />;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport List from '@mui/material/List';\nimport ListAltIcon from '@mui/icons-material/ListAlt';\nimport BackupIcon from '@mui/icons-material/Backup';\nimport Brightness6Icon from '@mui/icons-material/Brightness6';\nimport DnsIcon from '@mui/icons-material/Dns';\nimport EditIcon from '@mui/icons-material/Edit';\nimport InfoIcon from '@mui/icons-material/Info';\nimport CachedIcon from '@mui/icons-material/Cached';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemIcon from '@mui/material/ListItemIcon';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Switch from '@mui/material/Switch';\nimport Button from '@mui/material/Button';\nimport IconButton from '@mui/material/IconButton';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport TextField from '@mui/material/TextField';\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport NavbarContext from '../components/context/NavbarContext';\nimport DarkTheme from '../components/context/DarkTheme';\nimport useLocalStorage from '../util/useLocalStorage';\nimport ListItemLink from '../components/util/ListItemLink';\n\nexport default function Settings() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Settings'); setAction(<></>); }, []);\n\n    const { darkTheme, setDarkTheme } = useContext(DarkTheme);\n    const [serverAddress, setServerAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [showNsfw, setShowNsfw] = useLocalStorage<boolean>('showNsfw', true);\n    const [useCache, setUseCache] = useLocalStorage<boolean>('useCache', true);\n    const [dialogOpen, setDialogOpen] = useState(false);\n    const [dialogValue, setDialogValue] = useState(serverAddress);\n\n    const handleDialogOpen = () => {\n        setDialogValue(serverAddress);\n        setDialogOpen(true);\n    };\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n        setServerAddress(dialogValue);\n    };\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                <ListItemLink to=\"/settings/categories\">\n                    <ListItemIcon>\n                        <ListAltIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Categories\" />\n                </ListItemLink>\n                <ListItemLink to=\"/settings/backup\">\n                    <ListItemIcon>\n                        <BackupIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Backup\" />\n                </ListItemLink>\n                <ListItem>\n                    <ListItemIcon>\n                        <Brightness6Icon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Dark Theme\" />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={darkTheme}\n                            onChange={() => setDarkTheme(!darkTheme)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemIcon>\n                        <FavoriteIcon />\n                    </ListItemIcon>\n                    <ListItemText\n                        primary=\"Show NSFW\"\n                        secondary=\"Hide NSFW extensions and sources\"\n                    />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={showNsfw}\n                            onChange={() => setShowNsfw(!showNsfw)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemIcon>\n                        <CachedIcon />\n                    </ListItemIcon>\n                    <ListItemText\n                        primary=\"Use image cache\"\n                        secondary=\"Disabling image cache makes images load faster if you have a slow disk,\n                         but uses it much more internet traffic in turn\"\n                    />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={useCache}\n                            onChange={() => setUseCache(!useCache)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemIcon>\n                        <DnsIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Server Address\" secondary={serverAddress} />\n                    <ListItemSecondaryAction>\n                        <IconButton\n                            onClick={() => {\n                                handleDialogOpen();\n                            }}\n                            size=\"large\"\n                        >\n                            <EditIcon />\n                        </IconButton>\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItemLink to=\"/settings/about\">\n                    <ListItemIcon>\n                        <InfoIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"About\" />\n                </ListItemLink>\n            </List>\n\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogContent>\n                    <DialogContentText>\n                        Enter Server Address\n                    </DialogContentText>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Server Address\"\n                        type=\"text\"\n                        fullWidth\n                        value={dialogValue}\n                        placeholder=\"http://127.0.0.1:4567\"\n                        onChange={(e) => setDialogValue(e.target.value)}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        Set\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport axios from 'axios';\nimport storage from './localStorage';\n\nconst { hostname, port, protocol } = window.location;\n\n// if port is 3000 it's probably running from webpack devlopment server\nlet inferredPort;\nif (port === '3000') { inferredPort = '4567'; } else { inferredPort = port; }\n\nconst client = axios.create({\n    // baseURL must not have traling slash\n    baseURL: storage.getItem('serverBaseURL', `${protocol}//${hostname}:${inferredPort}`),\n});\n\nclient.interceptors.request.use((config) => {\n    if (config.data instanceof FormData) {\n        Object.assign(config.headers, { 'Content-Type': 'multipart/form-data' });\n    }\n    return config;\n});\n\nexport default client;\n","/* eslint-disable react/jsx-props-no-spreading */\n/* eslint-disable react/require-default-props */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    shouldRender?: boolean | (() => boolean)\n    children?: React.ReactNode\n    component?: string | React.FunctionComponent<any> | React.ComponentClass<any, any>\n    componentProps?: any\n}\n\nexport default function LoadingPlaceholder(props: IProps) {\n    const {\n        children, shouldRender, component, componentProps,\n    } = props;\n\n    let condition = true;\n    if (shouldRender !== undefined) {\n        condition = shouldRender instanceof Function ? shouldRender() : shouldRender;\n    }\n\n    if (condition) {\n        if (component) {\n            return React.createElement(component, componentProps);\n        }\n\n        if (children) {\n            return (\n                <>\n                    {children}\n                </>\n            );\n        }\n    }\n\n    return (\n        <Box sx={{\n            margin: '10px auto',\n            display: 'flex',\n            justifyContent: 'center',\n        }}\n        >\n            <CircularProgress thickness={5} />\n        </Box>\n    );\n}\n","import React, { useContext, useEffect, useState } from 'react';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport client from 'util/client';\nimport ListItemLink from 'components/util/ListItemLink';\nimport NavbarContext from 'components/context/NavbarContext';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\n\nexport default function About() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const [about, setAbout] = useState<IAbout>();\n\n    useEffect(() => { setTitle('About'); setAction(<></>); }, []);\n\n    useEffect(() => {\n        client.get('/api/v1/settings/about')\n            .then((response) => response.data)\n            .then((data:IAbout) => {\n                setAbout(data);\n            });\n    }, []);\n\n    if (about === undefined) {\n        return <LoadingPlaceholder />;\n    }\n\n    const version = () => {\n        if (about.buildType === 'Stable') return `${about.version}`;\n        return `${about.version}-${about.revision}`;\n    };\n\n    const buildTime = () => new Date(about.buildTime * 1000).toUTCString();\n\n    return (\n        <List>\n            <ListItem>\n                <ListItemText primary=\"Server\" secondary={`${about.name} ${about.buildType}`} />\n            </ListItem>\n            <ListItem>\n                <ListItemText primary=\"Server version\" secondary={version()} />\n            </ListItem>\n            <ListItem>\n                <ListItemText primary=\"Build time\" secondary={buildTime()} />\n            </ListItem>\n            <ListItemLink to={about.github}>\n                <ListItemText primary=\"Github\" secondary={about.github} />\n            </ListItemLink>\n            <ListItemLink to={about.discord}>\n                <ListItemText primary=\"Discord\" secondary={about.discord} />\n            </ListItemLink>\n        </List>\n    );\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/* eslint-disable react/jsx-props-no-spreading */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport {\n    List,\n    ListItem,\n    ListItemText,\n    ListItemIcon,\n    IconButton,\n} from '@mui/material';\nimport {\n    DragDropContext, Droppable, Draggable, DropResult, DraggingStyle, NotDraggingStyle,\n} from 'react-beautiful-dnd';\nimport DragHandleIcon from '@mui/icons-material/DragHandle';\nimport EditIcon from '@mui/icons-material/Edit';\nimport { useTheme, Palette } from '@mui/material/styles';\nimport Fab from '@mui/material/Fab';\nimport AddIcon from '@mui/icons-material/Add';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\n\nconst getItemStyle = (isDragging: boolean,\n    draggableStyle: DraggingStyle | NotDraggingStyle | undefined, palette: Palette) => ({\n    // styles we need to apply on draggables\n    ...draggableStyle,\n\n    ...(isDragging && {\n        background: palette.mode === 'dark' ? '#424242' : 'rgb(235,235,235)',\n    }),\n});\n\nexport default function Categories() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Categories'); setAction(<></>); }, []);\n\n    const [categories, setCategories] = useState<ICategory[]>([]);\n    const [categoryToEdit, setCategoryToEdit] = useState<number>(-1); // -1 means new category\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n    const [dialogName, setDialogName] = useState<string>('');\n    const [dialogDefault, setDialogDefault] = useState<boolean>(false);\n    const theme = useTheme();\n\n    const [updateTriggerHolder, setUpdateTriggerHolder] = useState<number>(0); // just a hack\n    const triggerUpdate = () => setUpdateTriggerHolder(updateTriggerHolder + 1); // just a hack\n\n    useEffect(() => {\n        if (!dialogOpen) {\n            client.get('/api/v1/category/')\n                .then((response) => response.data)\n                .then((data) => { if (data.length > 0 && data[0].name === 'Default') data.shift(); return data; })\n                .then((data) => setCategories(data));\n        }\n    }, [updateTriggerHolder]);\n\n    const categoryReorder = (list: ICategory[], from: number, to: number) => {\n        const formData = new FormData();\n        formData.append('from', `${from + 1}`);\n        formData.append('to', `${to + 1}`);\n        client.patch('/api/v1/category/reorder', formData)\n            .finally(() => triggerUpdate());\n\n        // also move it in local state to avoid jarring moving behviour...\n        const result = Array.from(list);\n        const [removed] = result.splice(from, 1);\n        result.splice(to, 0, removed);\n        return result;\n    };\n\n    const onDragEnd = (result: DropResult) => {\n        // dropped outside the list?\n        if (!result.destination) {\n            return;\n        }\n\n        setCategories(categoryReorder(\n            categories,\n            result.source.index,\n            result.destination.index,\n        ));\n    };\n\n    const resetDialog = () => {\n        setDialogName('');\n        setDialogDefault(false);\n        setCategoryToEdit(-1);\n    };\n\n    const handleDialogOpen = () => {\n        resetDialog();\n        setDialogOpen(true);\n    };\n\n    const handleEditDialogOpen = (index:number) => {\n        setDialogName(categories[index].name);\n        setDialogDefault(categories[index].default);\n        setCategoryToEdit(index);\n        setDialogOpen(true);\n    };\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n\n        const formData = new FormData();\n        formData.append('name', dialogName);\n        formData.append('default', dialogDefault.toString());\n\n        if (categoryToEdit === -1) {\n            client.post('/api/v1/category/', formData)\n                .finally(() => triggerUpdate());\n        } else {\n            const category = categories[categoryToEdit];\n            client.patch(`/api/v1/category/${category.id}`, formData)\n                .finally(() => triggerUpdate());\n        }\n    };\n\n    const deleteCategory = (index:number) => {\n        const category = categories[index];\n        client.delete(`/api/v1/category/${category.id}`)\n            .finally(() => triggerUpdate());\n    };\n\n    return (\n        <>\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <List ref={provided.innerRef}>\n                            {categories.map((item, index) => (\n                                <Draggable\n                                    key={item.id}\n                                    draggableId={item.id.toString()}\n                                    index={index}\n                                >\n                                    {(provided, snapshot) => (\n                                        <ListItem\n                                            ContainerProps={{ ref: provided.innerRef } as any}\n                                            {...provided.draggableProps}\n                                            {...provided.dragHandleProps}\n                                            style={getItemStyle(\n                                                snapshot.isDragging,\n                                                provided.draggableProps.style,\n                                                theme.palette,\n                                            )}\n                                            ref={provided.innerRef}\n                                        >\n                                            <ListItemIcon>\n                                                <DragHandleIcon />\n                                            </ListItemIcon>\n                                            <ListItemText\n                                                primary={item.name}\n                                            />\n                                            <IconButton\n                                                onClick={() => {\n                                                    handleEditDialogOpen(index);\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <EditIcon />\n                                            </IconButton>\n                                            <IconButton\n                                                onClick={() => {\n                                                    deleteCategory(index);\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <DeleteIcon />\n                                            </IconButton>\n                                        </ListItem>\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </List>\n                    )}\n                </Droppable>\n            </DragDropContext>\n            <Fab\n                color=\"primary\"\n                aria-label=\"add\"\n                style={{\n                    position: 'absolute',\n                    bottom: theme.spacing(2),\n                    right: theme.spacing(2),\n                }}\n                onClick={handleDialogOpen}\n            >\n                <AddIcon />\n            </Fab>\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogTitle id=\"form-dialog-title\">\n                    {categoryToEdit === -1 ? 'New Catalog' : 'Edit Catalog'}\n                </DialogTitle>\n                <DialogContent>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Category Name\"\n                        type=\"text\"\n                        fullWidth\n                        value={dialogName}\n                        onChange={(e) => setDialogName(e.target.value)}\n                    />\n                    <FormControlLabel\n                        control={(\n                            <Checkbox\n                                checked={dialogDefault}\n                                onChange={(e) => setDialogDefault(e.target.checked)}\n                                color=\"default\"\n                            />\n                        )}\n                        label=\"Default category when adding new manga to library\"\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        Submit\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport ReactDOM from 'react-dom';\nimport React from 'react';\nimport Slide, { SlideProps } from '@mui/material/Slide';\nimport Snackbar from '@mui/material/Snackbar';\nimport MuiAlert, { AlertColor as Severity } from '@mui/material/Alert';\n\nfunction removeToast(id: string) {\n    const container = document.querySelector(`#${id}`)!!;\n    ReactDOM.unmountComponentAtNode(container);\n    document.body.removeChild(container);\n}\n\nfunction Transition(props: SlideProps) {\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <Slide {...props} direction=\"up\" />;\n}\n\ninterface IToastProps{\n    message: string\n    severity: Severity\n}\n\nexport function Toast(props: IToastProps) {\n    const { message, severity } = props;\n    const [open, setOpen] = React.useState(true);\n\n    const handleClose = () => {\n        setOpen(false);\n    };\n\n    return (\n        <Snackbar\n            open={open}\n            onClose={handleClose}\n            autoHideDuration={3000}\n            TransitionComponent={Transition}\n            message=\"I love snacks\"\n        >\n            <MuiAlert elevation={6} variant=\"filled\" onClose={handleClose} severity={severity}>\n                {message}\n            </MuiAlert>\n        </Snackbar>\n    );\n}\n\nexport default function makeToast(message: string, severity: Severity) {\n    const id = Math.floor(Math.random() * 1000);\n    const container = document.createElement('div');\n    container.id = `alert-${id}`;\n\n    document.body.appendChild(container);\n\n    ReactDOM.render(<Toast message={message} severity={severity} />, container);\n\n    setTimeout(() => removeToast(container.id), 3500);\n}\n\nexport function makeToaster(\n    [toasts, setToasts] : [React.ReactElement[],\n        (arg0: React.ReactElement[]) => void],\n): [React.ReactElement[], ((message: string, severity: Severity) => void)] {\n    return [toasts, (message: string, severity: Severity) => {\n        setToasts([<Toast\n            key={Math.floor(Math.random() * 1000) + 1}\n            message={message}\n            severity={severity}\n        />]);\n    }];\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport { fromEvent } from 'file-selector';\nimport makeToast from 'components/util/Toast';\nimport ListItemLink from '../../components/util/ListItemLink';\nimport NavbarContext from '../../components/context/NavbarContext';\nimport client from '../../util/client';\n\nexport default function Backup() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Backup'); setAction(<></>); }, []);\n\n    const { baseURL } = client.defaults;\n\n    const submitBackup = (file: File) => {\n        if (file.name.toLowerCase().endsWith('proto.gz')) {\n            const formData = new FormData();\n            formData.append('backup.proto.gz', file);\n\n            makeToast('Restoring backup....', 'info');\n            client.post('/api/v1/backup/import/file',\n                formData, { headers: { 'Content-Type': 'multipart/form-data' } })\n                .then(() => makeToast('Backup restore finished!', 'success'))\n                .catch(() => makeToast('Backup restore failed!', 'error'));\n        } else if (file.name.toLowerCase().endsWith('json')) {\n            makeToast('legacy backups are not supported!', 'error');\n        } else {\n            makeToast('invalid file type!', 'error');\n        }\n    };\n\n    const dropHandler = async (e: Event) => {\n        e.preventDefault();\n        const files = await fromEvent(e);\n\n        submitBackup(files[0] as File);\n    };\n\n    const dragOverHandler = (e: Event) => {\n        e.preventDefault();\n    };\n\n    useEffect(() => {\n        document.addEventListener('drop', dropHandler);\n        document.addEventListener('dragover', dragOverHandler);\n\n        const input = document.getElementById('backup-file');\n        input?.addEventListener('change', async (evt) => {\n            const files = await fromEvent(evt);\n            submitBackup(files[0] as File);\n        });\n\n        return () => {\n            document.removeEventListener('drop', dropHandler);\n            document.removeEventListener('dragover', dragOverHandler);\n        };\n    }, []);\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                <ListItemLink to={`${baseURL}/api/v1/backup/export/file`} directLink>\n                    <ListItemText\n                        primary=\"Create Backup\"\n                        secondary=\"Backup library as a Tachiyomi backup\"\n                    />\n                </ListItemLink>\n                <ListItem button onClick={() => document.getElementById('backup-file')?.click()}>\n                    <ListItemText\n                        primary=\"Restore Backup\"\n                        secondary=\"You can also drag and drop the backup file here to restore\"\n                    />\n                </ListItem>\n            </List>\n            <input\n                type=\"file\"\n                id=\"backup-file\"\n                style={{ display: 'none' }}\n            />\n        </>\n\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport default function cloneObject<T extends object>(obj: T) {\n    return JSON.parse(JSON.stringify(obj)) as T;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n// adopted from: https://github.com/tachiyomiorg/tachiyomi/blob/master/app/src/main/java/eu/kanade/tachiyomi/widget/EmptyView.kt\n\nimport React from 'react';\nimport Typography from '@mui/material/Typography';\nimport { useTheme } from '@mui/material/styles';\nimport { useMediaQuery } from '@mui/material';\nimport { Box } from '@mui/system';\n\nconst ERROR_FACES = [\n    '(･o･;)',\n    'Σ(ಠ_ಠ)',\n    'ಥ_ಥ',\n    '(˘･_･˘)',\n    '(；￣Д￣)',\n    '(･Д･。',\n];\n\nfunction getRandomErrorFace() {\n    const randIndex = Math.floor(Math.random() * ERROR_FACES.length);\n    return ERROR_FACES[randIndex];\n}\n\ninterface IProps {\n    message: string\n    messageExtra?: JSX.Element\n}\n\nexport default function EmptyView({ message, messageExtra }: IProps) {\n    const theme = useTheme();\n    const isMobileWidth = useMediaQuery(theme.breakpoints.down('sm'));\n\n    return (\n        <Box sx={{\n            position: 'absolute',\n            left: `calc(50% + ${isMobileWidth ? '0px' : theme.spacing(8 / 2)})`,\n            top: '50%',\n            transform: 'translate(-50%, -50%)',\n            textAlign: 'center',\n        }}\n        >\n            <Typography variant=\"h3\" gutterBottom>\n                {getRandomErrorFace()}\n            </Typography>\n            <Typography variant=\"h5\">\n                {message}\n            </Typography>\n            {messageExtra}\n        </Box>\n    );\n}\n\nEmptyView.defaultProps = {\n    messageExtra: undefined,\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ninterface IProps {\n    children: React.ReactNode;\n    index: any;\n    currentIndex: any;\n}\n\nexport default function TabPanel(props: IProps) {\n    const {\n        children, index, currentIndex,\n    } = props;\n\n    return (\n        <div\n            role=\"tabpanel\"\n            hidden={index !== currentIndex}\n            id={`simple-tabpanel-${index}`}\n        >\n            {currentIndex === index && children}\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { Checkbox, createSvgIcon } from '@mui/material';\nimport React, {\n    useEffect, useState,\n} from 'react';\n\nexport interface IThreeStateCheckboxProps {\n    name: string\n    checked: boolean | undefined | null\n    onChange: (change: boolean | undefined | null, name: string) => void\n}\n\nenum CheckState {\n    SELECTED, INTERMEDIATE, UNSELECTED,\n}\n\nfunction checkedToState(checked: boolean | undefined | null): CheckState {\n    switch (checked) {\n        case true:\n            return CheckState.SELECTED;\n        case false:\n            return CheckState.INTERMEDIATE;\n        default:\n            return CheckState.UNSELECTED;\n    }\n}\nfunction stateToChecked(state: CheckState): boolean | undefined {\n    switch (state) {\n        case CheckState.SELECTED:\n            return true;\n        case CheckState.INTERMEDIATE:\n            return false;\n        default:\n        case CheckState.UNSELECTED:\n            return undefined;\n    }\n}\n\nfunction stateTransition(state: CheckState): CheckState {\n    switch (state) {\n        case CheckState.SELECTED:\n            return CheckState.INTERMEDIATE;\n        case CheckState.INTERMEDIATE:\n            return CheckState.UNSELECTED;\n        case CheckState.UNSELECTED:\n        default:\n            return CheckState.SELECTED;\n    }\n}\n\nconst ThreeStateCheckbox = (props: IThreeStateCheckboxProps) => {\n    const {\n        name, checked, onChange,\n    } = props;\n    const [localChecked, setLocalChecked] = useState(checkedToState(checked));\n    useEffect(() => setLocalChecked(checkedToState(checked)), [checked]);\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        setLocalChecked(stateTransition(localChecked));\n        if (onChange) {\n            onChange(stateToChecked(stateTransition(localChecked)), e.currentTarget.name);\n        }\n    };\n    const CancelBox = createSvgIcon(\n        <>\n            <path\n                d=\"M 19 6.41 L 13.41 12 L 19 17.59 L 17.59 19 L 12 13.41 L 6.41 19 V 19 H 6.41 L 5 17.59 L 11 12 L 5 6.41 L 6.41 5 L 12 10.59 L 17.59 5 L 19 6.41 M 5 5 m 0 -2 H 5 c -1.1 0 -2 0.9 -2 2 v 14 c 0 1.1 0.9 2 2 2 h 14 c 1.1 0 2 -0.9 2 -2 V 5 c 0 -1.1 -0.9 -2 -2 -2 z \"\n            />\n        </>,\n        'CancelBox',\n    );\n\n    return (\n        <Checkbox\n            name={name}\n            checked={localChecked === CheckState.SELECTED}\n            indeterminate={localChecked === CheckState.INTERMEDIATE}\n            indeterminateIcon={<CancelBox />}\n            onChange={handleChange}\n            className={`${localChecked}`}\n        />\n    );\n};\nexport default ThreeStateCheckbox;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { BooleanParam, useQueryParam, StringParam } from 'use-query-params';\n\ninterface IUseLibraryOptions {\n    downloaded: NullAndUndefined<boolean>\n    setDownloaded: (downloaded: NullAndUndefined<boolean>) => void\n    unread: NullAndUndefined<boolean>\n    setUnread: (unread: NullAndUndefined<boolean>) => void\n    query: NullAndUndefined<string>\n    setQuery: (query: NullAndUndefined<string>) => void\n    active: boolean\n    sorts: NullAndUndefined<string>\n    setSorts: (sorts: NullAndUndefined<string>) => void\n    sortDesc: NullAndUndefined<boolean>\n    setSortDesc: (sortDesc: NullAndUndefined<boolean>) => void\n}\n\nexport default function useLibraryOptions(): IUseLibraryOptions {\n    const [downloaded, setDownloaded] = useQueryParam('downloaded', BooleanParam);\n    const [unread, setUnread] = useQueryParam('unread', BooleanParam);\n    const [query, setQuery] = useQueryParam('query', StringParam);\n    const [sorts, setSorts] = useQueryParam('sorts', StringParam);\n    const [sortDesc, setSortDesc] = useQueryParam('sortDesc', BooleanParam);\n\n    // eslint-disable-next-line eqeqeq\n    const active = !(unread == undefined) || !(downloaded == undefined);\n    return {\n        downloaded,\n        setDownloaded,\n        unread,\n        setUnread,\n        query,\n        setQuery,\n        active,\n        sorts,\n        setSorts,\n        sortDesc,\n        setSortDesc,\n    };\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext } from 'react';\n\ntype ContextType = {\n    options: LibraryDisplayOptions;\n    setOptions: React.Dispatch<React.SetStateAction<LibraryDisplayOptions>>;\n};\n\nconst LibraryOptionsContext = React.createContext<ContextType>({\n    options: { showDownloadBadge: false, showUnreadBadge: false },\n    setOptions: () => {},\n});\n\nexport default LibraryOptionsContext;\n\nexport function useLibraryOptionsContext() {\n    return useContext(LibraryOptionsContext);\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React, { useState } from 'react';\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport {\n    Drawer,\n    FormControlLabel,\n    IconButton,\n    Tabs,\n    Tab,\n    Box,\n    Stack,\n    Checkbox,\n    Radio,\n    Switch,\n} from '@mui/material';\nimport useLibraryOptions from 'util/useLibraryOptions';\nimport ThreeStateCheckbox from 'components/util/ThreeStateCheckbox';\nimport TabPanel from 'components/util/TabPanel';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport SortIcon from '@mui/icons-material/Sort';\n\nfunction Options() {\n    const {\n        downloaded, setDownloaded, unread, setUnread,\n    } = useLibraryOptions();\n    const [currentTab, setCurrentTab] = useState<number>(0);\n    const { options, setOptions } = useLibraryOptionsContext();\n\n    function setContextOptions(\n        e: React.ChangeEvent<HTMLInputElement>,\n        checked: boolean,\n    ) {\n        setOptions((prev) => ({ ...prev, [e.target.name]: checked }));\n    }\n\n    return (\n        <Box>\n            <Tabs\n                key={currentTab}\n                value={currentTab}\n                variant=\"fullWidth\"\n                onChange={(e, newTab) => setCurrentTab(newTab)}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n            >\n                <Tab label=\"Filter\" value={0} />\n                <Tab label=\"Display\" value={1} />\n            </Tabs>\n            <TabPanel index={0} currentIndex={currentTab}>\n                <Stack direction=\"column\">\n                    <FormControlLabel\n                        control={(\n                            <ThreeStateCheckbox\n                                name=\"Unread\"\n                                checked={unread}\n                                onChange={setUnread}\n                            />\n                        )}\n                        label=\"Unread\"\n                    />\n                    <FormControlLabel\n                        control={(\n                            <ThreeStateCheckbox\n                                name=\"Downloaded\"\n                                checked={downloaded}\n                                onChange={setDownloaded}\n                            />\n                        )}\n                        label=\"Downloaded\"\n                    />\n                </Stack>\n            </TabPanel>\n            <TabPanel index={1} currentIndex={currentTab}>\n                <Stack direction=\"column\">\n                    <FormControlLabel\n                        label=\"Unread Badges\"\n                        control={(\n                            <Checkbox\n                                name=\"showUnreadBadge\"\n                                checked={options.showUnreadBadge}\n                                onChange={setContextOptions}\n                            />\n                        )}\n                    />\n                    <FormControlLabel\n                        label=\"Download Badges\"\n                        control={(\n                            <Checkbox\n                                name=\"showDownloadBadge\"\n                                checked={options.showDownloadBadge}\n                                onChange={setContextOptions}\n                            />\n                        )}\n                    />\n                </Stack>\n            </TabPanel>\n        </Box>\n    );\n}\n\nfunction SortOptions() {\n    const {\n        sorts, setSorts, sortDesc, setSortDesc,\n    } = useLibraryOptions();\n\n    const handleSortChange = (name: string) => (event: { target: { checked: boolean } }) => {\n        setSorts(event.target.checked ? name : undefined);\n    };\n\n    const handleOrderChange = () => (event: { target: { checked: boolean } }) => {\n        setSortDesc(event.target.checked);\n    };\n\n    return (\n        <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n            <FormControlLabel\n                control={(\n                    <Switch\n                        name=\"sortDesc\"\n                        checked={sortDesc === true}\n                        onChange={handleOrderChange()}\n                        color=\"default\"\n                    />\n                )}\n                label=\"Asc/Desc\"\n            />\n            <FormControlLabel\n                control={(\n                    <Radio\n                        name=\"sortToRead\"\n                        checked={sorts === 'sortToRead'}\n                        onChange={handleSortChange('sortToRead')}\n                    />\n                )}\n                label=\"Sort by left to read\"\n            />\n            <FormControlLabel\n                control={(\n                    <Radio\n                        name=\"sortAlph\"\n                        checked={sorts === 'sortAlph'}\n                        onChange={handleSortChange('sortAlph')}\n                    />\n                )}\n                label=\"Sort alphbetical\"\n            />\n            <FormControlLabel\n                control={(\n                    <Radio\n                        name=\"sortID\"\n                        checked={sorts === 'sortID' || sorts === undefined}\n                        onChange={handleSortChange('sortID')}\n                    />\n                )}\n                label=\"Sort by ID\"\n            />\n        </Box>\n    );\n}\n\nexport default function LibraryOptions() {\n    const [filtersOpen, setFiltersOpen] = React.useState(false);\n    const [sortsOpen, setSortsOpen] = React.useState(false);\n    const { active } = useLibraryOptions();\n    return (\n        <>\n            <IconButton\n                onClick={() => setFiltersOpen(!filtersOpen)}\n                color={active ? 'warning' : 'default'}\n            >\n                <FilterListIcon />\n            </IconButton>\n\n            <Drawer\n                anchor=\"bottom\"\n                open={filtersOpen}\n                onClose={() => setFiltersOpen(false)}\n                PaperProps={{\n                    style: {\n                        maxWidth: 600,\n                        padding: '1em',\n                        marginLeft: 'auto',\n                        marginRight: 'auto',\n                    },\n                }}\n            >\n                <Options />\n            </Drawer>\n\n            <IconButton\n                onClick={() => setSortsOpen(!filtersOpen)}\n                color={active ? 'warning' : 'default'}\n            >\n                <SortIcon />\n            </IconButton>\n\n            <Drawer\n                anchor=\"bottom\"\n                open={sortsOpen}\n                onClose={() => setSortsOpen(false)}\n                PaperProps={{\n                    style: {\n                        maxWidth: 600,\n                        padding: '1em',\n                        marginLeft: 'auto',\n                        marginRight: 'auto',\n                    },\n                }}\n            >\n                <SortOptions />\n            </Drawer>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState, CSSProperties } from 'react';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport Box from '@mui/system/Box';\nimport { Theme } from '@mui/system/createTheme';\nimport { SxProps } from '@mui/system/styleFunctionSx';\n\ninterface IProps {\n    src: string\n    alt: string\n\n    imgRef?: React.RefObject<HTMLImageElement>\n\n    spinnerStyle?: SxProps<Theme>\n    imgStyle?: CSSProperties\n\n    onImageLoad?: () => void\n}\n\nexport default function SpinnerImage(props: IProps) {\n    const {\n        src, alt, onImageLoad, imgRef, spinnerStyle, imgStyle,\n    } = props;\n    const [imageSrc, setImagsrc] = useState<string>('');\n\n    useEffect(() => {\n        const img = new Image();\n        img.src = src;\n\n        img.onload = () => {\n            setImagsrc(src);\n            onImageLoad?.();\n        };\n\n        img.onerror = () => {\n            // Setting to an actual image so CSS styling works consistently\n            setImagsrc('/notFound.svg');\n        };\n\n        return () => {\n            img.onload = null;\n            img.onerror = null;\n        };\n    }, [src]);\n\n    if (imageSrc.length === 0) {\n        return (\n            <Box sx={spinnerStyle}>\n                <CircularProgress thickness={5} />\n            </Box>\n        );\n    }\n\n    if (imageSrc === 'Not Found') {\n        return <Box sx={spinnerStyle} />;\n    }\n\n    return (\n        <img\n            style={imgStyle}\n            ref={imgRef}\n            src={imageSrc}\n            alt={alt}\n        />\n    );\n}\n\nSpinnerImage.defaultProps = {\n    spinnerStyle: {},\n    imgStyle: {},\n    onImageLoad: () => {},\n    imgRef: undefined,\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport Card from '@mui/material/Card';\nimport CardActionArea from '@mui/material/CardActionArea';\nimport Typography from '@mui/material/Typography';\nimport { Link } from 'react-router-dom';\nimport { Grid } from '@mui/material';\nimport useLocalStorage from 'util/useLocalStorage';\nimport SpinnerImage from 'components/util/SpinnerImage';\nimport { styled } from '@mui/system';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\n\nconst BottomGradient = styled('div')({\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: '30%',\n    background: 'linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%)',\n});\n\nconst BottomGradientDoubledDown = styled('div')({\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: '20%',\n    background: 'linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%)',\n});\n\nconst MangaTitle = styled(Typography)({\n    position: 'absolute',\n    bottom: 0,\n    padding: '0.5em',\n    color: 'white',\n    fontSize: '1.05rem',\n    textShadow: '0px 0px 3px #000000',\n});\n\nconst BadgeContainer = styled('div')({\n    display: 'flex',\n    position: 'absolute',\n    top: 5,\n    left: 5,\n    height: 'fit-content',\n    borderRadius: '5px',\n    overflow: 'hidden',\n    '& p': {\n        color: 'white',\n        padding: '0.1em',\n        paddingInline: '0.2em',\n        fontSize: '1.05rem',\n    },\n});\n\nconst truncateText = (str: string, maxLength: number) => {\n    const ending = '...';\n    // trim the string to the maximum length\n    const trimmedString = str.substr(0, maxLength - ending.length);\n\n    if (trimmedString.length < str.length) {\n        return trimmedString + ending;\n    }\n    return str;\n};\n\ninterface IProps {\n    manga: IMangaCard\n}\nconst MangaCard = React.forwardRef<HTMLDivElement, IProps>((props: IProps, ref) => {\n    const {\n        manga: {\n            id, title, thumbnailUrl, downloadCount, unreadCount: unread,\n        },\n    } = props;\n    const { options: { showUnreadBadge, showDownloadBadge } } = useLibraryOptionsContext();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    return (\n        <Grid item xs={6} sm={4} md={3} lg={2}>\n            <Link to={`/manga/${id}/`}>\n                <Card\n                    sx={{\n                        // force standard aspect ratio of manga covers\n                        aspectRatio: '225/350',\n                        display: 'flex',\n                    }}\n                    ref={ref}\n                >\n                    <CardActionArea\n                        sx={{\n                            position: 'relative',\n                            height: '100%',\n                        }}\n                    >\n\n                        <BadgeContainer>\n                            { showUnreadBadge && unread! > 0 && (\n                                <Typography\n                                    sx={{ backgroundColor: 'primary.dark' }}\n                                >\n                                    {unread}\n                                </Typography>\n                            )}\n                            { showDownloadBadge && downloadCount! > 0 && (\n                                <Typography sx={{\n                                    backgroundColor: 'success.dark',\n                                }}\n                                >\n                                    {downloadCount}\n                                </Typography>\n                            )}\n                        </BadgeContainer>\n                        <SpinnerImage\n                            alt={title}\n                            src={`${serverAddress}${thumbnailUrl}?useCache=${useCache}`}\n                            imgStyle={{\n                                height: '100%',\n                                width: '100%',\n                                objectFit: 'cover',\n                            }}\n                            spinnerStyle={{\n                                display: 'grid',\n                                placeItems: 'center',\n                            }}\n                        />\n                        <BottomGradient />\n                        <BottomGradientDoubledDown />\n\n                        <MangaTitle>\n                            {truncateText(title, 61)}\n                        </MangaTitle>\n                    </CardActionArea>\n                </Card>\n            </Link>\n        </Grid>\n    );\n});\n\nexport default MangaCard;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport Grid from '@mui/material/Grid';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport MangaCard from './MangaCard';\n\nexport interface IMangaGridProps{\n    mangas: IMangaCard[]\n    isLoading: boolean\n    message?: string\n    messageExtra?: JSX.Element\n    hasNextPage: boolean\n    lastPageNum: number\n    setLastPageNum: (lastPageNum: number) => void\n}\n\nexport default function MangaGrid(props: IMangaGridProps) {\n    const {\n        mangas, isLoading, message, messageExtra, hasNextPage, lastPageNum, setLastPageNum,\n    } = props;\n    let mapped;\n    const lastManga = useRef<HTMLDivElement>(null);\n\n    const scrollHandler = () => {\n        if (lastManga.current) {\n            const rect = lastManga.current.getBoundingClientRect();\n            if (((rect.y + rect.height) / window.innerHeight < 2) && hasNextPage) {\n                setLastPageNum(lastPageNum + 1);\n            }\n        }\n    };\n    useEffect(() => {\n        window.addEventListener('scroll', scrollHandler, true);\n        return () => {\n            window.removeEventListener('scroll', scrollHandler, true);\n        };\n    }, [hasNextPage, mangas]);\n\n    if (mangas.length === 0) {\n        if (isLoading) {\n            mapped = (\n                <LoadingPlaceholder />\n            );\n        } else {\n            mapped = (\n                <EmptyView message={message!} messageExtra={messageExtra} />\n            );\n        }\n    } else {\n        mapped = mangas.map((it, idx) => {\n            if (idx === mangas.length - 1) {\n                return (\n                    <MangaCard\n                        key={it.id}\n                        manga={it}\n                        ref={lastManga}\n                    />\n                );\n            }\n            return (\n                <MangaCard\n                    key={it.id}\n                    manga={it}\n                />\n            );\n        });\n    }\n\n    return (\n        <Grid container spacing={1} style={{ margin: 0, width: '100%', padding: '5px' }}>\n            {mapped}\n        </Grid>\n    );\n}\n\nMangaGrid.defaultProps = {\n    message: '',\n    messageExtra: undefined,\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React from 'react';\nimport MangaGrid, { IMangaGridProps } from 'components/MangaGrid';\nimport useLibraryOptions from 'util/useLibraryOptions';\n\nconst FILTERED_OUT_MESSAGE = 'There are no Manga matching this filter';\n\nfunction unreadFilter(unread: NullAndUndefined<boolean>, { unreadCount }: IMangaCard): boolean {\n    switch (unread) {\n        case true:\n            return !!unreadCount && unreadCount >= 1;\n        case false:\n            return unreadCount === 0;\n        default:\n            return true;\n    }\n}\n\nfunction downloadedFilter(downloaded: NullAndUndefined<boolean>,\n    { downloadCount }: IMangaCard): boolean {\n    switch (downloaded) {\n        case true:\n            return !!downloadCount && downloadCount >= 1;\n        case false:\n            return downloadCount === 0;\n        default:\n            return true;\n    }\n}\n\nfunction queryFilter(query: NullAndUndefined<string>, { title }: IMangaCard): boolean {\n    if (!query) return true;\n    return title.toLowerCase().includes(query.toLowerCase());\n}\n\nfunction filterManga(mangas: IMangaCard[]): IMangaCard[] {\n    const { downloaded, unread, query } = useLibraryOptions();\n    return mangas\n        .filter((manga) => downloadedFilter(downloaded, manga)\n        && unreadFilter(unread, manga)\n        && queryFilter(query, manga));\n}\n\nfunction toReadSort(a: IMangaCard, b: IMangaCard): number {\n    if (!a.unreadCount) return -1;\n    if (!b.unreadCount) return 1;\n    return a.unreadCount > b.unreadCount ? 1 : -1;\n}\n\nfunction toSortAlph(a: IMangaCard, b: IMangaCard): number {\n    return a.title < b.title ? 1 : -1;\n}\n\nfunction toSortID(a: IMangaCard, b: IMangaCard): number {\n    return a.id > b.id ? 1 : -1;\n}\n\nfunction sortManga(mangas: IMangaCard[]): IMangaCard[] {\n    const { sorts, sortDesc } = useLibraryOptions();\n    return (sorts === 'sortID' || sorts === undefined) && !sortDesc ? mangas : mangas.sort((a, b) => {\n        const c = sortDesc === true ? b : a;\n        const d = sortDesc === true ? a : b;\n        if (sorts === 'sortToRead') { return toReadSort(c, d); }\n        if (sorts === 'sortAlph') { return toSortAlph(c, d); }\n        if (sorts === 'sortID' || sorts === undefined) { return toSortID(c, d); }\n        return 1;\n    });\n}\n\nexport default function LibraryMangaGrid(props: IMangaGridProps) {\n    const {\n        mangas, isLoading, hasNextPage, lastPageNum, setLastPageNum, message,\n    } = props;\n\n    const { active, query } = useLibraryOptions();\n    const filteredManga = filterManga(mangas);\n    const sortedManga = sortManga(filteredManga);\n    const showFilteredOutMessage = (active || query)\n        && filteredManga.length === 0 && mangas.length > 0;\n\n    return (\n        <MangaGrid\n            mangas={sortedManga}\n            isLoading={isLoading}\n            hasNextPage={hasNextPage}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n            message={showFilteredOutMessage ? FILTERED_OUT_MESSAGE : message}\n        />\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { IconButton, Input } from '@mui/material';\nimport CancelIcon from '@mui/icons-material/Cancel';\nimport { useQueryParam, StringParam } from 'use-query-params';\n\nexport default function AppbarSearch() {\n    const [query, setQuery] = useQueryParam('query', StringParam);\n    const [searchOpen, setSearchOpen] = useState(!!query);\n    const inputRef = React.useRef<HTMLInputElement>();\n\n    function handleChange(e: React.ChangeEvent<HTMLInputElement>) {\n        setQuery(e.target.value === '' ? undefined : e.target.value);\n    }\n    const cancelSearch = () => {\n        setQuery(null);\n        setSearchOpen(false);\n    };\n    const handleBlur = () => { if (!query) setSearchOpen(false); };\n    const openSearch = () => {\n        setSearchOpen(true);\n        // Put Focus Action at the end of the Callstack so Input actually exists on the dom\n        setTimeout(() => {\n            if (inputRef && inputRef.current) inputRef.current.focus();\n        });\n    };\n\n    const handleSearchShortcut = (e: KeyboardEvent) => {\n        if ((e.code === 'F3') || (e.ctrlKey && e.code === 'KeyF')) {\n            e.preventDefault();\n            openSearch();\n        }\n    };\n\n    useEffect(() => {\n        window.addEventListener('keydown', handleSearchShortcut);\n\n        return () => {\n            window.removeEventListener('keydown', handleSearchShortcut);\n        };\n    }, [handleSearchShortcut]);\n\n    return (\n        <>\n            {searchOpen\n                ? (\n                    <Input\n                        value={query || ''}\n                        onChange={handleChange}\n                        onBlur={handleBlur}\n                        inputRef={inputRef}\n                        endAdornment={(\n                            <IconButton\n                                onClick={cancelSearch}\n                            >\n                                <CancelIcon />\n                            </IconButton>\n                        )}\n                    />\n                ) : (\n                    <IconButton onClick={openSearch}>\n                        <SearchIcon />\n                    </IconButton>\n                )}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Tab, Tabs } from '@mui/material';\nimport React, { useContext, useEffect, useState } from 'react';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport cloneObject from 'util/cloneObject';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport TabPanel from 'components/util/TabPanel';\nimport LibraryOptions from 'components/library/LibraryOptions';\nimport LibraryMangaGrid from 'components/library/LibraryMangaGrid';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport { useQueryParam, NumberParam } from 'use-query-params';\n\ninterface IMangaCategory {\n    category: ICategory\n    mangas: IManga[]\n    isFetched: boolean\n}\n\nexport default function Library() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => {\n        setTitle('Library'); setAction(\n            <>\n                <AppbarSearch />\n                <LibraryOptions />\n            </>,\n        );\n    }, []);\n\n    const [tabs, setTabs] = useState<IMangaCategory[]>();\n\n    const [tabNum, setTabNum] = useState<number>(0);\n    const [tabSearchParam, setTabSearchParam] = useQueryParam('tab', NumberParam);\n\n    // a hack so MangaGrid doesn't stop working. I won't change it in case\n    // if I do manga pagination for library..\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n\n    const handleTabChange = (newTab: number) => {\n        setTabNum(newTab);\n        setTabSearchParam(newTab);\n    };\n\n    useEffect(() => {\n        client.get('/api/v1/category')\n            .then((response) => response.data)\n            .then((categories: ICategory[]) => {\n                const categoryTabs = categories.map((category) => ({\n                    category,\n                    mangas: [] as IManga[],\n                    isFetched: false,\n                }));\n                setTabs(categoryTabs);\n                if (categoryTabs.length > 0) {\n                    if (\n                        tabSearchParam !== undefined\n                         && tabSearchParam !== null\n                         && !Number.isNaN(tabSearchParam)\n                         && categories.some((category) => category.order === Number(tabSearchParam))\n                    ) {\n                        handleTabChange(Number(tabSearchParam!));\n                    } else { handleTabChange(categoryTabs[0].category.order); }\n                }\n            });\n    }, []);\n\n    // fetch the current tab\n    useEffect(() => {\n        if (tabs !== undefined) {\n            tabs.forEach((tab, index) => {\n                if (tab.category.order === tabNum && !tab.isFetched) {\n                    // eslint-disable-next-line @typescript-eslint/no-shadow\n                    client.get(`/api/v1/category/${tab.category.id}`)\n                        .then((response) => response.data)\n                        .then((data: IManga[]) => {\n                            const tabsClone = cloneObject(tabs);\n                            tabsClone[index].mangas = data;\n                            tabsClone[index].isFetched = true;\n\n                            setTabs(tabsClone);\n                        });\n                }\n            });\n        }\n    }, [tabs?.length, tabNum]);\n\n    if (tabs === undefined) {\n        return <LoadingPlaceholder />;\n    }\n\n    if (tabs.length === 0) {\n        return <EmptyView message=\"Your Library is empty\" />;\n    }\n\n    let toRender;\n    if (tabs.length > 1) {\n        // eslint-disable-next-line max-len\n        const tabDefines = tabs.map((tab) => (<Tab label={tab.category.name} value={tab.category.order} />));\n\n        const tabBodies = tabs.map((tab) => (\n            <TabPanel index={tab.category.order} currentIndex={tabNum}>\n                <LibraryMangaGrid\n                    mangas={tab.mangas}\n                    hasNextPage={false}\n                    lastPageNum={lastPageNum}\n                    setLastPageNum={setLastPageNum}\n                    message=\"Category is Empty\"\n                    isLoading={!tab.isFetched}\n                />\n            </TabPanel>\n        ));\n\n        // Visual Hack: 160px is min-width for viewport width of >600\n        const scrollableTabs = window.innerWidth < tabs.length * 160;\n        toRender = (\n            <>\n                <Tabs\n                    key={tabNum}\n                    value={tabNum}\n                    onChange={(e, newTab) => handleTabChange(newTab)}\n                    indicatorColor=\"primary\"\n                    textColor=\"primary\"\n                    centered={!scrollableTabs}\n                    variant={scrollableTabs ? 'scrollable' : 'fullWidth'}\n                    scrollButtons\n                    allowScrollButtonsMobile\n                >\n                    {tabDefines}\n                </Tabs>\n                {tabBodies}\n            </>\n        );\n    } else {\n        const mangas = tabs.length === 1 ? tabs[0].mangas : [];\n        toRender = (\n            <LibraryMangaGrid\n                mangas={mangas}\n                hasNextPage={false}\n                lastPageNum={lastPageNum}\n                setLastPageNum={setLastPageNum}\n                message=\"Your Library is empty\"\n                isLoading={!tabs[0].isFetched}\n            />\n        );\n    }\n\n    return toRender;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport TextField from '@mui/material/TextField';\nimport Button from '@mui/material/Button';\nimport { useParams } from 'react-router-dom';\nimport MangaGrid from 'components/MangaGrid';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport { Box } from '@mui/system';\n\nexport default function SearchSingle() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Search'); setAction(<></>); }, []);\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const [error, setError] = useState<boolean>(false);\n    const [mangas, setMangas] = useState<IMangaCard[]>([]);\n    const [message, setMessage] = useState<string>('');\n    const [searchTerm, setSearchTerm] = useState<string>('');\n    const [hasNextPage, setHasNextPage] = useState<boolean>(false);\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n    const [isLoading, setIsLoading] = useState<boolean>(false);\n\n    const textInput = React.createRef<HTMLInputElement>();\n\n    useEffect(() => {\n        client.get(`/api/v1/source/${sourceId}`)\n            .then((response) => response.data)\n            .then((data: { name: string }) => setTitle(`Search: ${data.name}`));\n    }, []);\n\n    function resetSearch() {\n        setIsLoading(true);\n        setMangas([]);\n        setLastPageNum(1);\n    }\n\n    function processInput() {\n        if (textInput.current) {\n            const { value } = textInput.current;\n            if (value === '') {\n                setError(true);\n            } else {\n                setError(false);\n                setSearchTerm(value);\n                resetSearch();\n            }\n        }\n    }\n\n    useEffect(() => {\n        if (searchTerm.length > 0) {\n            client.get(`/api/v1/source/${sourceId}/search`, { params: { searchTerm, pageNum: lastPageNum } })\n                .then((response) => response.data)\n                .then((data: { mangaList: IManga[], hasNextPage: boolean }) => {\n                    if (data.mangaList.length > 0) {\n                        setMangas([\n                            ...mangas,\n                            ...data.mangaList.map((it) => ({\n                                title: it.title, thumbnailUrl: it.thumbnailUrl, id: it.id,\n                            }))]);\n                        setHasNextPage(data.hasNextPage);\n                    } else {\n                        setMessage('Search query returned nothing.');\n                    }\n\n                    setIsLoading(false);\n                });\n        }\n    }, [searchTerm, lastPageNum]);\n\n    return (\n        <>\n            <Box sx={{\n                margin: '20px 10px',\n                display: 'flex',\n                width: '400px',\n                maxWidth: 'calc(100% - 20px)',\n            }}\n            >\n                <TextField\n                    inputRef={textInput}\n                    error={error}\n                    sx={{\n                        mx: 1,\n                        flexGrow: 1,\n                    }}\n                    id=\"filled-basic\"\n                    variant=\"filled\"\n                    size=\"small\"\n                    label=\"Search text..\"\n                    onKeyDown={(e) => e.key === 'Enter' && processInput()}\n                />\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    onClick={() => processInput()}\n                >\n                    Search\n                </Button>\n            </Box>\n            {searchTerm.length > 0\n        && (\n            <MangaGrid\n                mangas={mangas}\n                message={message}\n                hasNextPage={hasNextPage}\n                lastPageNum={lastPageNum}\n                setLastPageNum={setLastPageNum}\n                isLoading={isLoading}\n            />\n        )}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Switch from '@mui/material/Switch';\nimport Checkbox from '@mui/material/Checkbox';\n\nfunction getTwoStateType(type: 'Checkbox' | 'Switch') {\n    if (type === 'Switch') { return Switch; }\n    return Checkbox;\n}\n\nfunction TwoSatePreference(props: TwoStatePreferenceProps) {\n    const {\n        title, summary, currentValue, updateValue, type,\n    } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<boolean>(currentValue);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    return (\n        <ListItem>\n            <ListItemText primary={title} secondary={summary} />\n            <ListItemSecondaryAction>\n                {React.createElement(getTwoStateType(type),\n                    {\n                        edge: 'end',\n                        checked: internalCurrentValue,\n                        onChange: () => {\n                            updateValue(!currentValue);\n\n                            // appear smooth\n                            setInternalCurrentValue(!currentValue);\n                        },\n                    })}\n            </ListItemSecondaryAction>\n        </ListItem>\n    );\n}\n\nexport function CheckBoxPreference(props: CheckBoxPreferenceProps) {\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <TwoSatePreference {...props} type=\"Checkbox\" />;\n}\nexport function SwitchPreferenceCompat(props: SwitchPreferenceCompatProps) {\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <TwoSatePreference {...props} type=\"Switch\" />;\n}\n\nexport default { CheckBoxPreference, SwitchPreferenceCompat };\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport RadioGroup from '@mui/material/RadioGroup';\nimport Radio from '@mui/material/Radio';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Button from '@mui/material/Button';\n\ninterface IListDialogProps{\n    value: string\n    open: boolean\n    onClose: (arg0: string | null) => void\n    options: string[]\n    title: string\n}\n\nfunction ListDialog(props: IListDialogProps) {\n    const {\n        value: valueProp, open, onClose, options, title,\n    } = props;\n    const [value, setValue] = React.useState(valueProp);\n    const radioGroupRef = React.useRef<HTMLDivElement>(null);\n\n    React.useEffect(() => {\n        if (!open) {\n            setValue(valueProp);\n        }\n    }, [valueProp, open]);\n\n    const handleEntering = () => {\n        if (radioGroupRef.current != null) {\n            radioGroupRef?.current.focus();\n        }\n    };\n\n    const handleCancel = () => {\n        onClose(null);\n    };\n\n    const handleOk = () => {\n        onClose(value);\n    };\n\n    const handleChange = (event: any) => {\n        setValue(event.target.value);\n    };\n\n    return (\n        <Dialog\n            sx={{ '& .MuiDialog-paper': { width: '80%', maxHeight: 435 } }}\n            maxWidth=\"xs\"\n            TransitionProps={{ onEntering: handleEntering }}\n            open={open}\n        >\n            <DialogTitle>{title}</DialogTitle>\n            <DialogContent dividers>\n                <RadioGroup\n                    ref={radioGroupRef}\n                    value={value}\n                    onChange={handleChange}\n                >\n                    {options.map((option) => (\n                        <FormControlLabel\n                            value={option}\n                            key={option}\n                            control={<Radio />}\n                            label={option}\n                        />\n                    ))}\n                </RadioGroup>\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel}>\n                    Cancel\n                </Button>\n                <Button onClick={handleOk}>Ok</Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n\nexport default function ListPreference(props: ListPreferenceProps) {\n    const {\n        title, summary, currentValue, updateValue, entryValues, entries,\n    } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    const findEntryOf = (value: string) => {\n        const idx = entryValues.indexOf(value);\n        return entries[idx];\n    };\n\n    const findEntryValueOf = (value: string) => {\n        const idx = entries.indexOf(value);\n        return entryValues[idx];\n    };\n\n    const getSummary = () => {\n        if (summary === '%s') {\n            return findEntryOf(currentValue);\n        }\n        return summary;\n    };\n\n    const handleDialogClose = (newValue: string | null) => {\n        if (newValue !== null) {\n            updateValue(findEntryValueOf(newValue));\n\n            // appear smooth\n            setInternalCurrentValue(newValue);\n        }\n\n        setDialogOpen(false);\n    };\n\n    return (\n        <>\n            <ListItem\n                button\n                onClick={() => setDialogOpen(true)}\n            >\n                <ListItemText primary={title} secondary={getSummary()} />\n            </ListItem>\n            <ListDialog\n                title={title}\n                open={dialogOpen}\n                onClose={handleDialogClose}\n                value={findEntryOf(internalCurrentValue)}\n                options={entries}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport DialogActions from '@mui/material/DialogActions';\nimport TextField from '@mui/material/TextField';\nimport Button from '@mui/material/Button';\n\nexport default function EditTextPreference(props: EditTextPreferenceProps) {\n    const {\n        title, summary, dialogTitle, dialogMessage, currentValue, updateValue,\n    } = props;\n\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n\n        // reset the dialog\n        setInternalCurrentValue(currentValue);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n\n        updateValue(internalCurrentValue);\n    };\n\n    return (\n        <>\n            <ListItem\n                button\n                onClick={() => setDialogOpen(true)}\n            >\n                <ListItemText\n                    primary={title}\n                    secondary={summary}\n                />\n            </ListItem>\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogTitle>\n                    {dialogTitle}\n                </DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        {dialogMessage}\n                    </DialogContentText>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        type=\"text\"\n                        fullWidth\n                        value={internalCurrentValue}\n                        onChange={(e) => setInternalCurrentValue(e.target.value)}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        OK\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport FormGroup from '@mui/material/FormGroup';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Button from '@mui/material/Button';\nimport cloneObject from 'util/cloneObject';\n\ninterface IListDialogProps{\n    selectedValues: string[]\n    open: boolean\n    onClose: (arg0: string[] | null) => void\n    values: string[]\n    title: string\n}\n\nfunction ListDialog(props: IListDialogProps) {\n    const {\n        selectedValues: selectedValuesProp, open, onClose, values, title,\n    } = props;\n    const [selectedValues, setSelectedValues] = React.useState(selectedValuesProp);\n\n    React.useEffect(() => {\n        if (!open) {\n            setSelectedValues(selectedValuesProp);\n        }\n    }, [selectedValuesProp, open]);\n\n    const handleCancel = () => {\n        onClose(null);\n    };\n\n    const handleOk = () => {\n        onClose(selectedValues);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, value: string) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        const hasEntry = selectedValues.some((selectedValue) => value === selectedValue);\n        if (checked) {\n            if (!hasEntry) {\n                const selectedValuesClone = cloneObject(selectedValues) as string[];\n                selectedValuesClone.push(value);\n                setSelectedValues(selectedValuesClone);\n            }\n        } else if (hasEntry) { // not checked and has entry\n            const selectedValuesClone = cloneObject(selectedValues) as string[];\n            const index = selectedValuesClone.indexOf(value);\n            selectedValuesClone.splice(index, 1);\n            setSelectedValues(selectedValuesClone);\n        }\n    };\n\n    return (\n        <Dialog\n            sx={{ '& .MuiDialog-paper': { width: '80%', maxHeight: 435 } }}\n            maxWidth=\"xs\"\n            open={open}\n        >\n            <DialogTitle>{title}</DialogTitle>\n            <DialogContent dividers>\n                <FormGroup>\n                    {values.map((value) => (\n                        <FormControlLabel\n                            control={(\n                                <Checkbox\n                                    checked={selectedValues.some(\n                                        (selectedValue) => value === selectedValue,\n                                    )}\n                                    onChange={(e) => handleChange(e, value)}\n                                    color=\"default\"\n                                />\n                            )}\n                            label={value}\n                            key={value}\n                        />\n                    ))}\n                </FormGroup>\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel}>\n                    Cancel\n                </Button>\n                <Button onClick={handleOk}>Ok</Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n\nexport default function MultiSelectListPreference(props: MultiSelectListPreferenceProps) {\n    const {\n        title, summary, currentValue, updateValue, entryValues, entries,\n    } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string[]>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    const findEntriesOf = (values: string[]) => values.map((value) => {\n        const idx = entryValues.indexOf(value);\n        return entries[idx];\n    });\n\n    const findEntryValuesOf = (values: string[]) => values.map((value) => {\n        const idx = entries.indexOf(value);\n        return entryValues[idx];\n    });\n\n    const getSummary = () => summary;\n\n    const handleDialogClose = (newValue: string[] | null) => {\n        if (newValue !== null) {\n            // console.log(newValue);\n            updateValue(findEntryValuesOf(newValue));\n\n            // appear smooth\n            setInternalCurrentValue(newValue);\n        }\n\n        setDialogOpen(false);\n    };\n\n    return (\n        <>\n            <ListItem\n                button\n                onClick={() => setDialogOpen(true)}\n            >\n                <ListItemText primary={title} secondary={getSummary()} />\n            </ListItem>\n            <ListDialog\n                title={title}\n                open={dialogOpen}\n                onClose={handleDialogClose}\n                selectedValues={findEntriesOf(internalCurrentValue)}\n                values={entries}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport NavbarContext from 'components/context/NavbarContext';\nimport { useParams } from 'react-router-dom';\nimport client from 'util/client';\nimport { SwitchPreferenceCompat, CheckBoxPreference } from 'components/sourceConfiguration/TwoStatePreference';\nimport ListPreference from 'components/sourceConfiguration/ListPreference';\nimport EditTextPreference from 'components/sourceConfiguration/EditTextPreference';\nimport MultiSelectListPreference from 'components/sourceConfiguration/MultiSelectListPreference';\nimport List from '@mui/material/List';\nimport cloneObject from 'util/cloneObject';\n\nfunction getPrefComponent(type: string) {\n    switch (type) {\n        case 'CheckBoxPreference':\n            return CheckBoxPreference;\n        case 'SwitchPreferenceCompat':\n            return SwitchPreferenceCompat;\n        case 'ListPreference':\n            return ListPreference;\n        case 'EditTextPreference':\n            return EditTextPreference;\n        case 'MultiSelectListPreference':\n            return MultiSelectListPreference;\n        default:\n            return CheckBoxPreference;\n    }\n}\n\nexport default function SourceConfigure() {\n    const [sourcePreferences, setSourcePreferences] = useState<SourcePreferences[]>([]);\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const [updateTriggerHolder, setUpdateTriggerHolder] = useState<number>(0); // just a hack\n    const triggerUpdate = () => setUpdateTriggerHolder(updateTriggerHolder + 1); // just a hack\n\n    useEffect(() => { setTitle('Source Configuration'); setAction(<></>); }, []);\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n\n    useEffect(() => {\n        client.get(`/api/v1/source/${sourceId}/preferences`)\n            .then((response) => response.data)\n            .then((data) => setSourcePreferences(data));\n    }, [updateTriggerHolder]);\n\n    const convertToString = (position: number, value: any): string => {\n        switch (sourcePreferences[position].props.defaultValueType) {\n            case 'Set<String>':\n                return JSON.stringify(value);\n            default:\n                return value.toString();\n        }\n    };\n\n    const updateValue = (position: number) => (\n        (value: any) => {\n            client.post(`/api/v1/source/${sourceId}/preferences`,\n                JSON.stringify({ position, value: convertToString(position, value) }))\n                .then(() => triggerUpdate());\n        }\n    );\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                {sourcePreferences.map(\n                    (it, index) => {\n                        const props = cloneObject(it.props);\n                        props.updateValue = updateValue(index);\n                        props.key = index;\n\n                        // TypeScript is dumb in detecting extra props\n                        // @ts-ignore\n                        return React.createElement(getPrefComponent(it.type), props);\n                    },\n                )}\n            </List>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState } from 'react';\nimport Button from '@mui/material/Button';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport Dialog from '@mui/material/Dialog';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport FormGroup from '@mui/material/FormGroup';\nimport client from 'util/client';\n\ninterface IProps {\n    open: boolean\n    setOpen: (value: boolean) => void\n    mangaId: number\n}\n\ninterface ICategoryInfo {\n    category: ICategory\n    selected: boolean\n}\n\nexport default function CategorySelect(props: IProps) {\n    const { open, setOpen, mangaId } = props;\n    const [categoryInfos, setCategoryInfos] = useState<ICategoryInfo[]>([]);\n\n    const [updateTriggerHolder, setUpdateTriggerHolder] = useState(0); // just a hack\n    const triggerUpdate = () => setUpdateTriggerHolder(updateTriggerHolder + 1); // just a hack\n\n    useEffect(() => {\n        let tmpCategoryInfos: ICategoryInfo[] = [];\n        client.get('/api/v1/category/')\n            .then((response) => response.data)\n            .then((data: ICategory[]) => {\n                if (data.length > 0 && data[0].name === 'Default') { data.shift(); }\n                tmpCategoryInfos = data.map((category) => ({ category, selected: false }));\n            })\n            .then(() => {\n                client.get(`/api/v1/manga/${mangaId}/category/`)\n                    .then((response) => response.data)\n                    .then((data: ICategory[]) => {\n                        data.forEach((category) => {\n                            tmpCategoryInfos[category.order - 1].selected = true;\n                        });\n                        setCategoryInfos(tmpCategoryInfos);\n                    });\n            });\n    }, [updateTriggerHolder, open]);\n\n    const handleCancel = () => {\n        setOpen(false);\n    };\n\n    const handleOk = () => {\n        setOpen(false);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, categoryId: number) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        const method = checked ? client.get : client.delete;\n        method(`/api/v1/manga/${mangaId}/category/${categoryId}`)\n            .then(() => triggerUpdate());\n    };\n\n    return (\n        <Dialog\n            sx={{\n                '.MuiDialog-paper': {\n                    maxHeight: 435,\n                    width: '80%',\n                },\n            }}\n            maxWidth=\"xs\"\n            open={open}\n        >\n            <DialogTitle>Set categories</DialogTitle>\n            <DialogContent dividers>\n                <FormGroup>\n                    {categoryInfos.length === 0\n                        && (\n                            <span>\n                                No categories found!\n                                <br />\n                                You should make some from settings.\n                            </span>\n                        )}\n                    {categoryInfos.map((categoryInfo) => (\n                        <FormControlLabel\n                            control={(\n                                <Checkbox\n                                    checked={categoryInfo.selected}\n                                    onChange={(e) => handleChange(e, categoryInfo.category.id)}\n                                    color=\"default\"\n                                />\n                            )}\n                            label={categoryInfo.category.name}\n                            key={categoryInfo.category.id}\n                        />\n                    ))}\n                </FormGroup>\n\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel} color=\"primary\">\n                    Cancel\n                </Button>\n                <Button onClick={handleOk} color=\"primary\">\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport makeStyles from '@mui/styles/makeStyles';\nimport IconButton from '@mui/material/IconButton';\nimport { Theme } from '@mui/material/styles';\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport FavoriteBorderIcon from '@mui/icons-material/FavoriteBorder';\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport PublicIcon from '@mui/icons-material/Public';\nimport React, { useContext, useEffect, useState } from 'react';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport CategorySelect from './navbar/action/CategorySelect';\n\nconst useStyles = (inLibrary: string) => makeStyles((theme: Theme) => ({\n    root: {\n        width: '100%',\n        [theme.breakpoints.up('md')]: {\n            position: 'sticky',\n            top: '64px',\n            left: '0px',\n            width: '50vw',\n            height: 'calc(100vh - 64px)',\n            alignSelf: 'flex-start',\n            overflowY: 'auto',\n        },\n    },\n    top: {\n        padding: '10px',\n        // [theme.breakpoints.up('md')]: {\n        //     minWidth: '50%',\n        // },\n    },\n    leftRight: {\n        display: 'flex',\n    },\n    leftSide: {\n        '& img': {\n            borderRadius: 4,\n            maxWidth: '100%',\n            minWidth: '100%',\n            height: 'auto',\n        },\n        maxWidth: '50%',\n        // [theme.breakpoints.up('md')]: {\n        //     minWidth: '100px',\n        // },\n    },\n    rightSide: {\n        marginLeft: 15,\n        maxWidth: '100%',\n        '& span': {\n            fontWeight: '400',\n        },\n        [theme.breakpoints.up('lg')]: {\n            fontSize: '1.3em',\n        },\n    },\n    buttons: {\n        display: 'flex',\n        justifyContent: 'space-around',\n        '& button': {\n            color: inLibrary === 'In Library' ? '#2196f3' : 'inherit',\n        },\n        '& span': {\n            display: 'block',\n            fontSize: '0.85em',\n        },\n        '& a': {\n            textDecoration: 'none',\n            color: '#858585',\n            '& button': {\n                color: 'inherit',\n            },\n        },\n    },\n    bottom: {\n        paddingLeft: '10px',\n        paddingRight: '10px',\n        [theme.breakpoints.up('md')]: {\n            fontSize: '1.2em',\n            // maxWidth: '50%',\n        },\n        [theme.breakpoints.up('lg')]: {\n            fontSize: '1.3em',\n        },\n    },\n    description: {\n        '& h4': {\n            marginTop: '1em',\n            marginBottom: 0,\n        },\n        '& p': {\n            textAlign: 'justify',\n            textJustify: 'inter-word',\n        },\n    },\n    genre: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        '& h5': {\n            border: '2px solid #2196f3',\n            borderRadius: '1.13em',\n            marginRight: '1em',\n            marginTop: 0,\n            marginBottom: '10px',\n            padding: '0.3em',\n            color: '#2196f3',\n        },\n    },\n}));\n\ninterface IProps{\n    manga: IManga\n}\n\nfunction getSourceName(source: ISource) {\n    if (source.displayName !== null) {\n        return source.displayName;\n    }\n    return source.id;\n}\n\nfunction getValueOrUnknown(val: string) {\n    return val || 'UNKNOWN';\n}\n\nexport default function MangaDetails(props: IProps) {\n    const { setAction } = useContext(NavbarContext);\n\n    const { manga } = props;\n\n    const [inLibrary, setInLibrary] = useState<string>(\n        manga.inLibrary ? 'In Library' : 'Add To Library',\n    );\n\n    const [categoryDialogOpen, setCategoryDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        if (inLibrary === 'In Library') {\n            setAction(\n                <>\n                    <IconButton\n                        onClick={() => setCategoryDialogOpen(true)}\n                        aria-label=\"display more actions\"\n                        edge=\"end\"\n                        color=\"inherit\"\n                        size=\"large\"\n                    >\n                        <FilterListIcon />\n                    </IconButton>\n                    <CategorySelect\n                        open={categoryDialogOpen}\n                        setOpen={setCategoryDialogOpen}\n                        mangaId={manga.id}\n                    />\n                </>,\n\n            );\n        } else { setAction(<></>); }\n    }, [inLibrary, categoryDialogOpen]);\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const classes = useStyles(inLibrary)();\n\n    function addToLibrary() {\n        // setInLibrary('adding');\n        client.get(`/api/v1/manga/${manga.id}/library/`).then(() => {\n            setInLibrary('In Library');\n        });\n    }\n\n    function removeFromLibrary() {\n        // setInLibrary('removing');\n        client.delete(`/api/v1/manga/${manga.id}/library/`).then(() => {\n            setInLibrary('Add To Library');\n        });\n    }\n\n    function handleButtonClick() {\n        if (inLibrary === 'Add To Library') {\n            addToLibrary();\n        } else {\n            removeFromLibrary();\n        }\n    }\n\n    return (\n        <div className={classes.root}>\n            <div className={classes.top}>\n                <div className={classes.leftRight}>\n                    <div className={classes.leftSide}>\n                        <img src={`${serverAddress}${manga.thumbnailUrl}?useCache=${useCache}`} alt=\"Manga Thumbnail\" />\n                    </div>\n                    <div className={classes.rightSide}>\n                        <h1>\n                            {manga.title}\n                        </h1>\n                        <h3>\n                            {'Author: '}\n                            <span>{getValueOrUnknown(manga.author)}</span>\n                        </h3>\n                        <h3>\n                            {'Artist: '}\n                            <span>{getValueOrUnknown(manga.artist)}</span>\n                        </h3>\n                        <h3>\n                            {`Status: ${manga.status}`}\n                        </h3>\n                        <h3>\n                            {`Source: ${getSourceName(manga.source)}`}\n                        </h3>\n                    </div>\n                </div>\n                <div className={classes.buttons}>\n                    <div>\n                        <IconButton onClick={() => handleButtonClick()} size=\"large\">\n                            {inLibrary === 'In Library' && <FavoriteIcon />}\n                            {inLibrary !== 'In Library' && <FavoriteBorderIcon />}\n                            <span>{inLibrary}</span>\n                        </IconButton>\n                    </div>\n                    { /* eslint-disable-next-line react/jsx-no-target-blank */ }\n                    <a href={manga.realUrl} target=\"_blank\">\n                        <IconButton size=\"large\">\n                            <PublicIcon />\n                            <span>Open Site</span>\n                        </IconButton>\n                    </a>\n                </div>\n            </div>\n            <div className={classes.bottom}>\n                <div className={classes.description}>\n                    <h4>About</h4>\n                    <p>{manga.description}</p>\n                </div>\n                <div className={classes.genre}>\n                    {manga.genre.map((g) => <h5 key={g}>{g}</h5>)}\n                </div>\n            </div>\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useCallback } from 'react';\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport {\n    Drawer, FormControlLabel, IconButton, Typography, Tab, Tabs, Radio, RadioGroup, Stack,\n} from '@mui/material';\nimport ThreeStateCheckbox from 'components/util/ThreeStateCheckbox';\nimport { Box } from '@mui/system';\nimport { ArrowDownward, ArrowUpward } from '@mui/icons-material';\nimport TabPanel from 'components/util/TabPanel';\n\ninterface IProps{\n    options: ChapterListOptions\n    optionsDispatch: React.Dispatch<ChapterOptionsReducerAction>\n}\n\nconst SortTab: [ChapterSortMode, string][] = [['source', 'By Source'], ['fetchedAt', 'By Fetch date']];\n\nexport default function ChapterOptions(props: IProps) {\n    const { options, optionsDispatch } = props;\n    const [filtersOpen, setFiltersOpen] = useState(false);\n    const [tabNum, setTabNum] = useState(0);\n\n    const filterOptions = useCallback(\n        (value: NullAndUndefined<boolean>, name: string) => {\n            optionsDispatch({ type: 'filter', filterType: name.toLowerCase(), filterValue: value });\n        }, [],\n    );\n\n    return (\n        <>\n            <IconButton\n                onClick={() => setFiltersOpen(!filtersOpen)}\n                color={options.active ? 'warning' : 'default'}\n            >\n                <FilterListIcon />\n            </IconButton>\n\n            <Drawer\n                anchor=\"bottom\"\n                open={filtersOpen}\n                onClose={() => setFiltersOpen(false)}\n                PaperProps={{\n                    style: {\n                        maxWidth: 600,\n                        padding: '1em',\n                        marginLeft: 'auto',\n                        marginRight: 'auto',\n                        minHeight: '150px',\n                    },\n                }}\n            >\n                <Box>\n                    <Tabs\n                        key={tabNum}\n                        value={tabNum}\n                        variant=\"fullWidth\"\n                        onChange={(e, newTab) => setTabNum(newTab)}\n                        indicatorColor=\"primary\"\n                        textColor=\"primary\"\n                    >\n                        <Tab value={0} label=\"Filter\" />\n                        <Tab value={1} label=\"Sort\" />\n                        <Tab value={2} label=\"Display\" />\n                    </Tabs>\n                    <TabPanel index={0} currentIndex={tabNum}>\n                        <Box sx={{ display: 'flex', flexDirection: 'column', minHeight: '150px' }}>\n                            <FormControlLabel control={<ThreeStateCheckbox name=\"Unread\" checked={options.unread} onChange={filterOptions} />} label=\"Unread\" />\n                            <FormControlLabel control={<ThreeStateCheckbox name=\"Downloaded\" checked={options.downloaded} onChange={filterOptions} />} label=\"Downloaded\" />\n                            <FormControlLabel control={<ThreeStateCheckbox name=\"Bookmarked\" checked={options.bookmarked} onChange={filterOptions} />} label=\"Bookmarked\" />\n                        </Box>\n                    </TabPanel>\n                    <TabPanel index={1} currentIndex={tabNum}>\n                        <Box sx={{ display: 'flex', flexDirection: 'column', minHeight: '150px' }}>\n                            {\n                                SortTab.map((item) => (\n                                    <Stack\n                                        direction=\"row\"\n                                        alignItems=\"center\"\n                                        spacing=\"2\"\n                                        sx={{ py: 1, height: 42 }}\n                                        onClick={() => (item[0] !== options.sortBy\n                                            ? optionsDispatch({ type: 'sortBy', sortBy: item[0] })\n                                            : optionsDispatch({ type: 'sortReverse' }))}\n                                    >\n                                        <Box sx={{ height: 24, width: 24 }}>\n                                            {\n                                                options.sortBy === item[0]\n                                                && (options.reverse\n                                                    ? (<ArrowUpward color=\"primary\" />) : (<ArrowDownward color=\"primary\" />))\n                                            }\n                                        </Box>\n                                        <Typography>{item[1]}</Typography>\n                                    </Stack>\n\n                                ))\n                            }\n                        </Box>\n                    </TabPanel>\n                    <TabPanel index={2} currentIndex={tabNum}>\n                        <Stack flexDirection=\"column\" sx={{ minHeight: '150px' }}>\n                            <RadioGroup name=\"chapter-title-display\" onChange={() => optionsDispatch({ type: 'showChapterNumber' })} value={options.showChapterNumber}>\n                                <FormControlLabel label=\"By Source Title\" value=\"title\" control={<Radio checked={!options.showChapterNumber} />} />\n                                <FormControlLabel label=\"By Chapter Number\" value=\"chapterNumber\" control={<Radio checked={options.showChapterNumber} />} />\n                            </RadioGroup>\n                        </Stack>\n                    </TabPanel>\n                </Box>\n            </Drawer>\n\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { useTheme } from '@mui/material/styles';\nimport { Link } from 'react-router-dom';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport IconButton from '@mui/material/IconButton';\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\nimport Typography from '@mui/material/Typography';\nimport Menu from '@mui/material/Menu';\nimport MenuItem from '@mui/material/MenuItem';\nimport BookmarkIcon from '@mui/icons-material/Bookmark';\n\nimport client from 'util/client';\nimport { Box } from '@mui/system';\n\ninterface IProps{\n    chapter: IChapter\n    triggerChaptersUpdate: () => void\n    downloadStatusString: string\n    showChapterNumber: boolean\n}\n\nexport default function ChapterCard(props: IProps) {\n    const theme = useTheme();\n\n    const {\n        chapter, triggerChaptersUpdate, downloadStatusString, showChapterNumber,\n    } = props;\n\n    const dateStr = chapter.uploadDate && new Date(chapter.uploadDate).toLocaleDateString();\n\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        // prevent parent tags from getting the event\n        event.stopPropagation();\n        event.preventDefault();\n\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const sendChange = (key: string, value: any) => {\n        handleClose();\n\n        const formData = new FormData();\n        formData.append(key, value);\n        if (key === 'read') { formData.append('lastPageRead', '1'); }\n        client.patch(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`, formData)\n            .then(() => triggerChaptersUpdate());\n    };\n\n    const downloadChapter = () => {\n        client.get(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`);\n        handleClose();\n    };\n\n    const deleteChapter = () => {\n        client.delete(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`)\n            .then(() => triggerChaptersUpdate());\n\n        handleClose();\n    };\n\n    const readChapterColor = theme.palette.mode === 'dark' ? '#acacac' : '#b0b0b0';\n\n    return (\n        <>\n            <li>\n                <Card\n                    sx={{\n                        margin: '10px',\n                        ':hover': {\n                            backgroundColor: 'action.hover',\n                            transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                            cursor: 'pointer',\n                        },\n                        ':active': {\n                            backgroundColor: 'action.selected',\n                            transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                        },\n                    }}\n                >\n                    <Link\n                        to={`/manga/${chapter.mangaId}/chapter/${chapter.index}`}\n                        style={{\n                            textDecoration: 'none',\n                            color: chapter.read ? readChapterColor : theme.palette.text.primary,\n                        }}\n                    >\n                        <CardContent\n                            sx={{\n                                display: 'flex',\n                                justifyContent: 'space-between',\n                                alignItems: 'center',\n                                padding: 2,\n                            }}\n                        >\n                            <Box sx={{ display: 'flex' }}>\n                                <div style={{ display: 'flex', flexDirection: 'column' }}>\n                                    <Typography variant=\"h5\" component=\"h2\">\n                                        <span style={{ color: theme.palette.primary.dark }}>\n                                            {chapter.bookmarked && <BookmarkIcon />}\n                                        </span>\n                                        { showChapterNumber ? `Chapter ${chapter.chapterNumber}` : chapter.name}\n                                    </Typography>\n                                    <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                        {chapter.scanlator}\n                                        {chapter.scanlator && ' '}\n                                        {dateStr}\n                                        {downloadStatusString}\n                                    </Typography>\n                                </div>\n                            </Box>\n\n                            <IconButton aria-label=\"more\" onClick={handleClick} size=\"large\">\n                                <MoreVertIcon />\n                            </IconButton>\n                        </CardContent>\n                    </Link>\n                    <Menu\n                        anchorEl={anchorEl}\n                        keepMounted\n                        open={Boolean(anchorEl)}\n                        onClose={handleClose}\n                    >\n                        {downloadStatusString.endsWith('Downloaded')\n                             && <MenuItem onClick={deleteChapter}>Delete</MenuItem>}\n                        {downloadStatusString.length === 0\n                         && <MenuItem onClick={downloadChapter}>Download</MenuItem> }\n                        <MenuItem onClick={() => sendChange('bookmarked', !chapter.bookmarked)}>\n                            {chapter.bookmarked && 'Remove bookmark'}\n                            {!chapter.bookmarked && 'Bookmark'}\n                        </MenuItem>\n                        <MenuItem onClick={() => sendChange('read', !chapter.read)}>\n                            {`Mark as ${chapter.read ? 'unread' : 'read'}`}\n                        </MenuItem>\n                        <MenuItem onClick={() => sendChange('markPrevRead', true)}>\n                            Mark previous as Read\n                        </MenuItem>\n                    </Menu>\n                </Card>\n            </li>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport const defaultChapterOptions: ChapterListOptions = {\n    active: false,\n    unread: undefined,\n    downloaded: undefined,\n    bookmarked: undefined,\n    reverse: false,\n    sortBy: 'source',\n    showChapterNumber: false,\n};\n\nexport function chapterOptionsReducer(state: ChapterListOptions,\n    actions: ChapterOptionsReducerAction)\n    : ChapterListOptions {\n    switch (actions.type) {\n        case 'filter':\n            // eslint-disable-next-line no-case-declarations\n            const active = state.unread !== false\n            && state.downloaded !== false\n            && state.bookmarked !== false;\n            return {\n                ...state,\n                active,\n                [actions.filterType!]: actions.filterValue,\n            };\n        case 'sortBy':\n            return { ...state, sortBy: actions.sortBy };\n        case 'sortReverse':\n            return { ...state, reverse: !state.reverse };\n        case 'showChapterNumber':\n            return { ...state, showChapterNumber: !state.showChapterNumber };\n        default:\n            throw Error('This is not a valid Action');\n    }\n}\n\nexport function unreadFilter(unread: NullAndUndefined<boolean>, { read: isChapterRead }: IChapter) {\n    switch (unread) {\n        case true:\n            return !isChapterRead;\n        case false:\n            return isChapterRead;\n        default:\n            return true;\n    }\n}\n\nexport function downloadFilter(downloaded: NullAndUndefined<boolean>,\n    { downloaded: chapterDownload }: IChapter) {\n    switch (downloaded) {\n        case true:\n            return chapterDownload;\n        case false:\n            return !chapterDownload;\n        default:\n            return true;\n    }\n}\n\nexport function bookmarkdFilter(bookmarked: NullAndUndefined<boolean>,\n    { bookmarked: chapterBookmarked }: IChapter) {\n    switch (bookmarked) {\n        case true:\n            return chapterBookmarked;\n        case false:\n            return !chapterBookmarked;\n        default:\n            return true;\n    }\n}\n\nexport function filterAndSortChapters(chapters: IChapter[], options: ChapterListOptions)\n    : IChapter[] {\n    const filtered = options.active\n        ? chapters.filter((chp) => unreadFilter(options.unread, chp)\n    && downloadFilter(options.downloaded, chp)\n    && bookmarkdFilter(options.bookmarked, chp))\n        : [...chapters];\n    const Sorted = options.sortBy === 'fetchedAt'\n        ? filtered.sort((a, b) => a.fetchedAt - b.fetchedAt)\n        : filtered;\n    if (options.reverse) {\n        Sorted.reverse();\n    }\n    return Sorted;\n}\n\nexport function findFirstUnreadChapter(chapters: IChapter[]): IChapter | undefined {\n    for (let index = chapters.length - 1; index >= 0; index--) {\n        if (!chapters[index].read) return chapters[index];\n    }\n    return undefined;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Fab } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport { PlayArrow } from '@mui/icons-material';\n\ninterface ResumeFABProps{\n    chapter: IChapter\n    mangaId: string\n}\n\nexport default function ResumeFab(props: ResumeFABProps) {\n    const { chapter: { index, lastPageRead }, mangaId } = props;\n    return (\n        <Fab\n            sx={{ position: 'fixed', bottom: '2em', right: '3em' }}\n            component={Link}\n            variant=\"extended\"\n            color=\"primary\"\n            to={`/manga/${mangaId}/chapter/${index}/page/${lastPageRead}`}\n        >\n            <PlayArrow />\n            {index === 1 ? 'Start' : 'Resume' }\n        </Fab>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Box, styled } from '@mui/system';\nimport { Virtuoso } from 'react-virtuoso';\nimport Typography from '@mui/material/Typography';\nimport { CircularProgress, Stack } from '@mui/material';\nimport makeToast from 'components/util/Toast';\nimport ChapterOptions from 'components/chapter/ChapterOptions';\nimport ChapterCard from 'components/chapter/ChapterCard';\nimport { useReducerLocalStorage } from 'util/useLocalStorage';\nimport {\n    chapterOptionsReducer, defaultChapterOptions, findFirstUnreadChapter,\n    filterAndSortChapters,\n} from 'components/chapter/util';\nimport ResumeFab from 'components/chapter/ResumeFAB';\nimport useFetchChapters from './useFetchChapters';\n\nconst CustomVirtuoso = styled(Virtuoso)(({ theme }) => ({\n    listStyle: 'none',\n    padding: 0,\n    minHeight: '200px',\n    [theme.breakpoints.up('md')]: {\n        width: '50vw',\n        // 64px for the Appbar, 48px for the ChapterCount Header\n        height: 'calc(100vh - 64px - 48px)',\n        margin: 0,\n    },\n}));\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\ninterface IProps {\n    id: string\n}\n\nexport default function ChapterList(props: IProps) {\n    const { id } = props;\n\n    const [chapters, triggerChaptersUpdate, noChaptersFound] = useFetchChapters(id);\n    const [firstUnreadChapter, setFirstUnreadChapter] = useState<IChapter>();\n    const [filteredChapters, setFilteredChapters] = useState<IChapter[]>([]);\n    // eslint-disable-next-line max-len\n    const [options, optionsDispatch] = useReducerLocalStorage<ChapterListOptions, ChapterOptionsReducerAction>(\n        chapterOptionsReducer, `${id}filterOptions`, defaultChapterOptions,\n    );\n\n    const [, setWsClient] = useState<WebSocket>();\n    const [{ queue }, setQueueState] = useState<IQueue>(initialQueue);\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/downloads`);\n        wsc.onmessage = (e) => {\n            const data = JSON.parse(e.data) as IQueue;\n            setQueueState(data);\n        };\n\n        setWsClient(wsc);\n\n        return () => wsc.close();\n    }, []);\n\n    useEffect(() => {\n        triggerChaptersUpdate();\n    }, [queue.length]);\n\n    const downloadStatusStringFor = useCallback((chapter: IChapter) => {\n        let rtn = '';\n        if (chapter.downloaded) {\n            rtn = ' • Downloaded';\n        }\n        queue.forEach((q) => {\n            if (chapter.index === q.chapterIndex && chapter.mangaId === q.mangaId) {\n                rtn = ` • Downloading (${(q.progress * 100).toFixed(2)}%)`;\n            }\n        });\n        return rtn;\n    }, [queue]);\n\n    useEffect(() => {\n        const filtered = filterAndSortChapters(chapters, options);\n        setFilteredChapters(filtered);\n        setFirstUnreadChapter(findFirstUnreadChapter(filtered));\n    }, [options, chapters]);\n\n    useEffect(() => {\n        if (noChaptersFound) {\n            makeToast('No chapters found', 'warning');\n        }\n    }, [noChaptersFound]);\n\n    if (chapters.length === 0 || noChaptersFound) {\n        return (\n            <div style={{\n                margin: '10px auto',\n                display: 'flex',\n                justifyContent: 'center',\n            }}\n            >\n                <CircularProgress thickness={5} />\n            </div>\n        );\n    }\n\n    return (\n        <>\n            <Stack direction=\"column\">\n                <Box sx={{\n                    display: 'flex', justifyContent: 'space-between', px: 1.5, mt: 1,\n                }}\n                >\n                    <Typography variant=\"h5\">\n                        {`${filteredChapters.length} Chapters`}\n                    </Typography>\n                    <ChapterOptions options={options} optionsDispatch={optionsDispatch} />\n                </Box>\n\n                <CustomVirtuoso\n                    style={{ // override Virtuoso default values and set them with class\n                        height: 'undefined',\n                        // 900 is the md breakpoint in MUI\n                        overflowY: window.innerWidth < 900 ? 'visible' : 'auto',\n                    }}\n                    totalCount={filteredChapters.length}\n                    itemContent={(index:number) => (\n                        <ChapterCard\n                            showChapterNumber={options.showChapterNumber}\n                            chapter={filteredChapters[index]}\n                            downloadStatusString={downloadStatusStringFor(filteredChapters[index])}\n                            triggerChaptersUpdate={triggerChaptersUpdate}\n                        />\n                    )}\n                    useWindowScroll={window.innerWidth < 900}\n                    overscan={window.innerHeight * 0.5}\n                />\n            </Stack>\n            {firstUnreadChapter && <ResumeFab chapter={firstUnreadChapter} mangaId={id} />}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\nimport { useState, useCallback, useEffect } from 'react';\nimport client from 'util/client';\n\nexport default function useChaptersFetch(id: string): [IChapter[], () => void, boolean] {\n    const [chapters, setChapters] = useState<IChapter[]>([]);\n    const [noChaptersFound, setNoChaptersFound] = useState(false);\n    const [chapterUpdateTriggerer, setChapterUpdateTriggerer] = useState(0);\n    const [fetchedOnline, setFetchedOnline] = useState(false);\n    const [fetchedOffline, setFetchedOffline] = useState(false);\n\n    const triggerChaptersUpdate = useCallback(() => setChapterUpdateTriggerer((prev) => prev + 1),\n        []);\n\n    useEffect(() => {\n        const shouldFetchOnline = fetchedOffline && !fetchedOnline;\n\n        client.get(`/api/v1/manga/${id}/chapters?onlineFetch=${shouldFetchOnline}`)\n            .then((response) => response.data)\n            .then((data) => {\n                if (data.length === 0 && fetchedOffline) {\n                    setNoChaptersFound(true);\n                }\n                setChapters(data);\n            })\n            .then(() => {\n                if (shouldFetchOnline) {\n                    setFetchedOnline(true);\n                } else setFetchedOffline(true);\n            });\n    }, [fetchedOnline, fetchedOffline, chapterUpdateTriggerer]);\n\n    return [chapters, triggerChaptersUpdate, noChaptersFound];\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState, useContext } from 'react';\nimport { Box } from '@mui/system';\nimport MangaDetails from 'components/MangaDetails';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport ChapterList from 'components/chapter/ChapterList';\nimport { useParams } from 'react-router-dom';\n\nexport default function Manga() {\n    const { setTitle } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Manga'); }, []); // delegate setting topbar action to MangaDetails\n\n    const { id } = useParams<{ id: string }>();\n\n    const [manga, setManga] = useState<IManga>();\n\n    useEffect(() => {\n        if (manga === undefined || !manga.freshData) {\n            client.get(`/api/v1/manga/${id}/?onlineFetch=${manga !== undefined}`)\n                .then((response) => response.data)\n                .then((data: IManga) => {\n                    setManga(data);\n                    setTitle(data.title);\n                });\n        }\n    }, [manga]);\n\n    return (\n        <Box sx={{ display: { md: 'flex' }, overflow: 'hidden' }}>\n            <LoadingPlaceholder\n                shouldRender={manga !== undefined}\n                component={MangaDetails}\n                componentProps={{ manga }}\n            />\n\n            <ChapterList id={id} />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport IconButton from '@mui/material/IconButton';\nimport MangaGrid from 'components/MangaGrid';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport SettingsIcon from '@mui/icons-material/Settings';\n\nexport default function SourceMangas(props: { popular: boolean }) {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const history = useHistory();\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const [isConfigurable, setIsConfigurable] = useState<boolean>(false);\n    const [mangas, setMangas] = useState<IMangaCard[]>([]);\n    const [hasNextPage, setHasNextPage] = useState<boolean>(false);\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n    const [fetched, setFetched] = useState<boolean>(false);\n\n    useEffect(() => {\n        setTitle('Source'); // title is later set after a fetch but we set it here once\n    }, []);\n\n    useEffect(() => {\n        setAction(\n            <>\n                {isConfigurable && (\n                    <IconButton\n                        onClick={() => history.push(`/sources/${sourceId}/configure/`)}\n                        aria-label=\"display more actions\"\n                        edge=\"end\"\n                        color=\"inherit\"\n                        size=\"large\"\n                    >\n                        <SettingsIcon />\n                    </IconButton>\n                )}\n            </>,\n        );\n    }, [isConfigurable]);\n\n    useEffect(() => {\n        client.get(`/api/v1/source/${sourceId}`)\n            .then((response) => response.data)\n            .then((data: ISource) => {\n                setTitle(data.displayName);\n                setIsConfigurable(data.isConfigurable);\n            });\n    }, []);\n\n    useEffect(() => {\n        const sourceType = props.popular ? 'popular' : 'latest';\n        client.get(`/api/v1/source/${sourceId}/${sourceType}/${lastPageNum}`)\n            .then((response) => response.data)\n            .then((data: { mangaList: IManga[], hasNextPage: boolean }) => {\n                setMangas([\n                    ...mangas,\n                    ...data.mangaList.map((it) => ({\n                        title: it.title, thumbnailUrl: it.thumbnailUrl, id: it.id,\n                    }))]);\n                setHasNextPage(data.hasNextPage);\n                setFetched(true);\n            });\n    }, [lastPageNum]);\n\n    let message;\n    let messageExtra;\n\n    if (fetched) {\n        message = 'No manga was found!';\n        if (sourceId === '0') {\n            messageExtra = (\n                <>\n                    <span>Check out </span>\n                    <a href=\"https://github.com/Suwayomi/Tachidesk-Server/wiki/Local-Source\">Local source guide</a>\n                </>\n            );\n        }\n    }\n\n    return (\n        <MangaGrid\n            mangas={mangas}\n            hasNextPage={hasNextPage}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n            message={message}\n            messageExtra={messageExtra}\n            isLoading={!fetched}\n        />\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport SpinnerImage from 'components/util/SpinnerImage';\nimport useLocalStorage from 'util/useLocalStorage';\nimport Box from '@mui/system/Box';\n\nfunction imageStyle(settings: IReaderSettings): any {\n    const [dimensions, setDimensions] = React.useState({\n        height: window.innerHeight,\n        width: window.innerWidth,\n    });\n    React.useEffect(() => {\n        function handleResize() {\n            setDimensions({\n                height: window.innerHeight,\n                width: window.innerWidth,\n            });\n        }\n        window.addEventListener('resize', handleResize);\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        };\n    }, []);\n    if (settings.readerType === 'DoubleLTR'\n    || settings.readerType === 'DoubleRTL'\n    || settings.readerType === 'ContinuesHorizontalLTR'\n    || settings.readerType === 'ContinuesHorizontalRTL') {\n        return {\n            display: 'block',\n            marginLeft: '7px',\n            marginRight: '7px',\n            width: 'auto',\n            minHeight: '99vh',\n            height: 'auto',\n            maxHeight: '99vh',\n            objectFit: 'contain',\n            pointerEvents: 'none',\n        };\n    }\n\n    return {\n        display: 'block',\n        marginBottom: settings.readerType === 'ContinuesVertical' ? '15px' : 0,\n        minWidth: '50vw',\n        width: dimensions.width < dimensions.height ? '100vw' : '100%',\n        maxWidth: '100%',\n    };\n}\n\ninterface IProps {\n    src: string\n    index: number\n    onImageLoad: () => void\n    setCurPage: React.Dispatch<React.SetStateAction<number>>\n    settings: IReaderSettings\n}\n\nconst Page = React.forwardRef((props: IProps, ref: any) => {\n    const {\n        src, index, onImageLoad, setCurPage, settings,\n    } = props;\n\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const imgRef = useRef<HTMLImageElement>(null);\n\n    const handleVerticalScroll = () => {\n        if (imgRef.current) {\n            const rect = imgRef.current.getBoundingClientRect();\n            if (rect.y < 0 && rect.y + rect.height > 0) {\n                setCurPage(index);\n            }\n        }\n    };\n\n    const handleHorizontalScroll = () => {\n        if (imgRef.current) {\n            const rect = imgRef.current.getBoundingClientRect();\n            if (rect.left <= window.innerWidth / 2 && rect.right > window.innerWidth / 2) {\n                setCurPage(index);\n            }\n        }\n    };\n\n    useEffect(() => {\n        switch (settings.readerType) {\n            case 'Webtoon':\n            case 'ContinuesVertical':\n                window.addEventListener('scroll', handleVerticalScroll);\n                return () => window.removeEventListener('scroll', handleVerticalScroll);\n            case 'ContinuesHorizontalLTR':\n            case 'ContinuesHorizontalRTL':\n                window.addEventListener('scroll', handleHorizontalScroll);\n                return () => window.removeEventListener('scroll', handleHorizontalScroll);\n            default:\n                return () => {};\n        }\n    }, [handleVerticalScroll]);\n\n    const imgStyle = imageStyle(settings);\n\n    return (\n        <Box ref={ref} sx={{ margin: 'auto' }}>\n            <SpinnerImage\n                src={`${src}?useCache=${useCache}`}\n                onImageLoad={onImageLoad}\n                alt={`Page #${index}`}\n                imgRef={imgRef}\n                spinnerStyle={{\n                    ...imgStyle,\n                    height: '100vh',\n                    width: '70vw',\n                    padding: '50px calc(50% - 20px)',\n                    backgroundColor: '#525252',\n                    marginBottom: 10,\n                }}\n                imgStyle={imgStyle}\n            />\n        </Box>\n    );\n});\n\nexport default Page;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from '../Page';\n\nexport default function HorizontalPager(props: IReaderProps) {\n    const {\n        pages, curPage, settings, setCurPage, prevChapter, nextChapter,\n    } = props;\n\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLDivElement[]>([]);\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            pagesRef.current[curPage + 1]?.scrollIntoView({ inline: 'center' });\n            setCurPage((page) => page + 1);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            pagesRef.current[curPage - 1]?.scrollIntoView({ inline: 'center' });\n            setCurPage(curPage - 1);\n        } else if (curPage === 0) {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            prevPage();\n        } else {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    const mouseXPos = useRef<number>(0);\n\n    function dragScreen(e: MouseEvent) {\n        window.scrollBy(mouseXPos.current - e.pageX, 0);\n    }\n\n    function dragControl(e:MouseEvent) {\n        mouseXPos.current = e.pageX;\n        selfRef.current?.addEventListener('mousemove', dragScreen);\n    }\n\n    function removeDragControl() {\n        selfRef.current?.removeEventListener('mousemove', dragScreen);\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX >= window.innerWidth * 0.85) {\n            goRight();\n        } else if (e.clientX <= window.innerWidth * 0.15) {\n            goLeft();\n        }\n    }\n\n    const handleLoadNextonEnding = () => {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            if (window.scrollX + window.innerWidth >= document.body.scrollWidth) {\n                nextChapter();\n            }\n        } else if (settings.readerType === 'ContinuesHorizontalRTL') {\n            if (window.scrollX <= window.innerWidth) {\n                nextChapter();\n            }\n        }\n    };\n\n    useEffect(() => {\n        // scroll last read page into view after first mount\n        pagesRef.current[curPage]?.scrollIntoView({ inline: 'center' });\n    }, [pagesRef.current.length]);\n\n    useEffect(() => {\n        selfRef.current?.addEventListener('mousedown', dragControl);\n        selfRef.current?.addEventListener('mouseup', removeDragControl);\n\n        return () => {\n            selfRef.current?.removeEventListener('mousedown', dragControl);\n            selfRef.current?.removeEventListener('mouseup', removeDragControl);\n        };\n    }, [selfRef]);\n\n    useEffect(() => {\n        if (settings.loadNextonEnding) {\n            document.addEventListener('scroll', handleLoadNextonEnding);\n        }\n        selfRef.current?.addEventListener('mousedown', clickControl);\n\n        return () => {\n            document.removeEventListener('scroll', handleLoadNextonEnding);\n            selfRef.current?.removeEventListener('mousedown', clickControl);\n        };\n    }, [selfRef, curPage]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: (settings.readerType === 'ContinuesHorizontalLTR') ? 'row' : 'row-reverse',\n                justifyContent: (settings.readerType === 'ContinuesHorizontalLTR') ? 'flex-start' : 'flex-end',\n                margin: '0 auto',\n                width: 'auto',\n                height: 'auto',\n                overflowX: 'visible',\n                userSelect: 'none',\n            }}\n        >\n            {\n                pages.map((page) => (\n                    <Page\n                        key={page.index}\n                        index={page.index}\n                        src={page.src}\n                        onImageLoad={() => {}}\n                        setCurPage={setCurPage}\n                        settings={settings}\n                        ref={(e:HTMLDivElement) => { pagesRef.current[page.index] = e; }}\n                    />\n                ))\n            }\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    settings: IReaderSettings\n    curPage: number\n    pageCount: number\n}\n\nexport default function PageNumber(props: IProps) {\n    const { settings, curPage, pageCount } = props;\n\n    return (\n        <Box sx={{\n            display: settings.showPageNumber ? 'block' : 'none',\n            position: 'fixed',\n            bottom: '50px',\n            right: settings.staticNav ? 'calc((100vw - 325px)/2)' : 'calc((100vw - 25px)/2)',\n            padding: '2px',\n            paddingLeft: '4px',\n            paddingRight: '4px',\n            textAlign: 'center',\n            backgroundColor: 'rgba(0, 0, 0, 0.3)',\n            borderRadius: '10px',\n        }}\n        >\n            {`${curPage + 1} / ${pageCount}`}\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from '../Page';\n\nexport default function PagedReader(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, curPage, nextChapter, prevChapter,\n    } = props;\n\n    const selfRef = useRef<HTMLDivElement>(null);\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            setCurPage(curPage + 1);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            setCurPage(curPage - 1);\n        } else {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'SingleLTR') {\n            prevPage();\n        } else if (settings.readerType === 'SingleRTL') {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'SingleLTR') {\n            nextPage();\n        } else if (settings.readerType === 'SingleRTL') {\n            prevPage();\n        }\n    }\n\n    function keyboardControl(e:KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                goRight();\n                break;\n            case 'ArrowLeft':\n                goLeft();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            goRight();\n        } else {\n            goLeft();\n        }\n    }\n\n    useEffect(() => {\n        document.addEventListener('keydown', keyboardControl);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage, settings.readerType]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: 'row',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: '100%',\n                height: '100vh',\n            }}\n        >\n            <Page\n                key={curPage}\n                index={curPage}\n                onImageLoad={() => {}}\n                src={pages[curPage].src}\n                setCurPage={setCurPage}\n                settings={settings}\n            />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Box, styled } from '@mui/system';\n\nconst Image = styled('img')({\n    marginBottom: 0,\n    width: 'auto',\n    minHeight: '99vh',\n    height: 'auto',\n    maxHeight: '99vh',\n    objectFit: 'contain',\n});\n\ninterface IProps {\n    index: number\n    image1src: string\n    image2src: string\n    settings: IReaderSettings\n}\n\nconst DoublePage = React.forwardRef((props: IProps, ref: any) => {\n    const {\n        image1src, image2src, index, settings,\n    } = props;\n\n    return (\n        <Box\n            ref={ref}\n            sx={{\n                display: 'flex',\n                flexDirection: settings.readerType === 'DoubleLTR' ? 'row' : 'row-reverse',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: 'auto',\n                height: 'auto',\n                overflowX: 'scroll',\n            }}\n        >\n            <Image\n                src={image1src}\n                alt={`Page #${index}`}\n            />\n            <Image\n                src={image2src}\n                alt={`Page #${index + 1}`}\n            />\n        </Box>\n    );\n});\n\nexport default DoublePage;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Box } from '@mui/system';\nimport Page from '../Page';\nimport DoublePage from '../DoublePage';\n\nexport default function DoublePagedPager(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, curPage, nextChapter, prevChapter,\n    } = props;\n\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLImageElement[]>([]);\n\n    const pagesDisplayed = useRef<number>(0);\n    const pageLoaded = useRef<boolean[]>(Array(pages.length).fill(false));\n\n    function setPagesToDisplay() {\n        pagesDisplayed.current = 0;\n        if (curPage < pages.length && pagesRef.current[curPage]) {\n            if (pageLoaded.current[curPage]) {\n                pagesDisplayed.current = 1;\n                const imgElem = pagesRef.current[curPage];\n                const aspectRatio = imgElem.height / imgElem.width;\n                if (aspectRatio < 1) {\n                    return;\n                }\n            }\n        }\n        if (curPage + 1 < pages.length && pagesRef.current[curPage + 1]) {\n            if (pageLoaded.current[curPage + 1]) {\n                const imgElem = pagesRef.current[curPage + 1];\n                const aspectRatio = imgElem.height / imgElem.width;\n                if (aspectRatio < 1) {\n                    return;\n                }\n                pagesDisplayed.current = 2;\n            }\n        }\n    }\n\n    function displayPages() {\n        if (pagesDisplayed.current === 2) {\n            ReactDOM.render(\n                <DoublePage\n                    key={curPage}\n                    index={curPage}\n                    image1src={pages[curPage].src}\n                    image2src={pages[curPage + 1].src}\n                    settings={settings}\n                />,\n                document.getElementById('display'),\n            );\n        } else {\n            ReactDOM.render(\n                <Page\n                    key={curPage}\n                    index={curPage}\n                    src={(pagesDisplayed.current === 1) ? pages[curPage].src : ''}\n                    onImageLoad={() => {}}\n                    setCurPage={setCurPage}\n                    settings={settings}\n                />,\n                document.getElementById('display'),\n            );\n        }\n    }\n\n    function pagesToGoBack() {\n        for (let i = 1; i <= 2; i++) {\n            if (curPage - i > 0 && pagesRef.current[curPage - i]) {\n                if (pageLoaded.current[curPage - i]) {\n                    const imgElem = pagesRef.current[curPage - i];\n                    const aspectRatio = imgElem.height / imgElem.width;\n                    if (aspectRatio < 1) {\n                        return 1;\n                    }\n                }\n            }\n        }\n        return 2;\n    }\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            const nextCurPage = curPage + pagesDisplayed.current;\n            setCurPage((nextCurPage >= pages.length) ? pages.length - 1 : nextCurPage);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            const nextCurPage = curPage - pagesToGoBack();\n            setCurPage((nextCurPage < 0) ? 0 : nextCurPage);\n        } else {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'DoubleLTR') {\n            prevPage();\n        } else {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'DoubleLTR') {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    function keyboardControl(e:KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                goRight();\n                break;\n            case 'ArrowLeft':\n                goLeft();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            goRight();\n        } else {\n            goLeft();\n        }\n    }\n\n    function handleImageLoad(index: number) {\n        return () => {\n            pageLoaded.current[index] = true;\n        };\n    }\n\n    useEffect(() => {\n        const retryDisplay = setInterval(() => {\n            const isLastPage = (curPage === pages.length - 1);\n            if ((!isLastPage && pageLoaded.current[curPage] && pageLoaded.current[curPage + 1])\n                || pageLoaded.current[curPage]) {\n                setPagesToDisplay();\n                displayPages();\n                clearInterval(retryDisplay);\n            }\n        }, 50);\n\n        document.addEventListener('keydown', keyboardControl);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            clearInterval(retryDisplay);\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage, settings.readerType]);\n\n    return (\n        <Box ref={selfRef}>\n            <Box id=\"preload\" sx={{ display: 'none' }}>\n                {\n                    pages.map((page) => (\n                        <img\n                            ref={(e:HTMLImageElement) => { pagesRef.current[page.index] = e; }}\n                            key={`${page.index}`}\n                            src={page.src}\n                            onLoad={handleImageLoad(page.index)}\n                            alt={`${page.index}`}\n                        />\n                    ))\n                }\n            </Box>\n            <Box\n                id=\"display\"\n                sx={{\n                    display: 'flex',\n                    flexDirection: (settings.readerType === 'DoubleLTR') ? 'row' : 'row-reverse',\n                    justifyContent: 'center',\n                    margin: '0 auto',\n                    width: 'auto',\n                    height: 'auto',\n                    overflowX: 'scroll',\n                }}\n            />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from '../Page';\n\nexport default function VerticalReader(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, curPage, nextChapter, prevChapter,\n    } = props;\n\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLDivElement[]>([]);\n\n    useEffect(() => {\n        pagesRef.current = pagesRef.current.slice(0, pages.length);\n    }, [pages.length]);\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            pagesRef.current[curPage + 1]?.scrollIntoView();\n            setCurPage((page) => page + 1);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            const rect = pagesRef.current[curPage].getBoundingClientRect();\n            if (rect.y < 0 && rect.y + rect.height > 0) {\n                pagesRef.current[curPage]?.scrollIntoView();\n            } else {\n                pagesRef.current[curPage - 1]?.scrollIntoView();\n                setCurPage(curPage - 1);\n            }\n        } else if (curPage === 0) {\n            prevChapter();\n        }\n    }\n\n    function keyboardControl(e:KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                nextPage();\n                break;\n            case 'ArrowLeft':\n                prevPage();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    const handleLoadNextonEnding = () => {\n        if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {\n            nextChapter();\n        }\n    };\n\n    useEffect(() => {\n        if (settings.loadNextonEnding) { document.addEventListener('scroll', handleLoadNextonEnding); }\n        document.addEventListener('keydown', keyboardControl, false);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            document.removeEventListener('scroll', handleLoadNextonEnding);\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage]);\n\n    useEffect(() => {\n        // scroll last read page into view after first mount\n        pagesRef.current[curPage].scrollIntoView();\n    }, [pagesRef.current.length]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: 'column',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: '100%',\n            }}\n        >\n            {\n                pages.map((page) => (\n                    <Page\n                        key={page.index}\n                        index={page.index}\n                        src={page.src}\n                        onImageLoad={() => {}}\n                        setCurPage={setCurPage}\n                        settings={settings}\n                        ref={(e:HTMLDivElement) => { pagesRef.current[page.index] = e; }}\n                    />\n                ))\n            }\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport IconButton from '@mui/material/IconButton';\nimport CloseIcon from '@mui/icons-material/Close';\nimport KeyboardArrowLeftIcon from '@mui/icons-material/KeyboardArrowLeft';\nimport KeyboardArrowRightIcon from '@mui/icons-material/KeyboardArrowRight';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport React, { useEffect, useState } from 'react';\nimport Typography from '@mui/material/Typography';\nimport { useHistory, Link } from 'react-router-dom';\nimport Slide from '@mui/material/Slide';\nimport Fade from '@mui/material/Fade';\nimport Zoom from '@mui/material/Zoom';\nimport { Switch } from '@mui/material';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport MenuItem from '@mui/material/MenuItem';\nimport Select from '@mui/material/Select';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Collapse from '@mui/material/Collapse';\nimport Button from '@mui/material/Button';\nimport { styled } from '@mui/system';\n\nconst Root = styled('div')(({ theme }) => ({\n    top: 0,\n    left: 0,\n    width: '300px',\n    minWidth: '300px',\n    height: '100vh',\n    overflowY: 'auto',\n    backgroundColor: theme.palette.background.default,\n\n    '& header': {\n        backgroundColor:\n        theme.palette.mode === 'dark' ? theme.palette.grey[800] : theme.palette.grey[100],\n        display: 'flex',\n        alignItems: 'center',\n        minHeight: '64px',\n        paddingLeft: '24px',\n        paddingRight: '24px',\n\n        transition: 'left 2s ease',\n\n        '& button': {\n            flexGrow: 0,\n            flexShrink: 0,\n        },\n\n        '& button:nth-child(1)': {\n            marginRight: '16px',\n        },\n\n        '& h1': {\n            fontSize: '1.25rem',\n            flexGrow: 1,\n        },\n    },\n    '& hr': {\n        margin: '0 16px',\n        height: '1px',\n        border: '0',\n        backgroundColor: theme.palette.mode === 'dark' ? theme.palette.grey[800] : theme.palette.grey[100],\n    },\n}));\n\nconst Navigation = styled('div')({\n    margin: '0 16px',\n    '& > span:nth-child(1)': {\n        textAlign: 'center',\n        display: 'block',\n        marginTop: '16px',\n    },\n});\n\nconst ChapterNavigation = styled('div')({\n    display: 'grid',\n    gridTemplateColumns: '1fr 1fr',\n    gridTemplateAreas: '\"prev next\"',\n    gridColumnGap: '5px',\n    margin: '10px 0',\n\n    '& a': {\n        flexGrow: 1,\n        textDecoration: 'none',\n\n        '& button': {\n            width: '100%',\n            padding: '5px 8px',\n            textTransform: 'none',\n        },\n    },\n});\n\nconst OpenDrawerButton = styled(IconButton)(({ theme }) => ({\n    position: 'fixed',\n    top: 0 + 20,\n    left: 10 + 20,\n    height: '40px',\n    width: '40px',\n    borderRadius: 5,\n    backgroundColor: theme.palette.mode === 'dark' ? 'black' : 'white',\n    '&:hover': {\n        backgroundColor: theme.palette.mode === 'dark' ? theme.palette.grey[900] : theme.palette.grey[100],\n    },\n}));\n\nexport const defaultReaderSettings = () => ({\n    staticNav: false,\n    showPageNumber: true,\n    continuesPageGap: false,\n    loadNextonEnding: false,\n    readerType: 'ContinuesVertical',\n} as IReaderSettings);\n\ninterface IProps {\n    settings: IReaderSettings\n    setSettings: React.Dispatch<React.SetStateAction<IReaderSettings>>\n    manga: IManga | IMangaCard\n    chapter: IChapter\n    curPage: number\n}\n\nexport default function ReaderNavBar(props: IProps) {\n    const history = useHistory();\n\n    const {\n        settings, setSettings, manga, chapter, curPage,\n    } = props;\n\n    const [drawerOpen, setDrawerOpen] = useState(false || settings.staticNav);\n    const [hideOpenButton, setHideOpenButton] = useState(false);\n    const [prevScrollPos, setPrevScrollPos] = useState(0);\n    const [settingsCollapseOpen, setSettingsCollapseOpen] = useState(true);\n\n    const setSettingValue = (key: string, value: any) => setSettings({ ...settings, [key]: value });\n\n    const handleScroll = () => {\n        const currentScrollPos = window.pageYOffset;\n\n        if (Math.abs(currentScrollPos - prevScrollPos) > 20) {\n            setHideOpenButton(currentScrollPos > prevScrollPos);\n            setPrevScrollPos(currentScrollPos);\n        }\n    };\n\n    useEffect(() => {\n        window.addEventListener('scroll', handleScroll);\n\n        const rootEl:HTMLDivElement = document.querySelector('#root')!;\n        const mainContainer:HTMLDivElement = document.querySelector('#appMainContainer')!;\n\n        // main container and root div need to change styles...\n        rootEl.style.display = 'flex';\n        mainContainer.style.display = 'none';\n\n        return () => {\n            rootEl.style.display = 'block';\n            mainContainer.style.display = 'block';\n            window.removeEventListener('scroll', handleScroll);\n        };\n    }, [handleScroll]);// handleScroll changes on every render\n\n    return (\n        <>\n            <Slide\n                direction=\"right\"\n                in={drawerOpen}\n                timeout={200}\n                appear={false}\n                mountOnEnter\n                unmountOnExit\n            >\n                <Root sx={{\n                    position: settings.staticNav ? 'sticky' : 'fixed',\n                }}\n                >\n                    <header>\n                        {!settings.staticNav\n                        && (\n                            <IconButton\n                                edge=\"start\"\n                                color=\"inherit\"\n                                aria-label=\"menu\"\n                                disableRipple\n                                onClick={() => setDrawerOpen(false)}\n                                size=\"large\"\n                            >\n                                <KeyboardArrowLeftIcon />\n                            </IconButton>\n                        )}\n                        <Typography variant=\"h1\">\n                            {chapter.name}\n                        </Typography>\n                        <IconButton\n                            edge=\"start\"\n                            color=\"inherit\"\n                            aria-label=\"menu\"\n                            disableRipple\n                            onClick={() => history.push('..')}\n                            size=\"large\"\n                            sx={{ mr: -1 }}\n                        >\n                            <CloseIcon />\n                        </IconButton>\n                    </header>\n                    <ListItem\n                        ContainerComponent=\"div\"\n                        sx={{\n                            '& span': {\n                                fontWeight: 'bold',\n                            },\n                        }}\n                    >\n                        <ListItemText primary=\"Reader Settings\" />\n                        <ListItemSecondaryAction>\n                            <IconButton\n                                edge=\"start\"\n                                color=\"inherit\"\n                                aria-label=\"menu\"\n                                disableRipple\n                                disableFocusRipple\n                                onClick={() => setSettingsCollapseOpen(!settingsCollapseOpen)}\n                                size=\"large\"\n                            >\n                                {settingsCollapseOpen && <KeyboardArrowUpIcon />}\n                                {!settingsCollapseOpen && <KeyboardArrowDownIcon />}\n                            </IconButton>\n                        </ListItemSecondaryAction>\n                    </ListItem>\n                    <Collapse in={settingsCollapseOpen} timeout=\"auto\" unmountOnExit>\n                        <List>\n                            <ListItem>\n                                <ListItemText primary=\"Static Navigation\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.staticNav}\n                                        onChange={(e) => setSettingValue('staticNav', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Show page number\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.showPageNumber}\n                                        onChange={(e) => setSettingValue('showPageNumber', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Load next chapter at ending\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.loadNextonEnding}\n                                        onChange={(e) => setSettingValue('loadNextonEnding', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Reader Type\" />\n                                <Select\n                                    variant=\"standard\"\n                                    value={settings.readerType}\n                                    onChange={(e) => setSettingValue('readerType', e.target.value)}\n                                    sx={{ p: 0 }}\n                                >\n                                    <MenuItem value=\"SingleLTR\">\n                                        Single Page (LTR)\n                                    </MenuItem>\n                                    <MenuItem value=\"SingleRTL\">\n                                        Single Page (RTL)\n                                    </MenuItem>\n                                    {/* <MenuItem value=\"SingleVertical\">\n                                       Vertical(WIP)\n                                    </MenuItem> */}\n                                    <MenuItem value=\"DoubleLTR\">\n                                        Double Page (LTR)\n                                    </MenuItem>\n                                    <MenuItem value=\"DoubleRTL\">\n                                        Double Page (RTL)\n                                    </MenuItem>\n                                    <MenuItem value=\"Webtoon\">\n                                        Webtoon\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesVertical\">\n                                        Continues Vertical\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesHorizontalLTR\">\n                                        Horizontal (LTR)\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesHorizontalRTL\">\n                                        Horizontal (RTL)\n                                    </MenuItem>\n                                </Select>\n                            </ListItem>\n                        </List>\n                    </Collapse>\n                    <hr />\n                    <Navigation>\n                        <span>\n                            {`Currently on page ${curPage + 1} of ${chapter.pageCount}`}\n                        </span>\n                        <ChapterNavigation>\n                            {chapter.index > 1\n                        && (\n                            <Link\n                                replace\n                                to={`/manga/${manga.id}/chapter/${chapter.index - 1}`}\n                            >\n                                <Button\n                                    variant=\"outlined\"\n                                    sx={{ gridArea: 'prev' }}\n                                    startIcon={<KeyboardArrowLeftIcon />}\n                                >\n                                    Prev. Chapter\n                                </Button>\n                            </Link>\n                        )}\n                            {chapter.index < chapter.chapterCount\n                        && (\n                            <Link\n                                replace\n                                style={{ gridArea: 'next' }}\n                                to={`/manga/${manga.id}/chapter/${chapter.index + 1}`}\n                            >\n                                <Button\n                                    variant=\"outlined\"\n                                    endIcon={<KeyboardArrowRightIcon />}\n                                >\n                                    Next Chapter\n                                </Button>\n                            </Link>\n                        )}\n                        </ChapterNavigation>\n                    </Navigation>\n                </Root>\n            </Slide>\n            <Zoom in={!drawerOpen}>\n                <Fade in={!hideOpenButton}>\n                    <OpenDrawerButton\n                        edge=\"start\"\n                        color=\"inherit\"\n                        aria-label=\"menu\"\n                        disableRipple\n                        disableFocusRipple\n                        onClick={() => setDrawerOpen(true)}\n                        size=\"large\"\n                    >\n                        <KeyboardArrowRightIcon />\n                    </OpenDrawerButton>\n                </Fade>\n            </Zoom>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport CircularProgress from '@mui/material/CircularProgress';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport HorizontalPager from 'components/reader/pager/HorizontalPager';\nimport PageNumber from 'components/reader/PageNumber';\nimport PagedPager from 'components/reader/pager/PagedPager';\nimport DoublePagedPager from 'components/reader/pager/DoublePagedPager';\nimport VerticalPager from 'components/reader/pager/VerticalPager';\nimport ReaderNavBar, { defaultReaderSettings } from 'components/navbar/ReaderNavBar';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport cloneObject from 'util/cloneObject';\nimport { Box } from '@mui/system';\n\nconst getReaderComponent = (readerType: ReaderType) => {\n    switch (readerType) {\n        case 'ContinuesVertical':\n        case 'Webtoon':\n            return VerticalPager;\n            break;\n        case 'SingleVertical':\n        case 'SingleRTL':\n        case 'SingleLTR':\n            return PagedPager;\n            break;\n        case 'DoubleVertical':\n        case 'DoubleRTL':\n        case 'DoubleLTR':\n            return DoublePagedPager;\n            break;\n        case 'ContinuesHorizontalLTR':\n        case 'ContinuesHorizontalRTL':\n            return HorizontalPager;\n        default:\n            return VerticalPager;\n            break;\n    }\n};\n\nconst range = (n:number) => Array.from({ length: n }, (value, key) => key);\nconst initialChapter = () => ({\n    pageCount: -1,\n    index: -1,\n    chapterCount: 0,\n    name: 'Loading...',\n});\n\nexport default function Reader() {\n    const [settings, setSettings] = useLocalStorage<IReaderSettings>('readerSettings', defaultReaderSettings);\n\n    const history = useHistory();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const { chapterIndex, mangaId } = useParams<{ chapterIndex: string, mangaId: string }>();\n    const [manga, setManga] = useState<IMangaCard | IManga>({ id: +mangaId, title: '', thumbnailUrl: '' });\n    const [chapter, setChapter] = useState<IChapter | IPartialChpter>(initialChapter());\n    const [curPage, setCurPage] = useState<number>(0);\n    const { setOverride, setTitle } = useContext(NavbarContext);\n\n    useEffect(() => {\n        // make sure settings has all the keys\n        const settingsClone = cloneObject(settings) as any;\n        const defualtSettings = defaultReaderSettings();\n        let shouldUpdateSettings = false;\n        Object.keys(defualtSettings).forEach((key) => {\n            const keyOf = key as keyof IReaderSettings;\n            if (settings[keyOf] === undefined) {\n                settingsClone[keyOf] = defualtSettings[keyOf];\n                shouldUpdateSettings = true;\n            }\n        });\n        if (shouldUpdateSettings) { setSettings(settingsClone); }\n\n        // set the custom navbar\n        setOverride(\n            {\n                status: true,\n                value: (\n                    <ReaderNavBar\n                        settings={settings}\n                        setSettings={setSettings}\n                        manga={manga}\n                        chapter={chapter as IChapter}\n                        curPage={curPage}\n                    />\n                ),\n            },\n        );\n\n        // clean up for when we leave the reader\n        return () => setOverride({ status: false, value: <div /> });\n    }, [manga, chapter, settings, curPage, chapterIndex]);\n\n    useEffect(() => {\n        setTitle('Reader');\n        client.get(`/api/v1/manga/${mangaId}/`)\n            .then((response) => response.data)\n            .then((data: IManga) => {\n                setManga(data);\n                setTitle(data.title);\n            });\n    }, [chapterIndex]);\n\n    useEffect(() => {\n        setChapter(initialChapter);\n        client.get(`/api/v1/manga/${mangaId}/chapter/${chapterIndex}`)\n            .then((response) => response.data)\n            .then((data:IChapter) => {\n                setChapter(data);\n\n                if (data.lastPageRead === data.pageCount - 1) {\n                    // last page, also probably read = true, we will load the first page.\n                    setCurPage(0);\n                } else setCurPage(data.lastPageRead);\n            });\n    }, [chapterIndex]);\n\n    useEffect(() => {\n        if (curPage !== -1) {\n            const formData = new FormData();\n            formData.append('lastPageRead', curPage.toString());\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formData);\n        }\n\n        if (curPage === chapter.pageCount - 1) {\n            const formDataRead = new FormData();\n            formDataRead.append('read', 'true');\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formDataRead);\n        }\n    }, [curPage]);\n\n    // return spinner while chpater data is loading\n    if (chapter.pageCount === -1) {\n        return (\n            <Box sx={{\n                height: '100vh', width: '100vw', display: 'grid', placeItems: 'center',\n            }}\n            >\n                <CircularProgress thickness={5} />\n            </Box>\n        );\n    }\n\n    const nextChapter = () => {\n        if (chapter.index < chapter.chapterCount) {\n            const formData = new FormData();\n            formData.append('lastPageRead', `${chapter.pageCount - 1}`);\n            formData.append('read', 'true');\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formData);\n\n            history.replace(`/manga/${manga.id}/chapter/${chapter.index + 1}`);\n        }\n    };\n\n    const prevChapter = () => {\n        if (chapter.index > 1) {\n            history.replace(`/manga/${manga.id}/chapter/${chapter.index - 1}`);\n        }\n    };\n\n    const pages = range(chapter.pageCount).map((index) => ({\n        index,\n        src: `${serverAddress}/api/v1/manga/${mangaId}/chapter/${chapterIndex}/page/${index}`,\n    }));\n\n    const ReaderComponent = getReaderComponent(settings.readerType);\n\n    return (\n        <Box sx={{ width: settings.staticNav ? 'calc(100vw - 300px)' : '100vw' }}>\n            <PageNumber\n                settings={settings}\n                curPage={curPage}\n                pageCount={chapter.pageCount}\n            />\n            <ReaderComponent\n                pages={pages}\n                pageCount={chapter.pageCount}\n                setCurPage={setCurPage}\n                curPage={curPage}\n                settings={settings}\n                manga={manga}\n                chapter={chapter}\n                nextChapter={nextChapter}\n                prevChapter={prevChapter}\n            />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, {\n    useContext, useEffect, useState, useRef,\n} from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport IconButton from '@mui/material/IconButton';\nimport DownloadIcon from '@mui/icons-material/Download';\nimport Avatar from '@mui/material/Avatar';\nimport Typography from '@mui/material/Typography';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport { Box } from '@mui/system';\n\nfunction epochToDate(epoch: number) {\n    const date = new Date(0); // The 0 there is the key, which sets the date to the epoch\n    date.setUTCSeconds(epoch);\n    return date;\n}\n\nfunction isTheSameDay(first:Date, second:Date) {\n    return first.getDate() === second.getDate()\n    && first.getMonth() === second.getMonth()\n    && first.getFullYear() === second.getFullYear();\n}\n\nfunction getDateString(date: Date) {\n    const today = new Date();\n    if (isTheSameDay(today, date)) return 'TODAY';\n    // calculate yesterday\n    const yesterday = new Date();\n    yesterday.setDate(today.getDate() - 1);\n    if (isTheSameDay(yesterday, date)) return 'YESTERDAY';\n    return date.toLocaleDateString();\n}\n\nfunction groupByDate(updates: IMangaChapter[]):\n[string, { item: IMangaChapter, globalIdx: number }[] ][] {\n    if (updates.length === 0) return [];\n\n    const groups = {};\n    updates.forEach((item, globalIdx) => {\n        const key = getDateString(epochToDate(item.chapter.fetchedAt));\n        // @ts-ignore\n        if (groups[key] === undefined) groups[key] = [];\n        // @ts-ignore\n        groups[key].push({ item, globalIdx });\n    });\n\n    // @ts-ignore\n    return Object.keys(groups).map((key) => [key, groups[key]]);\n}\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\nexport default function Updates() {\n    const history = useHistory();\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [updateEntries, setUpdateEntries] = useState<IMangaChapter[]>([]);\n    const [hasNextPage, setHasNextPage] = useState(true);\n    const [fetched, setFetched] = useState(false);\n    const [lastPageNum, setLastPageNum] = useState(0);\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const [, setWsClient] = useState<WebSocket>();\n    const [{ queue }, setQueueState] = useState<IQueue>(initialQueue);\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/downloads`);\n        wsc.onmessage = (e) => {\n            const data = JSON.parse(e.data) as IQueue;\n            setQueueState(data);\n        };\n\n        setWsClient(wsc);\n\n        return () => wsc.close();\n    }, []);\n\n    useEffect(() => {\n        setTitle('Updates');\n\n        setAction(<></>);\n    }, []);\n\n    useEffect(() => {\n        if (hasNextPage) {\n            client.get(`/api/v1/update/recentChapters/${lastPageNum}`)\n                .then((response) => response.data)\n                .then(({ hasNextPage: fetchedHasNextPage, page }: PaginatedList<IMangaChapter>) => {\n                    setUpdateEntries([\n                        ...updateEntries,\n                        ...page,\n                    ]);\n                    setHasNextPage(fetchedHasNextPage);\n                    setFetched(true);\n                });\n        }\n    }, [lastPageNum]);\n\n    const lastEntry = useRef<HTMLDivElement>(null);\n\n    const scrollHandler = () => {\n        if (lastEntry.current) {\n            const rect = lastEntry.current.getBoundingClientRect();\n            if (((rect.y + rect.height) / window.innerHeight < 2) && hasNextPage) {\n                setLastPageNum(lastPageNum + 1);\n            }\n        }\n    };\n    useEffect(() => {\n        window.addEventListener('scroll', scrollHandler, true);\n        return () => {\n            window.removeEventListener('scroll', scrollHandler, true);\n        };\n    }, [hasNextPage, updateEntries]);\n\n    if (!fetched) { return <LoadingPlaceholder />; }\n    if (fetched && updateEntries.length === 0) { return <EmptyView message=\"You don't have any updates yet.\" />; }\n\n    const downloadStatusStringFor = (chapter: IChapter) => {\n        let rtn = '';\n        if (chapter.downloaded) {\n            rtn = ' • Downloaded';\n        }\n        queue.forEach((q) => {\n            if (chapter.index === q.chapterIndex && chapter.mangaId === q.mangaId) {\n                rtn = ` • Downloading (${(q.progress * 100).toFixed(2)}%)`;\n            }\n        });\n        return rtn;\n    };\n\n    const downloadChapter = (chapter: IChapter) => {\n        client.get(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`);\n    };\n\n    return (\n        <>\n            {groupByDate(updateEntries).map((dateGroup) => (\n                <div key={dateGroup[0]}>\n                    <Typography\n                        variant=\"h5\"\n                        sx={{\n                            ml: 3,\n                            my: 2,\n                            fontWeight: 700,\n                        }}\n                    >\n                        {dateGroup[0]}\n                    </Typography>\n                    {dateGroup[1].map(({ item: { chapter, manga }, globalIdx }) => (\n                        <Card\n                            ref={globalIdx === updateEntries.length - 1 ? lastEntry : undefined}\n                            key={globalIdx}\n                            sx={{\n                                margin: '10px',\n                                '&:hover': {\n                                    backgroundColor: 'action.hover',\n                                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                },\n                                '&:active': {\n                                    backgroundColor: 'action.selected',\n                                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                },\n                            }}\n                            onClick={() => history.push(`/manga/${chapter.mangaId}/chapter/${chapter.index}`)}\n                        >\n                            <CardContent sx={{\n                                display: 'flex',\n                                justifyContent: 'space-between',\n                                alignItems: 'center',\n                                padding: 2,\n                            }}\n                            >\n                                <Box sx={{ display: 'flex' }}>\n                                    <Avatar\n                                        variant=\"rounded\"\n                                        sx={{\n                                            width: 56,\n                                            height: 56,\n                                            flex: '0 0 auto',\n                                            marginRight: 2,\n                                            imageRendering: 'pixelated',\n                                        }}\n                                        src={`${serverAddress}${manga.thumbnailUrl}?useCache=${useCache}`}\n                                    />\n                                    <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n                                        <Typography variant=\"h5\" component=\"h2\">\n                                            {manga.title}\n                                        </Typography>\n                                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                            {chapter.name}\n                                            {downloadStatusStringFor(chapter)}\n                                        </Typography>\n                                    </Box>\n                                </Box>\n                                {downloadStatusStringFor(chapter) === ''\n                                        && (\n                                            <IconButton\n                                                onClick={(e) => {\n                                                    downloadChapter(chapter);\n                                                    // prevent parent tags from getting the event\n                                                    e.stopPropagation();\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <DownloadIcon />\n                                            </IconButton>\n                                        )}\n                            </CardContent>\n                        </Card>\n                    ))}\n                </div>\n            ))}\n        </>\n    );\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/* eslint-disable react/jsx-props-no-spreading */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport NavbarContext from 'components/context/NavbarContext';\nimport React, { useContext, useEffect, useState } from 'react';\nimport PlayArrowIcon from '@mui/icons-material/PlayArrow';\nimport PauseIcon from '@mui/icons-material/Pause';\nimport IconButton from '@mui/material/IconButton';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport client from 'util/client';\nimport {\n    DragDropContext, Draggable, DraggingStyle, Droppable, DropResult, NotDraggingStyle,\n} from 'react-beautiful-dnd';\nimport { useTheme, Palette } from '@mui/material/styles';\nimport List from '@mui/material/List';\nimport DragHandleIcon from '@mui/icons-material/DragHandle';\nimport ListItem from '@mui/material/ListItem';\nimport { ListItemIcon } from '@mui/material';\nimport EmptyView from 'components/util/EmptyView';\n\nimport { Box } from '@mui/system';\nimport Typography from '@mui/material/Typography';\nimport { useHistory } from 'react-router-dom';\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\n\nconst getItemStyle = (isDragging: boolean,\n    draggableStyle: DraggingStyle | NotDraggingStyle | undefined, palette: Palette) => ({\n    // styles we need to apply on draggables\n    ...draggableStyle,\n\n    ...(isDragging && {\n        background: palette.mode === 'dark' ? '#424242' : 'rgb(235,235,235)',\n    }),\n});\n\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\nexport default function DownloadQueue() {\n    const [, setWsClient] = useState<WebSocket>();\n    const [queueState, setQueueState] = useState<IQueue>(initialQueue);\n    const { queue, status } = queueState;\n\n    const history = useHistory();\n\n    const theme = useTheme();\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const toggleQueueStatus = () => {\n        if (status === 'Stopped') {\n            client.get('/api/v1/downloads/start');\n        } else {\n            client.get('/api/v1/downloads/stop');\n        }\n    };\n\n    useEffect(() => {\n        setTitle('Download Queue');\n\n        setAction(() => {\n            if (status === 'Stopped') {\n                return (\n                    <IconButton onClick={toggleQueueStatus} size=\"large\">\n                        <PlayArrowIcon />\n                    </IconButton>\n                );\n            }\n            return (\n                <IconButton onClick={toggleQueueStatus} size=\"large\">\n                    <PauseIcon />\n                </IconButton>\n            );\n        });\n    }, [status]);\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/downloads`);\n        wsc.onmessage = (e) => {\n            setQueueState(JSON.parse(e.data));\n        };\n\n        setWsClient(wsc);\n    }, []);\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const onDragEnd = (result: DropResult) => {\n    };\n\n    if (queue.length === 0) {\n        return <EmptyView message=\"No downloads\" />;\n    }\n\n    return (\n        <>\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <List ref={provided.innerRef}>\n                            {queue.map((item, index) => (\n                                <Draggable\n                                    key={`${item.mangaId}-${item.chapterIndex}`}\n                                    draggableId={`${item.mangaId}-${item.chapterIndex}`}\n                                    index={index}\n                                >\n                                    {(provided, snapshot) => (\n                                        <ListItem\n                                            ContainerProps={{ ref: provided.innerRef } as any}\n                                            sx={{\n                                                display: 'flex',\n                                                justifyContent: 'flex-start',\n                                                alignItems: 'flex-start',\n                                                padding: 2,\n                                                margin: '10px',\n                                                '&:hover': {\n                                                    backgroundColor: 'action.hover',\n                                                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                                },\n                                                '&:active': {\n                                                    backgroundColor: 'action.selected',\n                                                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                                                },\n                                            }}\n                                            onClick={() => history.push(`/manga/${item.chapter.mangaId}`)}\n                                            {...provided.draggableProps}\n                                            {...provided.dragHandleProps}\n                                            style={getItemStyle(\n                                                snapshot.isDragging,\n                                                provided.draggableProps.style,\n                                                theme.palette,\n                                            )}\n                                            ref={provided.innerRef}\n                                        >\n                                            <ListItemIcon sx={{ margin: 'auto 0' }}>\n                                                <DragHandleIcon />\n                                            </ListItemIcon>\n                                            <Box sx={{ display: 'flex' }}>\n                                                <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n                                                    <Typography variant=\"h5\" component=\"h2\">\n                                                        {item.manga.title}\n                                                    </Typography>\n                                                    <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                                        {`${item.chapter.name} `\n                                                        + `(${(item.progress * 100).toFixed(2)}%)`\n                                                        + ` => state: ${item.state}`}\n                                                    </Typography>\n                                                </Box>\n                                            </Box>\n                                            <IconButton\n                                                sx={{ marginLeft: 'auto' }}\n                                                onClick={(e) => {\n                                                    // deleteCategory(index);\n                                                    // prevent parent tags from getting the event\n                                                    e.stopPropagation();\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <DeleteIcon />\n                                            </IconButton>\n                                        </ListItem>\n                                    )}\n                                </Draggable>\n\n                            ))}\n                            {provided.placeholder}\n                        </List>\n                    )}\n                </Droppable>\n            </DragDropContext>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport const ISOLanguages = [\n    { code: 'all', name: 'All', nativeName: 'All' },\n    { code: 'installed', name: 'Installed', nativeName: 'Installed' },\n    { code: 'updates pending', name: 'Updates pending', nativeName: 'Updates pending' },\n\n    { code: 'other', name: 'other langs?', nativeName: 'Other' },\n\n    { code: 'localsourcelang', name: 'Local source', nativeName: 'Local source' },\n\n    // full list: https://github.com/meikidd/iso-639-1/blob/master/src/data.js\n    { code: 'en', name: 'English', nativeName: 'English' },\n    { code: 'ca', name: 'Catalan; Valencian', nativeName: 'Català' },\n    { code: 'de', name: 'German', nativeName: 'Deutsch' },\n    { code: 'es', name: 'Spanish; Castilian', nativeName: 'Español' },\n    { code: 'es-419', name: 'Spanish; Castilian', nativeName: 'Español (Latinoamérica)' },\n    { code: 'fr', name: 'French', nativeName: 'Français' },\n    { code: 'id', name: 'Indonesian', nativeName: 'Indonesia' },\n    { code: 'it', name: 'Italian', nativeName: 'Italiano' },\n    { code: 'pt', name: 'Portuguese', nativeName: 'Português' },\n    { code: 'pt-pt', name: 'Portuguese', nativeName: 'Português (Portugal)' },\n    { code: 'pt-br', name: 'Portuguese; Brasil', nativeName: 'Português (Brasil)' },\n    { code: 'vi', name: 'Vietnamese', nativeName: 'Tiếng Việt' },\n    { code: 'tr', name: 'Turkish', nativeName: 'Türkçe' },\n    { code: 'ru', name: 'Russian', nativeName: 'русский' },\n    { code: 'ar', name: 'Arabic', nativeName: 'العربية' },\n    { code: 'hi', name: 'Hindi', nativeName: 'हिन्दी' },\n    { code: 'th', name: 'Thai', nativeName: 'ไทย' },\n    { code: 'zh', name: 'Chinese', nativeName: '中文' },\n    { code: 'zh-hans', name: 'Chinese', nativeName: '中文 (HANS)' },\n    { code: 'zh-hant', name: 'Chinese', nativeName: '中文 (HANT)' },\n    { code: 'zh-rhk', name: 'Chinese', nativeName: '中文 (RHK)' },\n    { code: 'zh-rtw', name: 'Chinese', nativeName: '中文 (RTW)' },\n\n    { code: 'ja', name: 'Japanese', nativeName: '日本語' },\n    { code: 'ko', name: 'Korean', nativeName: '한국어' },\n    { code: 'zu', name: 'Zulu', nativeName: 'isiZulu' },\n    { code: 'xh', name: 'Xhosa', nativeName: 'isiXhosa' },\n    { code: 'uk', name: 'Ukrainian', nativeName: 'Українська' },\n    { code: 'ro', name: 'Romanian', nativeName: 'Română' },\n    { code: 'bg', name: 'Bulgarian', nativeName: 'български' },\n    { code: 'cs', name: 'Czech', nativeName: 'čeština' },\n    { code: 'pl', name: 'Polish', nativeName: 'polski' },\n    { code: 'no', name: 'Norwegian', nativeName: 'Norsk' },\n    { code: 'nl', name: 'Dutch', nativeName: 'Nederlands' },\n    { code: 'my', name: 'Burmese', nativeName: 'ဗမာစာ' },\n    { code: 'ms', name: 'Malay', nativeName: 'Malaysia' },\n    { code: 'mn', name: 'Mongolian', nativeName: 'Монгол' },\n    { code: 'ml', name: 'Malayalam', nativeName: 'മലയാളം' },\n    { code: 'ku', name: 'Kurdish', nativeName: 'Kurdî' },\n    { code: 'hu', name: 'Hungarian', nativeName: 'Magyar' },\n    { code: 'hr', name: 'Croatian', nativeName: 'Hrvatski' },\n    { code: 'he', name: 'Hebrew', nativeName: 'עברית' },\n    { code: 'fil', name: 'Filipino', nativeName: 'Filipino' },\n    { code: 'fi', name: 'Finnish', nativeName: 'suomi' },\n    { code: 'fa', name: 'Persian', nativeName: 'فارسی' },\n    { code: 'eu', name: 'Basque', nativeName: 'euskara' },\n    { code: 'el', name: 'Greek', nativeName: 'Ελληνικά' },\n    { code: 'da', name: 'Danish', nativeName: 'dansk' },\n    { code: 'bn', name: 'Bengali', nativeName: 'বাংলা' },\n    { code: 'lt', name: 'Lithuanian', nativeName: 'lietuvių kalba' },\n    { code: 'sh', name: 'Serbo-Croatian', nativeName: 'srpskohrvatski' },\n\n    { code: 'af', name: 'Afrikaans', nativeName: 'Afrikaans' },\n    { code: 'am', name: 'Amharic', nativeName: 'አማርኛ' },\n    { code: 'az', name: 'Azerbaijani', nativeName: 'Azərbaycan' },\n    { code: 'be', name: 'Belarusian', nativeName: 'беларуская' },\n    { code: 'bs', name: 'Bosnian', nativeName: 'bosanski' },\n    { code: 'sv', name: 'Swedish', nativeName: 'svenska' },\n    { code: 'sv', name: 'Swedish', nativeName: 'svenska' },\n\n];\n\nexport function langCodeToName(code: string): string {\n    const whereToCut = code.indexOf('-') !== -1 ? code.indexOf('-') : code.length;\n\n    const proccessedCode = code.toLocaleLowerCase().substring(0, whereToCut);\n    let result = `language with code: ${code}`;\n\n    for (let i = 0; i < ISOLanguages.length; i++) {\n        if (ISOLanguages[i].code === proccessedCode\n            || ISOLanguages[i].code === code.toLocaleLowerCase()) {\n            result = ISOLanguages[i].nativeName;\n        }\n    }\n\n    return result;\n}\n\nfunction defaultNativeLang() {\n    return 'en'; // TODO: infer from the browser\n}\n\nexport function extensionDefaultLangs() {\n    return [\n        defaultNativeLang(),\n        'all',\n    ];\n}\n\nexport function sourceDefualtLangs() {\n    return [\n        defaultNativeLang(),\n        'localsourcelang',\n    ];\n}\n\nexport function sourceForcedDefaultLangs(): string[] {\n    return [\n        'localsourcelang',\n    ];\n}\n\nexport const langSortCmp = (a: string, b: string) => {\n    // puts english first for convience\n    const aLang = langCodeToName(a);\n    const bLang = langCodeToName(b);\n\n    if (a === 'en') return -1;\n    if (b === 'en') return 1;\n    if (a === 'localSourceLang') return 1;\n    if (b === 'localSourceLang') return -1;\n\n    return aLang > bLang ? 1 : -1;\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Button from '@mui/material/Button';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport Dialog from '@mui/material/Dialog';\nimport Switch from '@mui/material/Switch';\nimport IconButton from '@mui/material/IconButton';\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport { List, ListItemSecondaryAction, ListItemText } from '@mui/material';\nimport ListItem from '@mui/material/ListItem';\nimport { langCodeToName } from 'util/language';\nimport cloneObject from 'util/cloneObject';\n\nfunction removeAll(firstList: any[], secondList: any[]) {\n    secondList.forEach((item) => {\n        const index = firstList.indexOf(item);\n        if (index !== -1) {\n            firstList.splice(index, 1);\n        }\n    });\n\n    return firstList;\n}\n\ninterface IProps {\n    shownLangs: string[]\n    setShownLangs: (arg0: string[]) => void\n    allLangs: string[]\n    forcedLangs?: string[]\n}\n\nexport default function LangSelect(props: IProps) {\n    const {\n        shownLangs, setShownLangs, allLangs, forcedLangs,\n    } = props;\n    // hold a copy and only sate state on parent when OK pressed, improves performance\n    const [mShownLangs, setMShownLangs] = useState(\n        removeAll(cloneObject(shownLangs), forcedLangs!),\n    );\n    const [open, setOpen] = useState<boolean>(false);\n\n    const handleCancel = () => {\n        setOpen(false);\n    };\n\n    const handleOk = () => {\n        setOpen(false);\n        setShownLangs(mShownLangs);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, lang: string) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        if (checked) {\n            setMShownLangs([...mShownLangs, lang]);\n        } else {\n            const clone = cloneObject(mShownLangs);\n            clone.splice(clone.indexOf(lang), 1);\n            setMShownLangs(clone);\n        }\n    };\n\n    return (\n        <>\n            <IconButton\n                onClick={() => setOpen(true)}\n                aria-label=\"display more actions\"\n                edge=\"end\"\n                color=\"inherit\"\n                size=\"large\"\n            >\n                <FilterListIcon />\n            </IconButton>\n            <Dialog\n                sx={{\n                    '.MuiDialog-paper': {\n                        maxHeight: 435,\n                        width: '80%',\n                    },\n                }}\n                maxWidth=\"xs\"\n                open={open}\n            >\n                <DialogTitle>Enabled Languages</DialogTitle>\n                <DialogContent dividers sx={{ padding: 0 }}>\n                    <List>\n                        {allLangs.map((lang) => (\n                            <ListItem key={lang}>\n                                <ListItemText primary={langCodeToName(lang)} />\n\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        checked={mShownLangs.indexOf(lang) !== -1}\n                                        onChange={(e) => handleChange(e, lang)}\n                                    />\n                                </ListItemSecondaryAction>\n\n                            </ListItem>\n                        ))}\n                    </List>\n\n                </DialogContent>\n                <DialogActions>\n                    <Button autoFocus onClick={handleCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleOk} color=\"primary\">\n                        Ok\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n\nLangSelect.defaultProps = {\n    forcedLangs: [] as string[],\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport { useHistory } from 'react-router-dom';\nimport SearchIcon from '@mui/icons-material/Search';\nimport Button from '@mui/material/Button';\nimport IconButton from '@mui/material/IconButton';\nimport FiberNewOutlinedIcon from '@mui/icons-material/FiberNewOutlined';\nimport Avatar from '@mui/material/Avatar';\nimport Typography from '@mui/material/Typography';\nimport useLocalStorage from 'util/useLocalStorage';\nimport { langCodeToName } from 'util/language';\nimport { Box, styled } from '@mui/system';\n\nconst MobileWidthButtons = styled('div')(({ theme }) => ({\n    display: 'flex',\n    [theme.breakpoints.up('sm')]: {\n        display: 'none',\n    },\n}));\n\nconst WiderWidthButtons = styled('div')(({ theme }) => ({\n    display: 'flex',\n    [theme.breakpoints.down('sm')]: {\n        display: 'none',\n    },\n\n    '& .MuiButton-root': {\n        marginLeft: '20px',\n    },\n}));\n\ninterface IProps {\n    source: ISource\n}\n\nexport default function SourceCard(props: IProps) {\n    const {\n        source: {\n            id, name, lang, iconUrl, supportsLatest,\n        },\n    } = props;\n\n    const history = useHistory();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const redirectTo = (e: any, to: string) => {\n        history.push(to);\n\n        // prevent parent tags from getting the event\n        e.stopPropagation();\n    };\n\n    return (\n        <Card\n            sx={{\n                margin: '10px',\n                '&:hover': {\n                    backgroundColor: 'action.hover',\n                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                },\n                '&:active': {\n                    backgroundColor: 'action.selected',\n                    transition: 'background-color 100ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n                },\n            }}\n            onClick={(e) => redirectTo(e, `/sources/${id}/popular/`)}\n        >\n            <CardContent sx={{\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center',\n                padding: 2,\n            }}\n            >\n\n                <Box sx={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        alt={name}\n                        sx={{\n                            width: 56,\n                            height: 56,\n                            flex: '0 0 auto',\n                            mr: 2,\n                        }}\n                        src={`${serverAddress}${iconUrl}?useCache=${useCache}`}\n                    />\n                    <Box sx={{ display: 'flex', flexDirection: 'column', justifyContent: 'center' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        {id !== '0' && (\n                            <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                {langCodeToName(lang)}\n                            </Typography>\n                        )}\n                    </Box>\n                </Box>\n                <>\n                    <MobileWidthButtons>\n                        <IconButton\n                            sx={{ width: 59, height: 59 }}\n                            onClick={(e) => redirectTo(e, `/sources/${id}/search/`)}\n                            size=\"large\"\n                            edge=\"end\"\n                        >\n                            <SearchIcon\n                                fontSize=\"medium\"\n                            />\n                        </IconButton>\n                        {supportsLatest && (\n                            <IconButton\n                                onClick={(e) => redirectTo(e, `/sources/${id}/latest/`)}\n                                size=\"large\"\n                            >\n                                <FiberNewOutlinedIcon\n                                    fontSize=\"large\"\n                                />\n                            </IconButton>\n                        )}\n                    </MobileWidthButtons>\n                    <WiderWidthButtons>\n                        <Button\n                            variant=\"outlined\"\n                            onClick={(e) => redirectTo(e, `/sources/${id}/search/`)}\n                        >\n                            Search\n                        </Button>\n                        {supportsLatest && (\n                            <Button\n                                variant=\"outlined\"\n                                onClick={(e) => redirectTo(e, `/sources/${id}/latest/`)}\n                            >\n                                Latest\n                            </Button>\n                        )}\n                        <Button\n                            variant=\"outlined\"\n                            onClick={(e: any) => redirectTo(e, `/sources/${id}/popular/`)}\n                        >\n                            Browse\n                        </Button>\n                    </WiderWidthButtons>\n                </>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport LangSelect from 'components/navbar/action/LangSelect';\nimport SourceCard from 'components/SourceCard';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport {\n    sourceDefualtLangs, sourceForcedDefaultLangs, langCodeToName, langSortCmp,\n} from 'util/language';\nimport useLocalStorage from 'util/useLocalStorage';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\n\nfunction sourceToLangList(sources: ISource[]) {\n    const result: string[] = [];\n\n    sources.forEach((source) => {\n        if (result.indexOf(source.lang) === -1) { result.push(source.lang); }\n    });\n\n    result.sort(langSortCmp);\n    return result;\n}\n\nfunction groupByLang(sources: ISource[]) {\n    const result = {} as any;\n    sources.forEach((source) => {\n        if (result[source.lang] === undefined) { result[source.lang] = [] as ISource[]; }\n        result[source.lang].push(source);\n    });\n\n    return result;\n}\n\nexport default function Sources() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownSourceLangs', sourceDefualtLangs());\n    const [showNsfw] = useLocalStorage<boolean>('showNsfw', true);\n\n    const [sources, setSources] = useState<ISource[]>([]);\n    const [fetched, setFetched] = useState<boolean>(false);\n\n    useEffect(() => {\n        // make sure all of forcedDefaultLangs() exists in shownLangs\n        sourceForcedDefaultLangs().forEach((forcedLang) => {\n            let hasLang = false;\n            shownLangs.forEach((lang) => {\n                if (lang === forcedLang) hasLang = true;\n            });\n            if (!hasLang) {\n                setShownLangs((shownLangsCopy) => {\n                    shownLangsCopy.push(forcedLang);\n                    return shownLangsCopy;\n                });\n            }\n        });\n    }, []);\n\n    useEffect(() => {\n        setTitle('Sources');\n        setAction(\n            <LangSelect\n                shownLangs={shownLangs}\n                setShownLangs={setShownLangs}\n                allLangs={sourceToLangList(sources)}\n                forcedLangs={sourceForcedDefaultLangs()}\n            />,\n        );\n    }, [shownLangs, sources]);\n\n    useEffect(() => {\n        client.get('/api/v1/source/list')\n            .then((response) => response.data)\n            .then((data) => { setSources(data); setFetched(true); });\n    }, []);\n\n    if (sources.length === 0) {\n        if (fetched) return (<h3>No sources found. Install Some Extensions first.</h3>);\n        return <LoadingPlaceholder />;\n    }\n    return (\n        <>\n            {/* eslint-disable-next-line max-len */}\n            {Object.entries(groupByLang(sources)).sort((a, b) => langSortCmp(a[0], b[0])).map(([lang, list]) => (\n                shownLangs.indexOf(lang) !== -1 && (\n                    <React.Fragment key={lang}>\n                        <h1 key={lang} style={{ marginLeft: 25 }}>{langCodeToName(lang)}</h1>\n                        {(list as ISource[])\n                            .filter((source) => showNsfw || !source.isNsfw)\n                            .map((source) => (\n                                <SourceCard\n                                    key={source.id}\n                                    source={source}\n                                />\n                            ))}\n                    </React.Fragment>\n                )\n            ))}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport Button from '@mui/material/Button';\nimport Avatar from '@mui/material/Avatar';\nimport Typography from '@mui/material/Typography';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    extension: IExtension\n    notifyInstall: () => void\n}\n\nexport default function ExtensionCard(props: IProps) {\n    const {\n        extension: {\n            name, lang, versionName, installed, hasUpdate, obsolete, pkgName, iconUrl,\n        },\n        notifyInstall,\n    } = props;\n    const [installedState, setInstalledState] = useState<string>(\n        () => {\n            if (obsolete) { return 'obsolete'; }\n            if (hasUpdate) { return 'update'; }\n            return (installed ? 'uninstall' : 'install');\n        },\n    );\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const langPress = lang === 'all' ? 'All' : lang.toUpperCase();\n\n    function install() {\n        setInstalledState('installing');\n        client.get(`/api/v1/extension/install/${pkgName}`)\n            .then(() => {\n                setInstalledState('uninstall');\n                notifyInstall();\n            });\n    }\n\n    function update() {\n        setInstalledState('updating');\n        client.get(`/api/v1/extension/update/${pkgName}`)\n            .then(() => {\n                setInstalledState('uninstall');\n                notifyInstall();\n            });\n    }\n\n    function uninstall() {\n        setInstalledState('uninstalling');\n        client.get(`/api/v1/extension/uninstall/${pkgName}`)\n            .then(() => {\n                // setInstalledState('install');\n                notifyInstall();\n            });\n    }\n\n    function handleButtonClick() {\n        switch (installedState) {\n            case 'install':\n                install();\n                break;\n            case 'update':\n                update();\n                break;\n            case 'obsolete':\n                uninstall();\n                setTimeout(() => window.location.reload(), 3000);\n                break;\n            case 'uninstall':\n                uninstall();\n                break;\n            default:\n                break;\n        }\n    }\n\n    return (\n        <Card sx={{ margin: '10px' }}>\n            <CardContent sx={{\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center',\n                p: 2,\n            }}\n            >\n                <Box sx={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        sx={{\n                            width: 56,\n                            height: 56,\n                            flex: '0 0 auto',\n                            mr: 2,\n                        }}\n                        alt={name}\n                        src={`${serverAddress}${iconUrl}?useCache=${useCache}`}\n                    />\n                    <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                            {langPress}\n                            {' '}\n                            {versionName}\n                        </Typography>\n                    </Box>\n                </Box>\n\n                <Button\n                    variant=\"outlined\"\n                    sx={{ color: installedState === 'obsolete' ? 'red' : 'inherit' }}\n                    onClick={() => handleButtonClick()}\n                >\n                    {installedState}\n\n                </Button>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { fromEvent } from 'file-selector';\nimport IconButton from '@mui/material/IconButton';\nimport AddIcon from '@mui/icons-material/Add';\nimport ExtensionCard from 'components/ExtensionCard';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport LangSelect from 'components/navbar/action/LangSelect';\nimport { extensionDefaultLangs, langCodeToName, langSortCmp } from 'util/language';\nimport { makeToaster } from 'components/util/Toast';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport { useQueryParam, StringParam } from 'use-query-params';\nimport { Virtuoso } from 'react-virtuoso';\nimport { Typography, useMediaQuery, useTheme } from '@mui/material';\n\nconst LANGUAGE = 0;\nconst EXTENSIONS = 1;\n\nconst allLangs: string[] = [];\n\ninterface GroupedExtension {\n    [key: string]: IExtension[]\n}\n\nfunction groupExtensions(extensions: IExtension[]) {\n    allLangs.length = 0; // empty the array\n    const sortedExtenions: GroupedExtension = { installed: [], 'updates pending': [], all: [] };\n    extensions.forEach((extension) => {\n        if (sortedExtenions[extension.lang] === undefined) {\n            sortedExtenions[extension.lang] = [];\n            if (extension.lang !== 'all') { allLangs.push(extension.lang); }\n        }\n        if (extension.installed) {\n            if (extension.hasUpdate) {\n                sortedExtenions['updates pending'].push(extension);\n            } else {\n                sortedExtenions.installed.push(extension);\n            }\n        } else {\n            sortedExtenions[extension.lang].push(extension);\n        }\n    });\n\n    allLangs.sort(langSortCmp);\n    const result: [string, IExtension[]][] = [\n        ['updates pending', sortedExtenions['updates pending']],\n        ['installed', sortedExtenions.installed],\n        ['all', sortedExtenions.all],\n    ];\n\n    const langExt: [string, IExtension[]][] = allLangs.map((lang) => [lang, sortedExtenions[lang]]);\n\n    return result.concat(langExt);\n}\n\nexport default function MangaExtensions() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownExtensionLangs', extensionDefaultLangs());\n    const [showNsfw] = useLocalStorage<boolean>('showNsfw', true);\n    const theme = useTheme();\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\n    const [query] = useQueryParam('query', StringParam);\n\n    useEffect(() => {\n        setTitle('Extensions');\n        setAction(\n            <>\n                <AppbarSearch />\n                <IconButton\n                    onClick={\n                        () => document.getElementById('external-extension-file')?.click()\n                    }\n                    size=\"large\"\n                >\n                    <AddIcon />\n                </IconButton>\n                <LangSelect\n                    shownLangs={shownLangs}\n                    setShownLangs={setShownLangs}\n                    allLangs={allLangs}\n                />\n            </>,\n        );\n    }, [shownLangs]);\n\n    const [extensionsRaw, setExtensionsRaw] = useState<IExtension[]>([]);\n\n    const [updateTriggerHolder, setUpdateTriggerHolder] = useState(0); // just a hack\n    const triggerUpdate = () => setUpdateTriggerHolder(updateTriggerHolder + 1); // just a hack\n\n    useEffect(() => {\n        client.get('/api/v1/extension/list')\n            .then((response) => response.data)\n            .then((data) => setExtensionsRaw(data));\n    }, [updateTriggerHolder]);\n\n    const [toasts, makeToast] = makeToaster(useState<React.ReactElement[]>([]));\n\n    const submitExternalExtension = (file: File) => {\n        if (file.name.toLowerCase().endsWith('apk')) {\n            const formData = new FormData();\n            formData.append('file', file);\n\n            // empty the input\n            // @ts-ignore\n            document.getElementById('external-extension-file').value = null;\n\n            makeToast('Installing Extension File....', 'info');\n            client.post('/api/v1/extension/install',\n                formData, { headers: { 'Content-Type': 'multipart/form-data' } })\n                .then(() => {\n                    makeToast('Installed extension successfully!', 'success');\n                    triggerUpdate();\n                })\n                .catch(() => makeToast('Extension installion failed!', 'error'));\n        } else {\n            makeToast('invalid file type!', 'error');\n        }\n    };\n\n    const dropHandler = async (e: Event) => {\n        e.preventDefault();\n        const files = await fromEvent(e);\n\n        submitExternalExtension(files[0] as File);\n    };\n\n    const dragOverHandler = (e: Event) => {\n        e.preventDefault();\n    };\n\n    useEffect(() => {\n        document.addEventListener('drop', dropHandler);\n        document.addEventListener('dragover', dragOverHandler);\n\n        const changeHandler = async (evt: Event) => {\n            const files = await fromEvent(evt);\n            submitExternalExtension(files[0] as File);\n        };\n        const input = document.getElementById('external-extension-file');\n        input?.addEventListener('change', changeHandler);\n\n        return () => {\n            document.removeEventListener('drop', dropHandler);\n            document.removeEventListener('dragover', dragOverHandler);\n            input?.removeEventListener('change', changeHandler);\n        };\n    }, [extensionsRaw]); // useEffect only after <input> renders\n\n    if (extensionsRaw.length === 0) {\n        return <LoadingPlaceholder />;\n    }\n\n    const filtered = extensionsRaw.filter((ext) => {\n        const nsfwFilter = showNsfw || !ext.isNsfw;\n        if (!query) return nsfwFilter;\n        return nsfwFilter && ext.name.toLowerCase().includes(query.toLowerCase());\n    });\n\n    const combinedShownLangs = ['installed', 'updates pending', 'all', ...shownLangs];\n\n    const groupedExtensions: [string, IExtension[]][] = groupExtensions(filtered)\n        .filter((group) => group[EXTENSIONS].length > 0)\n        .filter((group) => combinedShownLangs.includes(group[LANGUAGE]));\n\n    const flatRenderItems: (IExtension | string)[] = groupedExtensions.flat(2);\n\n    return (\n        <>\n            {toasts}\n            <input\n                type=\"file\"\n                id=\"external-extension-file\"\n                style={{ display: 'none' }}\n            />\n            <Virtuoso\n                style={{\n                    height: isMobile ? 'calc(100vh - 64px - 64px)' : 'calc(100vh - 64px)',\n                }}\n                totalCount={flatRenderItems.length}\n                itemContent={(index) => {\n                    if (typeof (flatRenderItems[index]) === 'string') {\n                        const item = flatRenderItems[index] as string;\n                        return (\n                            <Typography\n                                key={item}\n                                variant=\"h2\"\n                                style={{\n                                    paddingLeft: 25,\n                                    paddingBottom: '0.83em',\n                                    paddingTop: '0.83em',\n                                    backgroundColor: 'rgb(18, 18, 18)',\n                                    fontSize: '2em',\n                                    fontWeight: 'bold',\n                                }}\n                            >\n                                {langCodeToName(item)}\n                            </Typography>\n                        );\n                    }\n                    const item = flatRenderItems[index] as IExtension;\n\n                    return (\n                        <ExtensionCard\n                            key={item.apkName}\n                            extension={item}\n                            notifyInstall={() => {\n                                triggerUpdate();\n                            }}\n                        />\n                    );\n                }}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Tabs from '@mui/material/Tabs';\nimport Tab from '@mui/material/Tab';\nimport TabPanel from 'components/util/TabPanel';\nimport Sources from 'screens/Sources';\nimport Extensions from 'screens/Extensions';\n\nexport default function Browse() {\n    const [tabNum, setTabNum] = useState<number>(0);\n\n    return (\n        <>\n            <Tabs\n                value={tabNum}\n                onChange={(e, newTab) => setTabNum(newTab)}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                centered\n                variant=\"fullWidth\"\n                scrollButtons\n                allowScrollButtonsMobile\n            >\n                <Tab sx={{ textTransform: 'none' }} label=\"Sources\" />\n                <Tab sx={{ textTransform: 'none' }} label=\"Extensions\" />\n            </Tabs>\n            <TabPanel index={0} currentIndex={tabNum}>\n                <Sources />\n            </TabPanel>\n            <TabPanel index={1} currentIndex={tabNum}>\n                <Extensions />\n            </TabPanel>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport NavBarContext from 'components/context/NavbarContext';\n\ninterface IProps{\n    children: React.ReactNode\n}\n\nexport default function NavBarProvider({ children }:IProps) {\n    const [title, setTitle] = useState<string>('Tachidesk');\n    const [action, setAction] = useState<any>(<div />);\n    const [override, setOverride] = useState<INavbarOverride>({\n        status: false,\n        value: <div />,\n    });\n\n    const value = {\n        title,\n        setTitle,\n        action,\n        setAction,\n        override,\n        setOverride,\n    };\n    return (\n        <NavBarContext.Provider value={value}>\n            {children}\n        </NavBarContext.Provider>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport LibraryOptionsContext from 'components/context/LibraryOptionsContext';\nimport useLocalStorage from 'util/useLocalStorage';\n\ninterface IProps {\n    children: React.ReactNode;\n}\n\nexport default function LibraryOptionsContextProvider({ children }: IProps) {\n    const [options, setOptions] = useLocalStorage<LibraryDisplayOptions>('libraryOptions',\n        { showDownloadBadge: false, showUnreadBadge: false });\n\n    return (\n        <LibraryOptionsContext.Provider value={{ options, setOptions }}>\n            {children}\n        </LibraryOptionsContext.Provider>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Redirect,\n} from 'react-router-dom';\nimport { QueryParamProvider } from 'use-query-params';\nimport { Container } from '@mui/material';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport {\n    createTheme,\n    ThemeProvider,\n    Theme,\n    StyledEngineProvider,\n} from '@mui/material/styles';\nimport DefaultNavBar from 'components/navbar/DefaultNavBar';\nimport DarkTheme from 'components/context/DarkTheme';\nimport useLocalStorage from 'util/useLocalStorage';\nimport Settings from 'screens/Settings';\nimport About from 'screens/settings/About';\nimport Categories from 'screens/settings/Categories';\nimport Backup from 'screens/settings/Backup';\nimport Library from 'screens/Library';\nimport SearchSingle from 'screens/SearchSingle';\nimport SourceConfigure from 'screens/SourceConfigure';\nimport Manga from 'screens/Manga';\nimport SourceMangas from 'screens/SourceMangas';\nimport Reader from 'screens/Reader';\nimport Updates from 'screens/Updates';\nimport DownloadQueue from 'screens/DownloadQueue';\nimport Browse from 'screens/Browse';\nimport Sources from 'screens/Sources';\nimport Extensions from 'screens/Extensions';\nimport NavBarContextProvider from 'components/navbar/NavBarContextProvider';\nimport LibraryOptionsContextProvider from 'components/library/LibraryOptionsProvider';\n\ndeclare module '@mui/styles/defaultTheme' {\n    // eslint-disable-next-line @typescript-eslint/no-empty-interface\n    interface DefaultTheme extends Theme {}\n}\n\nexport default function App() {\n    const [darkTheme, setDarkTheme] = useLocalStorage<boolean>(\n        'darkTheme',\n        true,\n    );\n\n    const darkThemeContext = {\n        darkTheme,\n        setDarkTheme,\n    };\n\n    const theme = React.useMemo(\n        () => createTheme({\n            palette: {\n                mode: darkTheme ? 'dark' : 'light',\n            },\n            components: {\n                MuiCssBaseline: {\n                    styleOverrides: `\n                        *::-webkit-scrollbar {\n                            width: 10px;\n                            background: ${darkTheme ? '#222' : '#e1e1e1'};   \n                        }\n                        \n                        *::-webkit-scrollbar-thumb {\n                            background: ${darkTheme ? '#111' : '#aaa'};\n                            border-radius: 5px;\n                        }\n                    `,\n                },\n            },\n        }),\n        [darkTheme],\n    );\n\n    return (\n        <Router>\n            <StyledEngineProvider injectFirst>\n                <ThemeProvider theme={theme}>\n                    <QueryParamProvider ReactRouterRoute={Route}>\n                        <LibraryOptionsContextProvider>\n                            <NavBarContextProvider>\n                                <CssBaseline />\n                                <DefaultNavBar />\n                                <Container\n                                    id=\"appMainContainer\"\n                                    maxWidth={false}\n                                    disableGutters\n                                    sx={{\n                                        mt: 8,\n                                        ml: { sm: 8 },\n                                        mb: { xs: 8, sm: 0 },\n                                        width: 'auto',\n                                        overflow: 'auto',\n                                    }}\n                                >\n                                    <Switch>\n                                        {/* General Routes */}\n                                        <Route\n                                            exact\n                                            path=\"/\"\n                                            render={() => (\n                                                <Redirect to=\"/library\" />\n                                            )}\n                                        />\n                                        <Route path=\"/settings/about\">\n                                            <About />\n                                        </Route>\n                                        <Route path=\"/settings/categories\">\n                                            <Categories />\n                                        </Route>\n                                        <Route path=\"/settings/backup\">\n                                            <Backup />\n                                        </Route>\n                                        <Route path=\"/settings\">\n                                            <DarkTheme.Provider\n                                                value={darkThemeContext}\n                                            >\n                                                <Settings />\n                                            </DarkTheme.Provider>\n                                        </Route>\n\n                                        {/* Manga Routes */}\n\n                                        <Route path=\"/sources/:sourceId/search/\">\n                                            <SearchSingle />\n                                        </Route>\n                                        <Route path=\"/sources/:sourceId/popular/\">\n                                            <SourceMangas popular />\n                                        </Route>\n                                        <Route path=\"/sources/:sourceId/latest/\">\n                                            <SourceMangas popular={false} />\n                                        </Route>\n                                        <Route path=\"/sources/:sourceId/configure/\">\n                                            <SourceConfigure />\n                                        </Route>\n                                        <Route path=\"/downloads\">\n                                            <DownloadQueue />\n                                        </Route>\n                                        <Route path=\"/manga/:mangaId/chapter/:chapterNum\">\n                                            <></>\n                                        </Route>\n                                        <Route path=\"/manga/:id\">\n                                            <Manga />\n                                        </Route>\n                                        <Route path=\"/library\">\n                                            <Library />\n                                        </Route>\n                                        <Route path=\"/updates\">\n                                            <Updates />\n                                        </Route>\n                                        <Route path=\"/sources\">\n                                            <Sources />\n                                        </Route>\n                                        <Route path=\"/extensions\">\n                                            <Extensions />\n                                        </Route>\n                                        <Route path=\"/browse\">\n                                            <Browse />\n                                        </Route>\n                                    </Switch>\n                                </Container>\n                                <Switch>\n                                    <Route\n                                        path=\"/manga/:mangaId/chapter/:chapterIndex\"\n                                        // passing a key re-mounts the reader when changing chapters\n                                        render={(props: any) => (\n                                            <Reader\n                                                key={\n                                                    props.match.params\n                                                        .chapterIndex\n                                                }\n                                            />\n                                        )}\n                                    />\n                                </Switch>\n                            </NavBarContextProvider>\n                        </LibraryOptionsContextProvider>\n                    </QueryParamProvider>\n                </ThemeProvider>\n            </StyledEngineProvider>\n        </Router>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n// roboto font\nimport '@fontsource/roboto';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n"],"sourceRoot":""}