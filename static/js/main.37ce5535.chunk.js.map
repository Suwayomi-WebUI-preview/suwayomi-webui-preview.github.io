{"version":3,"sources":["components/context/LibraryOptionsContext.tsx","util/localStorage.tsx","util/useLocalStorage.tsx","components/library/LibraryOptionsProvider.tsx","components/context/NavbarContext.tsx","components/navbar/NavBarContextProvider.tsx","util/client.tsx","theme.ts","components/context/DarkTheme.tsx","components/context/AppContext.tsx","components/util/CustomExtensionOutlinedIcon.tsx","util/useBackTo.ts","components/navbar/navigation/DesktopSideBar.tsx","components/navbar/navigation/MobileBottomBar.tsx","components/navbar/DefaultNavBar.tsx","components/util/TabPanel.tsx","util/language.tsx","util/cloneObject.tsx","components/navbar/action/LangSelect.tsx","components/SourceCard.tsx","components/util/LoadingPlaceholder.tsx","screens/Sources.tsx","components/ExtensionCard.tsx","components/util/Toast.tsx","components/util/AppbarSearch.tsx","screens/Extensions.tsx","screens/Browse.tsx","components/util/EmptyView.tsx","components/library/useSubscription.ts","components/molecules/DownloadStateIndicator.tsx","screens/DownloadQueue.tsx","components/atoms/CheckboxInput.tsx","components/atoms/RadioInput.tsx","components/atoms/SortRadioInput.tsx","components/atoms/ThreeStateCheckbox.tsx","components/atoms/ThreeStateCheckboxInput.tsx","components/molecules/OptionsPanel.tsx","components/molecules/OptionsTabs.tsx","components/library/LibraryOptionsPanel.tsx","components/library/LibraryToolbarMenu.tsx","components/util/SpinnerImage.tsx","components/MangaCard.tsx","components/MangaGrid.tsx","components/library/LibraryMangaGrid.tsx","components/library/UpdateChecker.tsx","screens/Library.tsx","util/date.ts","components/manga/ChapterCard.tsx","components/manga/ResumeFAB.tsx","components/manga/util.tsx","components/util/helpers.ts","components/manga/ChapterOptions.tsx","components/manga/ChaptersToolbarMenu.tsx","components/manga/SelectionFABActionItem.tsx","components/manga/SelectionFAB.tsx","components/manga/ChapterList.tsx","components/manga/MangaDetails.tsx","components/navbar/action/CategorySelect.tsx","components/manga/MangaToolbarMenu.tsx","screens/Manga.tsx","components/manga/hooks.ts","components/reader/Page.tsx","components/reader/pager/HorizontalPager.tsx","components/reader/PageNumber.tsx","components/reader/pager/PagedPager.tsx","components/reader/DoublePage.tsx","components/reader/pager/DoublePagedPager.tsx","components/reader/pager/VerticalPager.tsx","components/reader/ReaderSettingsOptions.tsx","components/navbar/ReaderNavBar.tsx","util/metadata.ts","util/readerSettings.ts","screens/Reader.tsx","screens/SearchAll.tsx","components/util/ListItemLink.tsx","screens/Settings.tsx","screens/settings/About.tsx","screens/settings/Backup.tsx","screens/settings/Categories.tsx","screens/settings/DefaultReaderSettings.tsx","components/sourceConfiguration/TwoStatePreference.tsx","components/sourceConfiguration/ListPreference.tsx","components/sourceConfiguration/EditTextPreference.tsx","components/sourceConfiguration/MultiSelectListPreference.tsx","screens/SourceConfigure.tsx","components/source/SourceMangaGrid.tsx","components/source/filters/CheckBoxFilter.tsx","components/source/filters/HeaderFilter.tsx","components/source/filters/SelectFilter.tsx","components/source/filters/SortFilter.tsx","components/source/filters/TextFilter.tsx","components/source/filters/TriStateFilter.tsx","components/source/filters/GroupFilter.tsx","components/source/filters/SeparatorFilter.tsx","components/source/SourceOptions.tsx","components/source/GridLayouts.tsx","screens/SourceMangas.tsx","screens/Updates.tsx","i18n/translations.ts","App.tsx","i18n/index.ts","index.tsx"],"names":["GridLayout","DefaultLibraryOptions","showDownloadBadge","showUnreadBadge","gridLayout","Compact","SourcegridLayout","downloaded","undefined","sortDesc","sorts","unread","LibraryOptionsContext","React","createContext","options","setOptions","useLibraryOptionsContext","useContext","getItem","key","defaultValue","item","window","localStorage","JSON","parse","setItem","stringify","value","useLocalStorage","initialState","Function","useState","storage","storedValue","setStoredValue","useCallback","prevValue","valueToStore","LibraryOptionsContextProvider","children","Provider","NavBarContext","defaultBackTo","setDefaultBackTo","title","setTitle","action","setAction","override","status","setOverride","useNavBarContext","NavBarProvider","newTitle","document","inferredPort","createTheme","dark","baseTheme","createMuiTheme","palette","mode","custom","main","common","black","white","light","grey","components","MuiCssBaseline","styleOverrides","location","hostname","port","protocol","baseURL","client","axios","create","interceptors","request","use","config","data","FormData","Object","assign","headers","fetcher","path","a","get","res","Error","statusText","useQuery","useSWR","loading","error","DarkTheme","darkTheme","setDarkTheme","AppContext","darkThemeContext","useMemo","theme","StyledEngineProvider","injectFirst","ThemeProvider","ReactRouterRoute","Route","icon","createSvgIcon","d","BACK","useBackTo","useLocation","url","state","backLink","back","SideNavBarContainer","styled","height","width","spacing","backgroundColor","position","top","left","paddingTop","display","flexDirection","DesktopSideBar","navBarItems","useTheme","iconFor","IconComponent","SelectedIconComponent","pathname","sx","color","fontSize","map","to","style","textDecoration","ListItem","disableRipple","button","ListItemIcon","minWidth","Tooltip","placement","BottomNavContainer","bottom","justifyContent","alignItems","zIndex","Link","RRDLink","flex","MobileBottomBar","padding","Box","navbarItems","t","CollectionsBookmarkIcon","CollectionsOutlinedBookmarkIcon","show","NewReleasesIcon","NewReleasesOutlinedIcon","ExtensionIcon","ExtensionOutlinedIcon","ExploreIcon","ExploreOutlinedIcon","GetAppIcon","GetAppOutlinedIcon","SettingsIcon","DefaultNavBar","backTo","history","useHistory","isMobileWidth","useMediaQuery","breakpoints","down","isMainRoute","some","navbar","filter","it","flexGrow","AppBar","Toolbar","IconButton","component","edge","marginRight","size","onClick","goBack","Typography","variant","noWrap","textOverflow","id","NavbarToolbar","container","getElementById","createPortal","TabPanel","props","index","currentIndex","role","hidden","ISOLanguages","code","name","nativeName","langCodeToName","whereToCut","indexOf","length","proccessedCode","toLocaleLowerCase","substring","result","i","langSortCmp","b","aLang","bLang","cloneObject","obj","LangSelect","firstList","shownLangs","setShownLangs","allLangs","forcedLangs","forEach","splice","mShownLangs","setMShownLangs","open","setOpen","Dialog","maxHeight","maxWidth","DialogTitle","DialogContent","dividers","List","lang","ListItemText","primary","ListItemSecondaryAction","Switch","checked","onChange","e","event","target","clone","handleChange","DialogActions","Button","autoFocus","defaultProps","MobileWidthButtons","up","WiderWidthButtons","marginLeft","SourceCard","source","iconUrl","supportsLatest","isNsfw","serverAddress","useCache","Card","margin","CardActionArea","CardContent","Avatar","alt","mr","src","gutterBottom","push","stopPropagation","redirectTo","LoadingPlaceholder","shouldRender","componentProps","condition","createElement","CircularProgress","thickness","sourceToLangList","sources","sort","groupByLang","Sources","NavbarContext","showNsfw","useEffect","forcedLang","hasLang","shownLangsCopy","entries","list","Fragment","ExtensionCard","extension","versionName","installed","hasUpdate","obsolete","pkgName","notifyInstall","installedState","setInstalledState","langPress","toUpperCase","uninstall","then","handleButtonClick","setTimeout","reload","p","Transition","Slide","direction","Toast","message","severity","handleClose","Snackbar","onClose","autoHideDuration","TransitionComponent","elevation","makeToast","Math","floor","random","body","appendChild","ReactDOM","render","querySelector","unmountComponentAtNode","removeChild","removeToast","AppbarSearch","autoOpen","useQueryParam","StringParam","query","setQuery","searchOpen","setSearchOpen","inputRef","useRef","openSearch","current","focus","handleSearchShortcut","ctrlKey","preventDefault","addEventListener","removeEventListener","Input","onBlur","endAdornment","MangaExtensions","isMobile","click","allExtensions","mutate","filteredExtensions","ext","nsfwFilter","toLowerCase","includes","flatRenderItems","extensions","sortedExtenions","all","langExt","concat","groupExtensions","group","flat","toasts","setToasts","makeToaster","submitExternalExtension","file","endsWith","formData","append","post","catch","dropHandler","fromEvent","files","dragOverHandler","type","ref","totalCount","itemContent","paddingLeft","paddingBottom","fontWeight","apkName","Browse","useTranslation","tabNum","setTabNum","Tabs","newTab","indicatorColor","textColor","centered","scrollButtons","allowScrollButtonsMobile","Tab","textTransform","label","ERROR_FACES","EmptyView","messageExtra","errorFace","randIndex","getRandomErrorFace","transform","textAlign","baseWebsocketUrl","replace","useSubscription","callback","setState","wsc","WebSocket","onmessage","close","DownloadStateIndicator","download","progress","right","round","initialQueue","queue","DownloadQueue","queueState","onDragEnd","droppableId","provided","innerRef","pt","draggableId","mangaId","chapterIndex","snapshot","draggableProps","dragHandleProps","pb","isDragging","chapter","pointerEvents","Stack","ml","manga","Promise","delete","placeholder","CheckboxInput","rest","FormControlLabel","control","Checkbox","RadioInput","Radio","SortRadioInput","sortDescending","checkedIcon","ThreeStateCheckbox","newState","indeterminateIcon","DisabledByDefaultRounded","indeterminate","ThreeStateCheckboxInput","OptionsPanel","minHeight","Drawer","anchor","PaperProps","OptionsTabs","tabs","tabTitle","tabContent","tab","tabIndex","px","py","TITLES","SORT_OPTIONS","LibraryOptionsPanel","handleFilterChange","v","c","FormLabel","RadioGroup","Number","Comfortable","mt","LibraryToolbarMenu","active","SpinnerImage","onImageLoad","imgRef","spinnerStyle","imgStyle","imageSrc","setImagsrc","img","Image","onload","onerror","BottomGradient","background","BottomGradientDoubledDown","MangaTitle","BadgeContainer","borderRadius","overflow","paddingInline","truncateText","str","maxLength","trimmedString","substr","MangaCard","forwardRef","thumbnailUrl","downloadCount","unreadCount","inLibrary","dimensions","inLibraryIndicator","ItemWidth","mangaLinkTo","cols","ceil","Grid","columns","xs","aspectRatio","objectFit","placeItems","textShadow","imageRendering","MangaGrid","mapped","mangas","isLoading","hasNextPage","lastPageNum","setLastPageNum","horizontal","noFaces","lastManga","scrollHandler","rect","getBoundingClientRect","y","innerHeight","movementTimer","setDimensions","gridRef","TestDimensions","offsetWidth","useLayoutEffect","clearInterval","idx","overflowX","flexWrap","sortByUnread","sortByTitle","localeCompare","sortById","LibraryMangaGrid","lastLibraryUpdate","filteredPaginatedMangas","setFilteredPaginatedMangas","sortedManga","setSortedManga","filteredManga","setFilteredManga","totalPages","defaultPageNumber","titleFilteredManga","m","queryFilter","genreFilteredManga","genre","split","trim","every","element","el","queryGenreFilter","unique","reduce","acc","values","downloadedFilter","unreadFilter","filterManga","scrollTo","desc","reverse","sortManga","slice","showFilteredOutMessage","Progress","UpdateChecker","handleFinishedUpdate","setLoading","setProgress","updateStarted","running","statusMap","COMPLETE","RUNNING","PENDING","currentProgress","isUpdateFinished","isNaN","Date","now","disabled","Library","setLastLibraryUpdate","tabsData","tabsError","NumberParam","tabSearchParam","setTabSearchParam","activeTab","find","order","isPaused","mangaData","mangaError","mangaLoading","scrollableTabs","innerWidth","handleTabChange","isWithinLastXMillis","date","timeMS","getTime","getUploadDateString","uploadDate","today","todayElapsedTime","startOfDay","getFullYear","getMonth","getDate","getElapsedTimeSinceStartOfDay","yesterday","elapsedTimeSinceYesterday","wasUploadedToday","wasUploadedYesterday","timeString","toLocaleTimeString","hour","minute","toLocaleDateString","year","month","day","ChapterCard","triggerChaptersUpdate","dc","downloadChapter","showChapterNumber","onSelect","selected","isSelecting","anchorEl","setAnchorEl","sendChange","patch","isDownloaded","canBeDownloaded","text","read","bookmarked","chapterNumber","scanlator","currentTarget","Menu","keepMounted","Boolean","MenuItem","ResumeFab","lastPageRead","Fab","defaultChapterOptions","sortBy","chapterOptionsReducer","actions","filterType","filterValue","useChapterOptions","reducer","defaultState","setValue","useReducer","useReducerLocalStorage","pluralize","count","input","interpolate","one","many","replaceAll","toString","ChapterOptions","optionsDispatch","ChaptersToolbarMenu","isFiltered","isFilterActive","ICONS","Download","Delete","bookmark","BookmarkAdd","unbookmark","BookmarkRemove","mark_as_read","Done","mark_as_unread","RemoveDone","SelectionFABActionItem","matchingChapters","Icon","SelectionFAB","selectedChapters","onAction","handleAction","chapters","anchorOrigin","vertical","transformOrigin","MenuListProps","StyledVirtuoso","Virtuoso","listStyle","actionsStrings","success","ChapterList","selection","setSelection","prevQueueRef","dispatch","chaptersData","prevQueue","cd","prevChapterDownload","pcd","visibleChapters","filtered","chp","isChapterRead","chapterDownload","downloadFilter","chapterBookmarked","bookmarkedFilter","Sorted","fetchedAt","filterAndSortChapters","firstUnreadChapter","noChaptersFound","noChaptersMatchingFilter","chaptersWithMeta","mb","overflowY","newSelection","cid","handleSelection","useWindowScroll","overscan","actionChapters","actionPromise","chapterIds","change","isBookmarked","isRead","getValueOrUnknown","val","MangaDetails","classes","makeStyles","root","alignSelf","leftRight","leftSide","rightSide","buttons","paddingRight","description","marginTop","marginBottom","textJustify","border","className","author","artist","displayName","revalidate","sm","href","realUrl","rel","g","CategorySelect","mangaCategoriesData","categoriesData","allCategories","cats","shift","selectedIds","FormGroup","category","categoryId","MangaToolbarMenu","onRefresh","refreshing","isLargeScreen","editCategories","setEditCategories","Manga","useParams","autofetchedRef","isValidating","fetchingOnline","setFetchingOnline","finally","useRefreshManga","refresh","useSetDefaultBackTo","sourceId","age","chaptersAge","md","Warning","Page","settings","handleResize","readerType","imageStyle","HorizontalPager","pages","curPage","initialPage","setCurPage","prevChapter","nextChapter","currentPageRef","selfRef","pagesRef","nextPage","scrollIntoView","inline","page","loadNextOnEnding","prevPage","mouseXPos","dragScreen","scrollBy","pageX","dragControl","removeDragControl","clickControl","clientX","handleLoadNextonEnding","scrollX","scrollWidth","handleScroll","currentPage","wrapper","child","findCurrentPageIndex","userSelect","PageNumber","pageCount","showPageNumber","staticNav","PagedReader","changePage","newPage","scroll","goLeft","goRight","keyboardControl","DoublePage","image1src","image2src","DoublePagedPager","pagesDisplayed","pageLoaded","Array","fill","spreadPage","nextCurPage","spreadPages","isLastPage","lastIndexOf","pagesToGoBack","retryDisplay","setInterval","setPagesToDisplay","onLoad","image","isSpreadPage","isAtBottom","scrollY","offsetHeight","VerticalPager","go","behavior","handleKeyboard","ReaderSettingsOptions","setSettingValue","Select","Root","default","hover","transition","flexShrink","Navigation","PageNavigation","alignContent","ChapterNavigation","gridTemplateRows","gridTemplateColumns","gridTemplateAreas","gridColumnGap","MenuProps","OpenDrawerButton","ReaderNavBar","prevDrawerOpen","prevSettingsCollapseOpen","scrollToPage","drawerOpen","setDrawerOpen","updateDrawerOnRender","setUpdateDrawerOnRender","hideOpenButton","setHideOpenButton","prevScrollPos","setPrevScrollPos","settingsCollapseOpen","setSettingsCollapseOpen","updateDrawer","currentScrollPos","pageYOffset","abs","rootEl","mainContainer","in","timeout","appear","mountOnEnter","unmountOnExit","ContainerComponent","disableFocusRipple","Collapse","Divider","my","mx","FormControl","displayEmpty","selectedPage","max","ignoreValue","gridArea","selectedChapter","chapterCount","Zoom","Fade","APP_METADATA_KEY_PREFIX","migrations","keys","oldKey","newKey","getMetadataKey","appPrefix","doesMetadataKeyExistIn","meta","prototype","hasOwnProperty","call","convertValueFromMetadata","getAppMetadataFrom","appMetadata","startsWith","applyMetadataMigrations","migrationToMetadata","migration","migrationId","metadataKeysMigrated","migratedMetadata","applyMetadataKeyMigration","appKeyPrefix","oldPrefix","newPrefix","oldAppMetadata","newAppMetadata","missingMetadataKeys","keyWithNewPrefix","applyAppKeyPrefixMigration","pop","getMetadataFrom","keysToDefaultValues","applyMigrations","metadata","getMetadataValueFrom","wrapMetadataWithMetaKey","wrap","requestUpdateMetadataValue","endpoint","metadataHolder","endpointToMutate","wrapWithMetaKey","restApiVersion","urlToMutate","metadataKey","valueAsString","mutatedMetadata","requestUpdateMetadata","keysToValues","requestUpdateServerMetadata","serverMetadata","requestUpdateMangaMetadata","getDefaultSettings","forceUndefined","continuesPageGap","getReaderSettingsWithDefaultValueFallback","defaultSettings","applyMetadataMigration","getReaderSettingsFor","getReaderSettingsFromMetadata","useDefaultReaderSettings","checkAndHandleMissingStoredReaderSettings","metadataHolderType","settingsToCheck","newSettings","undefinedSettings","setting","settingsToUpdate","initialChapter","Reader","setManga","setChapter","pageToScrollTo","setPageToScrollTo","areDefaultSettingsLoading","setSettings","isMangaLoading","setIsMangaLoading","response","formDataRead","n","from","ReaderComponent","PagedPager","getReaderComponent","SearchAll","triggerUpdate","setTriggerUpdate","setMangas","setSources","fetched","setFetched","FetchedSources","setFetchedSources","ResetUI","setResetUI","limit","PQueue","concurrency","elem","ele","add","tmp","mangaList","tmp2","doIT","delayDebounceFn","clearTimeout","af","bf","al","bl","ListItemLink","directLink","Settings","setServerAddress","setShowNsfw","setUseCache","dialogOpen","setDialogOpen","dialogValue","setDialogValue","dialogOpenItemWidth","setDialogOpenItemWidth","setItemWidth","DialogItemWidth","setDialogItemWidth","handleDialogCancel","handleDialogCancelItemWidth","ListItemButton","secondary","DialogContentText","TextField","fullWidth","parseInt","Slider","step","min","newValue","About","about","buildType","version","revision","buildTime","toUTCString","github","discord","Backup","defaults","submitBackup","evt","Categories","categories","categoryToEdit","setCategoryToEdit","dialogName","setDialogName","dialogDefault","setDialogDefault","destination","newData","removed","categoryReorder","ContainerProps","draggableStyle","handleEditDialogOpen","deleteCategory","DefaultReaderSettings","getTwoStateType","TwoSatePreference","summary","currentValue","updateValue","internalCurrentValue","setInternalCurrentValue","CheckBoxPreference","SwitchPreferenceCompat","ListDialog","valueProp","radioGroupRef","TransitionProps","onEntering","option","ListPreference","entryValues","findEntryOf","findEntryValueOf","EditTextPreference","dialogTitle","dialogMessage","selectedValuesProp","selectedValues","setSelectedValues","selectedValue","hasEntry","selectedValuesClone","MultiSelectListPreference","SourceConfigure","sourcePreferences","convertToString","defaultValueType","getPrefComponent","SourceMangaGrid","CheckBoxFilter","updateFilterValue","update","setval","upd","HeaderFilter","SelectFilter","rett","InputLabel","vall","noSelect","displayname","hasSelect","SortFilter","ExpandLess","ExpandMore","ascending","TextFilter","typingTimer","Search","setsearch","doneTyping","InputAdornment","TriStateFilter","GroupFilter","Options","sourceFilter","SeparatorFilter","checkif","displayValues","SourceOptions","resetFilterValue","setSearch","FilterOptions","setFilterOptions","SourceGridLayout","setGridContextOptions","prev","SourceMangas","isConfigurable","setIsConfigurable","setHasNextPage","setquery","reset","setReset","setUpdate","Data","SetData","Init","setInit","Noreset","setNoreset","makeFilters","rep","sourceType","popular","isTheSameDay","first","second","groupByDate","updates","groups","globalIdx","setDate","getDateString","epoch","setUTCSeconds","epochToDate","lng","Updates","updateEntries","setUpdateEntries","setWsClient","setQueueState","fetchedHasNextPage","lastEntry","dateGroup","q","downloadForChapter","resources","en","translation","App","initReactI18next","LanguageDetector","init","fallbackLng","interpolation","escapeValue","returnNull","debug","process","CssBaseline","Container","disableGutters","exact","match","params","StrictMode"],"mappings":"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","file":"static/js/main.37ce5535.chunk.js","sourcesContent":["/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext } from 'react';\n\ntype ContextType = {\n    options: LibraryOptions;\n    setOptions: React.Dispatch<React.SetStateAction<LibraryOptions>>;\n};\n\nexport enum GridLayout {\n    Compact = 0,\n    Comfortable = 1,\n    List = 2,\n}\n\nexport const DefaultLibraryOptions: LibraryOptions = {\n    showDownloadBadge: false,\n    showUnreadBadge: false,\n    gridLayout: GridLayout.Compact,\n    SourcegridLayout: GridLayout.Compact,\n\n    downloaded: undefined,\n    sortDesc: undefined,\n    sorts: undefined,\n    unread: undefined,\n};\n\nconst LibraryOptionsContext = React.createContext<ContextType>({\n    options: DefaultLibraryOptions,\n    setOptions: () => {},\n});\n\nexport default LibraryOptionsContext;\n\nexport function useLibraryOptionsContext() {\n    return useContext(LibraryOptionsContext);\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nfunction getItem<T>(key: string, defaultValue: T): T {\n    try {\n        const item = window.localStorage.getItem(key);\n\n        if (item !== null) {\n            return JSON.parse(item);\n        }\n\n        window.localStorage.setItem(key, JSON.stringify(defaultValue));\n\n        /* eslint-disable no-empty */\n    } finally {\n    }\n    return defaultValue;\n}\n\nfunction setItem<T>(key: string, value: T): void {\n    try {\n        window.localStorage.setItem(key, JSON.stringify(value));\n\n        // eslint-disable-next-line no-empty\n    } finally {\n    }\n}\n\nexport default { getItem, setItem };\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, Dispatch, SetStateAction, useReducer, Reducer, useCallback } from 'react';\nimport storage from 'util/localStorage';\n\n// eslint-disable-next-line max-len\nexport default function useLocalStorage<T>(key: string, defaultValue: T | (() => T)): [T, Dispatch<SetStateAction<T>>] {\n    const initialState = defaultValue instanceof Function ? defaultValue() : defaultValue;\n    const [storedValue, setStoredValue] = useState<T>(storage.getItem(key, initialState));\n\n    const setValue = useCallback<React.Dispatch<React.SetStateAction<T>>>(\n        (value) => {\n            setStoredValue((prevValue) => {\n                // Allow value to be a function so we have same API as useState\n                const valueToStore = value instanceof Function ? value(prevValue) : value;\n                storage.setItem(key, valueToStore);\n                return valueToStore;\n            });\n        },\n        [key],\n    );\n\n    return [storedValue, setValue];\n}\n\nexport function useReducerLocalStorage<S, A>(reducer: Reducer<S, A>, key: string, defaultState: S | (() => S)) {\n    const [storedValue, setValue] = useLocalStorage(key, defaultState);\n    return useReducer((state: S, action: A): S => {\n        const newState = reducer(state, action);\n        setValue(newState);\n        return newState;\n    }, storedValue);\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport LibraryOptionsContext, { DefaultLibraryOptions } from 'components/context/LibraryOptionsContext';\nimport React from 'react';\nimport useLocalStorage from 'util/useLocalStorage';\n\ninterface IProps {\n    children: React.ReactNode;\n}\n\nconst LibraryOptionsContextProvider: React.FC<IProps> = ({ children }) => {\n    const [options, setOptions] = useLocalStorage<LibraryOptions>('libraryOptions', DefaultLibraryOptions);\n\n    return <LibraryOptionsContext.Provider value={{ options, setOptions }}>{children}</LibraryOptionsContext.Provider>;\n};\n\nexport default LibraryOptionsContextProvider;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\n\ntype ContextType = {\n    // Default back button url\n    defaultBackTo: string | undefined;\n    setDefaultBackTo: React.Dispatch<React.SetStateAction<string | undefined>>;\n\n    // AppBar title\n    title: string;\n    setTitle: (title: string) => void;\n\n    // AppBar action buttons\n    action: any;\n    setAction: React.Dispatch<React.SetStateAction<any>>;\n\n    // Allow default navbar to be overrided\n    override: INavbarOverride;\n    setOverride: React.Dispatch<React.SetStateAction<INavbarOverride>>;\n};\n\nconst NavBarContext = React.createContext<ContextType>({\n    defaultBackTo: undefined,\n    setDefaultBackTo: (): void => {},\n    title: 'Tachidesk',\n    setTitle: (): void => {},\n    action: <div />,\n    setAction: (): void => {},\n    override: { status: false, value: <div /> },\n    setOverride: (): void => {},\n});\n\nexport default NavBarContext;\n\nexport const useNavBarContext = () => useContext(NavBarContext);\n\nexport const useSetDefaultBackTo = (value: string) => {\n    const { setDefaultBackTo } = useNavBarContext();\n\n    useEffect(() => {\n        setDefaultBackTo(value);\n        return () => setDefaultBackTo(undefined);\n    }, [value]);\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport NavBarContext from 'components/context/NavbarContext';\n\ninterface IProps {\n    children: React.ReactNode;\n}\n\nexport default function NavBarProvider({ children }: IProps) {\n    const [defaultBackTo, setDefaultBackTo] = useState<string | undefined>();\n    const [title, setTitle] = useState<string>('Tachidesk');\n    const [action, setAction] = useState<any>(<div />);\n    const [override, setOverride] = useState<INavbarOverride>({\n        status: false,\n        value: <div />,\n    });\n\n    const updateTitle = (newTitle: string) => {\n        document.title = `${newTitle} - Tachidesk`;\n        setTitle(newTitle);\n    };\n\n    const value = {\n        defaultBackTo,\n        setDefaultBackTo,\n        title,\n        setTitle: updateTitle,\n        action,\n        setAction,\n        override,\n        setOverride,\n    };\n    return <NavBarContext.Provider value={value}>{children}</NavBarContext.Provider>;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport axios from 'axios';\nimport useSWR, { SWRConfiguration, SWRResponse } from 'swr';\nimport storage from 'util/localStorage';\n\nconst { hostname, port, protocol } = window.location;\n\n// if port is 3000 it's probably running from webpack devlopment server\nlet inferredPort;\nif (port === '3000') {\n    inferredPort = '4567';\n} else {\n    inferredPort = port;\n}\n\nconst baseURL = storage.getItem('serverBaseURL', `${protocol}//${hostname}:${inferredPort}`);\n\nconst client = axios.create({\n    // baseURL must not have traling slash\n    baseURL,\n});\n\nclient.interceptors.request.use((config) => {\n    if (config.data instanceof FormData) {\n        Object.assign(config.headers, { 'Content-Type': 'multipart/form-data' });\n    }\n    return config;\n});\n\nexport default client;\n\nexport async function fetcher<T = any>(path: string) {\n    const res = await client.get(path);\n    if (res.status !== 200) {\n        throw new Error(res.statusText);\n    }\n    if (res.headers['content-type'] !== 'application/json') {\n        throw new Error('Response is not json');\n    }\n    return res.data as T;\n}\n\nexport const useQuery = <D extends any = any, E extends any = any>(\n    key: string,\n    config?: SWRConfiguration<D, E>,\n): SWRResponse<D, E> & { loading: boolean } => {\n    const res = useSWR(key, config);\n    return {\n        ...res,\n        loading: res.data == null && res.error == null,\n    };\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { Theme, createTheme as createMuiTheme } from '@mui/material/styles';\n\ndeclare module '@mui/styles/defaultTheme' {\n    interface DefaultTheme extends Theme {}\n}\n\ndeclare module '@mui/material/styles' {\n    interface PaletteOptions {\n        custom?: PaletteOptions['primary'];\n    }\n}\n\nconst createTheme = (dark?: boolean) => {\n    const baseTheme = createMuiTheme({\n        palette: {\n            mode: dark ? 'dark' : 'light',\n        },\n    });\n\n    const tachideskTheme = createMuiTheme(\n        {\n            palette: {\n                custom: {\n                    main: dark ? baseTheme.palette.common.black : baseTheme.palette.common.white,\n                    light: dark ? baseTheme.palette.grey[900] : baseTheme.palette.grey[100],\n                },\n            },\n            components: {\n                MuiCssBaseline: {\n                    styleOverrides: `\n                *::-webkit-scrollbar {\n                    width: 10px;\n                    background: ${dark ? '#222' : '#e1e1e1'};   \n                }\n                \n                *::-webkit-scrollbar-thumb {\n                    background: ${dark ? '#111' : '#aaa'};\n                    border-radius: 5px;\n                }\n            `,\n                },\n            },\n        },\n        baseTheme,\n    );\n\n    return tachideskTheme;\n};\n\nexport default createTheme;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ntype ContextType = {\n    darkTheme: boolean;\n    setDarkTheme: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nconst DarkTheme = React.createContext<ContextType>({\n    darkTheme: true,\n    setDarkTheme: (): void => {},\n});\n\nexport default DarkTheme;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { StyledEngineProvider, ThemeProvider } from '@mui/material/styles';\nimport LibraryOptionsContextProvider from 'components/library/LibraryOptionsProvider';\nimport NavBarContextProvider from 'components/navbar/NavBarContextProvider';\nimport React, { useMemo } from 'react';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport { SWRConfig } from 'swr';\nimport createTheme from 'theme';\nimport { QueryParamProvider } from 'use-query-params';\nimport { fetcher } from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport DarkTheme from 'components/context/DarkTheme';\n\ninterface Props {\n    children: React.ReactNode;\n}\n\nconst AppContext: React.FC<Props> = ({ children }) => {\n    const [darkTheme, setDarkTheme] = useLocalStorage<boolean>('darkTheme', true);\n\n    const darkThemeContext = useMemo(\n        () => ({\n            darkTheme,\n            setDarkTheme,\n        }),\n        [darkTheme],\n    );\n\n    const theme = useMemo(() => createTheme(darkTheme), [darkTheme]);\n\n    return (\n        <SWRConfig value={{ fetcher }}>\n            <Router>\n                <StyledEngineProvider injectFirst>\n                    <ThemeProvider theme={theme}>\n                        <DarkTheme.Provider value={darkThemeContext}>\n                            <QueryParamProvider ReactRouterRoute={Route}>\n                                <LibraryOptionsContextProvider>\n                                    <NavBarContextProvider>{children}</NavBarContextProvider>\n                                </LibraryOptionsContextProvider>\n                            </QueryParamProvider>\n                        </DarkTheme.Provider>\n                    </ThemeProvider>\n                </StyledEngineProvider>\n            </Router>\n        </SWRConfig>\n    );\n};\n\nexport default AppContext;\n","import React from 'react';\nimport createSvgIcon from '@mui/material/utils/createSvgIcon';\n\nconst d =\n    'M 11 1 C 9.3550302 1 8 2.3550302 8 4 L 4 4 C 2.9069372 4 2 4.9069372 2 6 L 2 12 L 4 12 C 4.5650302 12 5 12.43497 5 13 C 5 13.56503 4.5650302 14 4 14 L 2 14 L 2 20 C 2 21.093063 2.9069372 22 4 22 L 10 22 L 10 20 C 10 19.43497 10.43497 19 11 19 C 11.56503 19 12 19.43497 12 20 L 12 22 L 18 22 C 19.093063 22 20 21.093063 20 20 L 20 16 C 21.64497 16 23 14.64497 23 13 C 23 11.35503 21.64497 10 20 10 L 20 6 C 20 4.9069372 19.093063 4 18 4 L 14 4 C 14 2.3550302 12.64497 1 11 1 z M 11 3 C 11.56503 3 12 3.4349698 12 4 L 12 6 L 18 6 L 18 12 L 20 12 C 20.56503 12 21 12.43497 21 13 C 21 13.56503 20.56503 14 20 14 L 18 14 L 18 20 L 14 20 C 14 18.35503 12.64497 17 11 17 C 9.3550302 17 8 18.35503 8 20 L 4 20 L 4 16 C 5.6449698 16 7 14.64497 7 13 C 7 11.35503 5.6449698 10 4 10 L 4 6 L 10 6 L 10 4 C 10 3.4349698 10.43497 3 11 3 z';\n\nconst icon = createSvgIcon(<path d={d} />, 'CustomExtensionOutlined');\n\nexport default icon;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { useNavBarContext } from 'components/context/NavbarContext';\nimport { useLocation } from 'react-router-dom';\n\nexport const BACK = '__BACK__';\n\nconst useBackTo = (): { url?: string; back: boolean } => {\n    const location = useLocation<{ backLink?: string }>();\n    const { defaultBackTo } = useNavBarContext();\n\n    const url = location.state?.backLink ?? defaultBackTo;\n    return {\n        url: url === BACK ? undefined : url,\n        back: url === BACK,\n    };\n};\n\nexport default useBackTo;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { ListItem, ListItemIcon, Tooltip } from '@mui/material';\nimport { Link, useLocation } from 'react-router-dom';\nimport { styled } from '@mui/system';\nimport { useTheme } from '@mui/material/styles';\n\nconst SideNavBarContainer = styled('div')(({ theme }) => ({\n    height: '100vh',\n    width: theme.spacing(8),\n    backgroundColor: theme.palette.custom,\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    paddingTop: theme.spacing(8),\n    display: 'flex',\n    flexDirection: 'column',\n}));\n\ninterface IProps {\n    navBarItems: Array<NavbarItem>;\n}\n\nexport default function DesktopSideBar({ navBarItems }: IProps) {\n    const location = useLocation();\n    const theme = useTheme();\n\n    const iconFor = (path: string, IconComponent: any, SelectedIconComponent: any) => {\n        if (location.pathname === path)\n            return <SelectedIconComponent sx={{ color: 'primary.main' }} fontSize=\"large\" />;\n        return (\n            <IconComponent sx={{ color: theme.palette.mode === 'dark' ? 'grey.A400' : 'grey.600' }} fontSize=\"large\" />\n        );\n    };\n\n    return (\n        <SideNavBarContainer>\n            {\n                // eslint-disable-next-line react/destructuring-assignment\n                navBarItems.map(({ path, title, IconComponent, SelectedIconComponent }: NavbarItem) => (\n                    <Link to={path} style={{ color: 'inherit', textDecoration: 'none' }} key={path}>\n                        <ListItem disableRipple button key={title}>\n                            <ListItemIcon sx={{ minWidth: '0' }}>\n                                <Tooltip placement=\"right\" title={title}>\n                                    {iconFor(path, IconComponent, SelectedIconComponent)}\n                                </Tooltip>\n                            </ListItemIcon>\n                        </ListItem>\n                    </Link>\n                ))\n            }\n        </SideNavBarContainer>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { ListItem } from '@mui/material';\nimport { styled, Box } from '@mui/system';\nimport { Link as RRDLink, useLocation } from 'react-router-dom';\nimport { useTheme } from '@mui/material/styles';\n\nconst BottomNavContainer = styled('div')(({ theme }) => ({\n    bottom: 0,\n    left: 0,\n    height: theme.spacing(7),\n    width: '100vw',\n    backgroundColor: theme.palette.custom.light,\n    position: 'fixed',\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-evenly',\n    alignItems: 'center',\n    // For Some reason the theme is throwing and error when accessing the Zindex object,\n    // This is the zIndex of the appBar in the default theme\n    zIndex: 1100,\n}));\n\nconst Link = styled(RRDLink)({\n    textDecoration: 'none',\n    flex: 1,\n});\n\ninterface IProps {\n    navBarItems: Array<NavbarItem>;\n}\n\nexport default function MobileBottomBar({ navBarItems }: IProps) {\n    const location = useLocation();\n    const theme = useTheme();\n\n    const iconFor = (path: string, IconComponent: any, SelectedIconComponent: any) => {\n        if (location.pathname === path)\n            return <SelectedIconComponent sx={{ color: 'primary.main' }} fontSize=\"medium\" />;\n        return (\n            <IconComponent sx={{ color: theme.palette.mode === 'dark' ? 'grey.A400' : 'grey.600' }} fontSize=\"medium\" />\n        );\n    };\n\n    return (\n        <BottomNavContainer>\n            {navBarItems.map(({ path, title, IconComponent, SelectedIconComponent }: NavbarItem) => (\n                <Link to={path} key={path}>\n                    <ListItem disableRipple button sx={{ justifyContent: 'center', padding: '8px' }} key={title}>\n                        <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\">\n                            {iconFor(path, IconComponent, SelectedIconComponent)}\n                            <Box\n                                sx={{\n                                    fontSize: '0.65rem',\n                                    color:\n                                        // eslint-disable-next-line no-nested-ternary\n                                        location.pathname === path\n                                            ? 'primary.main'\n                                            : theme.palette.mode === 'dark'\n                                            ? 'grey.A400'\n                                            : 'grey.600',\n                                }}\n                            >\n                                {title}\n                            </Box>\n                        </Box>\n                    </ListItem>\n                </Link>\n            ))}\n        </BottomNavContainer>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext } from 'react';\nimport AppBar from '@mui/material/AppBar';\nimport Toolbar from '@mui/material/Toolbar';\nimport Typography from '@mui/material/Typography';\nimport IconButton from '@mui/material/IconButton';\nimport { useMediaQuery } from '@mui/material';\nimport { useTheme } from '@mui/material/styles';\nimport CollectionsBookmarkIcon from '@mui/icons-material/CollectionsBookmark';\nimport CollectionsOutlinedBookmarkIcon from '@mui/icons-material/CollectionsBookmarkOutlined';\nimport NewReleasesIcon from '@mui/icons-material/NewReleases';\nimport NewReleasesOutlinedIcon from '@mui/icons-material/NewReleasesOutlined';\nimport ExploreIcon from '@mui/icons-material/Explore';\nimport ExploreOutlinedIcon from '@mui/icons-material/ExploreOutlined';\nimport ExtensionIcon from '@mui/icons-material/Extension';\nimport GetAppIcon from '@mui/icons-material/GetApp';\nimport GetAppOutlinedIcon from '@mui/icons-material/GetAppOutlined';\nimport SettingsIcon from '@mui/icons-material/Settings';\nimport ArrowBack from '@mui/icons-material/ArrowBack';\nimport { Link, useHistory } from 'react-router-dom';\nimport NavBarContext from 'components/context/NavbarContext';\nimport ExtensionOutlinedIcon from 'components/util/CustomExtensionOutlinedIcon';\nimport { Box } from '@mui/system';\nimport { createPortal } from 'react-dom';\nimport useBackTo from 'util/useBackTo';\nimport DesktopSideBar from 'components/navbar/navigation/DesktopSideBar';\nimport MobileBottomBar from 'components/navbar/navigation/MobileBottomBar';\n// import { useTranslation } from 'react-i18next';\nimport { t } from 'i18next';\n\nconst navbarItems: Array<NavbarItem> = [\n    {\n        path: '/library',\n        title: t('DefaultNavBar.navbarItems.Library'),\n        SelectedIconComponent: CollectionsBookmarkIcon,\n        IconComponent: CollectionsOutlinedBookmarkIcon,\n        show: 'both',\n    },\n    {\n        path: '/updates',\n        title: 'Updates',\n        SelectedIconComponent: NewReleasesIcon,\n        IconComponent: NewReleasesOutlinedIcon,\n        show: 'both',\n    },\n    {\n        path: '/extensions',\n        title: 'Extensions',\n        SelectedIconComponent: ExtensionIcon,\n        IconComponent: ExtensionOutlinedIcon,\n        show: 'desktop',\n    },\n    {\n        path: '/sources',\n        title: 'Sources',\n        SelectedIconComponent: ExploreIcon,\n        IconComponent: ExploreOutlinedIcon,\n        show: 'desktop',\n    },\n    {\n        path: '/browse',\n        title: 'Browse',\n        SelectedIconComponent: ExploreIcon,\n        IconComponent: ExploreOutlinedIcon,\n        show: 'mobile',\n    },\n    {\n        path: '/downloads',\n        title: 'Downloads',\n        SelectedIconComponent: GetAppIcon,\n        IconComponent: GetAppOutlinedIcon,\n        show: 'both',\n    },\n    {\n        path: '/settings',\n        title: 'Settings',\n        SelectedIconComponent: SettingsIcon,\n        IconComponent: SettingsIcon,\n        show: 'both',\n    },\n];\n\nexport default function DefaultNavBar() {\n    // const { t } = useTranslation();\n    const { title, action, override } = useContext(NavBarContext);\n    const backTo = useBackTo();\n\n    const theme = useTheme();\n    const history = useHistory();\n\n    const isMobileWidth = useMediaQuery(theme.breakpoints.down('sm'));\n    const isMainRoute = navbarItems.some(({ path }) => path === history.location.pathname);\n\n    // Allow default navbar to be overrided\n    if (override.status) return override.value;\n\n    let navbar = <></>;\n    if (isMobileWidth) {\n        if (isMainRoute) {\n            navbar = <MobileBottomBar navBarItems={navbarItems.filter((it) => it.show !== 'desktop')} />;\n        }\n    } else {\n        navbar = <DesktopSideBar navBarItems={navbarItems.filter((it) => it.show !== 'mobile')} />;\n    }\n\n    const handleBack = () => {\n        if (backTo.url != null) return;\n        history.goBack();\n    };\n\n    return (\n        <Box sx={{ flexGrow: 1 }}>\n            <AppBar position=\"fixed\" color=\"default\">\n                <Toolbar>\n                    {!isMainRoute && (\n                        <IconButton\n                            component={backTo.url ? Link : 'button'}\n                            to={backTo.url}\n                            edge=\"start\"\n                            sx={{ marginRight: theme.spacing(2) }}\n                            color=\"inherit\"\n                            aria-label=\"menu\"\n                            disableRipple\n                            size=\"large\"\n                            onClick={handleBack}\n                        >\n                            <ArrowBack />\n                        </IconButton>\n                    )}\n                    <Typography\n                        variant={isMobileWidth ? 'h6' : 'h5'}\n                        sx={{ flexGrow: 1 }}\n                        noWrap\n                        textOverflow=\"ellipsis\"\n                    >\n                        {title}\n                    </Typography>\n                    {action}\n                    <div id=\"navbarToolbar\" />\n                </Toolbar>\n            </AppBar>\n            {navbar}\n        </Box>\n    );\n}\n\ninterface INavbarToolbarProps {\n    children?: React.ReactNode;\n}\n\nexport const NavbarToolbar: React.FC<INavbarToolbarProps> = ({ children }) => {\n    const container = document.getElementById('navbarToolbar');\n    if (!container) return null;\n\n    return createPortal(children, container);\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ninterface IProps {\n    children: React.ReactNode;\n    index: any;\n    currentIndex: any;\n}\n\nexport default function TabPanel(props: IProps) {\n    const { children, index, currentIndex } = props;\n\n    return (\n        <div role=\"tabpanel\" hidden={index !== currentIndex} id={`simple-tabpanel-${index}`}>\n            {currentIndex === index && children}\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport const ISOLanguages = [\n    { code: 'all', name: 'All', nativeName: 'All' },\n    { code: 'installed', name: 'Installed', nativeName: 'Installed' },\n    { code: 'updates pending', name: 'Updates pending', nativeName: 'Updates pending' },\n\n    { code: 'other', name: 'other langs?', nativeName: 'Other' },\n\n    { code: 'localsourcelang', name: 'Local source', nativeName: 'Local source' },\n\n    // full list: https://github.com/meikidd/iso-639-1/blob/master/src/data.js\n    { code: 'en', name: 'English', nativeName: 'English' },\n    { code: 'ca', name: 'Catalan; Valencian', nativeName: 'Català' },\n    { code: 'de', name: 'German', nativeName: 'Deutsch' },\n    { code: 'es', name: 'Spanish; Castilian', nativeName: 'Español' },\n    { code: 'es-419', name: 'Spanish; Castilian', nativeName: 'Español (Latinoamérica)' },\n    { code: 'fr', name: 'French', nativeName: 'Français' },\n    { code: 'id', name: 'Indonesian', nativeName: 'Indonesia' },\n    { code: 'it', name: 'Italian', nativeName: 'Italiano' },\n    { code: 'pt', name: 'Portuguese', nativeName: 'Português' },\n    { code: 'pt-pt', name: 'Portuguese', nativeName: 'Português (Portugal)' },\n    { code: 'pt-br', name: 'Portuguese; Brasil', nativeName: 'Português (Brasil)' },\n    { code: 'vi', name: 'Vietnamese', nativeName: 'Tiếng Việt' },\n    { code: 'tr', name: 'Turkish', nativeName: 'Türkçe' },\n    { code: 'ru', name: 'Russian', nativeName: 'русский' },\n    { code: 'ar', name: 'Arabic', nativeName: 'العربية' },\n    { code: 'hi', name: 'Hindi', nativeName: 'हिन्दी' },\n    { code: 'th', name: 'Thai', nativeName: 'ไทย' },\n    { code: 'zh', name: 'Chinese', nativeName: '中文' },\n    { code: 'zh-hans', name: 'Chinese', nativeName: '中文 (HANS)' },\n    { code: 'zh-hant', name: 'Chinese', nativeName: '中文 (HANT)' },\n    { code: 'zh-rhk', name: 'Chinese', nativeName: '中文 (RHK)' },\n    { code: 'zh-rtw', name: 'Chinese', nativeName: '中文 (RTW)' },\n\n    { code: 'ja', name: 'Japanese', nativeName: '日本語' },\n    { code: 'ko', name: 'Korean', nativeName: '한국어' },\n    { code: 'zu', name: 'Zulu', nativeName: 'isiZulu' },\n    { code: 'xh', name: 'Xhosa', nativeName: 'isiXhosa' },\n    { code: 'uk', name: 'Ukrainian', nativeName: 'Українська' },\n    { code: 'ro', name: 'Romanian', nativeName: 'Română' },\n    { code: 'bg', name: 'Bulgarian', nativeName: 'български' },\n    { code: 'cs', name: 'Czech', nativeName: 'čeština' },\n    { code: 'pl', name: 'Polish', nativeName: 'polski' },\n    { code: 'no', name: 'Norwegian', nativeName: 'Norsk' },\n    { code: 'nl', name: 'Dutch', nativeName: 'Nederlands' },\n    { code: 'my', name: 'Burmese', nativeName: 'ဗမာစာ' },\n    { code: 'ms', name: 'Malay', nativeName: 'Malaysia' },\n    { code: 'mn', name: 'Mongolian', nativeName: 'Монгол' },\n    { code: 'ml', name: 'Malayalam', nativeName: 'മലയാളം' },\n    { code: 'ku', name: 'Kurdish', nativeName: 'Kurdî' },\n    { code: 'hu', name: 'Hungarian', nativeName: 'Magyar' },\n    { code: 'hr', name: 'Croatian', nativeName: 'Hrvatski' },\n    { code: 'he', name: 'Hebrew', nativeName: 'עברית' },\n    { code: 'fil', name: 'Filipino', nativeName: 'Filipino' },\n    { code: 'fi', name: 'Finnish', nativeName: 'suomi' },\n    { code: 'fa', name: 'Persian', nativeName: 'فارسی' },\n    { code: 'eu', name: 'Basque', nativeName: 'euskara' },\n    { code: 'el', name: 'Greek', nativeName: 'Ελληνικά' },\n    { code: 'da', name: 'Danish', nativeName: 'dansk' },\n    { code: 'bn', name: 'Bengali', nativeName: 'বাংলা' },\n    { code: 'lt', name: 'Lithuanian', nativeName: 'lietuvių kalba' },\n    { code: 'sh', name: 'Serbo-Croatian', nativeName: 'srpskohrvatski' },\n\n    { code: 'af', name: 'Afrikaans', nativeName: 'Afrikaans' },\n    { code: 'am', name: 'Amharic', nativeName: 'አማርኛ' },\n    { code: 'az', name: 'Azerbaijani', nativeName: 'Azərbaycan' },\n    { code: 'be', name: 'Belarusian', nativeName: 'беларуская' },\n    { code: 'bs', name: 'Bosnian', nativeName: 'bosanski' },\n    { code: 'sv', name: 'Swedish', nativeName: 'svenska' },\n    { code: 'sv', name: 'Swedish', nativeName: 'svenska' },\n];\n\nexport function langCodeToName(code: string): string {\n    const whereToCut = code.indexOf('-') !== -1 ? code.indexOf('-') : code.length;\n\n    const proccessedCode = code.toLocaleLowerCase().substring(0, whereToCut);\n    let result = `language with code: ${code}`;\n\n    for (let i = 0; i < ISOLanguages.length; i++) {\n        if (ISOLanguages[i].code === proccessedCode || ISOLanguages[i].code === code.toLocaleLowerCase()) {\n            result = ISOLanguages[i].nativeName;\n        }\n    }\n\n    return result;\n}\n\nfunction defaultNativeLang() {\n    return 'en'; // TODO: infer from the browser\n}\n\nexport function extensionDefaultLangs() {\n    return [defaultNativeLang(), 'all'];\n}\n\nexport function sourceDefualtLangs() {\n    return [defaultNativeLang(), 'localsourcelang'];\n}\n\nexport function sourceForcedDefaultLangs(): string[] {\n    return ['localsourcelang'];\n}\n\nexport const langSortCmp = (a: string, b: string) => {\n    // puts english first for convience\n    const aLang = langCodeToName(a);\n    const bLang = langCodeToName(b);\n\n    if (a === 'en') return -1;\n    if (b === 'en') return 1;\n    if (a === 'localSourceLang') return 1;\n    if (b === 'localSourceLang') return -1;\n\n    return aLang > bLang ? 1 : -1;\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport default function cloneObject<T extends object>(obj: T) {\n    return JSON.parse(JSON.stringify(obj)) as T;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Button from '@mui/material/Button';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport Dialog from '@mui/material/Dialog';\nimport Switch from '@mui/material/Switch';\nimport IconButton from '@mui/material/IconButton';\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport { List, ListItemSecondaryAction, ListItemText } from '@mui/material';\nimport ListItem from '@mui/material/ListItem';\nimport { langCodeToName } from 'util/language';\nimport cloneObject from 'util/cloneObject';\n\nfunction removeAll(firstList: any[], secondList: any[]) {\n    secondList.forEach((item) => {\n        const index = firstList.indexOf(item);\n        if (index !== -1) {\n            firstList.splice(index, 1);\n        }\n    });\n\n    return firstList;\n}\n\ninterface IProps {\n    shownLangs: string[];\n    setShownLangs: (arg0: string[]) => void;\n    allLangs: string[];\n    forcedLangs?: string[];\n}\n\nexport default function LangSelect(props: IProps) {\n    const { shownLangs, setShownLangs, allLangs, forcedLangs } = props;\n    // hold a copy and only sate state on parent when OK pressed, improves performance\n    const [mShownLangs, setMShownLangs] = useState(removeAll(cloneObject(shownLangs), forcedLangs!));\n    const [open, setOpen] = useState<boolean>(false);\n\n    const handleCancel = () => {\n        setOpen(false);\n    };\n\n    const handleOk = () => {\n        setOpen(false);\n        setShownLangs(mShownLangs);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, lang: string) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        if (checked) {\n            setMShownLangs([...mShownLangs, lang]);\n        } else {\n            const clone = cloneObject(mShownLangs);\n            clone.splice(clone.indexOf(lang), 1);\n            setMShownLangs(clone);\n        }\n    };\n\n    return (\n        <>\n            <IconButton\n                onClick={() => setOpen(true)}\n                aria-label=\"display more actions\"\n                edge=\"end\"\n                color=\"inherit\"\n                size=\"large\"\n            >\n                <FilterListIcon />\n            </IconButton>\n            <Dialog\n                sx={{\n                    '.MuiDialog-paper': {\n                        maxHeight: 435,\n                        width: '80%',\n                    },\n                }}\n                maxWidth=\"xs\"\n                open={open}\n            >\n                <DialogTitle>Enabled Languages</DialogTitle>\n                <DialogContent dividers sx={{ padding: 0 }}>\n                    <List>\n                        {allLangs.map((lang) => (\n                            <ListItem key={lang}>\n                                <ListItemText primary={langCodeToName(lang)} />\n\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        checked={mShownLangs.indexOf(lang) !== -1}\n                                        onChange={(e) => handleChange(e, lang)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                        ))}\n                    </List>\n                </DialogContent>\n                <DialogActions>\n                    <Button autoFocus onClick={handleCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleOk} color=\"primary\">\n                        Ok\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n\nLangSelect.defaultProps = {\n    forcedLangs: [] as string[],\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { CardActionArea } from '@mui/material';\nimport Avatar from '@mui/material/Avatar';\nimport Button from '@mui/material/Button';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport Typography from '@mui/material/Typography';\nimport { Box, styled } from '@mui/system';\nimport React from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { langCodeToName } from 'util/language';\nimport useLocalStorage from 'util/useLocalStorage';\n\nconst MobileWidthButtons = styled('div')(({ theme }) => ({\n    display: 'flex',\n    [theme.breakpoints.up('sm')]: {\n        display: 'none',\n    },\n}));\n\nconst WiderWidthButtons = styled('div')(({ theme }) => ({\n    display: 'flex',\n    [theme.breakpoints.down('sm')]: {\n        display: 'none',\n    },\n\n    '& .MuiButton-root': {\n        marginLeft: '20px',\n    },\n}));\n\ninterface IProps {\n    source: ISource;\n}\n\nconst SourceCard: React.FC<IProps> = (props: IProps) => {\n    const {\n        source: { id, name, lang, iconUrl, supportsLatest, isNsfw },\n    } = props;\n\n    const history = useHistory();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const redirectTo = (e: any, to: string) => {\n        history.push(to);\n\n        // prevent parent tags from getting the event\n        e.stopPropagation();\n    };\n\n    return (\n        <Card\n            sx={{\n                margin: '10px',\n            }}\n        >\n            <CardActionArea component={Link} to={`/sources/${id}/popular/`}>\n                <CardContent\n                    sx={{\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                        padding: 2,\n                    }}\n                >\n                    <Box sx={{ display: 'flex' }}>\n                        <Avatar\n                            variant=\"rounded\"\n                            alt={name}\n                            sx={{\n                                width: 56,\n                                height: 56,\n                                flex: '0 0 auto',\n                                mr: 2,\n                            }}\n                            src={`${serverAddress}${iconUrl}?useCache=${useCache}`}\n                        />\n                        <Box\n                            sx={{\n                                display: 'flex',\n                                flexDirection: 'column',\n                                justifyContent: 'center',\n                            }}\n                        >\n                            <Typography variant=\"h5\" component=\"h2\">\n                                {name}\n                            </Typography>\n                            {id !== '0' && (\n                                <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                    {langCodeToName(lang)}\n                                    {isNsfw && (\n                                        <Typography variant=\"caption\" display=\"inline\" gutterBottom color=\"red\">\n                                            {' 18+'}\n                                        </Typography>\n                                    )}\n                                </Typography>\n                            )}\n                        </Box>\n                    </Box>\n                    <>\n                        <MobileWidthButtons>\n                            {supportsLatest && (\n                                <Button variant=\"outlined\" onClick={(e) => redirectTo(e, `/sources/${id}/latest/`)}>\n                                    Latest\n                                </Button>\n                            )}\n                        </MobileWidthButtons>\n                        <WiderWidthButtons>\n                            {supportsLatest && (\n                                <Button component={Link} to={`/sources/${id}/latest/`} variant=\"outlined\">\n                                    Latest\n                                </Button>\n                            )}\n                            <Button component={Link} to={`/sources/${id}/popular/`} variant=\"outlined\">\n                                Browse\n                            </Button>\n                        </WiderWidthButtons>\n                    </>\n                </CardContent>\n            </CardActionArea>\n        </Card>\n    );\n};\n\nexport default SourceCard;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    shouldRender?: boolean | (() => boolean);\n    children?: React.ReactNode;\n    component?: string | React.FunctionComponent<any> | React.ComponentClass<any, any>;\n    componentProps?: any;\n}\n\nexport default function LoadingPlaceholder(props: IProps) {\n    const { children, shouldRender, component, componentProps } = props;\n\n    let condition = true;\n    if (shouldRender !== undefined) {\n        condition = shouldRender instanceof Function ? shouldRender() : shouldRender;\n    }\n\n    if (condition) {\n        if (component) {\n            return React.createElement(component, componentProps);\n        }\n\n        if (children) {\n            return <>{children}</>;\n        }\n    }\n\n    return (\n        <Box\n            sx={{\n                margin: '10px auto',\n                display: 'flex',\n                justifyContent: 'center',\n            }}\n        >\n            <CircularProgress thickness={5} />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\nimport LangSelect from 'components/navbar/action/LangSelect';\nimport SourceCard from 'components/SourceCard';\nimport NavbarContext from 'components/context/NavbarContext';\nimport { sourceDefualtLangs, sourceForcedDefaultLangs, langCodeToName, langSortCmp } from 'util/language';\nimport useLocalStorage from 'util/useLocalStorage';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport { IconButton } from '@mui/material';\nimport TravelExploreIcon from '@mui/icons-material/TravelExplore';\nimport { useHistory } from 'react-router-dom';\nimport { useQuery } from 'util/client';\n\nfunction sourceToLangList(sources: ISource[]) {\n    const result: string[] = [];\n\n    sources.forEach((source) => {\n        if (result.indexOf(source.lang) === -1) {\n            result.push(source.lang);\n        }\n    });\n\n    result.sort(langSortCmp);\n    return result;\n}\n\nfunction groupByLang(sources: ISource[]) {\n    const result = {} as any;\n    sources.forEach((source) => {\n        if (result[source.lang] === undefined) {\n            result[source.lang] = [] as ISource[];\n        }\n        result[source.lang].push(source);\n    });\n\n    return result;\n}\n\nexport default function Sources() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownSourceLangs', sourceDefualtLangs());\n    const [showNsfw] = useLocalStorage<boolean>('showNsfw', true);\n\n    const { data: sources, loading } = useQuery<ISource[]>('/api/v1/source/list');\n\n    const history = useHistory();\n\n    useEffect(() => {\n        // make sure all of forcedDefaultLangs() exists in shownLangs\n        sourceForcedDefaultLangs().forEach((forcedLang) => {\n            let hasLang = false;\n            shownLangs.forEach((lang) => {\n                if (lang === forcedLang) hasLang = true;\n            });\n            if (!hasLang) {\n                setShownLangs((shownLangsCopy) => {\n                    shownLangsCopy.push(forcedLang);\n                    return shownLangsCopy;\n                });\n            }\n        });\n    }, []);\n\n    useEffect(() => {\n        setTitle('Sources');\n        setAction(\n            <>\n                <IconButton onClick={() => history.push('/sources/all/search/')} size=\"large\">\n                    <TravelExploreIcon />\n                </IconButton>\n                <LangSelect\n                    shownLangs={shownLangs}\n                    setShownLangs={setShownLangs}\n                    allLangs={sourceToLangList(sources ?? [])}\n                    forcedLangs={sourceForcedDefaultLangs()}\n                />\n            </>,\n        );\n    }, [shownLangs, sources]);\n\n    if (loading) return <LoadingPlaceholder />;\n\n    if (sources?.length === 0) {\n        return <h3>No sources found. Install Some Extensions first.</h3>;\n    }\n\n    return (\n        <>\n            {/* eslint-disable-next-line max-len */}\n            {Object.entries(groupByLang(sources ?? []))\n                .sort((a, b) => langSortCmp(a[0], b[0]))\n                .map(\n                    ([lang, list]) =>\n                        shownLangs.indexOf(lang) !== -1 && (\n                            <React.Fragment key={lang}>\n                                <h1 key={lang} style={{ marginLeft: 25 }}>\n                                    {langCodeToName(lang)}\n                                </h1>\n                                {(list as ISource[])\n                                    .filter((source) => showNsfw || !source.isNsfw)\n                                    .map((source) => (\n                                        <SourceCard key={source.id} source={source} />\n                                    ))}\n                            </React.Fragment>\n                        ),\n                )}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport Button from '@mui/material/Button';\nimport Avatar from '@mui/material/Avatar';\nimport Typography from '@mui/material/Typography';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    extension: IExtension;\n    notifyInstall: () => void;\n}\n\nexport default function ExtensionCard(props: IProps) {\n    const {\n        extension: { name, lang, versionName, installed, hasUpdate, obsolete, pkgName, iconUrl, isNsfw },\n        notifyInstall,\n    } = props;\n    const [installedState, setInstalledState] = useState<string>(() => {\n        if (obsolete) {\n            return 'obsolete';\n        }\n        if (hasUpdate) {\n            return 'update';\n        }\n        return installed ? 'uninstall' : 'install';\n    });\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const langPress = lang === 'all' ? 'All' : lang.toUpperCase();\n\n    function install() {\n        setInstalledState('installing');\n        client.get(`/api/v1/extension/install/${pkgName}`).then(() => {\n            setInstalledState('uninstall');\n            notifyInstall();\n        });\n    }\n\n    function update() {\n        setInstalledState('updating');\n        client.get(`/api/v1/extension/update/${pkgName}`).then(() => {\n            setInstalledState('uninstall');\n            notifyInstall();\n        });\n    }\n\n    function uninstall() {\n        setInstalledState('uninstalling');\n        client.get(`/api/v1/extension/uninstall/${pkgName}`).then(() => {\n            // setInstalledState('install');\n            notifyInstall();\n        });\n    }\n\n    function handleButtonClick() {\n        switch (installedState) {\n            case 'install':\n                install();\n                break;\n            case 'update':\n                update();\n                break;\n            case 'obsolete':\n                uninstall();\n                setTimeout(() => window.location.reload(), 3000);\n                break;\n            case 'uninstall':\n                uninstall();\n                break;\n            default:\n                break;\n        }\n    }\n\n    return (\n        <Card sx={{ margin: '10px' }}>\n            <CardContent\n                sx={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    p: 2,\n                }}\n            >\n                <Box sx={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        sx={{\n                            width: 56,\n                            height: 56,\n                            flex: '0 0 auto',\n                            mr: 2,\n                        }}\n                        alt={name}\n                        src={`${serverAddress}${iconUrl}?useCache=${useCache}`}\n                    />\n                    <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                            {langPress} {versionName}\n                            {isNsfw && (\n                                <Typography variant=\"caption\" display=\"inline\" gutterBottom color=\"red\">\n                                    {' 18+'}\n                                </Typography>\n                            )}\n                        </Typography>\n                    </Box>\n                </Box>\n\n                <Button\n                    variant=\"outlined\"\n                    sx={{ color: installedState === 'obsolete' ? 'red' : 'inherit' }}\n                    onClick={() => handleButtonClick()}\n                >\n                    {installedState}\n                </Button>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport ReactDOM from 'react-dom';\nimport React from 'react';\nimport Slide, { SlideProps } from '@mui/material/Slide';\nimport Snackbar from '@mui/material/Snackbar';\nimport MuiAlert, { AlertColor as Severity } from '@mui/material/Alert';\n\nfunction removeToast(id: string) {\n    const container = document.querySelector(`#${id}`)!!;\n    ReactDOM.unmountComponentAtNode(container);\n    document.body.removeChild(container);\n}\n\nfunction Transition(props: SlideProps) {\n    return <Slide {...props} direction=\"up\" />;\n}\n\ninterface IToastProps {\n    message: string;\n    severity: Severity;\n}\n\nexport function Toast(props: IToastProps) {\n    const { message, severity } = props;\n    const [open, setOpen] = React.useState(true);\n\n    const handleClose = () => {\n        setOpen(false);\n    };\n\n    return (\n        <Snackbar\n            open={open}\n            onClose={handleClose}\n            autoHideDuration={3000}\n            TransitionComponent={Transition}\n            message=\"I love snacks\"\n        >\n            <MuiAlert elevation={6} variant=\"filled\" onClose={handleClose} severity={severity}>\n                {message}\n            </MuiAlert>\n        </Snackbar>\n    );\n}\n\nexport default function makeToast(message: string, severity: Severity) {\n    const id = Math.floor(Math.random() * 1000);\n    const container = document.createElement('div');\n    container.id = `alert-${id}`;\n\n    document.body.appendChild(container);\n\n    ReactDOM.render(<Toast message={message} severity={severity} />, container);\n\n    setTimeout(() => removeToast(container.id), 3500);\n}\n\nexport function makeToaster([toasts, setToasts]: [React.ReactElement[], (arg0: React.ReactElement[]) => void]): [\n    React.ReactElement[],\n    (message: string, severity: Severity) => void,\n] {\n    return [\n        toasts,\n        (message: string, severity: Severity) => {\n            setToasts([<Toast key={Math.floor(Math.random() * 1000) + 1} message={message} severity={severity} />]);\n        },\n    ];\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { IconButton, Input } from '@mui/material';\nimport CancelIcon from '@mui/icons-material/Cancel';\nimport { useQueryParam, StringParam } from 'use-query-params';\n\ninterface IProps {\n    autoOpen?: boolean;\n}\n\nconst defaultProps = {\n    autoOpen: false,\n};\n\nconst AppbarSearch: React.FunctionComponent<IProps> = (props) => {\n    const { autoOpen } = props;\n    const [query, setQuery] = useQueryParam('query', StringParam);\n    const [searchOpen, setSearchOpen] = useState(!!query);\n    const inputRef = React.useRef<HTMLInputElement>();\n\n    function handleChange(e: React.ChangeEvent<HTMLInputElement>) {\n        setQuery(e.target.value === '' ? undefined : e.target.value);\n    }\n\n    const cancelSearch = () => {\n        setQuery(null);\n        setSearchOpen(false);\n    };\n    const handleBlur = () => {\n        if (!query) setSearchOpen(false);\n    };\n    const openSearch = () => {\n        setSearchOpen(true);\n        // Put Focus Action at the end of the Callstack so Input actually exists on the dom\n        setTimeout(() => {\n            if (inputRef && inputRef.current) inputRef.current.focus();\n        });\n    };\n\n    const handleSearchShortcut = (e: KeyboardEvent) => {\n        if (e.code === 'F3' || (e.ctrlKey && e.code === 'KeyF')) {\n            e.preventDefault();\n            openSearch();\n        }\n    };\n\n    useEffect(() => {\n        if (autoOpen) {\n            openSearch();\n        }\n    }, []);\n\n    useEffect(() => {\n        window.addEventListener('keydown', handleSearchShortcut);\n\n        return () => {\n            window.removeEventListener('keydown', handleSearchShortcut);\n        };\n    }, [handleSearchShortcut]);\n\n    return (\n        <>\n            {searchOpen ? (\n                <Input\n                    value={query || ''}\n                    onChange={handleChange}\n                    onBlur={handleBlur}\n                    inputRef={inputRef}\n                    endAdornment={\n                        <IconButton onClick={cancelSearch}>\n                            <CancelIcon />\n                        </IconButton>\n                    }\n                />\n            ) : (\n                <IconButton onClick={openSearch}>\n                    <SearchIcon />\n                </IconButton>\n            )}\n        </>\n    );\n};\n\nAppbarSearch.defaultProps = defaultProps;\n\nexport default AppbarSearch;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState, useMemo, useRef } from 'react';\nimport { fromEvent } from 'file-selector';\nimport IconButton from '@mui/material/IconButton';\nimport AddIcon from '@mui/icons-material/Add';\nimport ExtensionCard from 'components/ExtensionCard';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client, { useQuery } from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport LangSelect from 'components/navbar/action/LangSelect';\nimport { extensionDefaultLangs, langCodeToName, langSortCmp } from 'util/language';\nimport { makeToaster } from 'components/util/Toast';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport { useQueryParam, StringParam } from 'use-query-params';\nimport { Virtuoso } from 'react-virtuoso';\nimport { Typography, useMediaQuery, useTheme } from '@mui/material';\n\nconst LANGUAGE = 0;\nconst EXTENSIONS = 1;\n\nconst allLangs: string[] = [];\n\ninterface GroupedExtension {\n    [key: string]: IExtension[];\n}\n\nfunction groupExtensions(extensions: IExtension[]) {\n    allLangs.length = 0; // empty the array\n    const sortedExtenions: GroupedExtension = { installed: [], 'updates pending': [], all: [] };\n    extensions.forEach((extension) => {\n        if (sortedExtenions[extension.lang] === undefined) {\n            sortedExtenions[extension.lang] = [];\n            if (extension.lang !== 'all') {\n                allLangs.push(extension.lang);\n            }\n        }\n        if (extension.installed) {\n            if (extension.hasUpdate) {\n                sortedExtenions['updates pending'].push(extension);\n            } else {\n                sortedExtenions.installed.push(extension);\n            }\n        } else {\n            sortedExtenions[extension.lang].push(extension);\n        }\n    });\n\n    allLangs.sort(langSortCmp);\n    const result: [string, IExtension[]][] = [\n        ['updates pending', sortedExtenions['updates pending']],\n        ['installed', sortedExtenions.installed],\n        ['all', sortedExtenions.all],\n    ];\n\n    const langExt: [string, IExtension[]][] = allLangs.map((lang) => [lang, sortedExtenions[lang]]);\n\n    return result.concat(langExt);\n}\n\nexport default function MangaExtensions() {\n    const inputRef = useRef<HTMLInputElement>(null);\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownExtensionLangs', extensionDefaultLangs());\n    const [showNsfw] = useLocalStorage<boolean>('showNsfw', true);\n    const theme = useTheme();\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\n    const [query] = useQueryParam('query', StringParam);\n\n    useEffect(() => {\n        setTitle('Extensions');\n        setAction(\n            <>\n                <AppbarSearch />\n                <IconButton onClick={() => inputRef.current?.click()} size=\"large\">\n                    <AddIcon />\n                </IconButton>\n                <LangSelect shownLangs={shownLangs} setShownLangs={setShownLangs} allLangs={allLangs} />\n            </>,\n        );\n    }, [shownLangs]);\n\n    const { data: allExtensions, mutate, loading } = useQuery<IExtension[]>('/api/v1/extension/list');\n\n    const filteredExtensions = useMemo(\n        () =>\n            (allExtensions ?? []).filter((ext) => {\n                const nsfwFilter = showNsfw || !ext.isNsfw;\n                if (!query) return nsfwFilter;\n                return nsfwFilter && ext.name.toLowerCase().includes(query.toLowerCase());\n            }),\n        [allExtensions, showNsfw, query],\n    );\n\n    const groupedExtensions = useMemo(\n        () =>\n            groupExtensions(filteredExtensions)\n                .filter((group) => group[EXTENSIONS].length > 0)\n                .filter((group) => ['installed', 'updates pending', 'all', ...shownLangs].includes(group[LANGUAGE])),\n        [shownLangs, filteredExtensions],\n    );\n\n    const flatRenderItems: (IExtension | string)[] = groupedExtensions.flat(2);\n\n    const [toasts, makeToast] = makeToaster(useState<React.ReactElement[]>([]));\n\n    const submitExternalExtension = (file: File) => {\n        if (file.name.toLowerCase().endsWith('apk')) {\n            const formData = new FormData();\n            formData.append('file', file);\n\n            if (inputRef.current) {\n                inputRef.current.value = '';\n            }\n\n            makeToast('Installing Extension File....', 'info');\n            client\n                .post('/api/v1/extension/install', formData, {\n                    headers: { 'Content-Type': 'multipart/form-data' },\n                })\n                .then(() => {\n                    makeToast('Installed extension successfully!', 'success');\n                    mutate();\n                })\n                .catch(() => makeToast('Extension installion failed!', 'error'));\n        } else {\n            makeToast('invalid file type!', 'error');\n        }\n    };\n\n    useEffect(() => {\n        const dropHandler = async (e: Event) => {\n            e.preventDefault();\n            const files = await fromEvent(e);\n            submitExternalExtension(files[0] as File);\n        };\n\n        const dragOverHandler = (e: Event) => {\n            e.preventDefault();\n        };\n\n        document.addEventListener('drop', dropHandler);\n        document.addEventListener('dragover', dragOverHandler);\n\n        return () => {\n            document.removeEventListener('drop', dropHandler);\n            document.removeEventListener('dragover', dragOverHandler);\n        };\n    }, []);\n\n    if (loading) {\n        return <LoadingPlaceholder />;\n    }\n\n    return (\n        <>\n            {toasts}\n            <input\n                type=\"file\"\n                style={{ display: 'none' }}\n                ref={inputRef}\n                onChange={(e) => {\n                    const file = e.target.files?.[0];\n                    if (file) {\n                        submitExternalExtension(file);\n                    }\n                }}\n            />\n            <Virtuoso\n                style={{\n                    height: isMobile ? 'calc(100vh - 64px - 64px)' : 'calc(100vh - 64px)',\n                }}\n                totalCount={flatRenderItems.length}\n                itemContent={(index) => {\n                    if (typeof flatRenderItems[index] === 'string') {\n                        const item = flatRenderItems[index] as string;\n                        return (\n                            <Typography\n                                key={item}\n                                variant=\"h2\"\n                                style={{\n                                    paddingLeft: 25,\n                                    paddingBottom: '0.83em',\n                                    paddingTop: '0.83em',\n                                    fontSize: '2em',\n                                    fontWeight: 'bold',\n                                }}\n                            >\n                                {langCodeToName(item)}\n                            </Typography>\n                        );\n                    }\n                    const item = flatRenderItems[index] as IExtension;\n\n                    return (\n                        <ExtensionCard\n                            key={item.apkName}\n                            extension={item}\n                            notifyInstall={() => {\n                                mutate();\n                            }}\n                        />\n                    );\n                }}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport Tabs from '@mui/material/Tabs';\nimport Tab from '@mui/material/Tab';\nimport TabPanel from 'components/util/TabPanel';\nimport Sources from 'screens/Sources';\nimport Extensions from 'screens/Extensions';\nimport { useTranslation } from 'react-i18next';\n\nexport default function Browse() {\n    const { t } = useTranslation();\n\n    const [tabNum, setTabNum] = useState<number>(0);\n\n    return (\n        <>\n            <Tabs\n                value={tabNum}\n                onChange={(e, newTab) => setTabNum(newTab)}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                centered\n                variant=\"fullWidth\"\n                scrollButtons\n                allowScrollButtonsMobile\n            >\n                <Tab sx={{ textTransform: 'none' }} label={t('screens.Browse.sources')} />\n                <Tab sx={{ textTransform: 'none' }} label={t('screens.Browse.extensions')} />\n            </Tabs>\n            <TabPanel index={0} currentIndex={tabNum}>\n                <Sources />\n            </TabPanel>\n            <TabPanel index={1} currentIndex={tabNum}>\n                <Extensions />\n            </TabPanel>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n// adopted from: https://github.com/tachiyomiorg/tachiyomi/blob/master/app/src/main/java/eu/kanade/tachiyomi/widget/EmptyView.kt\n\nimport React, { useMemo } from 'react';\nimport Typography from '@mui/material/Typography';\nimport { useTheme } from '@mui/material/styles';\nimport { useMediaQuery } from '@mui/material';\nimport { Box } from '@mui/system';\n\nconst ERROR_FACES = ['(･o･;)', 'Σ(ಠ_ಠ)', 'ಥ_ಥ', '(˘･_･˘)', '(；￣Д￣)', '(･Д･。'];\n\nfunction getRandomErrorFace() {\n    const randIndex = Math.floor(Math.random() * ERROR_FACES.length);\n    return ERROR_FACES[randIndex];\n}\n\ninterface IProps {\n    message: string;\n    messageExtra?: JSX.Element;\n}\n\nexport default function EmptyView({ message, messageExtra }: IProps) {\n    const theme = useTheme();\n    const isMobileWidth = useMediaQuery(theme.breakpoints.down('sm'));\n\n    const errorFace = useMemo(() => getRandomErrorFace(), []);\n\n    return (\n        <Box\n            sx={{\n                position: 'absolute',\n                left: `calc(50% + ${isMobileWidth ? '0px' : theme.spacing(8 / 2)})`,\n                top: '50%',\n                transform: 'translate(-50%, -50%)',\n                textAlign: 'center',\n            }}\n        >\n            <Typography variant=\"h3\" gutterBottom>\n                {errorFace}\n            </Typography>\n            <Typography variant=\"h5\">{message}</Typography>\n            {messageExtra}\n        </Box>\n    );\n}\n\nEmptyView.defaultProps = {\n    messageExtra: undefined,\n};\n","import { useEffect, useState } from 'react';\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\n\nconst useSubscription = <T>(path: string, callback?: (newValue: T) => boolean | void) => {\n    const [state, setState] = useState<T | undefined>();\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}${path}`);\n\n        wsc.onmessage = (e) => {\n            const data = JSON.parse(e.data) as T;\n            if (callback) {\n                // If callback is specified, only update state if callback returns true\n                // This is so that useSubscription can be used without causing rerender\n                if (callback(data) === true) {\n                    setState(data);\n                }\n            } else {\n                setState(data);\n            }\n        };\n\n        return () => wsc.close();\n    }, [path]);\n\n    return { data: state };\n};\n\nexport default useSubscription;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { CircularProgress } from '@mui/material';\nimport Typography from '@mui/material/Typography';\nimport { Box } from '@mui/system';\nimport React from 'react';\n\ninterface DownloadStateIndicatorProps {\n    download: IDownloadChapter;\n}\n\nconst DownloadStateIndicator: React.FC<DownloadStateIndicatorProps> = ({ download }) => (\n    <Box\n        sx={{\n            position: 'relative',\n            display: 'inline-flex',\n            width: '50px',\n            justifyContent: 'center',\n        }}\n    >\n        {download.progress !== 0 && <CircularProgress variant=\"determinate\" value={download.progress * 100} />}\n        <Box\n            sx={{\n                top: 0,\n                left: 0,\n                bottom: 0,\n                right: 0,\n                position: 'absolute',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n            }}\n        >\n            <Typography variant=\"caption\" component=\"div\" color=\"text.secondary\">\n                {download.progress !== 0 && `${Math.round(download.progress * 100)}%`}\n                {download.progress === 0 && download.state}\n            </Typography>\n        </Box>\n    </Box>\n);\n\nexport default DownloadStateIndicator;\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport DragHandle from '@mui/icons-material/DragHandle';\nimport PauseIcon from '@mui/icons-material/Pause';\nimport PlayArrowIcon from '@mui/icons-material/PlayArrow';\nimport { Card, CardActionArea, Stack } from '@mui/material';\nimport IconButton from '@mui/material/IconButton';\nimport NavbarContext from 'components/context/NavbarContext';\nimport EmptyView from 'components/util/EmptyView';\nimport React, { useContext, useEffect } from 'react';\nimport { DragDropContext, Draggable, Droppable, DropResult } from 'react-beautiful-dnd';\nimport client from 'util/client';\n\nimport Typography from '@mui/material/Typography';\nimport { Box } from '@mui/system';\nimport useSubscription from 'components/library/useSubscription';\nimport DownloadStateIndicator from 'components/molecules/DownloadStateIndicator';\nimport { NavbarToolbar } from 'components/navbar/DefaultNavBar';\nimport { Link } from 'react-router-dom';\nimport { BACK } from 'util/useBackTo';\nimport { useTranslation } from 'react-i18next';\n\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\nconst DownloadQueue: React.FC = () => {\n    const { t } = useTranslation();\n\n    const { data: queueState } = useSubscription<IQueue>('/api/v1/downloads');\n    const { queue, status } = queueState ?? initialQueue;\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const toggleQueueStatus = () => {\n        if (status === 'Stopped') {\n            client.get('/api/v1/downloads/start');\n        } else {\n            client.get('/api/v1/downloads/stop');\n        }\n    };\n\n    useEffect(() => {\n        setTitle(t('screens.DownloadQueue.download-queue'));\n        setAction(null);\n    }, []);\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const onDragEnd = (result: DropResult) => {};\n\n    if (queue.length === 0) {\n        return <EmptyView message={t('screens.DownloadQueue.no-downloads')} />;\n    }\n\n    const handleDelete = (chapter: IChapter) => {\n        // required to stop before deleting otherwise the download kept going. Server issue?\n        client.get('/api/v1/downloads/stop').then(() =>\n            Promise.all([\n                // remove from download queue\n                client.delete(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`),\n                // delete partial download, should be handle server side?\n                // bug: The folder and the last image downloaded are not deleted\n                client.delete(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`),\n            ]),\n        );\n    };\n\n    return (\n        <>\n            <NavbarToolbar>\n                <IconButton onClick={toggleQueueStatus} size=\"large\">\n                    {status === 'Stopped' ? <PlayArrowIcon /> : <PauseIcon />}\n                </IconButton>\n            </NavbarToolbar>\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <Box ref={provided.innerRef} sx={{ pt: 1 }}>\n                            {queue.map((item, index) => (\n                                <Draggable\n                                    key={`${item.mangaId}-${item.chapterIndex}`}\n                                    draggableId={`${item.mangaId}-${item.chapterIndex}`}\n                                    index={index}\n                                >\n                                    {(provided, snapshot) => (\n                                        <Box\n                                            {...provided.draggableProps}\n                                            {...provided.dragHandleProps}\n                                            ref={provided.innerRef}\n                                            sx={{ p: 1, pb: 2 }}\n                                        >\n                                            <Card\n                                                sx={{\n                                                    backgroundColor: snapshot.isDragging ? 'custom.light' : undefined,\n                                                }}\n                                            >\n                                                <CardActionArea\n                                                    component={Link}\n                                                    to={{\n                                                        pathname: `/manga/${item.chapter.mangaId}`,\n                                                        state: { backLink: BACK },\n                                                    }}\n                                                    sx={{\n                                                        display: 'flex',\n                                                        alignItems: 'center',\n                                                        p: 1,\n                                                    }}\n                                                >\n                                                    <IconButton sx={{ pointerEvents: 'none' }}>\n                                                        <DragHandle />\n                                                    </IconButton>\n                                                    <Stack sx={{ flex: 1, ml: 1 }} direction=\"column\">\n                                                        <Typography variant=\"h6\">{item.manga.title}</Typography>\n                                                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                                            {item.chapter.name}\n                                                        </Typography>\n                                                    </Stack>\n                                                    <DownloadStateIndicator download={item} />\n                                                    <IconButton\n                                                        onClick={(e) => {\n                                                            e.preventDefault();\n                                                            e.stopPropagation();\n                                                            handleDelete(item.chapter);\n                                                        }}\n                                                        size=\"large\"\n                                                    >\n                                                        <DeleteIcon />\n                                                    </IconButton>\n                                                </CardActionArea>\n                                            </Card>\n                                        </Box>\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </Box>\n                    )}\n                </Droppable>\n            </DragDropContext>\n        </>\n    );\n};\n\nexport default DownloadQueue;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { Checkbox, CheckboxProps, FormControlLabel } from '@mui/material';\nimport React from 'react';\n\ninterface IProps extends CheckboxProps {\n    label?: string;\n}\n\nconst CheckboxInput: React.FC<IProps> = ({ label, sx, ...rest }) => (\n    <FormControlLabel control={<Checkbox {...rest} />} label={label} sx={sx} />\n);\n\nexport default CheckboxInput;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { FormControlLabel, Radio, RadioProps } from '@mui/material';\nimport React from 'react';\n\nexport interface RadioInputProps extends RadioProps {\n    label?: string;\n}\n\nconst RadioInput: React.FC<RadioInputProps> = ({ label, sx, ...rest }) => (\n    <FormControlLabel control={<Radio {...rest} />} label={label} sx={sx} />\n);\n\nexport default RadioInput;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport ArrowDownward from '@mui/icons-material/ArrowDownward';\nimport ArrowUpward from '@mui/icons-material/ArrowUpward';\nimport React from 'react';\nimport RadioInput, { RadioInputProps } from 'components/atoms/RadioInput';\n\ninterface IProps extends RadioInputProps {\n    sortDescending?: boolean | null | undefined;\n}\n\nconst SortRadioInput: React.FC<IProps> = ({ sortDescending, ...rest }) => (\n    <RadioInput\n        checkedIcon={sortDescending ? <ArrowDownward color=\"primary\" /> : <ArrowUpward color=\"primary\" />}\n        {...rest}\n    />\n);\n\nexport default SortRadioInput;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { DisabledByDefaultRounded } from '@mui/icons-material';\nimport { Checkbox, CheckboxProps } from '@mui/material';\nimport React, { useCallback } from 'react';\n\ntype CheckState = boolean | undefined | null;\n\nfunction nextState(state: CheckState): CheckState {\n    if (state === true) return false;\n    if (state === false) return undefined;\n    return true;\n}\n\nexport interface ThreeStateCheckboxProps extends Omit<CheckboxProps, 'checked' | 'onChange'> {\n    checked?: boolean | undefined | null;\n    onChange?: (checked: boolean | undefined | null) => void;\n}\n\n/**\n * When checked is true, checkbox contains checkmark\n * When checked is false, checkbox contains cross\n * When checked is null or undefined, checkbox is empty\n */\nconst ThreeStateCheckbox: React.FC<ThreeStateCheckboxProps> = ({ checked, onChange, ...rest }) => {\n    const handleChange = useCallback(() => {\n        if (onChange) {\n            const newState = nextState(checked);\n            onChange(newState);\n        }\n    }, [onChange]);\n\n    return (\n        <Checkbox\n            indeterminateIcon={<DisabledByDefaultRounded />}\n            checked={checked === true}\n            indeterminate={checked === false}\n            onChange={handleChange}\n            {...rest}\n        />\n    );\n};\nexport default ThreeStateCheckbox;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { FormControlLabel } from '@mui/material';\nimport React from 'react';\nimport ThreeStateCheckbox, { ThreeStateCheckboxProps } from 'components/atoms/ThreeStateCheckbox';\n\ninterface IProps extends ThreeStateCheckboxProps {\n    label?: string;\n}\n\nconst ThreeStateCheckboxInput: React.FC<IProps> = ({ label, sx, ...rest }) => (\n    <FormControlLabel control={<ThreeStateCheckbox {...rest} />} label={label} sx={sx} />\n);\n\nexport default ThreeStateCheckboxInput;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Drawer } from '@mui/material';\nimport { Box } from '@mui/system';\nimport React from 'react';\n\ninterface IProps {\n    open: boolean;\n    onClose: () => void;\n    children: React.ReactNode;\n    minHeight?: number;\n}\n\nconst OptionsPanel: React.FC<IProps> = ({ open, onClose, children, minHeight }) => (\n    <Drawer\n        anchor=\"bottom\"\n        open={open}\n        onClose={onClose}\n        PaperProps={{\n            style: {\n                maxWidth: 600,\n                marginLeft: 'auto',\n                marginRight: 'auto',\n                minHeight,\n            },\n        }}\n    >\n        <Box>{children}</Box>\n    </Drawer>\n);\n\nOptionsPanel.defaultProps = {\n    minHeight: undefined,\n};\n\nexport default OptionsPanel;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Stack, Tab, Tabs } from '@mui/material';\nimport TabPanel from 'components/util/TabPanel';\nimport React, { useState } from 'react';\nimport OptionsPanel from 'components/molecules/OptionsPanel';\n\ninterface IProps<T = string> {\n    open: boolean;\n    onClose: () => void;\n    tabs: T[];\n    tabTitle: (key: T) => React.ReactNode;\n    tabContent: (key: T) => React.ReactNode;\n    minHeight?: number;\n}\n\nconst OptionsTabs = <T extends string = string>({\n    open,\n    onClose,\n    tabs,\n    tabTitle,\n    tabContent,\n    minHeight,\n}: IProps<T>) => {\n    const [tabNum, setTabNum] = useState(0);\n\n    return (\n        <OptionsPanel open={open} onClose={onClose} minHeight={minHeight}>\n            <Tabs\n                value={tabNum}\n                variant=\"fullWidth\"\n                onChange={(e, newTab) => setTabNum(newTab)}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n            >\n                {tabs.map((tab, tabIndex) => (\n                    <Tab key={tab} value={tabIndex} label={tabTitle(tab)} />\n                ))}\n            </Tabs>\n            {tabs.map((tab, tabIndex) => (\n                <TabPanel key={tab} index={tabIndex} currentIndex={tabNum}>\n                    <Stack sx={{ px: 3, py: 1, minHeight }}>{tabContent(tab)}</Stack>\n                </TabPanel>\n            ))}\n        </OptionsPanel>\n    );\n};\n\nOptionsTabs.defaultProps = {\n    minHeight: undefined,\n};\n\nexport default OptionsTabs;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { FormLabel, RadioGroup } from '@mui/material';\nimport CheckboxInput from 'components/atoms/CheckboxInput';\nimport RadioInput from 'components/atoms/RadioInput';\nimport SortRadioInput from 'components/atoms/SortRadioInput';\nimport ThreeStateCheckboxInput from 'components/atoms/ThreeStateCheckboxInput';\nimport { GridLayout, useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport OptionsTabs from 'components/molecules/OptionsTabs';\nimport React from 'react';\n\nconst TITLES = {\n    filter: 'Filter',\n    sort: 'Sort',\n    display: 'Display',\n};\n\nconst SORT_OPTIONS: [LibrarySortMode, string][] = [\n    ['sortToRead', 'By Unread chapters'],\n    ['sortAlph', 'Alphabetically'],\n    ['sortID', 'By ID'],\n];\n\ninterface IProps {\n    open: boolean;\n    onClose: () => void;\n}\n\nconst LibraryOptionsPanel: React.FC<IProps> = ({ open, onClose }) => {\n    const { options, setOptions } = useLibraryOptionsContext();\n\n    const handleFilterChange = <T extends keyof LibraryOptions>(key: T, value: LibraryOptions[T]) => {\n        setOptions((v) => ({ ...v, [key]: value }));\n    };\n\n    return (\n        <OptionsTabs<'filter' | 'sort' | 'display'>\n            open={open}\n            onClose={onClose}\n            tabs={['filter', 'sort', 'display']}\n            tabTitle={(key) => TITLES[key]}\n            tabContent={(key) => {\n                if (key === 'filter') {\n                    return (\n                        <>\n                            <ThreeStateCheckboxInput\n                                label=\"Unread\"\n                                checked={options.unread}\n                                onChange={(c) => handleFilterChange('unread', c)}\n                            />\n                            <ThreeStateCheckboxInput\n                                label=\"Downloaded\"\n                                checked={options.downloaded}\n                                onChange={(c) => handleFilterChange('downloaded', c)}\n                            />\n                        </>\n                    );\n                }\n                if (key === 'sort') {\n                    return SORT_OPTIONS.map(([mode, label]) => (\n                        <SortRadioInput\n                            key={mode}\n                            label={label}\n                            checked={options.sorts === mode}\n                            sortDescending={options.sortDesc}\n                            onClick={() =>\n                                mode !== options.sorts\n                                    ? handleFilterChange('sorts', mode)\n                                    : handleFilterChange('sortDesc', !options.sortDesc)\n                            }\n                        />\n                    ));\n                }\n                if (key === 'display') {\n                    const { gridLayout, showDownloadBadge, showUnreadBadge } = options;\n                    return (\n                        <>\n                            <FormLabel>Display mode</FormLabel>\n                            <RadioGroup\n                                onChange={(e) => handleFilterChange('gridLayout', Number(e.target.value))}\n                                value={gridLayout}\n                            >\n                                <RadioInput\n                                    label=\"Compact grid\"\n                                    value={GridLayout.Compact}\n                                    checked={gridLayout == null || gridLayout === GridLayout.Compact}\n                                />\n                                <RadioInput\n                                    label=\"Comfortable grid\"\n                                    value={GridLayout.Comfortable}\n                                    checked={gridLayout === GridLayout.Comfortable}\n                                />\n                                <RadioInput\n                                    label=\"List\"\n                                    value={GridLayout.List}\n                                    checked={gridLayout === GridLayout.List}\n                                />\n                            </RadioGroup>\n\n                            <FormLabel sx={{ mt: 2 }}>Badges</FormLabel>\n                            <CheckboxInput\n                                label=\"Unread Badges\"\n                                checked={showUnreadBadge === true}\n                                onChange={() => handleFilterChange('showUnreadBadge', !showUnreadBadge)}\n                            />\n                            <CheckboxInput\n                                label=\"Download Badges\"\n                                checked={showDownloadBadge === true}\n                                onChange={() => handleFilterChange('showDownloadBadge', !showDownloadBadge)}\n                            />\n                        </>\n                    );\n                }\n                return null;\n            }}\n        />\n    );\n};\n\nexport default LibraryOptionsPanel;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport FilterList from '@mui/icons-material/FilterList';\nimport { IconButton } from '@mui/material';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport React, { useState } from 'react';\nimport LibraryOptionsPanel from 'components/library/LibraryOptionsPanel';\n\nconst LibraryToolbarMenu: React.FC = () => {\n    const [open, setOpen] = useState(false);\n    const { options } = useLibraryOptionsContext();\n    const active = options.downloaded != null || options.unread != null;\n\n    return (\n        <>\n            <IconButton onClick={() => setOpen(!open)} color={active ? 'warning' : 'default'}>\n                <FilterList />\n            </IconButton>\n            <LibraryOptionsPanel open={open} onClose={() => setOpen(false)} />\n        </>\n    );\n};\n\nexport default LibraryToolbarMenu;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState, CSSProperties } from 'react';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport Box from '@mui/system/Box';\nimport { Theme } from '@mui/system/createTheme';\nimport { SxProps } from '@mui/system/styleFunctionSx';\n\ninterface IProps {\n    src: string;\n    alt: string;\n\n    imgRef?: React.RefObject<HTMLImageElement>;\n\n    spinnerStyle?: SxProps<Theme>;\n    imgStyle?: CSSProperties;\n\n    onImageLoad?: () => void;\n}\n\nexport default function SpinnerImage(props: IProps) {\n    const { src, alt, onImageLoad, imgRef, spinnerStyle, imgStyle } = props;\n    const [imageSrc, setImagsrc] = useState<string>('');\n\n    useEffect(() => {\n        const img = new Image();\n        img.src = src;\n\n        img.onload = () => {\n            setImagsrc(src);\n            onImageLoad?.();\n        };\n\n        img.onerror = () => {\n            // Setting to an actual image so CSS styling works consistently\n            setImagsrc('/notFound.svg');\n        };\n\n        return () => {\n            img.onload = null;\n            img.onerror = null;\n        };\n    }, [src]);\n\n    if (imageSrc.length === 0) {\n        return (\n            <Box sx={spinnerStyle}>\n                <CircularProgress thickness={5} />\n            </Box>\n        );\n    }\n\n    if (imageSrc === 'Not Found') {\n        return <Box sx={spinnerStyle} />;\n    }\n\n    return <img style={imgStyle} ref={imgRef} src={imageSrc} alt={alt} />;\n}\n\nSpinnerImage.defaultProps = {\n    spinnerStyle: {},\n    imgStyle: {},\n    onImageLoad: () => {},\n    imgRef: undefined,\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport Card from '@mui/material/Card';\nimport CardActionArea from '@mui/material/CardActionArea';\nimport Typography from '@mui/material/Typography';\nimport { Link } from 'react-router-dom';\nimport { Avatar, CardContent, Grid } from '@mui/material';\nimport useLocalStorage from 'util/useLocalStorage';\nimport SpinnerImage from 'components/util/SpinnerImage';\nimport { Box, styled } from '@mui/system';\nimport { GridLayout, useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport { BACK } from 'util/useBackTo';\n\nconst BottomGradient = styled('div')({\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: '30%',\n    background: 'linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%)',\n});\n\nconst BottomGradientDoubledDown = styled('div')({\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: '20%',\n    background: 'linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%)',\n});\n\nconst MangaTitle = styled(Typography)({\n    position: 'absolute',\n    bottom: 0,\n    padding: '0.5em',\n    fontSize: '1.05rem',\n});\n\nconst BadgeContainer = styled('div')({\n    display: 'flex',\n    height: 'fit-content',\n    borderRadius: '5px',\n    overflow: 'hidden',\n    '& p': {\n        color: 'white',\n        padding: '0.1em',\n        paddingInline: '0.2em',\n        fontSize: '1.05rem',\n    },\n});\n\nconst truncateText = (str: string, maxLength: number) => {\n    const ending = '...';\n    // trim the string to the maximum length\n    const trimmedString = str.substr(0, maxLength - ending.length);\n\n    if (trimmedString.length < str.length) {\n        return trimmedString + ending;\n    }\n    return str;\n};\n\ninterface IProps {\n    manga: IMangaCard;\n    gridLayout?: GridLayout;\n    dimensions: number;\n    inLibraryIndicator?: boolean;\n}\n\nconst MangaCard = React.forwardRef<HTMLDivElement, IProps>((props: IProps, ref) => {\n    const {\n        manga: {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            id,\n            title,\n            thumbnailUrl,\n            downloadCount,\n            unreadCount: unread,\n            inLibrary,\n        },\n        gridLayout,\n        dimensions,\n        inLibraryIndicator,\n    } = props;\n    const {\n        options: { showUnreadBadge, showDownloadBadge },\n    } = useLibraryOptionsContext();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n    const [ItemWidth] = useLocalStorage<number>('ItemWidth', 300);\n\n    const mangaLinkTo = { pathname: `/manga/${id}/`, state: { backLink: BACK } };\n\n    if (gridLayout !== GridLayout.List) {\n        const cols = Math.ceil(dimensions / ItemWidth);\n        return (\n            <Grid item columns={cols} xs={1}>\n                <Link to={mangaLinkTo} style={gridLayout === GridLayout.Comfortable ? { textDecoration: 'none' } : {}}>\n                    <Box\n                        sx={{\n                            display: 'flex',\n                            flexDirection: 'column',\n                        }}\n                    >\n                        <Card\n                            sx={{\n                                // force standard aspect ratio of manga covers\n                                aspectRatio: '225/350',\n                                display: 'flex',\n                            }}\n                            ref={ref}\n                        >\n                            <CardActionArea\n                                sx={{\n                                    position: 'relative',\n                                    height: '100%',\n                                }}\n                            >\n                                <BadgeContainer\n                                    sx={{\n                                        position: 'absolute',\n                                        top: 5,\n                                        left: 5,\n                                    }}\n                                >\n                                    {inLibraryIndicator && inLibrary && (\n                                        <Typography sx={{ backgroundColor: 'primary.dark', zIndex: '1' }}>\n                                            In library\n                                        </Typography>\n                                    )}\n                                    {showUnreadBadge && unread! > 0 && (\n                                        <Typography sx={{ backgroundColor: 'primary.dark' }}>{unread}</Typography>\n                                    )}\n                                    {showDownloadBadge && downloadCount! > 0 && (\n                                        <Typography\n                                            sx={{\n                                                backgroundColor: 'success.dark',\n                                            }}\n                                        >\n                                            {downloadCount}\n                                        </Typography>\n                                    )}\n                                </BadgeContainer>\n                                <SpinnerImage\n                                    alt={title}\n                                    src={`${serverAddress}${thumbnailUrl}?useCache=${useCache}`}\n                                    imgStyle={\n                                        inLibraryIndicator && inLibrary\n                                            ? {\n                                                  height: '100%',\n                                                  width: '100%',\n                                                  objectFit: 'cover',\n                                                  filter: 'brightness(0.4)',\n                                              }\n                                            : {\n                                                  height: '100%',\n                                                  width: '100%',\n                                                  objectFit: 'cover',\n                                              }\n                                    }\n                                    spinnerStyle={{\n                                        display: 'grid',\n                                        placeItems: 'center',\n                                    }}\n                                />\n                                {gridLayout === GridLayout.Comfortable ? (\n                                    <></>\n                                ) : (\n                                    <>\n                                        <BottomGradient />\n                                        <BottomGradientDoubledDown />\n                                    </>\n                                )}\n                                {gridLayout === GridLayout.Comfortable ? (\n                                    <></>\n                                ) : (\n                                    <MangaTitle\n                                        sx={{\n                                            color: 'white',\n                                            textShadow: '0px 0px 3px #000000',\n                                        }}\n                                        title={title}\n                                    >\n                                        {truncateText(title, 61)}\n                                    </MangaTitle>\n                                )}\n                            </CardActionArea>\n                        </Card>\n                        {gridLayout === GridLayout.Comfortable ? (\n                            <MangaTitle\n                                sx={{\n                                    position: 'relative',\n                                    color: 'text.primary',\n                                }}\n                                title={title}\n                            >\n                                {truncateText(title, 61)}\n                            </MangaTitle>\n                        ) : (\n                            <></>\n                        )}\n                    </Box>\n                </Link>\n            </Grid>\n        );\n    }\n\n    return (\n        <Grid item xs={12}>\n            <Card>\n                <CardActionArea component={Link} to={mangaLinkTo}>\n                    <CardContent\n                        sx={{\n                            display: 'flex',\n                            justifyContent: 'space-between',\n                            alignItems: 'center',\n                            padding: 2,\n                            position: 'relative',\n                        }}\n                    >\n                        <Avatar\n                            variant=\"rounded\"\n                            sx={\n                                inLibraryIndicator && inLibrary\n                                    ? {\n                                          width: 56,\n                                          height: 56,\n                                          flex: '0 0 auto',\n                                          marginRight: 2,\n                                          imageRendering: 'pixelated',\n                                          filter: 'brightness(0.4)',\n                                      }\n                                    : {\n                                          width: 56,\n                                          height: 56,\n                                          flex: '0 0 auto',\n                                          marginRight: 2,\n                                          imageRendering: 'pixelated',\n                                      }\n                            }\n                            src={`${serverAddress}${thumbnailUrl}?useCache=${useCache}`}\n                        />\n                        <Box\n                            sx={{\n                                display: 'flex',\n                                flexDirection: 'row',\n                                flexGrow: 1,\n                                width: 'min-content',\n                            }}\n                        >\n                            <Typography variant=\"h5\" component=\"h2\" title={title}>\n                                {truncateText(title, 61)}\n                            </Typography>\n                        </Box>\n                        <BadgeContainer>\n                            {inLibraryIndicator && inLibrary && (\n                                <Typography sx={{ backgroundColor: 'primary.dark' }}>In library</Typography>\n                            )}\n                            {showUnreadBadge && unread! > 0 && (\n                                <Typography sx={{ backgroundColor: 'primary.dark' }}>{unread}</Typography>\n                            )}\n                            {showDownloadBadge && downloadCount! > 0 && (\n                                <Typography\n                                    sx={{\n                                        backgroundColor: 'success.dark',\n                                    }}\n                                >\n                                    {downloadCount}\n                                </Typography>\n                            )}\n                        </BadgeContainer>\n                    </CardContent>\n                </CardActionArea>\n            </Card>\n        </Grid>\n    );\n});\n\nexport default MangaCard;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useLayoutEffect, useRef, useState } from 'react';\nimport Grid from '@mui/material/Grid';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport { Typography } from '@mui/material';\nimport { Box } from '@mui/system';\nimport MangaCard from 'components/MangaCard';\nimport { GridLayout } from 'components/context/LibraryOptionsContext';\n\nexport interface IMangaGridProps {\n    mangas: IMangaCard[];\n    isLoading: boolean;\n    message?: string;\n    messageExtra?: JSX.Element;\n    hasNextPage: boolean;\n    lastPageNum: number;\n    setLastPageNum: (lastPageNum: number) => void;\n    gridLayout?: GridLayout;\n    horizontal?: boolean | undefined;\n    noFaces?: boolean | undefined;\n    inLibraryIndicator?: boolean;\n}\n\nconst MangaGrid: React.FC<IMangaGridProps> = (props) => {\n    const {\n        mangas,\n        isLoading,\n        message,\n        messageExtra,\n        hasNextPage,\n        lastPageNum,\n        setLastPageNum,\n        gridLayout,\n        horizontal,\n        noFaces,\n        inLibraryIndicator,\n    } = props;\n    let mapped;\n    const lastManga = useRef<HTMLDivElement>(null);\n\n    const scrollHandler = () => {\n        if (lastManga.current) {\n            const rect = lastManga.current.getBoundingClientRect();\n            if ((rect.y + rect.height) / window.innerHeight < 2 && hasNextPage) {\n                setLastPageNum(lastPageNum + 1);\n            }\n        }\n    };\n    useEffect(() => {\n        window.addEventListener('scroll', scrollHandler, true);\n        return () => {\n            window.removeEventListener('scroll', scrollHandler, true);\n        };\n    }, [hasNextPage, mangas]);\n\n    const [dimensions, setDimensions] = useState(1);\n\n    const gridRef = useRef<HTMLDivElement>(null);\n\n    const TestDimensions = () => {\n        setDimensions(gridRef.current ? gridRef.current.offsetWidth : 0);\n    };\n\n    useLayoutEffect(TestDimensions, []);\n\n    let movementTimer: NodeJS.Timeout;\n\n    window.addEventListener('resize', () => {\n        clearInterval(movementTimer);\n        movementTimer = setTimeout(TestDimensions, 100);\n    });\n\n    if (mangas.length === 0) {\n        if (isLoading) {\n            mapped = <LoadingPlaceholder />;\n        } else {\n            mapped = noFaces ? (\n                <Box\n                    sx={{\n                        margin: 'auto',\n                    }}\n                >\n                    <Typography variant=\"h5\">{message}</Typography>\n                    {messageExtra}\n                </Box>\n            ) : (\n                <EmptyView message={message!} messageExtra={messageExtra} />\n            );\n        }\n    } else {\n        mapped = mangas.map((it, idx) => (\n            <MangaCard\n                key={it.id}\n                manga={it}\n                ref={idx === mangas.length - 1 ? lastManga : undefined}\n                gridLayout={gridLayout}\n                dimensions={dimensions}\n                inLibraryIndicator={inLibraryIndicator}\n            />\n        ));\n    }\n\n    return (\n        <div ref={gridRef}>\n            <Grid\n                container\n                spacing={1}\n                style={\n                    horizontal\n                        ? {\n                              margin: 0,\n                              width: '100%',\n                              padding: '5px',\n                              overflowX: 'scroll',\n                              display: '-webkit-inline-box',\n                              flexWrap: 'nowrap',\n                          }\n                        : {\n                              margin: 0,\n                              width: '100%',\n                              padding: '5px',\n                          }\n                }\n            >\n                {mapped}\n            </Grid>\n        </div>\n    );\n};\n\nMangaGrid.defaultProps = {\n    message: '',\n    messageExtra: undefined,\n};\n\nexport default MangaGrid;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport MangaGrid from 'components/MangaGrid';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\nimport { StringParam, useQueryParam } from 'use-query-params';\nimport { useMediaQuery, useTheme } from '@mui/material';\n\nconst FILTERED_OUT_MESSAGE = 'There are no Manga matching this filter';\n\nconst unreadFilter = (unread: NullAndUndefined<boolean>, { unreadCount }: IMangaCard): boolean => {\n    switch (unread) {\n        case true:\n            return !!unreadCount && unreadCount >= 1;\n        case false:\n            return unreadCount === 0;\n        default:\n            return true;\n    }\n};\n\nconst downloadedFilter = (downloaded: NullAndUndefined<boolean>, { downloadCount }: IMangaCard): boolean => {\n    switch (downloaded) {\n        case true:\n            return !!downloadCount && downloadCount >= 1;\n        case false:\n            return downloadCount === 0;\n        default:\n            return true;\n    }\n};\n\nconst queryFilter = (query: NullAndUndefined<string>, { title }: IMangaCard): boolean => {\n    if (!query) return true;\n    return title.toLowerCase().includes(query.toLowerCase());\n};\n\nconst queryGenreFilter = (query: NullAndUndefined<string>, { genre }: IMangaCard): boolean => {\n    if (!query) return true;\n    const queries = query.split(',').map((str) => str.toLowerCase().trim());\n    return queries.every((element) => genre.map((el) => el.toLowerCase()).includes(element));\n};\n\nconst filterManga = (\n    manga: IMangaCard[],\n    query: NullAndUndefined<string>,\n    unread: NullAndUndefined<boolean>,\n    downloaded: NullAndUndefined<boolean>,\n): IMangaCard[] => {\n    let filteredManga: IMangaCard[] = [];\n    if (query) {\n        const titleFilteredManga = manga.filter((m) => queryFilter(query, m));\n        const genreFilteredManga = manga.filter((m) => queryGenreFilter(query, m));\n        const unique = titleFilteredManga.concat(genreFilteredManga).reduce((acc: Record<number, IMangaCard>, obj) => {\n            const { id } = obj;\n            if (!acc[id]) {\n                acc[id] = obj;\n            }\n            return acc;\n        }, {});\n        filteredManga = Object.values(unique);\n    }\n    filteredManga = (filteredManga.length ? filteredManga : manga).filter(\n        (m) => downloadedFilter(downloaded, m) && unreadFilter(unread, m),\n    );\n    return filteredManga;\n};\n\nconst sortByUnread = (a: IMangaCard, b: IMangaCard): number =>\n    // eslint-disable-next-line implicit-arrow-linebreak\n    (a.unreadCount ?? 0) - (b.unreadCount ?? 0);\n\nconst sortByTitle = (a: IMangaCard, b: IMangaCard): number => a.title.localeCompare(b.title);\n\nconst sortById = (a: IMangaCard, b: IMangaCard): number => a.id - b.id;\n\nconst sortManga = (\n    manga: IMangaCard[],\n    sort: NullAndUndefined<LibrarySortMode>,\n    desc: NullAndUndefined<boolean>,\n): IMangaCard[] => {\n    const result = [...manga];\n\n    switch (sort) {\n        case 'sortAlph':\n            result.sort(sortByTitle);\n            break;\n        case 'sortID':\n            result.sort(sortById);\n            break;\n        case 'sortToRead':\n            result.sort(sortByUnread);\n            break;\n        default:\n            break;\n    }\n\n    if (desc === true) {\n        result.reverse();\n    }\n\n    return result;\n};\n\ninterface LibraryMangaGridProps {\n    mangas: IMangaCard[];\n    isLoading: boolean;\n    message?: string;\n}\n\nconst LibraryMangaGrid: React.FC<LibraryMangaGridProps & { lastLibraryUpdate: number }> = ({\n    mangas,\n    isLoading,\n    message,\n    lastLibraryUpdate,\n}) => {\n    const [query] = useQueryParam('query', StringParam);\n    const { options } = useLibraryOptionsContext();\n    const { unread, downloaded } = options;\n    const [filteredPaginatedMangas, setFilteredPaginatedMangas] = useState<IMangaCard[]>([]);\n    const [sortedManga, setSortedManga] = useState<IMangaCard[]>([]);\n    const [filteredManga, setFilteredManga] = useState<IMangaCard[]>([]);\n    const totalPages = (mangas ?? []).length / 10;\n    const theme = useTheme();\n    const isLargeScreen = useMediaQuery(theme.breakpoints.up('sm'));\n    const defaultPageNumber = isLargeScreen ? 4 : 1;\n    const [lastPageNum, setLastPageNum] = useState<number>(defaultPageNumber);\n    useEffect(() => {\n        setFilteredManga(filterManga(mangas, query, unread, downloaded));\n        setLastPageNum(defaultPageNumber);\n        window.scrollTo(0, 0);\n    }, [mangas, query, unread, downloaded]);\n\n    useEffect(() => {\n        setSortedManga(sortManga(filteredManga, options.sorts, options.sortDesc));\n    }, [filteredManga, lastLibraryUpdate, options.sorts, options.sortDesc]);\n\n    useEffect(() => {\n        setFilteredPaginatedMangas((sortedManga ?? []).slice(0, lastPageNum * 10));\n    }, [lastPageNum, sortedManga]);\n\n    const showFilteredOutMessage =\n        (unread != null || downloaded != null || query) && filteredManga.length === 0 && mangas.length > 0;\n\n    return (\n        <MangaGrid\n            mangas={filteredPaginatedMangas}\n            isLoading={isLoading}\n            hasNextPage={lastPageNum < totalPages}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n            message={showFilteredOutMessage ? FILTERED_OUT_MESSAGE : message}\n            gridLayout={options.gridLayout}\n        />\n    );\n};\n\nexport default LibraryMangaGrid;\n","import React, { useEffect, useState } from 'react';\nimport IconButton from '@mui/material/IconButton';\nimport RefreshIcon from '@mui/icons-material/Refresh';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport { Box } from '@mui/system';\nimport Typography from '@mui/material/Typography';\nimport client from 'util/client';\nimport makeToast from 'components/util/Toast';\n\ninterface IProgressProps {\n    progress: number;\n}\n\nfunction Progress({ progress }: IProgressProps) {\n    return (\n        <Box sx={{ display: 'grid', placeItems: 'center', position: 'relative' }}>\n            <CircularProgress variant=\"determinate\" value={progress} />\n            <Box sx={{ position: 'absolute' }}>\n                <Typography fontSize=\"0.8rem\">{`${Math.round(progress)}%`}</Typography>\n            </Box>\n        </Box>\n    );\n}\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\n\ninterface IUpdateCheckerProps {\n    handleFinishedUpdate: (time: number) => void;\n}\n\nfunction UpdateChecker({ handleFinishedUpdate }: IUpdateCheckerProps) {\n    const [loading, setLoading] = useState(false);\n    const [progress, setProgress] = useState(0);\n\n    const onClick = async () => {\n        try {\n            setLoading(true);\n            setProgress(0);\n            await client.post('/api/v1/update/fetch');\n        } catch (e) {\n            makeToast('Checking for updates failed!', 'error');\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/update`);\n\n        // \"loading\" can't be used since it will be outdated once the state gets changed\n        // it could be used by adding it as a dependency of \"useEffect\" but then the socket would\n        // get closed and connected again every time it changes\n        let updateStarted = false;\n\n        wsc.onmessage = (e) => {\n            const { running, statusMap } = JSON.parse(e.data) as IUpdateStatus;\n            const { COMPLETE = [], RUNNING = [], PENDING = [] } = statusMap;\n\n            const currentProgress = 100 * (COMPLETE.length / (COMPLETE.length + RUNNING.length + PENDING.length));\n\n            const isUpdateFinished = currentProgress === 100;\n            const ignoreFaultyMessage = !updateStarted && !running && isUpdateFinished;\n\n            // for some reason the server sends 100% completed manga updates when connecting to the\n            // socket while no update is running\n            if (ignoreFaultyMessage) {\n                return;\n            }\n\n            updateStarted = running;\n            setLoading(running);\n            setProgress(Number.isNaN(currentProgress) ? 0 : currentProgress);\n\n            if (isUpdateFinished) {\n                handleFinishedUpdate(Date.now());\n            }\n        };\n\n        return () => wsc.close();\n    }, []);\n\n    return (\n        <IconButton onClick={onClick} disabled={loading}>\n            {loading ? <Progress progress={progress} /> : <RefreshIcon />}\n        </IconButton>\n    );\n}\n\nexport default UpdateChecker;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Tab, Tabs } from '@mui/material';\nimport React, { useContext, useEffect, useState } from 'react';\nimport NavbarContext from 'components/context/NavbarContext';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport TabPanel from 'components/util/TabPanel';\nimport LibraryToolbarMenu from 'components/library/LibraryToolbarMenu';\nimport LibraryMangaGrid from 'components/library/LibraryMangaGrid';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport { useQueryParam, NumberParam } from 'use-query-params';\nimport { useQuery } from 'util/client';\nimport UpdateChecker from 'components/library/UpdateChecker';\nimport { useTranslation } from 'react-i18next';\n\nexport default function Library() {\n    const { t } = useTranslation();\n\n    const [lastLibraryUpdate, setLastLibraryUpdate] = useState(Date.now());\n    const { data: tabsData, error: tabsError, loading } = useQuery<ICategory[]>('/api/v1/category');\n    const tabs = tabsData ?? [];\n\n    const [tabSearchParam, setTabSearchParam] = useQueryParam('tab', NumberParam);\n\n    const activeTab = tabs.find((tab) => tab.order === tabSearchParam) ?? tabs[0];\n    const {\n        data: mangaData,\n        error: mangaError,\n        loading: mangaLoading,\n    } = useQuery<IManga[]>(`/api/v1/category/${activeTab?.id}`, {\n        isPaused: () => activeTab == null,\n    });\n    const mangas = mangaData ?? [];\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => {\n        setTitle(t('screens.Library.Library'));\n        setAction(\n            <>\n                <AppbarSearch />\n                <LibraryToolbarMenu />\n                <UpdateChecker handleFinishedUpdate={setLastLibraryUpdate} />\n            </>,\n        );\n        return () => {\n            setTitle('');\n            setAction(<></>);\n        };\n    }, []);\n\n    const handleTabChange = (newTab: number) => {\n        setTabSearchParam(newTab === 0 ? undefined : newTab);\n    };\n\n    if (tabsError != null) {\n        return (\n            <EmptyView\n                message={t('screens.Library.could-not-load-categories')}\n                messageExtra={tabsError?.message ?? tabsError}\n            />\n        );\n    }\n\n    if (loading) {\n        return <LoadingPlaceholder />;\n    }\n\n    if (tabs.length === 0) {\n        return <EmptyView message={t('screens.Library.your-library-is-empty')} />;\n    }\n\n    if (tabs.length === 1) {\n        return (\n            <LibraryMangaGrid\n                mangas={mangas}\n                lastLibraryUpdate={lastLibraryUpdate}\n                message={t('screens.Library.your-library-is-empty') as string}\n                isLoading={activeTab != null && mangaLoading}\n            />\n        );\n    }\n\n    // Visual Hack: 160px is min-width for viewport width of >600\n    const scrollableTabs = window.innerWidth < tabs.length * 160;\n\n    return (\n        <>\n            <Tabs\n                key={activeTab.order}\n                value={activeTab.order}\n                onChange={(e, newTab) => handleTabChange(newTab)}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                centered={!scrollableTabs}\n                variant={scrollableTabs ? 'scrollable' : 'fullWidth'}\n                scrollButtons\n                allowScrollButtonsMobile\n            >\n                {tabs.map((tab) => (\n                    <Tab key={tab.id} label={tab.name} value={tab.order} />\n                ))}\n            </Tabs>\n            {tabs.map((tab) => (\n                <TabPanel key={tab.order} index={tab.order} currentIndex={activeTab.order}>\n                    {tab === activeTab &&\n                        (mangaError ? (\n                            <EmptyView\n                                message={t('screens.Library.could-not-load-manga')}\n                                messageExtra={mangaError?.message ?? mangaError}\n                            />\n                        ) : (\n                            <LibraryMangaGrid\n                                mangas={mangas}\n                                lastLibraryUpdate={lastLibraryUpdate}\n                                message={t('screens.Library.category-is-empty') as string}\n                                isLoading={mangaLoading}\n                            />\n                        ))}\n                </TabPanel>\n            ))}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nexport const isWithinLastXMillis = (date: Date, timeMS: number) => {\n    const timeDifference = Date.now() - date.getTime();\n    return timeDifference <= timeMS;\n};\n\nexport const getElapsedTimeSinceStartOfDay = (date: Date) => {\n    const startOfDay = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n    return date.getTime() - startOfDay.getTime();\n};\n\n/**\n * Returns a string in localized format for the passed date.\n *\n * In case the date is from today or yesterday a special string will be returned including \"Today\"\n * or \"Yesterday\" with the localized time of the passed date.\n *\n * @example\n * const today = new Date();\n * const yesterday = new Date(today.getTime() - 1000 * 60 * 60 * 24);\n * const someDate = new Date(1337, 4, 20);\n *\n * const todayAsString = getDateString(today); // => \"Today at 02:50 AM\"\n * const yesterdayAsString = getDateString(yesterday) // => \"Yesterday at 02:50 AM\"\n * const someDate = getDateString(someDate) // => \"04/20/1337\"\n *\n *\n * @param date\n */\nexport const getUploadDateString = (date: Date | number) => {\n    const uploadDate = date instanceof Date ? date : new Date(date);\n\n    const today = new Date();\n    const todayElapsedTime = getElapsedTimeSinceStartOfDay(today);\n    const yesterday = new Date(today.getTime() - todayElapsedTime - 1000 * 60 * 60 * 24);\n    const elapsedTimeSinceYesterday = today.getTime() - yesterday.getTime();\n\n    const wasUploadedToday = isWithinLastXMillis(uploadDate, todayElapsedTime);\n    const wasUploadedYesterday = isWithinLastXMillis(uploadDate, elapsedTimeSinceYesterday);\n\n    const addTimeString = wasUploadedToday || wasUploadedYesterday;\n    const timeString = addTimeString\n        ? uploadDate.toLocaleTimeString(undefined, {\n              hour: '2-digit',\n              minute: '2-digit',\n          })\n        : '';\n\n    if (wasUploadedToday) {\n        return `Today at ${timeString}`;\n    }\n\n    if (wasUploadedYesterday) {\n        return `Yesterday at ${timeString}`;\n    }\n\n    return uploadDate.toLocaleDateString(undefined, {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n    });\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport BookmarkIcon from '@mui/icons-material/Bookmark';\nimport BookmarkAdd from '@mui/icons-material/BookmarkAdd';\nimport BookmarkRemove from '@mui/icons-material/BookmarkRemove';\nimport CheckBoxOutlineBlank from '@mui/icons-material/CheckBoxOutlineBlank';\nimport Delete from '@mui/icons-material/Delete';\nimport Done from '@mui/icons-material/Done';\nimport DoneAll from '@mui/icons-material/DoneAll';\nimport Download from '@mui/icons-material/Download';\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\nimport RemoveDone from '@mui/icons-material/RemoveDone';\nimport { CardActionArea, Checkbox, ListItemIcon, ListItemText, Stack } from '@mui/material';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport IconButton from '@mui/material/IconButton';\nimport Menu from '@mui/material/Menu';\nimport MenuItem from '@mui/material/MenuItem';\nimport { useTheme } from '@mui/material/styles';\nimport Typography from '@mui/material/Typography';\nimport DownloadStateIndicator from 'components/molecules/DownloadStateIndicator';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport client from 'util/client';\nimport { BACK } from 'util/useBackTo';\nimport { getUploadDateString } from 'util/date';\n\ninterface IProps {\n    chapter: IChapter;\n    triggerChaptersUpdate: () => void;\n    downloadChapter: IDownloadChapter | undefined;\n    showChapterNumber: boolean;\n    onSelect: (selected: boolean) => void;\n    selected: boolean | null;\n}\n\nconst ChapterCard: React.FC<IProps> = (props: IProps) => {\n    const theme = useTheme();\n\n    const { chapter, triggerChaptersUpdate, downloadChapter: dc, showChapterNumber, onSelect, selected } = props;\n    const isSelecting = selected !== null;\n\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n    const handleMenuClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        // prevent parent tags from getting the event\n        event.stopPropagation();\n        event.preventDefault();\n\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const sendChange = (key: string, value: any) => {\n        handleClose();\n\n        const formData = new FormData();\n        formData.append(key, value);\n        if (key === 'read') {\n            formData.append('lastPageRead', '1');\n        }\n        client\n            .patch(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`, formData)\n            .then(() => triggerChaptersUpdate());\n    };\n\n    const downloadChapter = () => {\n        client.get(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`);\n        handleClose();\n    };\n\n    const deleteChapter = () => {\n        client.delete(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`).then(() => triggerChaptersUpdate());\n        handleClose();\n    };\n\n    const handleSelect = () => {\n        onSelect(true);\n        handleClose();\n    };\n\n    const handleClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n        if (isSelecting) {\n            event.preventDefault();\n            event.stopPropagation();\n            onSelect(!selected);\n        }\n    };\n\n    const isDownloaded = chapter.downloaded;\n    const canBeDownloaded = !chapter.downloaded && dc === undefined;\n\n    return (\n        <li>\n            <Card\n                sx={{\n                    position: 'relative',\n                    margin: 1,\n                }}\n            >\n                <CardActionArea\n                    component={Link}\n                    to={{\n                        pathname: `/manga/${chapter.mangaId}/chapter/${chapter.index}`,\n                        state: { backLink: BACK },\n                    }}\n                    style={{\n                        color: theme.palette.text[chapter.read ? 'disabled' : 'primary'],\n                    }}\n                    onClick={handleClick}\n                >\n                    <CardContent\n                        sx={{\n                            display: 'flex',\n                            justifyContent: 'space-between',\n                            alignItems: 'center',\n                            padding: 2,\n                            '&:last-child': { pb: 2 },\n                        }}\n                    >\n                        <Stack direction=\"column\" flex={1}>\n                            <Typography variant=\"h5\" component=\"h2\">\n                                {chapter.bookmarked && (\n                                    <BookmarkIcon\n                                        color=\"primary\"\n                                        sx={{ mr: 0.5, position: 'relative', top: '0.15em' }}\n                                    />\n                                )}\n                                {showChapterNumber ? `Chapter ${chapter.chapterNumber}` : chapter.name}\n                            </Typography>\n                            <Typography variant=\"caption\">{chapter.scanlator}</Typography>\n                            <Typography variant=\"caption\">\n                                {getUploadDateString(chapter.uploadDate)}\n                                {isDownloaded && ' • Downloaded'}\n                            </Typography>\n                        </Stack>\n\n                        {dc && <DownloadStateIndicator download={dc} />}\n\n                        {selected === null ? (\n                            <IconButton aria-label=\"more\" onClick={handleMenuClick} size=\"large\">\n                                <MoreVertIcon />\n                            </IconButton>\n                        ) : (\n                            <Checkbox checked={selected} />\n                        )}\n                    </CardContent>\n                </CardActionArea>\n                <Menu anchorEl={anchorEl} keepMounted open={Boolean(anchorEl)} onClose={handleClose}>\n                    <MenuItem onClick={handleSelect}>\n                        <ListItemIcon>\n                            <CheckBoxOutlineBlank fontSize=\"small\" />\n                        </ListItemIcon>\n                        <ListItemText>Select</ListItemText>\n                    </MenuItem>\n                    {isDownloaded && (\n                        <MenuItem onClick={deleteChapter}>\n                            <ListItemIcon>\n                                <Delete fontSize=\"small\" />\n                            </ListItemIcon>\n                            <ListItemText>Delete</ListItemText>\n                        </MenuItem>\n                    )}\n                    {canBeDownloaded && (\n                        <MenuItem onClick={downloadChapter}>\n                            <ListItemIcon>\n                                <Download fontSize=\"small\" />\n                            </ListItemIcon>\n                            <ListItemText>Download</ListItemText>\n                        </MenuItem>\n                    )}\n                    <MenuItem onClick={() => sendChange('bookmarked', !chapter.bookmarked)}>\n                        <ListItemIcon>\n                            {chapter.bookmarked && <BookmarkRemove fontSize=\"small\" />}\n                            {!chapter.bookmarked && <BookmarkAdd fontSize=\"small\" />}\n                        </ListItemIcon>\n                        <ListItemText>\n                            {chapter.bookmarked && 'Remove bookmark'}\n                            {!chapter.bookmarked && 'Add bookmark'}\n                        </ListItemText>\n                    </MenuItem>\n                    <MenuItem onClick={() => sendChange('read', !chapter.read)}>\n                        <ListItemIcon>\n                            {chapter.read && <RemoveDone fontSize=\"small\" />}\n                            {!chapter.read && <Done fontSize=\"small\" />}\n                        </ListItemIcon>\n                        <ListItemText>\n                            {chapter.read && 'Mark as unread'}\n                            {!chapter.read && 'Mark as read'}\n                        </ListItemText>\n                    </MenuItem>\n                    <MenuItem onClick={() => sendChange('markPrevRead', true)}>\n                        <ListItemIcon>\n                            <DoneAll fontSize=\"small\" />\n                        </ListItemIcon>\n                        <ListItemText>Mark previous as Read</ListItemText>\n                    </MenuItem>\n                </Menu>\n            </Card>\n        </li>\n    );\n};\n\nexport default ChapterCard;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Fab } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport { PlayArrow } from '@mui/icons-material';\nimport { BACK } from 'util/useBackTo';\n\ninterface ResumeFABProps {\n    chapter: IChapter;\n    mangaId: string;\n}\n\nexport default function ResumeFab(props: ResumeFABProps) {\n    const {\n        chapter: { index, lastPageRead },\n        mangaId,\n    } = props;\n    return (\n        <Fab\n            sx={{ position: 'fixed', bottom: '2em', right: '3em' }}\n            component={Link}\n            variant=\"extended\"\n            color=\"primary\"\n            to={{\n                pathname: `/manga/${mangaId}/chapter/${index}/page/${lastPageRead}`,\n                state: { backLink: BACK },\n            }}\n        >\n            <PlayArrow />\n            {index === 1 ? 'Start' : 'Resume'}\n        </Fab>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { useReducerLocalStorage } from 'util/useLocalStorage';\n\nconst defaultChapterOptions: ChapterListOptions = {\n    active: false,\n    unread: undefined,\n    downloaded: undefined,\n    bookmarked: undefined,\n    reverse: false,\n    sortBy: 'source',\n    showChapterNumber: false,\n};\n\nfunction chapterOptionsReducer(state: ChapterListOptions, actions: ChapterOptionsReducerAction): ChapterListOptions {\n    switch (actions.type) {\n        case 'filter':\n            // eslint-disable-next-line no-case-declarations\n            const active = state.unread !== false && state.downloaded !== false && state.bookmarked !== false;\n            return {\n                ...state,\n                active,\n                [actions.filterType!]: actions.filterValue,\n            };\n        case 'sortBy':\n            return { ...state, sortBy: actions.sortBy };\n        case 'sortReverse':\n            return { ...state, reverse: !state.reverse };\n        case 'showChapterNumber':\n            return { ...state, showChapterNumber: !state.showChapterNumber };\n        default:\n            throw Error('This is not a valid Action');\n    }\n}\n\nexport function unreadFilter(unread: NullAndUndefined<boolean>, { read: isChapterRead }: IChapter) {\n    switch (unread) {\n        case true:\n            return !isChapterRead;\n        case false:\n            return isChapterRead;\n        default:\n            return true;\n    }\n}\n\nfunction downloadFilter(downloaded: NullAndUndefined<boolean>, { downloaded: chapterDownload }: IChapter) {\n    switch (downloaded) {\n        case true:\n            return chapterDownload;\n        case false:\n            return !chapterDownload;\n        default:\n            return true;\n    }\n}\n\nfunction bookmarkedFilter(bookmarked: NullAndUndefined<boolean>, { bookmarked: chapterBookmarked }: IChapter) {\n    switch (bookmarked) {\n        case true:\n            return chapterBookmarked;\n        case false:\n            return !chapterBookmarked;\n        default:\n            return true;\n    }\n}\n\nexport function filterAndSortChapters(chapters: IChapter[], options: ChapterListOptions): IChapter[] {\n    const filtered = options.active\n        ? chapters.filter(\n              (chp) =>\n                  unreadFilter(options.unread, chp) &&\n                  downloadFilter(options.downloaded, chp) &&\n                  bookmarkedFilter(options.bookmarked, chp),\n          )\n        : [...chapters];\n    const Sorted = options.sortBy === 'fetchedAt' ? filtered.sort((a, b) => a.fetchedAt - b.fetchedAt) : filtered;\n    if (options.reverse) {\n        Sorted.reverse();\n    }\n    return Sorted;\n}\n\nexport const useChapterOptions = (mangaId: string) =>\n    useReducerLocalStorage<ChapterListOptions, ChapterOptionsReducerAction>(\n        chapterOptionsReducer,\n        `${mangaId}filterOptions`,\n        defaultChapterOptions,\n    );\n\nexport const SORT_OPTIONS: [ChapterSortMode, string][] = [\n    ['source', 'By Source'],\n    ['fetchedAt', 'By Fetch date'],\n];\n\nexport const isFilterActive = (options: ChapterListOptions) => {\n    const { unread, downloaded, bookmarked } = options;\n    return unread != null || downloaded != null || bookmarked != null;\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\n// eslint-disable-next-line import/prefer-default-export\nexport const pluralize = (count: number, input: string | { one: string; many: string }) => {\n    if (typeof input === 'string') {\n        return `${input}${count === 1 ? '' : 's'}`;\n    }\n    return input[count === 1 ? 'one' : 'many'];\n};\n\nexport const interpolate = (count: number, input: { one: string; many: string }) => {\n    const text = count === 1 ? input.one : input.many;\n    return text.replaceAll('%count%', count.toString());\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { RadioGroup } from '@mui/material';\nimport RadioInput from 'components/atoms/RadioInput';\nimport SortRadioInput from 'components/atoms/SortRadioInput';\nimport ThreeStateCheckboxInput from 'components/atoms/ThreeStateCheckboxInput';\nimport OptionsTabs from 'components/molecules/OptionsTabs';\nimport React from 'react';\nimport { SORT_OPTIONS } from 'components/manga/util';\n\ninterface IProps {\n    open: boolean;\n    onClose: () => void;\n    options: ChapterListOptions;\n    optionsDispatch: React.Dispatch<ChapterOptionsReducerAction>;\n}\n\nconst TITLES = {\n    filter: 'Filter',\n    sort: 'Sort',\n    display: 'Display',\n};\n\nconst ChapterOptions: React.FC<IProps> = ({ open, onClose, options, optionsDispatch }) => (\n    <OptionsTabs<'filter' | 'sort' | 'display'>\n        open={open}\n        onClose={onClose}\n        minHeight={150}\n        tabs={['filter', 'sort', 'display']}\n        tabTitle={(key) => TITLES[key]}\n        tabContent={(key) => {\n            if (key === 'filter') {\n                return (\n                    <>\n                        <ThreeStateCheckboxInput\n                            label=\"Unread\"\n                            checked={options.unread}\n                            onChange={(c) =>\n                                optionsDispatch({\n                                    type: 'filter',\n                                    filterType: 'unread',\n                                    filterValue: c,\n                                })\n                            }\n                        />\n                        <ThreeStateCheckboxInput\n                            label=\"Downloaded\"\n                            checked={options.downloaded}\n                            onChange={(c) =>\n                                optionsDispatch({\n                                    type: 'filter',\n                                    filterType: 'downloaded',\n                                    filterValue: c,\n                                })\n                            }\n                        />\n                        <ThreeStateCheckboxInput\n                            label=\"Bookmarked\"\n                            checked={options.bookmarked}\n                            onChange={(c) =>\n                                optionsDispatch({\n                                    type: 'filter',\n                                    filterType: 'bookmarked',\n                                    filterValue: c,\n                                })\n                            }\n                        />\n                    </>\n                );\n            }\n            if (key === 'sort') {\n                return SORT_OPTIONS.map(([mode, label]) => (\n                    <SortRadioInput\n                        key={mode}\n                        label={label}\n                        checked={options.sortBy === mode}\n                        sortDescending={options.reverse}\n                        onClick={() =>\n                            mode !== options.sortBy\n                                ? optionsDispatch({ type: 'sortBy', sortBy: mode })\n                                : optionsDispatch({ type: 'sortReverse' })\n                        }\n                    />\n                ));\n            }\n            if (key === 'display') {\n                return (\n                    <RadioGroup\n                        onChange={() => optionsDispatch({ type: 'showChapterNumber' })}\n                        value={options.showChapterNumber}\n                    >\n                        <RadioInput label=\"Source Title\" value={false} />\n                        <RadioInput label=\"Chapter Number\" value />\n                    </RadioGroup>\n                );\n            }\n            return null;\n        }}\n    />\n);\n\nexport default ChapterOptions;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport FilterList from '@mui/icons-material/FilterList';\nimport { IconButton } from '@mui/material';\nimport * as React from 'react';\nimport ChapterOptions from 'components/manga/ChapterOptions';\nimport { isFilterActive } from 'components/manga/util';\n\ninterface IProps {\n    options: ChapterListOptions;\n    optionsDispatch: React.Dispatch<ChapterOptionsReducerAction>;\n}\n\nconst ChaptersToolbarMenu = ({ options, optionsDispatch }: IProps) => {\n    const [open, setOpen] = React.useState(false);\n    const isFiltered = isFilterActive(options);\n\n    return (\n        <>\n            <IconButton onClick={() => setOpen(true)}>\n                <FilterList color={isFiltered ? 'warning' : undefined} />\n            </IconButton>\n            <ChapterOptions\n                open={open}\n                onClose={() => setOpen(false)}\n                options={options}\n                optionsDispatch={optionsDispatch}\n            />\n        </>\n    );\n};\n\nexport default ChaptersToolbarMenu;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport BookmarkAdd from '@mui/icons-material/BookmarkAdd';\nimport BookmarkRemove from '@mui/icons-material/BookmarkRemove';\nimport Delete from '@mui/icons-material/Delete';\nimport Done from '@mui/icons-material/Done';\nimport Download from '@mui/icons-material/Download';\nimport RemoveDone from '@mui/icons-material/RemoveDone';\nimport { ListItemIcon, ListItemText, MenuItem } from '@mui/material';\nimport React from 'react';\nimport type { IChapterWithMeta } from 'components/manga/ChapterList';\nimport type { SelectionAction } from 'components/manga/SelectionFAB';\n\ninterface IProps {\n    action: SelectionAction;\n    matchingChapters: IChapterWithMeta[];\n    title: string;\n    onClick: (action: SelectionAction, chapters: IChapterWithMeta[]) => void;\n}\n\nconst ICONS = {\n    download: Download,\n    delete: Delete,\n    bookmark: BookmarkAdd,\n    unbookmark: BookmarkRemove,\n    mark_as_read: Done,\n    mark_as_unread: RemoveDone,\n};\n\nconst SelectionFABActionItem: React.FC<IProps> = ({ action, matchingChapters, onClick, title }) => {\n    const count = matchingChapters.length;\n    const Icon = ICONS[action];\n    return (\n        <MenuItem onClick={() => onClick(action, matchingChapters)} disabled={count === 0}>\n            <ListItemIcon>\n                <Icon fontSize=\"small\" />\n            </ListItemIcon>\n            <ListItemText>\n                {title}\n                {count > 0 ? ` (${count})` : ''}\n            </ListItemText>\n        </MenuItem>\n    );\n};\n\nexport default SelectionFABActionItem;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport MoreHoriz from '@mui/icons-material/MoreHoriz';\nimport { Fab, Menu } from '@mui/material';\nimport { Box } from '@mui/system';\nimport { pluralize } from 'components/util/helpers';\nimport React, { useRef, useState } from 'react';\nimport type { IChapterWithMeta } from 'components/manga/ChapterList';\nimport SelectionFABActionItem from 'components/manga/SelectionFABActionItem';\n\nexport type SelectionAction = 'download' | 'delete' | 'bookmark' | 'unbookmark' | 'mark_as_read' | 'mark_as_unread';\n\ninterface SelectionFABProps {\n    selectedChapters: IChapterWithMeta[];\n    onAction: (action: SelectionAction, chapters: IChapterWithMeta[]) => void;\n}\n\nconst SelectionFAB: React.FC<SelectionFABProps> = (props) => {\n    const { selectedChapters, onAction } = props;\n    const count = selectedChapters.length;\n\n    const anchorEl = useRef<HTMLElement>();\n    const [open, setOpen] = useState(false);\n    const handleClose = () => setOpen(false);\n\n    const handleAction = (action: SelectionAction, chapters: IChapterWithMeta[]) => {\n        onAction(action, chapters);\n        handleClose();\n    };\n\n    return (\n        <Box\n            sx={{\n                position: 'fixed',\n                bottom: '2em',\n                right: '3em',\n                pt: 1,\n            }}\n            ref={anchorEl}\n        >\n            <Fab variant=\"extended\" color=\"primary\" id=\"selectionMenuButton\" onClick={() => setOpen(true)}>\n                {`${count} ${pluralize(count, 'chapter')}`}\n                <MoreHoriz sx={{ ml: 1 }} />\n            </Fab>\n            <Menu\n                id=\"selectionMenu\"\n                anchorEl={anchorEl.current}\n                open={open}\n                onClose={handleClose}\n                anchorOrigin={{ horizontal: 'right', vertical: 'top' }}\n                transformOrigin={{ horizontal: 'right', vertical: 'bottom' }}\n                MenuListProps={{\n                    'aria-labelledby': 'selectionMenuButton',\n                }}\n            >\n                <SelectionFABActionItem\n                    action=\"download\"\n                    matchingChapters={selectedChapters.filter(\n                        ({ chapter: c, downloadChapter: dc }) => !c.downloaded && dc === undefined,\n                    )}\n                    onClick={handleAction}\n                    title=\"Download selected\"\n                />\n                <SelectionFABActionItem\n                    action=\"delete\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => chapter.downloaded)}\n                    onClick={handleAction}\n                    title=\"Delete selected\"\n                />\n                <SelectionFABActionItem\n                    action=\"bookmark\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => !chapter.bookmarked)}\n                    onClick={handleAction}\n                    title=\"Bookmark selected\"\n                />\n                <SelectionFABActionItem\n                    action=\"unbookmark\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => chapter.bookmarked)}\n                    onClick={handleAction}\n                    title=\"Remove bookmarks from selected\"\n                />\n                <SelectionFABActionItem\n                    action=\"mark_as_read\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => !chapter.read)}\n                    onClick={handleAction}\n                    title=\"Mark selected as read\"\n                />\n                <SelectionFABActionItem\n                    action=\"mark_as_unread\"\n                    matchingChapters={selectedChapters.filter(({ chapter }) => chapter.read)}\n                    onClick={handleAction}\n                    title=\"Mark selected as unread\"\n                />\n            </Menu>\n        </Box>\n    );\n};\n\nexport default SelectionFAB;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Button, CircularProgress, Stack } from '@mui/material';\nimport Typography from '@mui/material/Typography';\nimport { styled } from '@mui/system';\nimport useSubscription from 'components/library/useSubscription';\nimport ChapterCard from 'components/manga/ChapterCard';\nimport ResumeFab from 'components/manga/ResumeFAB';\nimport { filterAndSortChapters, useChapterOptions } from 'components/manga/util';\nimport EmptyView from 'components/util/EmptyView';\nimport { interpolate } from 'components/util/helpers';\nimport makeToast from 'components/util/Toast';\nimport React, { ComponentProps, useEffect, useMemo, useRef, useState } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\nimport client, { useQuery } from 'util/client';\nimport ChaptersToolbarMenu from 'components/manga/ChaptersToolbarMenu';\nimport SelectionFAB from 'components/manga/SelectionFAB';\n\nconst StyledVirtuoso = styled(Virtuoso)(({ theme }) => ({\n    listStyle: 'none',\n    padding: 0,\n    minHeight: '200px',\n    [theme.breakpoints.up('md')]: {\n        width: '50vw',\n        // 64px for the Appbar, 48px for the ChapterCount Header\n        height: 'calc(100vh - 64px - 48px)',\n        margin: 0,\n    },\n}));\n\nconst actionsStrings = {\n    download: {\n        success: { one: 'Download added', many: '%count% downloads added' },\n        error: { one: 'Error adding download', many: 'Error adding downloads' },\n    },\n    delete: {\n        success: { one: 'Chapter deleted', many: '%count% chapters deleted' },\n        error: { one: 'Error deleting chapter', many: 'Error deleting chapters' },\n    },\n    bookmark: {\n        success: { one: 'Chapter bookmarked', many: '%count% chapters bookmarked' },\n        error: { one: 'Error bookmarking chapter', many: 'Error bookmarking chapters' },\n    },\n    unbookmark: {\n        success: { one: 'Chapter bookmark removed', many: '%count% chapter bookmarks removed' },\n        error: { one: 'Error removing bookmark', many: 'Error removing bookmarks' },\n    },\n    mark_as_read: {\n        success: { one: 'Chapter marked as read', many: '%count% chapters marked as read' },\n        error: { one: 'Error marking chapter as read', many: 'Error marking chapters as read' },\n    },\n    mark_as_unread: {\n        success: { one: 'Chapter marked as unread', many: '%count% chapters marked as unread' },\n        error: { one: 'Error marking chapter as unread', many: 'Error marking chapters as unread' },\n    },\n};\n\nexport interface IChapterWithMeta {\n    chapter: IChapter;\n    downloadChapter: IDownloadChapter | undefined;\n    selected: boolean | null;\n}\n\ninterface IProps {\n    mangaId: string;\n}\n\nconst ChapterList: React.FC<IProps> = ({ mangaId }) => {\n    const [selection, setSelection] = useState<number[] | null>(null);\n    const prevQueueRef = useRef<IDownloadChapter[]>();\n    const queue = useSubscription<IQueue>('/api/v1/downloads').data?.queue;\n\n    const [options, dispatch] = useChapterOptions(mangaId);\n    const {\n        data: chaptersData,\n        mutate,\n        loading,\n    } = useQuery<IChapter[]>(`/api/v1/manga/${mangaId}/chapters?onlineFetch=false`);\n    const chapters = useMemo(() => chaptersData ?? [], [chaptersData]);\n\n    useEffect(() => {\n        if (prevQueueRef.current && queue) {\n            const prevQueue = prevQueueRef.current;\n            const changedDownloads = queue.filter((cd) => {\n                const prevChapterDownload = prevQueue.find(\n                    (pcd) => cd.chapterIndex === pcd.chapterIndex && cd.mangaId === pcd.mangaId,\n                );\n                if (!prevChapterDownload) return true;\n                return cd.state !== prevChapterDownload.state;\n            });\n\n            if (changedDownloads.length > 0) {\n                mutate();\n            }\n        }\n\n        prevQueueRef.current = queue;\n    }, [queue]);\n\n    const visibleChapters = useMemo(\n        () => filterAndSortChapters(chapters, options), //\n        [chapters, options],\n    );\n\n    const firstUnreadChapter = useMemo(\n        () =>\n            visibleChapters\n                .slice()\n                .reverse()\n                .find((c) => c.read === false),\n        [visibleChapters],\n    );\n\n    const handleSelection = (index: number) => {\n        const chapter = visibleChapters[index];\n        if (!chapter) return;\n\n        if (selection === null) {\n            setSelection([chapter.id]);\n        } else if (selection.includes(chapter.id)) {\n            const newSelection = selection.filter((cid) => cid !== chapter.id);\n            setSelection(newSelection.length > 0 ? newSelection : null);\n        } else {\n            setSelection([...selection, chapter.id]);\n        }\n    };\n\n    const handleSelectAll = () => {\n        if (selection === null) return;\n        setSelection(visibleChapters.map((c) => c.id));\n    };\n\n    const handleClear = () => {\n        if (selection === null) return;\n        setSelection(null);\n    };\n\n    const handleFabAction: ComponentProps<typeof SelectionFAB>['onAction'] = (action, actionChapters) => {\n        if (actionChapters.length === 0) return;\n        const chapterIds = actionChapters.map(({ chapter }) => chapter.id);\n\n        let actionPromise: Promise<any>;\n\n        if (action === 'download') {\n            actionPromise = client.post('/api/v1/download/batch', { chapterIds });\n        } else {\n            const change: BatchChaptersChange = {};\n\n            if (action === 'delete') change.delete = true;\n            else if (action === 'bookmark') change.isBookmarked = true;\n            else if (action === 'unbookmark') change.isBookmarked = false;\n            else if (action === 'mark_as_read') change.isRead = true;\n            else if (action === 'mark_as_unread') change.isRead = false;\n\n            actionPromise = client.post('/api/v1/chapter/batch', { chapterIds, change });\n        }\n\n        actionPromise\n            .then(() => makeToast(interpolate(chapterIds.length, actionsStrings[action].success), 'success'))\n            .then(() => mutate())\n            .catch(() => makeToast(interpolate(chapterIds.length, actionsStrings[action].error), 'error'));\n    };\n\n    if (loading) {\n        return (\n            <div\n                style={{\n                    margin: '10px auto',\n                    display: 'flex',\n                    justifyContent: 'center',\n                }}\n            >\n                <CircularProgress thickness={5} />\n            </div>\n        );\n    }\n\n    const noChaptersFound = chapters.length === 0;\n    const noChaptersMatchingFilter = !noChaptersFound && visibleChapters.length === 0;\n\n    const chaptersWithMeta: IChapterWithMeta[] = visibleChapters.map((chapter) => {\n        const downloadChapter = queue?.find(\n            (cd) => cd.chapterIndex === chapter.index && cd.mangaId === chapter.mangaId,\n        );\n        const selected = selection?.includes(chapter.id) ?? null;\n        return {\n            chapter,\n            downloadChapter,\n            selected,\n        };\n    });\n\n    const selectedChapters =\n        selection === null ? null : chaptersWithMeta.filter(({ chapter }) => selection.includes(chapter.id));\n\n    return (\n        <>\n            <Stack direction=\"column\" sx={{ position: 'relative' }}>\n                <Stack\n                    direction=\"row\"\n                    alignItems=\"center\"\n                    justifyContent=\"space-between\"\n                    sx={{\n                        m: 1,\n                        mb: 0,\n                        mr: 2,\n                        minHeight: 40,\n                    }}\n                >\n                    <Typography variant=\"h5\">\n                        {`${visibleChapters.length} Chapter${visibleChapters.length === 1 ? '' : 's'}`}\n                    </Typography>\n\n                    {selection === null ? (\n                        <ChaptersToolbarMenu options={options} optionsDispatch={dispatch} />\n                    ) : (\n                        <Stack direction=\"row\">\n                            <Button size=\"small\" onClick={handleSelectAll}>\n                                Select all\n                            </Button>\n                            <Button size=\"small\" onClick={handleClear}>\n                                Clear\n                            </Button>\n                        </Stack>\n                    )}\n                </Stack>\n\n                {noChaptersFound && <EmptyView message=\"No chapters found\" />}\n                {noChaptersMatchingFilter && <EmptyView message=\"No chapters matching filter\" />}\n\n                <StyledVirtuoso\n                    style={{\n                        // override Virtuoso default values and set them with class\n                        height: 'undefined',\n                        // 900 is the md breakpoint in MUI\n                        overflowY: window.innerWidth < 900 ? 'visible' : 'auto',\n                    }}\n                    totalCount={visibleChapters.length}\n                    itemContent={(index: number) => (\n                        <ChapterCard\n                            {...chaptersWithMeta[index]}\n                            showChapterNumber={options.showChapterNumber}\n                            triggerChaptersUpdate={() => mutate()}\n                            onSelect={() => handleSelection(index)}\n                        />\n                    )}\n                    useWindowScroll={window.innerWidth < 900}\n                    overscan={window.innerHeight * 0.5}\n                />\n            </Stack>\n            {selectedChapters !== null ? (\n                <SelectionFAB selectedChapters={selectedChapters} onAction={handleFabAction} />\n            ) : (\n                firstUnreadChapter && <ResumeFab chapter={firstUnreadChapter} mangaId={mangaId} />\n            )}\n        </>\n    );\n};\n\nexport default ChapterList;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport FavoriteBorderIcon from '@mui/icons-material/FavoriteBorder';\nimport PublicIcon from '@mui/icons-material/Public';\nimport { Typography } from '@mui/material';\nimport IconButton from '@mui/material/IconButton';\nimport { Theme } from '@mui/material/styles';\nimport makeStyles from '@mui/styles/makeStyles';\nimport React from 'react';\nimport { mutate } from 'swr';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\n\nconst useStyles = (inLibrary: boolean) =>\n    makeStyles((theme: Theme) => ({\n        root: {\n            width: '100%',\n            [theme.breakpoints.up('md')]: {\n                position: 'sticky',\n                top: '64px',\n                left: '0px',\n                width: '50vw',\n                height: 'calc(100vh - 64px)',\n                alignSelf: 'flex-start',\n                overflowY: 'auto',\n            },\n        },\n        top: {\n            padding: '10px',\n            // [theme.breakpoints.up('md')]: {\n            //     minWidth: '50%',\n            // },\n        },\n        leftRight: {\n            display: 'flex',\n        },\n        leftSide: {\n            '& img': {\n                borderRadius: 4,\n                maxWidth: '100%',\n                minWidth: '100%',\n                height: 'auto',\n            },\n            maxWidth: '50%',\n            // [theme.breakpoints.up('md')]: {\n            //     minWidth: '100px',\n            // },\n        },\n        rightSide: {\n            marginLeft: 15,\n            maxWidth: '100%',\n            '& span': {\n                fontWeight: '400',\n            },\n            [theme.breakpoints.up('lg')]: {\n                fontSize: '1.3em',\n            },\n        },\n        buttons: {\n            display: 'flex',\n            justifyContent: 'space-around',\n            '& button': {\n                color: inLibrary ? '#2196f3' : 'inherit',\n            },\n            '& a': {\n                textDecoration: 'none',\n                color: '#858585',\n                '& button': {\n                    color: 'inherit',\n                },\n            },\n        },\n        bottom: {\n            paddingLeft: '10px',\n            paddingRight: '10px',\n            [theme.breakpoints.up('md')]: {\n                fontSize: '1.2em',\n                // maxWidth: '50%',\n            },\n            [theme.breakpoints.up('lg')]: {\n                fontSize: '1.3em',\n            },\n        },\n        description: {\n            '& h4': {\n                marginTop: '1em',\n                marginBottom: 0,\n            },\n            '& p': {\n                textAlign: 'justify',\n                textJustify: 'inter-word',\n            },\n        },\n        genre: {\n            display: 'flex',\n            flexWrap: 'wrap',\n            '& h5': {\n                border: '2px solid #2196f3',\n                borderRadius: '1.13em',\n                marginRight: '1em',\n                marginTop: 0,\n                marginBottom: '10px',\n                padding: '0.3em',\n                color: '#2196f3',\n            },\n        },\n    }));\n\ninterface IProps {\n    manga: IManga;\n}\n\nfunction getSourceName(source: ISource) {\n    if (source.displayName !== null) {\n        return source.displayName;\n    }\n    return source.id;\n}\n\nfunction getValueOrUnknown(val: string) {\n    return val || 'UNKNOWN';\n}\n\nconst MangaDetails: React.FC<IProps> = ({ manga }) => {\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const classes = useStyles(manga.inLibrary)();\n\n    const addToLibrary = () => {\n        mutate(`/api/v1/manga/${manga.id}/?onlineFetch=false`, { ...manga, inLibrary: true }, { revalidate: false });\n        client\n            .get(`/api/v1/manga/${manga.id}/library/`)\n            .then(() => mutate(`/api/v1/manga/${manga.id}/?onlineFetch=false`));\n    };\n\n    const removeFromLibrary = () => {\n        mutate(`/api/v1/manga/${manga.id}/?onlineFetch=false`, { ...manga, inLibrary: false }, { revalidate: false });\n        client\n            .delete(`/api/v1/manga/${manga.id}/library/`)\n            .then(() => mutate(`/api/v1/manga/${manga.id}/?onlineFetch=false`));\n    };\n\n    return (\n        <div className={classes.root}>\n            <div className={classes.top}>\n                <div className={classes.leftRight}>\n                    <div className={classes.leftSide}>\n                        <img src={`${serverAddress}${manga.thumbnailUrl}?useCache=${useCache}`} alt=\"Manga Thumbnail\" />\n                    </div>\n                    <div className={classes.rightSide}>\n                        <h1>{manga.title}</h1>\n                        <h3>\n                            {'Author: '}\n                            <span>{getValueOrUnknown(manga.author)}</span>\n                        </h3>\n                        <h3>\n                            {'Artist: '}\n                            <span>{getValueOrUnknown(manga.artist)}</span>\n                        </h3>\n                        <h3>{`Status: ${manga.status}`}</h3>\n                        <h3>{`Source: ${getSourceName(manga.source)}`}</h3>\n                    </div>\n                </div>\n                <div className={classes.buttons}>\n                    <div>\n                        <IconButton onClick={manga.inLibrary ? removeFromLibrary : addToLibrary} size=\"large\">\n                            {manga.inLibrary ? <FavoriteIcon sx={{ mr: 1 }} /> : <FavoriteBorderIcon sx={{ mr: 1 }} />}\n                            <Typography sx={{ fontSize: { xs: '0.75em', sm: '0.85em' } }}>\n                                {manga.inLibrary ? 'In Library' : 'Add To Library'}\n                            </Typography>\n                        </IconButton>\n                    </div>\n                    <a href={manga.realUrl} target=\"_blank\" rel=\"noreferrer\">\n                        <IconButton size=\"large\">\n                            <PublicIcon sx={{ mr: 1 }} />\n                            <Typography sx={{ fontSize: { xs: '0.75em', sm: '0.85em' } }}>Open Site</Typography>\n                        </IconButton>\n                    </a>\n                </div>\n            </div>\n            <div className={classes.bottom}>\n                <div className={classes.description}>\n                    <h4>About</h4>\n                    <p>{manga.description}</p>\n                </div>\n                <div className={classes.genre}>\n                    {manga.genre.map((g) => (\n                        <h5 key={g}>{g}</h5>\n                    ))}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default MangaDetails;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useMemo } from 'react';\nimport Button from '@mui/material/Button';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport Dialog from '@mui/material/Dialog';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport FormGroup from '@mui/material/FormGroup';\nimport client, { useQuery } from 'util/client';\n\ninterface IProps {\n    open: boolean;\n    setOpen: (value: boolean) => void;\n    mangaId: number;\n}\n\nexport default function CategorySelect(props: IProps) {\n    const { open, setOpen, mangaId } = props;\n\n    const { data: mangaCategoriesData, mutate } = useQuery<ICategory[]>(`/api/v1/manga/${mangaId}/category`);\n    const { data: categoriesData } = useQuery<ICategory[]>('/api/v1/category');\n\n    const allCategories = useMemo(() => {\n        const cats = [...(categoriesData ?? [])]; // make copy\n        if (cats.length > 0 && cats[0].name === 'Default') {\n            cats.shift(); // remove first category if it is 'Default'\n        }\n        return cats;\n    }, [categoriesData]);\n\n    const selectedIds = mangaCategoriesData?.map((c) => c.id) ?? [];\n\n    const handleCancel = () => {\n        setOpen(false);\n    };\n\n    const handleOk = () => {\n        setOpen(false);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, categoryId: number) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        const method = checked ? client.get : client.delete;\n        method(`/api/v1/manga/${mangaId}/category/${categoryId}`).then(() => mutate());\n    };\n\n    return (\n        <Dialog\n            sx={{\n                '.MuiDialog-paper': {\n                    maxHeight: 435,\n                    width: '80%',\n                },\n            }}\n            maxWidth=\"xs\"\n            open={open}\n        >\n            <DialogTitle>Set categories</DialogTitle>\n            <DialogContent dividers>\n                <FormGroup>\n                    {allCategories.length === 0 && (\n                        <span>\n                            No categories found!\n                            <br />\n                            You should make some from settings.\n                        </span>\n                    )}\n                    {allCategories.map((category) => (\n                        <FormControlLabel\n                            control={\n                                <Checkbox\n                                    checked={selectedIds.includes(category.id)}\n                                    onChange={(e) => handleChange(e, category.id)}\n                                    color=\"default\"\n                                />\n                            }\n                            label={category.name}\n                            key={category.id}\n                        />\n                    ))}\n                </FormGroup>\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel} color=\"primary\">\n                    Cancel\n                </Button>\n                <Button onClick={handleOk} color=\"primary\">\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport Label from '@mui/icons-material/Label';\nimport MoreHoriz from '@mui/icons-material/MoreHoriz';\nimport Refresh from '@mui/icons-material/Refresh';\nimport {\n    IconButton,\n    ListItemIcon,\n    ListItemText,\n    Menu,\n    MenuItem,\n    Tooltip,\n    useMediaQuery,\n    useTheme,\n} from '@mui/material';\nimport CategorySelect from 'components/navbar/action/CategorySelect';\nimport React, { useState } from 'react';\n\ninterface IProps {\n    manga: IManga;\n    onRefresh: () => any;\n    refreshing: boolean;\n}\n\nconst MangaToolbarMenu = ({ manga, onRefresh, refreshing }: IProps) => {\n    const theme = useTheme();\n    const isLargeScreen = useMediaQuery(theme.breakpoints.up('sm'));\n\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n    const open = Boolean(anchorEl);\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const [editCategories, setEditCategories] = useState(false);\n\n    return (\n        <>\n            {isLargeScreen && (\n                <>\n                    <Tooltip title=\"Reload data from source\">\n                        <IconButton\n                            onClick={() => {\n                                onRefresh();\n                            }}\n                            disabled={refreshing}\n                        >\n                            <Refresh />\n                        </IconButton>\n                    </Tooltip>\n                    {manga.inLibrary && (\n                        <Tooltip title=\"Edit manga categories\">\n                            <IconButton\n                                onClick={() => {\n                                    setEditCategories(true);\n                                }}\n                            >\n                                <Label />\n                            </IconButton>\n                        </Tooltip>\n                    )}\n                </>\n            )}\n            {!isLargeScreen && (\n                <>\n                    <IconButton\n                        id=\"chaptersMenuButton\"\n                        aria-controls={open ? 'chaptersMenu' : undefined}\n                        aria-haspopup=\"true\"\n                        aria-expanded={open ? 'true' : undefined}\n                        onClick={(e) => setAnchorEl(e.currentTarget)}\n                    >\n                        <MoreHoriz />\n                    </IconButton>\n                    <Menu\n                        id=\"chaptersMenu\"\n                        anchorEl={anchorEl}\n                        open={open}\n                        onClose={handleClose}\n                        MenuListProps={{\n                            'aria-labelledby': 'chaptersMenuButton',\n                        }}\n                    >\n                        <MenuItem\n                            onClick={() => {\n                                onRefresh();\n                                handleClose();\n                            }}\n                            disabled={refreshing}\n                        >\n                            <ListItemIcon>\n                                <Refresh fontSize=\"small\" />\n                            </ListItemIcon>\n                            <ListItemText>Reload data from source</ListItemText>\n                        </MenuItem>\n                        {manga.inLibrary && (\n                            <MenuItem\n                                onClick={() => {\n                                    setEditCategories(true);\n                                    handleClose();\n                                }}\n                            >\n                                <ListItemIcon>\n                                    <Label fontSize=\"small\" />\n                                </ListItemIcon>\n                                <ListItemText>Edit manga categories</ListItemText>\n                            </MenuItem>\n                        )}\n                    </Menu>\n                </>\n            )}\n\n            <CategorySelect open={editCategories} setOpen={setEditCategories} mangaId={manga.id} />\n        </>\n    );\n};\n\nexport default MangaToolbarMenu;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Warning } from '@mui/icons-material';\nimport { CircularProgress, IconButton, Stack, Tooltip } from '@mui/material';\nimport { Box } from '@mui/system';\nimport NavbarContext, { useSetDefaultBackTo } from 'components/context/NavbarContext';\nimport ChapterList from 'components/manga/ChapterList';\nimport { useRefreshManga } from 'components/manga/hooks';\nimport MangaDetails from 'components/manga/MangaDetails';\nimport MangaToolbarMenu from 'components/manga/MangaToolbarMenu';\nimport { NavbarToolbar } from 'components/navbar/DefaultNavBar';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport React, { useContext, useEffect, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useQuery } from 'util/client';\n\nconst AUTOFETCH_AGE = 60 * 60 * 24; // 24 hours\n\nconst Manga: React.FC = () => {\n    const { setTitle } = useContext(NavbarContext);\n    const { id } = useParams<{ id: string }>();\n    const autofetchedRef = useRef(false);\n\n    const {\n        data: manga,\n        error,\n        loading,\n        isValidating,\n        mutate,\n    } = useQuery<IManga>(`/api/v1/manga/${id}/?onlineFetch=false`);\n\n    const [refresh, { loading: refreshing }] = useRefreshManga(id);\n\n    useSetDefaultBackTo(\n        manga?.inLibrary === false && manga.sourceId != null ? `/sources/${manga.sourceId}/popular` : '/library',\n    );\n\n    useEffect(() => {\n        // Automatically fetch manga from source if data is older then 24 hours\n        // Automatic fetch is done only once, to prevent issues when server does\n        // not update age for some reason (ie. error on source side)\n        if (manga == null) return;\n        if (\n            manga.inLibrary &&\n            (manga.age > AUTOFETCH_AGE || manga.chaptersAge > AUTOFETCH_AGE) &&\n            autofetchedRef.current === false\n        ) {\n            autofetchedRef.current = true;\n            refresh();\n        }\n    }, [manga]);\n\n    useEffect(() => {\n        setTitle(manga?.title ?? 'Manga');\n    }, [manga?.title]);\n\n    if (error && !manga) {\n        return <EmptyView message=\"Could not load manga\" messageExtra={error.message ?? error} />;\n    }\n    return (\n        <Box sx={{ display: { md: 'flex' }, overflow: 'hidden' }}>\n            <NavbarToolbar>\n                <Stack direction=\"row\" alignItems=\"center\">\n                    {error && !isValidating && !refreshing && (\n                        <Tooltip\n                            title={\n                                <>\n                                    Could not fetch manga data\n                                    <br />\n                                    {error.message ?? error}\n                                </>\n                            }\n                        >\n                            <IconButton onClick={() => mutate()}>\n                                <Warning color=\"error\" />\n                            </IconButton>\n                        </Tooltip>\n                    )}\n                    {manga && (refreshing || isValidating) && (\n                        <IconButton disabled>\n                            <CircularProgress size={16} />\n                        </IconButton>\n                    )}\n                    {manga && <MangaToolbarMenu manga={manga} onRefresh={refresh} refreshing={refreshing} />}\n                </Stack>\n            </NavbarToolbar>\n\n            {loading && <LoadingPlaceholder />}\n\n            {manga && <MangaDetails manga={manga} />}\n            <ChapterList mangaId={id} />\n        </Box>\n    );\n};\n\nexport default Manga;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { useCallback, useState } from 'react';\nimport { mutate } from 'swr';\nimport { fetcher } from 'util/client';\n\n// eslint-disable-next-line import/prefer-default-export\nexport const useRefreshManga = (mangaId: string) => {\n    const [fetchingOnline, setFetchingOnline] = useState(false);\n\n    const handleRefresh = useCallback(async () => {\n        setFetchingOnline(true);\n        await Promise.all([\n            fetcher(`/api/v1/manga/${mangaId}/?onlineFetch=true`).then((res) =>\n                mutate(`/api/v1/manga/${mangaId}/?onlineFetch=false`, res, { revalidate: false }),\n            ),\n            fetcher(`/api/v1/manga/${mangaId}/chapters?onlineFetch=true`).then((res) =>\n                mutate(`/api/v1/manga/${mangaId}/chapters?onlineFetch=false`, res, {\n                    revalidate: false,\n                }),\n            ),\n        ]).finally(() => setFetchingOnline(false));\n    }, [mangaId]);\n\n    return [handleRefresh, { loading: fetchingOnline }] as const;\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useRef } from 'react';\nimport SpinnerImage from 'components/util/SpinnerImage';\nimport useLocalStorage from 'util/useLocalStorage';\nimport Box from '@mui/system/Box';\n\nfunction imageStyle(settings: IReaderSettings): any {\n    const [dimensions, setDimensions] = React.useState({\n        height: window.innerHeight,\n        width: window.innerWidth,\n    });\n    React.useEffect(() => {\n        function handleResize() {\n            setDimensions({\n                height: window.innerHeight,\n                width: window.innerWidth,\n            });\n        }\n\n        window.addEventListener('resize', handleResize);\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        };\n    }, []);\n    if (\n        settings.readerType === 'DoubleLTR' ||\n        settings.readerType === 'DoubleRTL' ||\n        settings.readerType === 'ContinuesHorizontalLTR' ||\n        settings.readerType === 'ContinuesHorizontalRTL'\n    ) {\n        return {\n            display: 'block',\n            marginLeft: '7px',\n            marginRight: '7px',\n            width: 'auto',\n            minHeight: '99vh',\n            height: 'auto',\n            maxHeight: '99vh',\n            objectFit: 'contain',\n            pointerEvents: 'none',\n        };\n    }\n\n    return {\n        display: 'block',\n        marginBottom: settings.readerType === 'ContinuesVertical' ? '15px' : 0,\n        minWidth: '50vw',\n        width: dimensions.width < dimensions.height ? '100vw' : '100%',\n        maxWidth: '100%',\n    };\n}\n\ninterface IProps {\n    src: string;\n    index: number;\n    onImageLoad: () => void;\n    settings: IReaderSettings;\n}\n\nconst Page = React.forwardRef((props: IProps, ref: any) => {\n    const { src, index, onImageLoad, settings } = props;\n\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const imgRef = useRef<HTMLImageElement>(null);\n\n    const imgStyle = imageStyle(settings);\n\n    return (\n        <Box ref={ref} sx={{ margin: 'auto' }}>\n            <SpinnerImage\n                src={`${src}?useCache=${useCache}`}\n                onImageLoad={onImageLoad}\n                alt={`Page #${index}`}\n                imgRef={imgRef}\n                spinnerStyle={{\n                    ...imgStyle,\n                    height: '100vh',\n                    width: '70vw',\n                    padding: '50px calc(50% - 20px)',\n                    backgroundColor: '#525252',\n                    marginBottom: 10,\n                }}\n                imgStyle={imgStyle}\n            />\n        </Box>\n    );\n});\n\nexport default Page;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from 'components/reader/Page';\n\nconst findCurrentPageIndex = (wrapper: HTMLDivElement): number => {\n    for (let i = 0; i < wrapper.children.length; i++) {\n        const child = wrapper.children.item(i);\n        if (child) {\n            const { left, right } = child.getBoundingClientRect();\n            if (left <= window.innerWidth / 2 && right > window.innerWidth / 2) return i;\n        }\n    }\n    return -1;\n};\n\nconst SCROLL_SAFE_ZONE = 5; // px\nconst isAtEnd = () => {\n    const visibleEnd = window.innerWidth + window.scrollX;\n    // SCROLL_SAFE_ZONE is here for special cases when window might be .5px shorter\n    // and math just dont add up correctly\n    return visibleEnd >= document.body.scrollWidth - SCROLL_SAFE_ZONE;\n};\nconst isAtStart = () => window.scrollX <= 0;\n\nexport default function HorizontalPager(props: IReaderProps) {\n    const { pages, curPage, initialPage, settings, setCurPage, prevChapter, nextChapter } = props;\n\n    const currentPageRef = useRef(initialPage);\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLDivElement[]>([]);\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            pagesRef.current[curPage + 1]?.scrollIntoView({ inline: 'center' });\n            setCurPage((page) => page + 1);\n        } else if (settings.loadNextOnEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            pagesRef.current[curPage - 1]?.scrollIntoView({ inline: 'center' });\n            setCurPage(curPage - 1);\n        } else if (curPage === 0) {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            prevPage();\n        } else {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    const mouseXPos = useRef<number>(0);\n\n    function dragScreen(e: MouseEvent) {\n        window.scrollBy(mouseXPos.current - e.pageX, 0);\n    }\n\n    function dragControl(e: MouseEvent) {\n        mouseXPos.current = e.pageX;\n        selfRef.current?.addEventListener('mousemove', dragScreen);\n    }\n\n    function removeDragControl() {\n        selfRef.current?.removeEventListener('mousemove', dragScreen);\n    }\n\n    function clickControl(e: MouseEvent) {\n        if (e.clientX >= window.innerWidth * 0.85) {\n            goRight();\n        } else if (e.clientX <= window.innerWidth * 0.15) {\n            goLeft();\n        }\n    }\n\n    const handleLoadNextonEnding = () => {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            if (window.scrollX + window.innerWidth >= document.body.scrollWidth) {\n                nextChapter();\n            }\n        } else if (settings.readerType === 'ContinuesHorizontalRTL') {\n            if (window.scrollX <= window.innerWidth) {\n                nextChapter();\n            }\n        }\n    };\n\n    useEffect(() => {\n        // Delay scrolling to next cycle\n        setTimeout(() => {\n            // scroll last read page into view when initialPage changes\n            pagesRef.current[initialPage]?.scrollIntoView({ inline: 'center' });\n        }, 0);\n    }, [initialPage]);\n\n    useEffect(() => {\n        selfRef.current?.addEventListener('mousedown', dragControl);\n        selfRef.current?.addEventListener('mouseup', removeDragControl);\n\n        return () => {\n            selfRef.current?.removeEventListener('mousedown', dragControl);\n            selfRef.current?.removeEventListener('mouseup', removeDragControl);\n        };\n    }, [selfRef]);\n\n    useEffect(() => {\n        if (settings.loadNextOnEnding) {\n            document.addEventListener('scroll', handleLoadNextonEnding);\n        }\n        selfRef.current?.addEventListener('mousedown', clickControl);\n\n        return () => {\n            document.removeEventListener('scroll', handleLoadNextonEnding);\n            selfRef.current?.removeEventListener('mousedown', clickControl);\n        };\n    }, [selfRef, curPage]);\n\n    useEffect(() => {\n        const handleScroll = () => {\n            if (!selfRef.current) return;\n\n            // Update current page in parent\n            const currentPage = findCurrentPageIndex(selfRef.current);\n            if (currentPage !== currentPageRef.current) {\n                currentPageRef.current = currentPage;\n                setCurPage(currentPage);\n            }\n\n            // Special case if scroll is moved all the way to the edge\n            // This handles cases when last page is show, but is smaller then\n            // window, in which case it would never get marked as read.\n            // See https://github.com/Suwayomi/Tachidesk-WebUI/issues/14 for more info\n            if (settings.readerType === 'ContinuesHorizontalLTR' ? isAtEnd() : isAtStart()) {\n                currentPageRef.current = pages.length - 1;\n                setCurPage(currentPageRef.current);\n            }\n        };\n        window.addEventListener('scroll', handleScroll);\n        return () => window.removeEventListener('scroll', handleScroll);\n    }, [settings.readerType]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: settings.readerType === 'ContinuesHorizontalLTR' ? 'row' : 'row-reverse',\n                justifyContent: settings.readerType === 'ContinuesHorizontalLTR' ? 'flex-start' : 'flex-end',\n                margin: '0 auto',\n                width: 'auto',\n                height: 'auto',\n                overflowX: 'visible',\n                userSelect: 'none',\n            }}\n        >\n            {pages.map((page) => (\n                <Page\n                    key={page.index}\n                    index={page.index}\n                    src={page.src}\n                    onImageLoad={() => {}}\n                    settings={settings}\n                    ref={(e: HTMLDivElement) => {\n                        pagesRef.current[page.index] = e;\n                    }}\n                />\n            ))}\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Box } from '@mui/system';\n\ninterface IProps {\n    settings: IReaderSettings;\n    curPage: number;\n    pageCount: number;\n}\n\nexport default function PageNumber(props: IProps) {\n    const { settings, curPage, pageCount } = props;\n\n    return (\n        <Box\n            sx={{\n                display: settings.showPageNumber ? 'block' : 'none',\n                position: 'fixed',\n                bottom: '50px',\n                right: settings.staticNav ? 'calc((100vw - 325px)/2)' : 'calc((100vw - 25px)/2)',\n                padding: '2px',\n                paddingLeft: '4px',\n                paddingRight: '4px',\n                textAlign: 'center',\n                backgroundColor: 'rgba(0, 0, 0, 0.3)',\n                borderRadius: '10px',\n            }}\n        >\n            {`${curPage + 1} / ${pageCount}`}\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from 'components/reader/Page';\n\nexport default function PagedReader(props: IReaderProps) {\n    const { pages, settings, setCurPage, initialPage, curPage, nextChapter, prevChapter } = props;\n\n    const selfRef = useRef<HTMLDivElement>(null);\n\n    const changePage = (newPage: number) => {\n        setCurPage(newPage);\n        window.scroll({ top: 0 });\n    };\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            changePage(curPage + 1);\n        } else if (settings.loadNextOnEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            changePage(curPage - 1);\n        } else {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'SingleLTR') {\n            prevPage();\n        } else if (settings.readerType === 'SingleRTL') {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'SingleLTR') {\n            nextPage();\n        } else if (settings.readerType === 'SingleRTL') {\n            prevPage();\n        }\n    }\n\n    function keyboardControl(e: KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                goRight();\n                break;\n            case 'ArrowLeft':\n                goLeft();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e: MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            goRight();\n        } else {\n            goLeft();\n        }\n    }\n\n    useEffect(() => {\n        document.addEventListener('keydown', keyboardControl);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage, settings.readerType]);\n\n    useEffect(() => {\n        // Delay scrolling to next cycle\n        setTimeout(() => {\n            // scroll last read page into view when initialPage changes\n            changePage(initialPage);\n        }, 0);\n    }, [initialPage]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: 'row',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: '100%',\n                height: '100vh',\n            }}\n        >\n            <Page key={curPage} index={curPage} onImageLoad={() => {}} src={pages[curPage].src} settings={settings} />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { Box, styled } from '@mui/system';\n\nconst Image = styled('img')({\n    marginBottom: 0,\n    width: 'auto',\n    minHeight: '99vh',\n    height: 'auto',\n    maxHeight: '99vh',\n    objectFit: 'contain',\n});\n\ninterface IProps {\n    index: number;\n    image1src: string;\n    image2src: string;\n    settings: IReaderSettings;\n}\n\nconst DoublePage = React.forwardRef((props: IProps, ref: any) => {\n    const { image1src, image2src, index, settings } = props;\n\n    return (\n        <Box\n            ref={ref}\n            sx={{\n                display: 'flex',\n                flexDirection: settings.readerType === 'DoubleLTR' ? 'row' : 'row-reverse',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: 'auto',\n                height: 'auto',\n                overflowX: 'scroll',\n            }}\n        >\n            <Image src={image1src} alt={`Page #${index}`} />\n            <Image src={image2src} alt={`Page #${index + 1}`} />\n        </Box>\n    );\n});\n\nexport default DoublePage;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Box } from '@mui/system';\nimport Page from 'components/reader/Page';\nimport DoublePage from 'components/reader/DoublePage';\n\nconst isSpreadPage = (image: HTMLImageElement): boolean => {\n    const aspectRatio = image.height / image.width;\n    return aspectRatio < 1;\n};\n\nconst isSinglePage = (index: number, spreadPages: boolean[]): boolean => {\n    // Page is single if it is spread page\n    if (spreadPages[index]) return true;\n    // Page is single if it is last page\n    if (index === spreadPages.length - 1) return true;\n    // Page can not be single if it is not followed by spread\n    if (!spreadPages[index + 1]) return false;\n    // Page is single if number of single pages since last spread is odd\n    const previousSpreadIndex = spreadPages.lastIndexOf(true, index - 1);\n    const numberOfNonSpreads = index - (previousSpreadIndex + 1);\n    return numberOfNonSpreads % 2 === 0;\n};\n\nexport default function DoublePagedPager(props: IReaderProps) {\n    const { pages, settings, setCurPage, initialPage, curPage, nextChapter, prevChapter } = props;\n\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLImageElement[]>([]);\n\n    const pagesDisplayed = useRef<number>(0);\n    const pageLoaded = useRef<boolean[]>(Array(pages.length).fill(false));\n    const spreadPage = useRef<boolean[]>(Array(pages.length).fill(false));\n\n    function setPagesToDisplay() {\n        pagesDisplayed.current = 0;\n        if (curPage < pages.length && pagesRef.current[curPage]) {\n            if (pageLoaded.current[curPage]) {\n                pagesDisplayed.current = 1;\n                if (spreadPage.current[curPage]) return;\n            }\n        }\n        if (curPage + 1 < pages.length && pagesRef.current[curPage + 1]) {\n            if (pageLoaded.current[curPage + 1]) {\n                if (spreadPage.current[curPage + 1]) return;\n                pagesDisplayed.current = 2;\n            }\n        }\n    }\n\n    function displayPages() {\n        if (pagesDisplayed.current === 2) {\n            ReactDOM.render(\n                <DoublePage\n                    key={curPage}\n                    index={curPage}\n                    image1src={pages[curPage].src}\n                    image2src={pages[curPage + 1].src}\n                    settings={settings}\n                />,\n                document.getElementById('display'),\n            );\n        } else {\n            ReactDOM.render(\n                <Page\n                    key={curPage}\n                    index={curPage}\n                    src={pagesDisplayed.current === 1 ? pages[curPage].src : ''}\n                    onImageLoad={() => {}}\n                    settings={settings}\n                />,\n                document.getElementById('display'),\n            );\n        }\n    }\n\n    function pagesToGoBack() {\n        // If previous page is single page, go only one page pack\n        // If previous page is not single page, but we are on last page\n        // go back one page anyway.\n        // This handles special case, where last page was displayed in pair, but then\n        // page was changed to the last page and now it is shown as single page.\n        const isLastPage = curPage === spreadPage.current.length - 1;\n        if (isSinglePage(curPage - 1, spreadPage.current) || isLastPage) {\n            return 1;\n        }\n\n        // Otherwise go two pages back\n        return 2;\n    }\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            const nextCurPage = curPage + pagesDisplayed.current;\n            setCurPage(nextCurPage >= pages.length ? pages.length - 1 : nextCurPage);\n        } else if (settings.loadNextOnEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            const nextCurPage = curPage - pagesToGoBack();\n            setCurPage(nextCurPage < 0 ? 0 : nextCurPage);\n        } else {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'DoubleLTR') {\n            prevPage();\n        } else {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'DoubleLTR') {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    function keyboardControl(e: KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                goRight();\n                break;\n            case 'ArrowLeft':\n                goLeft();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e: MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            goRight();\n        } else {\n            goLeft();\n        }\n    }\n\n    function handleImageLoad(index: number) {\n        return () => {\n            pageLoaded.current[index] = true;\n            const image = pagesRef.current[index];\n            spreadPage.current[index] = isSpreadPage(image);\n        };\n    }\n\n    useEffect(() => {\n        const retryDisplay = setInterval(() => {\n            const isLastPage = curPage === pages.length - 1;\n            if (\n                (!isLastPage && pageLoaded.current[curPage] && pageLoaded.current[curPage + 1]) ||\n                pageLoaded.current[curPage]\n            ) {\n                setPagesToDisplay();\n                displayPages();\n                clearInterval(retryDisplay);\n            }\n        }, 50);\n\n        document.addEventListener('keydown', keyboardControl);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            clearInterval(retryDisplay);\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage, settings.readerType]);\n\n    useEffect(() => {\n        setCurPage(initialPage);\n    }, [initialPage]);\n\n    return (\n        <Box ref={selfRef}>\n            <Box id=\"preload\" sx={{ display: 'none' }}>\n                {pages.map((page) => (\n                    <img\n                        ref={(e: HTMLImageElement) => {\n                            pagesRef.current[page.index] = e;\n                        }}\n                        key={`${page.index}`}\n                        src={page.src}\n                        onLoad={handleImageLoad(page.index)}\n                        alt={`${page.index}`}\n                    />\n                ))}\n            </Box>\n            <Box\n                id=\"display\"\n                sx={{\n                    display: 'flex',\n                    flexDirection: settings.readerType === 'DoubleLTR' ? 'row' : 'row-reverse',\n                    justifyContent: 'center',\n                    margin: '0 auto',\n                    width: 'auto',\n                    height: 'auto',\n                    overflowX: 'scroll',\n                }}\n            />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useCallback, useEffect, useRef } from 'react';\nimport { Box } from '@mui/system';\nimport Page from 'components/reader/Page';\n\nconst findCurrentPageIndex = (wrapper: HTMLDivElement): number => {\n    for (let i = 0; i < wrapper.children.length; i++) {\n        const child = wrapper.children.item(i);\n        if (child) {\n            const { top, bottom } = child.getBoundingClientRect();\n            if (top <= window.innerHeight && bottom > 1) return i;\n        }\n    }\n    return -1;\n};\n\n// TODO: make configurable?\nconst SCROLL_SAFE_ZONE = 5; // px\nconst SCROLL_OFFSET = 0.95;\nconst SCROLL_BEHAVIOR: ScrollBehavior = 'smooth';\n\nconst isAtBottom = () => {\n    const visibleBottom = window.innerHeight + window.scrollY;\n    // SCROLL_SAFE_ZONE is here for special cases when window might be .5px shorter\n    // and math just dont add up correctly\n    return visibleBottom >= document.body.offsetHeight - SCROLL_SAFE_ZONE;\n};\nconst isAtTop = () => window.scrollY <= 0;\n\nexport default function VerticalPager(props: IReaderProps) {\n    const { pages, settings, setCurPage, initialPage, nextChapter, prevChapter } = props;\n\n    const currentPageRef = useRef(initialPage);\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLDivElement[]>([]);\n\n    useEffect(() => {\n        const handleScroll = () => {\n            if (!selfRef.current) return;\n\n            if (isAtBottom()) {\n                // If scroll is moved all the way to the bottom\n                // This handles cases when last page is show, but is smaller then\n                // window, in which case it would never get marked as read.\n                // See https://github.com/Suwayomi/Tachidesk-WebUI/issues/14 for more info\n                currentPageRef.current = pages.length - 1;\n                setCurPage(currentPageRef.current);\n\n                // Go to next chapter if configured to and at bottom\n                if (settings.loadNextOnEnding) {\n                    nextChapter();\n                }\n            } else {\n                // Update current page in parent\n                const currentPage = findCurrentPageIndex(selfRef.current);\n                if (currentPage !== currentPageRef.current) {\n                    currentPageRef.current = currentPage;\n                    setCurPage(currentPage);\n                }\n            }\n        };\n\n        window.addEventListener('scroll', handleScroll);\n        return () => {\n            window.removeEventListener('scroll', handleScroll);\n        };\n    }, [settings.loadNextOnEnding]);\n\n    const go = useCallback(\n        (direction: 'up' | 'down') => {\n            if (direction === 'down' && isAtBottom()) {\n                nextChapter();\n                return;\n            }\n\n            if (direction === 'up' && isAtTop()) {\n                prevChapter();\n                return;\n            }\n\n            window.scroll({\n                top: window.scrollY + window.innerHeight * SCROLL_OFFSET * (direction === 'up' ? -1 : 1),\n                behavior: SCROLL_BEHAVIOR,\n            });\n        },\n        [nextChapter, prevChapter],\n    );\n\n    useEffect(() => {\n        const handleKeyboard = (e: KeyboardEvent) => {\n            switch (e.code) {\n                case 'Space':\n                case 'ArrowRight':\n                    e.preventDefault();\n                    go('down');\n                    break;\n                case 'ArrowLeft':\n                    e.preventDefault();\n                    go('up');\n                    break;\n                default:\n                    break;\n            }\n        };\n\n        document.addEventListener('keydown', handleKeyboard, false);\n        return () => {\n            document.removeEventListener('keydown', handleKeyboard);\n        };\n    }, []);\n\n    useEffect(() => {\n        // Delay scrolling to next cycle\n        setTimeout(() => {\n            // scroll last read page into view when initialPage changes\n            pagesRef.current[initialPage]?.scrollIntoView();\n        }, 0);\n    }, [initialPage]);\n\n    return (\n        <Box\n            ref={selfRef}\n            sx={{\n                display: 'flex',\n                flexDirection: 'column',\n                justifyContent: 'center',\n                margin: '0 auto',\n                width: '100%',\n            }}\n            onClick={(e) => go(e.clientX > window.innerWidth / 2 ? 'down' : 'up')}\n        >\n            {pages.map((page) => (\n                <Page\n                    key={page.index}\n                    index={page.index}\n                    src={page.src}\n                    onImageLoad={() => {}}\n                    settings={settings}\n                    ref={(e: HTMLDivElement) => {\n                        pagesRef.current[page.index] = e;\n                    }}\n                />\n            ))}\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { List, ListItem, ListItemText, Switch } from '@mui/material';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Select from '@mui/material/Select';\nimport MenuItem from '@mui/material/MenuItem';\nimport React from 'react';\n\ninterface IProps extends IReaderSettings {\n    setSettingValue: (key: keyof IReaderSettings, value: string | boolean) => void;\n}\n\nexport default function ReaderSettingsOptions({\n    staticNav,\n    loadNextOnEnding,\n    readerType,\n    showPageNumber,\n    setSettingValue,\n}: IProps) {\n    return (\n        <>\n            <List>\n                <ListItem>\n                    <ListItemText primary=\"Static Navigation\" />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={staticNav}\n                            onChange={(e) => setSettingValue('staticNav', e.target.checked)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemText primary=\"Show page number\" />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={showPageNumber}\n                            onChange={(e) => setSettingValue('showPageNumber', e.target.checked)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemText primary=\"Load next chapter at ending\" />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={loadNextOnEnding}\n                            onChange={(e) => setSettingValue('loadNextOnEnding', e.target.checked)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemText primary=\"Reader Type\" />\n                    <Select\n                        variant=\"standard\"\n                        value={readerType}\n                        onChange={(e) => setSettingValue('readerType', e.target.value)}\n                        sx={{ p: 0 }}\n                    >\n                        <MenuItem value=\"SingleLTR\">Single Page (LTR)</MenuItem>\n                        <MenuItem value=\"SingleRTL\">Single Page (RTL)</MenuItem>\n                        {/* <MenuItem value=\"SingleVertical\">\n                                       Vertical(WIP)\n                                    </MenuItem> */}\n                        <MenuItem value=\"DoubleLTR\">Double Page (LTR)</MenuItem>\n                        <MenuItem value=\"DoubleRTL\">Double Page (RTL)</MenuItem>\n                        <MenuItem value=\"Webtoon\">Webtoon</MenuItem>\n                        <MenuItem value=\"ContinuesVertical\">Continues Vertical</MenuItem>\n                        <MenuItem value=\"ContinuesHorizontalLTR\">Horizontal (LTR)</MenuItem>\n                        <MenuItem value=\"ContinuesHorizontalRTL\">Horizontal (RTL)</MenuItem>\n                    </Select>\n                </ListItem>\n            </List>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport IconButton from '@mui/material/IconButton';\nimport CloseIcon from '@mui/icons-material/Close';\nimport KeyboardArrowLeftIcon from '@mui/icons-material/KeyboardArrowLeft';\nimport KeyboardArrowRightIcon from '@mui/icons-material/KeyboardArrowRight';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport React, { useEffect, useState } from 'react';\nimport Typography from '@mui/material/Typography';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport Slide from '@mui/material/Slide';\nimport Fade from '@mui/material/Fade';\nimport Zoom from '@mui/material/Zoom';\nimport { Divider, FormControl, MenuItem, Select } from '@mui/material';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Collapse from '@mui/material/Collapse';\nimport { styled } from '@mui/system';\nimport useBackTo from 'util/useBackTo';\nimport ReaderSettingsOptions from 'components/reader/ReaderSettingsOptions';\n\nconst Root = styled('div')(({ theme }) => ({\n    top: 0,\n    left: 0,\n    width: '300px',\n    minWidth: '300px',\n    height: '100vh',\n    overflowY: 'auto',\n    backgroundColor: theme.palette.background.default,\n\n    '& header': {\n        backgroundColor: theme.palette.action.hover,\n        display: 'flex',\n        alignItems: 'center',\n        minHeight: '64px',\n        paddingLeft: '24px',\n        paddingRight: '24px',\n\n        transition: 'left 2s ease',\n\n        '& button': {\n            flexGrow: 0,\n            flexShrink: 0,\n        },\n\n        '& button:nth-child(1)': {\n            marginRight: '16px',\n        },\n\n        '& h1': {\n            fontSize: '1.25rem',\n            flexGrow: 1,\n        },\n    },\n}));\n\nconst Navigation = styled('div')({\n    margin: '0 16px',\n    '& > span:nth-child(1)': {\n        textAlign: 'center',\n        display: 'block',\n        marginTop: '16px',\n    },\n});\n\nconst PageNavigation = styled('div')({\n    display: 'flex',\n    flexWrap: 'wrap',\n    alignContent: 'center',\n    alignItems: 'center',\n    justifyContent: 'center',\n});\n\nconst ChapterNavigation = styled('div')({\n    display: 'grid',\n    gridTemplateRows: 'auto auto auto',\n    gridTemplateColumns: '0fr 1fr 0fr',\n    gridTemplateAreas: '\"pre current next\"',\n    gridColumnGap: '5px',\n    margin: '10px 0',\n\n    '& a': {\n        textDecoration: 'none',\n        color: 'inherit',\n        display: 'flex',\n        flexWrap: 'wrap',\n        alignContent: 'center',\n    },\n});\n\nconst MenuProps = { PaperProps: { style: { maxHeight: 150 } } };\n\nconst OpenDrawerButton = styled(IconButton)(({ theme }) => ({\n    position: 'fixed',\n    top: 0 + 20,\n    left: 10 + 20,\n    height: '40px',\n    width: '40px',\n    borderRadius: 5,\n    backgroundColor: theme.palette.custom.main,\n    '&:hover': {\n        backgroundColor: theme.palette.custom.light,\n    },\n}));\n\ninterface IProps {\n    settings: IReaderSettings;\n    setSettingValue: (key: keyof IReaderSettings, value: string | boolean) => void;\n    manga: IManga | IMangaCard;\n    chapter: IChapter;\n    curPage: number;\n    scrollToPage: (page: number) => void;\n}\n\nexport default function ReaderNavBar(props: IProps) {\n    const history = useHistory();\n    const backTo = useBackTo();\n    const location = useLocation<{\n        prevDrawerOpen?: boolean;\n        prevSettingsCollapseOpen?: boolean;\n    }>();\n    const { prevDrawerOpen, prevSettingsCollapseOpen } = location.state ?? {};\n\n    const { settings, setSettingValue, manga, chapter, curPage, scrollToPage } = props;\n\n    const [drawerOpen, setDrawerOpen] = useState(settings.staticNav || prevDrawerOpen);\n    const [updateDrawerOnRender, setUpdateDrawerOnRender] = useState(true);\n    const [hideOpenButton, setHideOpenButton] = useState(settings.staticNav || prevDrawerOpen);\n    const [prevScrollPos, setPrevScrollPos] = useState(0);\n    const [settingsCollapseOpen, setSettingsCollapseOpen] = useState(prevSettingsCollapseOpen ?? true);\n\n    const updateSettingValue = (key: keyof IReaderSettings, value: string | boolean) => {\n        // prevent closing the navBar when updating the \"staticNav\" setting\n        setUpdateDrawerOnRender(key !== 'staticNav');\n        setSettingValue(key, value);\n    };\n\n    const updateDrawer = (open: boolean) => {\n        setDrawerOpen(open);\n        setHideOpenButton(open);\n    };\n\n    const handleScroll = () => {\n        const currentScrollPos = window.pageYOffset;\n\n        if (Math.abs(currentScrollPos - prevScrollPos) > 20) {\n            setHideOpenButton(currentScrollPos > prevScrollPos);\n            setPrevScrollPos(currentScrollPos);\n        }\n    };\n\n    useEffect(() => {\n        if (updateDrawerOnRender) {\n            updateDrawer(settings.staticNav);\n        }\n    }, [settings.staticNav]);\n\n    useEffect(() => {\n        window.addEventListener('scroll', handleScroll);\n\n        const rootEl: HTMLDivElement = document.querySelector('#root')!;\n        const mainContainer: HTMLDivElement = document.querySelector('#appMainContainer')!;\n\n        // main container and root div need to change styles...\n        rootEl.style.display = 'flex';\n        mainContainer.style.display = 'none';\n\n        return () => {\n            rootEl.style.display = 'block';\n            mainContainer.style.display = 'block';\n            window.removeEventListener('scroll', handleScroll);\n        };\n    }, [handleScroll]); // handleScroll changes on every render\n\n    const handleClose = () => {\n        if (backTo.back) history.goBack();\n        else if (backTo.url) history.push(backTo.url);\n        else history.push(`/manga/${manga.id}`);\n    };\n\n    return (\n        <>\n            <Slide direction=\"right\" in={drawerOpen} timeout={200} appear={false} mountOnEnter unmountOnExit>\n                <Root\n                    sx={{\n                        position: 'fixed',\n                    }}\n                >\n                    <header>\n                        {!settings.staticNav && (\n                            <IconButton\n                                edge=\"start\"\n                                color=\"inherit\"\n                                aria-label=\"menu\"\n                                disableRipple\n                                onClick={() => updateDrawer(false)}\n                                size=\"large\"\n                            >\n                                <KeyboardArrowLeftIcon />\n                            </IconButton>\n                        )}\n                        <Typography variant=\"h1\" textOverflow=\"ellipsis\" overflow=\"hidden\" sx={{ py: 1 }}>\n                            {chapter.name}\n                        </Typography>\n                        <IconButton\n                            edge=\"start\"\n                            color=\"inherit\"\n                            aria-label=\"menu\"\n                            disableRipple\n                            onClick={handleClose}\n                            size=\"large\"\n                            sx={{ mr: -1 }}\n                        >\n                            <CloseIcon />\n                        </IconButton>\n                    </header>\n                    <ListItem\n                        ContainerComponent=\"div\"\n                        sx={{\n                            '& span': {\n                                fontWeight: 'bold',\n                            },\n                        }}\n                    >\n                        <ListItemText primary=\"Reader Settings\" />\n                        <ListItemSecondaryAction>\n                            <IconButton\n                                edge=\"start\"\n                                color=\"inherit\"\n                                aria-label=\"menu\"\n                                disableRipple\n                                disableFocusRipple\n                                onClick={() => setSettingsCollapseOpen(!settingsCollapseOpen)}\n                                size=\"large\"\n                            >\n                                {settingsCollapseOpen && <KeyboardArrowUpIcon />}\n                                {!settingsCollapseOpen && <KeyboardArrowDownIcon />}\n                            </IconButton>\n                        </ListItemSecondaryAction>\n                    </ListItem>\n                    <Collapse in={settingsCollapseOpen} timeout=\"auto\" unmountOnExit>\n                        <ReaderSettingsOptions\n                            setSettingValue={updateSettingValue}\n                            staticNav={settings.staticNav}\n                            showPageNumber={settings.showPageNumber}\n                            loadNextOnEnding={settings.loadNextOnEnding}\n                            readerType={settings.readerType}\n                        />\n                    </Collapse>\n                    <Divider sx={{ my: 1, mx: 2 }} />\n                    <Navigation>\n                        <PageNavigation>\n                            <span>Currently on page</span>\n                            <FormControl size=\"small\" sx={{ margin: '0 5px' }} disabled={chapter.pageCount === -1}>\n                                <Select\n                                    MenuProps={MenuProps}\n                                    value={chapter.pageCount > -1 ? curPage : ''}\n                                    displayEmpty\n                                    onChange={({ target: { value: selectedPage } }) => {\n                                        scrollToPage(Number(selectedPage));\n                                    }}\n                                >\n                                    {Array(Math.max(0, chapter.pageCount))\n                                        .fill(1)\n                                        .map((ignoreValue, index) => (\n                                            // eslint-disable-next-line react/no-array-index-key\n                                            <MenuItem key={`Page#${index}`} value={index}>\n                                                {index + 1}\n                                            </MenuItem>\n                                        ))}\n                                </Select>\n                            </FormControl>\n                            <span>{`of ${chapter.pageCount}`}</span>\n                        </PageNavigation>\n                        <ChapterNavigation>\n                            <IconButton\n                                title=\"Previous Chapter\"\n                                sx={{ gridArea: 'pre' }}\n                                disabled={chapter.index <= 1}\n                                onClick={() => {\n                                    history.replace({\n                                        pathname: `/manga/${manga.id}/chapter/${chapter.index - 1}`,\n                                        state: {\n                                            prevDrawerOpen: drawerOpen,\n                                            prevSettingsCollapseOpen: settingsCollapseOpen,\n                                        },\n                                    });\n                                }}\n                            >\n                                <KeyboardArrowLeftIcon />\n                            </IconButton>\n                            <FormControl sx={{ gridArea: 'current' }} size=\"small\" disabled={chapter.index < 1}>\n                                <Select\n                                    MenuProps={MenuProps}\n                                    value={chapter.index >= 1 ? chapter.index : ''}\n                                    displayEmpty\n                                    onChange={({ target: { value: selectedChapter } }) => {\n                                        history.replace({\n                                            pathname: `/manga/${manga.id}/chapter/${selectedChapter}`,\n                                            state: {\n                                                prevDrawerOpen: drawerOpen,\n                                                prevSettingsCollapseOpen: settingsCollapseOpen,\n                                            },\n                                        });\n                                    }}\n                                >\n                                    {Array(Math.max(0, chapter.chapterCount))\n                                        .fill(1)\n                                        .map((ignoreValue, index) => (\n                                            // eslint-disable-next-line  max-len\n                                            // eslint-disable-next-line  react/no-array-index-key\n                                            <MenuItem key={`Chapter#${index + 1}`} value={index + 1}>{`Chapter ${\n                                                index + 1\n                                            }`}</MenuItem>\n                                        ))}\n                                </Select>\n                            </FormControl>\n                            <IconButton\n                                title=\"Next Chapter\"\n                                sx={{ gridArea: 'next' }}\n                                disabled={chapter.index < 1 || chapter.index >= chapter.chapterCount}\n                                onClick={() => {\n                                    history.replace({\n                                        pathname: `/manga/${manga.id}/chapter/${chapter.index + 1}`,\n                                        state: {\n                                            prevDrawerOpen: drawerOpen,\n                                            prevSettingsCollapseOpen: settingsCollapseOpen,\n                                        },\n                                    });\n                                }}\n                            >\n                                <KeyboardArrowRightIcon />\n                            </IconButton>\n                        </ChapterNavigation>\n                    </Navigation>\n                </Root>\n            </Slide>\n            <Zoom in={!drawerOpen}>\n                <Fade in={!hideOpenButton}>\n                    <OpenDrawerButton\n                        edge=\"start\"\n                        aria-label=\"menu\"\n                        disableRipple\n                        disableFocusRipple\n                        onClick={() => updateDrawer(true)}\n                        size=\"large\"\n                    >\n                        <KeyboardArrowRightIcon />\n                    </OpenDrawerButton>\n                </Fade>\n            </Zoom>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { mutate } from 'swr';\nimport client from 'util/client';\n\nconst APP_METADATA_KEY_PREFIX = 'webUI_';\n\nconst migrations: IMetadataMigration[] = [\n    {\n        keys: [{ oldKey: 'loadNextonEnding', newKey: 'loadNextOnEnding' }],\n    },\n];\n\nconst getMetadataKey = (key: string, appPrefix: string = APP_METADATA_KEY_PREFIX) => `${appPrefix}${key}`;\n\nconst doesMetadataKeyExistIn = (meta: IMetadata | undefined, key: string, appPrefix?: string): boolean =>\n    Object.prototype.hasOwnProperty.call(meta ?? {}, getMetadataKey(key, appPrefix));\n\nconst convertValueFromMetadata = <T extends AllowedMetadataValueTypes = AllowedMetadataValueTypes>(\n    value: string,\n): T => {\n    if (!Number.isNaN(+value)) {\n        return +value as T;\n    }\n\n    if (value === 'true' || value === 'false') {\n        return (value === 'true') as T;\n    }\n\n    if (value === 'undefined') {\n        return undefined as T;\n    }\n\n    return value as T;\n};\n\nconst getAppMetadataFrom = (meta: IMetadata, appPrefix: string = APP_METADATA_KEY_PREFIX): IMetadata => {\n    const appMetadata: IMetadata = {};\n\n    Object.entries(meta).forEach(([key, value]) => {\n        if (key.startsWith(appPrefix)) {\n            appMetadata[key] = value;\n        }\n    });\n\n    return appMetadata;\n};\n\nconst applyAppKeyPrefixMigration = (meta: IMetadata, migration: IMetadataMigration): IMetadata => {\n    const migratedMetadata: IMetadata = { ...meta };\n\n    if (!migration.appKeyPrefix) {\n        return migratedMetadata;\n    }\n\n    const { oldPrefix, newPrefix } = migration.appKeyPrefix;\n\n    const oldAppMetadata = getAppMetadataFrom(meta, oldPrefix);\n    const newAppMetadata = getAppMetadataFrom(meta, newPrefix);\n\n    const missingMetadataKeys = Object.keys(oldAppMetadata).filter((key) => !Object.keys(newAppMetadata).includes(key));\n\n    const isMissingOldMetadata = missingMetadataKeys.length;\n    if (isMissingOldMetadata) {\n        missingMetadataKeys.forEach((oldKey) => {\n            const keyWithNewPrefix = oldKey.replace(oldPrefix, newPrefix);\n            migratedMetadata[keyWithNewPrefix] = oldAppMetadata[oldKey];\n        });\n    }\n\n    return migratedMetadata;\n};\n\nconst applyMetadataKeyMigration = (meta: IMetadata, migration: IMetadataMigration): IMetadata => {\n    const migratedMetadata: IMetadata = { ...meta };\n\n    if (!migration.keys) {\n        return migratedMetadata;\n    }\n\n    const metadataKeyChanges = migration.keys;\n\n    metadataKeyChanges.forEach(({ oldKey, newKey }) => {\n        if (!doesMetadataKeyExistIn(meta, oldKey)) {\n            return;\n        }\n\n        if (doesMetadataKeyExistIn(meta, newKey)) {\n            return;\n        }\n\n        migratedMetadata[getMetadataKey(newKey)] = meta[getMetadataKey(oldKey)];\n    });\n\n    return migratedMetadata;\n};\n\nconst applyMetadataMigrations = (meta?: IMetadata): IMetadata | undefined => {\n    if (!meta) {\n        return undefined;\n    }\n\n    const migrationToMetadata: [number, IMetadata][] = [[0, meta]];\n\n    migrations.forEach((migration, index) => {\n        const migrationId = index + 1;\n        const metadataToMigrate = migrationToMetadata[migrationId - 1][1];\n        const appKeyPrefixMigrated = applyAppKeyPrefixMigration(metadataToMigrate, migration);\n        const metadataKeysMigrated = applyMetadataKeyMigration(appKeyPrefixMigrated, migration);\n\n        migrationToMetadata.push([migrationId, metadataKeysMigrated]);\n    });\n\n    const appliedMigration = migrationToMetadata.length > 1;\n    if (!appliedMigration) {\n        return { ...meta };\n    }\n\n    return migrationToMetadata.pop()![1];\n};\n\nexport const getMetadataValueFrom = <T extends AllowedMetadataValueTypes = AllowedMetadataValueTypes>(\n    { meta }: IMetadataHolder,\n    key: AppMetadataKeys,\n    defaultValue?: T,\n    applyMigrations: boolean = true,\n): T | undefined => {\n    const metadata = applyMigrations ? applyMetadataMigrations(meta) : meta;\n\n    if (metadata === undefined || !doesMetadataKeyExistIn(metadata, key)) {\n        return defaultValue;\n    }\n\n    return convertValueFromMetadata(metadata[getMetadataKey(key)]);\n};\n\nexport const getMetadataFrom = (\n    { meta }: IMetadataHolder,\n    keysToDefaultValues: MetadataKeyValuePair[],\n    applyMigrations?: boolean,\n): IMetadata<AllowedMetadataValueTypes> => {\n    const appMetadata: IMetadata<AllowedMetadataValueTypes> = {};\n\n    keysToDefaultValues.forEach(([key, defaultValue]) => {\n        appMetadata[key] = getMetadataValueFrom({ meta }, key, defaultValue, applyMigrations);\n    });\n\n    return appMetadata;\n};\n\nconst wrapMetadataWithMetaKey = (wrap: boolean, metadata: IMetadata): IMetadataHolder => {\n    if (wrap) {\n        return {\n            meta: {\n                ...metadata,\n            },\n        };\n    }\n\n    return {\n        ...metadata,\n    };\n};\n\nexport const requestUpdateMetadataValue = async (\n    endpoint: string,\n    metadataHolder: IMetadataHolder,\n    key: AppMetadataKeys,\n    value: AllowedMetadataValueTypes,\n    endpointToMutate: string = endpoint,\n    wrapWithMetaKey: boolean = true,\n): Promise<void> => {\n    const restApiVersion = '/api/v1';\n    const url = `${restApiVersion}${endpoint}/meta`;\n    const urlToMutate = `${restApiVersion}${endpointToMutate}`;\n\n    const metadataKey = getMetadataKey(key);\n    const valueAsString = `${value}`;\n\n    const formData = new FormData();\n    formData.append('key', metadataKey);\n    formData.append('value', valueAsString);\n\n    const mutatedMetadata = {\n        ...metadataHolder.meta,\n        [metadataKey]: valueAsString,\n    };\n\n    await client.patch(url, formData);\n    await mutate(\n        urlToMutate,\n        { ...metadataHolder, ...wrapMetadataWithMetaKey(wrapWithMetaKey, mutatedMetadata) },\n        { revalidate: false },\n    );\n};\n\nexport const requestUpdateMetadata = async (\n    endpoint: string,\n    metadataHolder: IMetadataHolder,\n    keysToValues: [AppMetadataKeys, AllowedMetadataValueTypes][],\n    endpointToMutate?: string,\n    wrapWithMetaKey?: boolean,\n): Promise<void[]> =>\n    Promise.all(\n        keysToValues.map(([key, value]) =>\n            requestUpdateMetadataValue(endpoint, metadataHolder, key, value, endpointToMutate, wrapWithMetaKey),\n        ),\n    );\n\nexport const requestUpdateServerMetadata = async (\n    serverMetadata: IMetadata,\n    keysToValues: MetadataKeyValuePair[],\n): Promise<void[]> => requestUpdateMetadata('', { meta: serverMetadata }, keysToValues, '/meta', false);\n\nexport const requestUpdateMangaMetadata = async (\n    manga: IMangaCard | IManga,\n    keysToValues: MetadataKeyValuePair[],\n): Promise<void[]> => requestUpdateMetadata(`/manga/${manga.id}`, manga, keysToValues);\n\nexport const requestUpdateChapterMetadata = async (\n    mangaChapter: IMangaChapter,\n    keysToValues: MetadataKeyValuePair[],\n): Promise<void[]> =>\n    requestUpdateMetadata(\n        `/manga/${mangaChapter.manga.id}/chapter/${mangaChapter.chapter.index}`,\n        mangaChapter.chapter,\n        keysToValues,\n    );\n\nexport const requestUpdateCategoryMetadata = async (\n    category: ICategory,\n    keysToValues: MetadataKeyValuePair[],\n): Promise<void[]> => requestUpdateMetadata(`/category/${category.id}`, category, keysToValues);\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { getMetadataFrom, requestUpdateMangaMetadata, requestUpdateServerMetadata } from 'util/metadata';\nimport { useQuery } from 'util/client';\n\nexport const getDefaultSettings = (forceUndefined: boolean = false) =>\n    ({\n        staticNav: forceUndefined ? undefined : false,\n        showPageNumber: forceUndefined ? undefined : true,\n        continuesPageGap: forceUndefined ? undefined : false,\n        loadNextOnEnding: forceUndefined ? undefined : false,\n        readerType: forceUndefined ? undefined : 'ContinuesVertical',\n    } as IReaderSettings);\n\nconst getReaderSettingsWithDefaultValueFallback = (\n    meta?: IMetadata,\n    defaultSettings?: IReaderSettings,\n    applyMetadataMigration: boolean = true,\n): IReaderSettings => ({\n    ...(getMetadataFrom(\n        { meta },\n        Object.entries(defaultSettings ?? getDefaultSettings()) as MetadataKeyValuePair[],\n        applyMetadataMigration,\n    ) as unknown as IReaderSettings),\n});\n\nexport const getReaderSettingsFromMetadata = (\n    meta?: IMetadata,\n    defaultSettings?: IReaderSettings,\n    applyMetadataMigration?: boolean,\n): IReaderSettings => ({\n    ...getReaderSettingsWithDefaultValueFallback(meta, defaultSettings, applyMetadataMigration),\n});\n\nexport const getReaderSettingsFor = (\n    { meta }: IMetadataHolder,\n    defaultSettings?: IReaderSettings,\n    applyMetadataMigration?: boolean,\n): IReaderSettings => getReaderSettingsFromMetadata(meta, defaultSettings, applyMetadataMigration);\n\nexport const useDefaultReaderSettings = (): {\n    metadata?: IMetadata;\n    settings: IReaderSettings;\n    loading: boolean;\n} => {\n    const { data: meta, loading } = useQuery<IMetadata>('/api/v1/meta');\n    const settings = getReaderSettingsWithDefaultValueFallback(meta);\n\n    return { metadata: meta, settings, loading };\n};\n\n/**\n * Saves all missing reader settings from the metadata to the server\n *\n * @param metadataHolder\n * @param metadataHolderType\n * @param defaultSettings\n */\nexport const checkAndHandleMissingStoredReaderSettings = async (\n    metadataHolder: IManga | IMetadataHolder,\n    metadataHolderType: 'manga' | 'server',\n    defaultSettings: IReaderSettings,\n): Promise<void | void[]> => {\n    const meta = metadataHolder.meta ?? (metadataHolder as IMetadata);\n    const settingsToCheck = getReaderSettingsFor({ meta }, getDefaultSettings(true), false);\n    const newSettings = getReaderSettingsFor({ meta }, defaultSettings);\n\n    const undefinedSettings = Object.entries(settingsToCheck).filter((setting) => setting[1] === undefined);\n\n    const settingsToUpdate: MetadataKeyValuePair[] = [];\n    undefinedSettings.forEach((setting) => {\n        const key = setting[0] as keyof IReaderSettings;\n\n        settingsToUpdate.push([key, newSettings[key]]);\n    });\n\n    if (!undefinedSettings.length) {\n        return;\n    }\n\n    if (metadataHolderType === 'manga') {\n        await requestUpdateMangaMetadata(metadataHolder as IManga, settingsToUpdate);\n        return;\n    }\n\n    await requestUpdateServerMetadata(meta, settingsToUpdate);\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport CircularProgress from '@mui/material/CircularProgress';\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport HorizontalPager from 'components/reader/pager/HorizontalPager';\nimport PageNumber from 'components/reader/PageNumber';\nimport PagedPager from 'components/reader/pager/PagedPager';\nimport DoublePagedPager from 'components/reader/pager/DoublePagedPager';\nimport VerticalPager from 'components/reader/pager/VerticalPager';\nimport ReaderNavBar from 'components/navbar/ReaderNavBar';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport { Box } from '@mui/system';\nimport { requestUpdateMangaMetadata } from 'util/metadata';\nimport {\n    checkAndHandleMissingStoredReaderSettings,\n    getReaderSettingsFor,\n    useDefaultReaderSettings,\n} from 'util/readerSettings';\nimport makeToast from 'components/util/Toast';\n\nconst getReaderComponent = (readerType: ReaderType) => {\n    switch (readerType) {\n        case 'ContinuesVertical':\n        case 'Webtoon':\n            return VerticalPager;\n            break;\n        case 'SingleVertical':\n        case 'SingleRTL':\n        case 'SingleLTR':\n            return PagedPager;\n            break;\n        case 'DoubleVertical':\n        case 'DoubleRTL':\n        case 'DoubleLTR':\n            return DoublePagedPager;\n            break;\n        case 'ContinuesHorizontalLTR':\n        case 'ContinuesHorizontalRTL':\n            return HorizontalPager;\n        default:\n            return VerticalPager;\n            break;\n    }\n};\n\nconst range = (n: number) => Array.from({ length: n }, (value, key) => key);\nconst initialChapter = () => ({\n    pageCount: -1,\n    index: -1,\n    chapterCount: 0,\n    lastPageRead: 0,\n    name: 'Loading...',\n});\n\nexport default function Reader() {\n    const history = useHistory();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const { chapterIndex, mangaId } = useParams<{ chapterIndex: string; mangaId: string }>();\n    const [manga, setManga] = useState<IMangaCard | IManga>({\n        id: +mangaId,\n        title: '',\n        thumbnailUrl: '',\n        genre: [],\n    });\n    const [chapter, setChapter] = useState<IChapter | IPartialChapter>(initialChapter());\n    const [curPage, setCurPage] = useState<number>(0);\n    const [pageToScrollTo, setPageToScrollTo] = useState<number | undefined>(undefined);\n    const { setOverride, setTitle } = useContext(NavbarContext);\n\n    const { settings: defaultSettings, loading: areDefaultSettingsLoading } = useDefaultReaderSettings();\n    const [settings, setSettings] = useState(getReaderSettingsFor(manga, defaultSettings));\n    const [isMangaLoading, setIsMangaLoading] = useState(true);\n\n    const setSettingValue = (key: keyof IReaderSettings, value: string | boolean) => {\n        setSettings({ ...settings, [key]: value });\n        requestUpdateMangaMetadata(manga, [[key, value]]).catch(() =>\n            makeToast('Failed to save the reader settings to the server', 'warning'),\n        );\n    };\n\n    useEffect(() => {\n        if (!manga?.title || (chapter as IChapter)?.name === 'Loading...') {\n            setTitle(`Reader - Manga ${mangaId} Chapter ${chapterIndex}`);\n        } else {\n            setTitle(`${manga.title}: ${(chapter as IChapter).name}`);\n        }\n    }, [manga, chapter]);\n\n    useEffect(() => {\n        if (!areDefaultSettingsLoading && !isMangaLoading) {\n            checkAndHandleMissingStoredReaderSettings(manga, 'manga', defaultSettings).catch(() => {});\n            setSettings(getReaderSettingsFor(manga, defaultSettings));\n        }\n    }, [areDefaultSettingsLoading, isMangaLoading]);\n\n    useEffect(() => {\n        // set the custom navbar\n        setOverride({\n            status: true,\n            value: (\n                <ReaderNavBar\n                    settings={settings}\n                    setSettingValue={setSettingValue}\n                    manga={manga}\n                    chapter={chapter as IChapter}\n                    curPage={curPage}\n                    scrollToPage={setPageToScrollTo}\n                />\n            ),\n        });\n\n        // clean up for when we leave the reader\n        return () => setOverride({ status: false, value: <div /> });\n    }, [manga, chapter, settings, curPage, chapterIndex]);\n\n    useEffect(() => {\n        setIsMangaLoading(true);\n        client\n            .get(`/api/v1/manga/${mangaId}/`)\n            .then((response) => response.data)\n            .then((data: IManga) => {\n                setManga(data);\n                setIsMangaLoading(false);\n            });\n    }, [mangaId]);\n\n    useEffect(() => {\n        setChapter(initialChapter);\n        client\n            .get(`/api/v1/manga/${mangaId}/chapter/${chapterIndex}`)\n            .then((response) => response.data)\n            .then((data: IChapter) => {\n                setChapter(data);\n\n                if (data.lastPageRead === data.pageCount - 1) {\n                    // last page, also probably read = true, we will load the first page.\n                    setCurPage(0);\n                } else setCurPage(data.lastPageRead);\n            });\n    }, [chapterIndex]);\n\n    useEffect(() => {\n        if (curPage !== -1) {\n            const formData = new FormData();\n            formData.append('lastPageRead', curPage.toString());\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formData);\n        }\n\n        if (curPage === chapter.pageCount - 1) {\n            const formDataRead = new FormData();\n            formDataRead.append('read', 'true');\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formDataRead);\n        }\n    }, [curPage]);\n\n    const nextChapter = useCallback(() => {\n        if (chapter.index < chapter.chapterCount) {\n            const formData = new FormData();\n            formData.append('lastPageRead', `${chapter.pageCount - 1}`);\n            formData.append('read', 'true');\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formData);\n\n            history.replace({\n                pathname: `/manga/${manga.id}/chapter/${chapter.index + 1}`,\n                state: history.location.state,\n            });\n        }\n    }, [chapter.index, chapter.chapterCount, chapter.pageCount, manga.id]);\n\n    const prevChapter = useCallback(() => {\n        if (chapter.index > 1) {\n            history.replace({\n                pathname: `/manga/${manga.id}/chapter/${chapter.index - 1}`,\n                state: history.location.state,\n            });\n        }\n    }, [chapter.index, manga.id]);\n\n    // return spinner while chpater data is loading\n    if (chapter.pageCount === -1) {\n        return (\n            <Box\n                sx={{\n                    height: '100vh',\n                    width: '100vw',\n                    display: 'grid',\n                    placeItems: 'center',\n                }}\n            >\n                <CircularProgress thickness={5} />\n            </Box>\n        );\n    }\n\n    const pages = range(chapter.pageCount).map((index) => ({\n        index,\n        src: `${serverAddress}/api/v1/manga/${mangaId}/chapter/${chapterIndex}/page/${index}`,\n    }));\n\n    const ReaderComponent = getReaderComponent(settings.readerType);\n\n    // last page, also probably read = true, we will load the first page.\n    const initialPage = pageToScrollTo ?? (chapter.lastPageRead === chapter.pageCount - 1 ? 0 : chapter.lastPageRead);\n\n    return (\n        <Box\n            sx={{\n                width: settings.staticNav ? 'calc(100vw - 300px)' : '100vw',\n                marginLeft: settings.staticNav ? '300px' : 'unset',\n            }}\n        >\n            <PageNumber settings={settings} curPage={curPage} pageCount={chapter.pageCount} />\n            <ReaderComponent\n                pages={pages}\n                pageCount={chapter.pageCount}\n                setCurPage={setCurPage}\n                initialPage={initialPage}\n                curPage={curPage}\n                settings={settings}\n                manga={manga}\n                chapter={chapter}\n                nextChapter={nextChapter}\n                prevChapter={prevChapter}\n            />\n        </Box>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { Card, CardActionArea, Typography } from '@mui/material';\nimport NavbarContext from 'components/context/NavbarContext';\nimport MangaGrid from 'components/MangaGrid';\nimport LangSelect from 'components/navbar/action/LangSelect';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport PQueue from 'p-queue/dist/index';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { StringParam, useQueryParam } from 'use-query-params';\nimport client from 'util/client';\nimport { langCodeToName, langSortCmp, sourceDefualtLangs, sourceForcedDefaultLangs } from 'util/language';\nimport useLocalStorage from 'util/useLocalStorage';\n\nfunction sourceToLangList(sources: ISource[]) {\n    const result: string[] = [];\n\n    sources.forEach((source) => {\n        if (result.indexOf(source.lang) === -1) {\n            result.push(source.lang);\n        }\n    });\n\n    result.sort(langSortCmp);\n    return result;\n}\n\nconst SearchAll: React.FC = () => {\n    const [query] = useQueryParam('query', StringParam);\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [triggerUpdate, setTriggerUpdate] = useState<number>(2);\n    const [mangas, setMangas] = useState<any>({});\n\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownSourceLangs', sourceDefualtLangs());\n    const [showNsfw] = useLocalStorage<boolean>('showNsfw', true);\n\n    const [sources, setSources] = useState<ISource[]>([]);\n    const [fetched, setFetched] = useState<any>({});\n    const [FetchedSources, setFetchedSources] = useState<any>({});\n\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n\n    const [ResetUI, setResetUI] = useState<number>(0);\n\n    const limit = new PQueue({ concurrency: 5 });\n\n    useEffect(() => {\n        setTitle('Global Search');\n        setAction(\n            <>\n                <AppbarSearch />\n            </>,\n        );\n    }, []);\n\n    useEffect(() => {\n        client\n            .get('/api/v1/source/list')\n            .then((response) => response.data)\n            .then((data) => {\n                setSources(\n                    data.sort((a: { displayName: string }, b: { displayName: string }) => {\n                        if (a.displayName < b.displayName) {\n                            return -1;\n                        }\n                        if (a.displayName > b.displayName) {\n                            return 1;\n                        }\n                        return 0;\n                    }),\n                );\n                setFetchedSources(true);\n            });\n    }, []);\n\n    async function doIT(elem: any[]) {\n        elem.map((ele) =>\n            limit.add(async () => {\n                const response = await client.get(\n                    `/api/v1/source/${ele.id}/search?searchTerm=${query || ''}&pageNum=1`,\n                );\n                const data = await response.data;\n                const tmp = mangas;\n                tmp[ele.id] = data.mangaList;\n                setMangas(tmp);\n                const tmp2 = fetched;\n                tmp2[ele.id] = true;\n                setFetched(tmp2);\n                setResetUI(1);\n            }),\n        );\n    }\n\n    useEffect(() => {\n        if (triggerUpdate === 2) {\n            return;\n        }\n        if (triggerUpdate === 0) {\n            setTriggerUpdate(1);\n            return;\n        }\n        setFetched({});\n        setMangas({});\n        // eslint-disable-next-line max-len\n        doIT(\n            sources\n                .filter(({ lang }) => shownLangs.indexOf(lang) !== -1)\n                .filter((source) => showNsfw || !source.isNsfw),\n        );\n    }, [triggerUpdate]);\n\n    useEffect(() => {\n        if (ResetUI === 1) {\n            setResetUI(0);\n        }\n    }, [ResetUI]);\n\n    useEffect(() => {\n        if (query && FetchedSources) {\n            const delayDebounceFn = setTimeout(() => {\n                setTriggerUpdate(0);\n            }, 1000);\n            return () => clearTimeout(delayDebounceFn);\n        }\n        return () => {};\n    }, [query, shownLangs, sources]);\n\n    useEffect(() => {\n        // make sure all of forcedDefaultLangs() exists in shownLangs\n        sourceForcedDefaultLangs().forEach((forcedLang) => {\n            let hasLang = false;\n            shownLangs.forEach((lang) => {\n                if (lang === forcedLang) hasLang = true;\n            });\n            if (!hasLang) {\n                setShownLangs((shownLangsCopy) => {\n                    shownLangsCopy.push(forcedLang);\n                    return shownLangsCopy;\n                });\n            }\n        });\n    }, []);\n\n    useEffect(() => {\n        setTitle('Sources');\n        setAction(\n            <>\n                <AppbarSearch autoOpen />\n                <LangSelect\n                    shownLangs={shownLangs}\n                    setShownLangs={setShownLangs}\n                    allLangs={sourceToLangList(sources)}\n                    forcedLangs={sourceForcedDefaultLangs()}\n                />\n            </>,\n        );\n    }, [shownLangs, sources]);\n\n    if (query) {\n        return (\n            <>\n                {/* eslint-disable-next-line max-len */}\n                {sources\n                    .filter(({ lang }) => shownLangs.indexOf(lang) !== -1)\n                    .filter((source) => showNsfw || !source.isNsfw)\n                    .sort((a, b) => {\n                        const af = fetched[a.id];\n                        const bf = fetched[b.id];\n                        if (af && !bf) {\n                            return -1;\n                        }\n                        if (!af && bf) {\n                            return 1;\n                        }\n                        if (!af && !bf) {\n                            return 0;\n                        }\n\n                        const al = mangas[a.id].length === 0;\n                        const bl = mangas[b.id].length === 0;\n                        if (al && !bl) {\n                            return 1;\n                        }\n                        if (bl && !al) {\n                            return -1;\n                        }\n                        return 0;\n                    })\n                    .map(({ lang, id, displayName }) => (\n                        <>\n                            <Card sx={{ margin: '10px' }}>\n                                <CardActionArea\n                                    component={Link}\n                                    to={`/sources/${id}/popular/?R&query=${query}`}\n                                    sx={{ p: 3 }}\n                                >\n                                    <Typography variant=\"h5\">{displayName}</Typography>\n                                    <Typography variant=\"caption\">{langCodeToName(lang)}</Typography>\n                                </CardActionArea>\n                            </Card>\n                            <MangaGrid\n                                mangas={mangas[id] || []}\n                                isLoading={!fetched[id]}\n                                hasNextPage={false}\n                                lastPageNum={lastPageNum}\n                                setLastPageNum={setLastPageNum}\n                                horizontal\n                                noFaces\n                                message={fetched[id] ? 'No manga was found!' : undefined}\n                                inLibraryIndicator\n                            />\n                        </>\n                    ))}\n            </>\n        );\n    }\n    return <></>;\n};\n\nexport default SearchAll;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport ListItem, { ListItemProps } from '@mui/material/ListItem';\nimport { Link } from 'react-router-dom';\n\nexport default function ListItemLink(props: ListItemProps<Link, { directLink?: boolean }>) {\n    const { directLink, to } = props;\n    if (directLink) {\n        return <ListItem button component=\"a\" href={to} {...props} />;\n    }\n\n    return <ListItem button component={Link} {...props} />;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport AutoStoriesIcon from '@mui/icons-material/AutoStories';\nimport List from '@mui/material/List';\nimport ListAltIcon from '@mui/icons-material/ListAlt';\nimport BackupIcon from '@mui/icons-material/Backup';\nimport Brightness6Icon from '@mui/icons-material/Brightness6';\nimport DnsIcon from '@mui/icons-material/Dns';\nimport EditIcon from '@mui/icons-material/Edit';\nimport InfoIcon from '@mui/icons-material/Info';\nimport CachedIcon from '@mui/icons-material/Cached';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemIcon from '@mui/material/ListItemIcon';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Switch from '@mui/material/Switch';\nimport Button from '@mui/material/Button';\nimport IconButton from '@mui/material/IconButton';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport TextField from '@mui/material/TextField';\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport Slider from '@mui/material/Slider';\nimport { DialogTitle, ListItemButton } from '@mui/material';\nimport ViewModuleIcon from '@mui/icons-material/ViewModule';\nimport NavbarContext from 'components/context/NavbarContext';\nimport DarkTheme from 'components/context/DarkTheme';\nimport useLocalStorage from 'util/useLocalStorage';\nimport ListItemLink from 'components/util/ListItemLink';\n\nexport default function Settings() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => {\n        setTitle('Settings');\n        setAction(<></>);\n    }, []);\n\n    const { darkTheme, setDarkTheme } = useContext(DarkTheme);\n    const [serverAddress, setServerAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [showNsfw, setShowNsfw] = useLocalStorage<boolean>('showNsfw', true);\n    const [useCache, setUseCache] = useLocalStorage<boolean>('useCache', true);\n    const [dialogOpen, setDialogOpen] = useState(false);\n    const [dialogValue, setDialogValue] = useState(serverAddress);\n\n    const [dialogOpenItemWidth, setDialogOpenItemWidth] = useState(false);\n    const [ItemWidth, setItemWidth] = useLocalStorage<number>('ItemWidth', 300);\n    const [DialogItemWidth, setDialogItemWidth] = useState(ItemWidth);\n\n    const handleDialogOpen = () => {\n        setDialogValue(serverAddress);\n        setDialogOpen(true);\n    };\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n        setServerAddress(dialogValue);\n    };\n\n    const handleDialogOpenItemWidth = () => {\n        setDialogItemWidth(ItemWidth);\n        setDialogOpenItemWidth(true);\n    };\n\n    const handleDialogCancelItemWidth = () => {\n        setDialogOpenItemWidth(false);\n    };\n\n    const handleDialogSubmitItemWidth = () => {\n        setDialogOpenItemWidth(false);\n        setItemWidth(DialogItemWidth);\n    };\n\n    const handleDialogResetItemWidth = () => {\n        setDialogOpenItemWidth(false);\n        setItemWidth(300);\n    };\n\n    const handleChange = (event: Event, newValue: number | number[]) => {\n        setDialogItemWidth(newValue as number);\n    };\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                <ListItemLink to=\"/settings/categories\">\n                    <ListItemIcon>\n                        <ListAltIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Categories\" />\n                </ListItemLink>\n                <ListItemLink to=\"/settings/defaultReaderSettings\">\n                    <ListItemIcon>\n                        <AutoStoriesIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Default Reader Settings\" />\n                </ListItemLink>\n                <ListItemLink to=\"/settings/backup\">\n                    <ListItemIcon>\n                        <BackupIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Backup\" />\n                </ListItemLink>\n                <ListItem>\n                    <ListItemIcon>\n                        <Brightness6Icon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Dark Theme\" />\n                    <ListItemSecondaryAction>\n                        <Switch edge=\"end\" checked={darkTheme} onChange={() => setDarkTheme(!darkTheme)} />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItemButton>\n                    <ListItemIcon>\n                        <ViewModuleIcon />\n                    </ListItemIcon>\n                    <ListItemText\n                        primary=\"Manga Item width\"\n                        secondary={`px:${ItemWidth}`}\n                        onClick={() => {\n                            handleDialogOpenItemWidth();\n                        }}\n                    />\n                </ListItemButton>\n                <ListItem>\n                    <ListItemIcon>\n                        <FavoriteIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Show NSFW\" secondary=\"Hide NSFW extensions and sources\" />\n                    <ListItemSecondaryAction>\n                        <Switch edge=\"end\" checked={showNsfw} onChange={() => setShowNsfw(!showNsfw)} />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemIcon>\n                        <CachedIcon />\n                    </ListItemIcon>\n                    <ListItemText\n                        primary=\"Use image cache\"\n                        secondary=\"Disabling image cache makes images load faster if you have a slow disk,\n                         but uses it much more internet traffic in turn\"\n                    />\n                    <ListItemSecondaryAction>\n                        <Switch edge=\"end\" checked={useCache} onChange={() => setUseCache(!useCache)} />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemIcon>\n                        <DnsIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Server Address\" secondary={serverAddress} />\n                    <ListItemSecondaryAction>\n                        <IconButton\n                            onClick={() => {\n                                handleDialogOpen();\n                            }}\n                            size=\"large\"\n                        >\n                            <EditIcon />\n                        </IconButton>\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItemLink to=\"/settings/about\">\n                    <ListItemIcon>\n                        <InfoIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"About\" />\n                </ListItemLink>\n            </List>\n\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogContent>\n                    <DialogContentText>Enter Server Address</DialogContentText>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Server Address\"\n                        type=\"text\"\n                        fullWidth\n                        value={dialogValue}\n                        placeholder=\"http://127.0.0.1:4567\"\n                        onChange={(e) => setDialogValue(e.target.value)}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        Set\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            <Dialog open={dialogOpenItemWidth} onClose={handleDialogCancelItemWidth}>\n                <DialogTitle>Manga Item width</DialogTitle>\n                <DialogContent\n                    sx={{\n                        width: '98%',\n                        margin: 'auto',\n                    }}\n                >\n                    <TextField\n                        sx={{\n                            width: '100%',\n                            margin: 'auto',\n                        }}\n                        autoFocus\n                        value={DialogItemWidth}\n                        type=\"number\"\n                        onChange={(e) => setDialogItemWidth(parseInt(e.target.value, 10))}\n                    />\n                    <Slider\n                        aria-label=\"Manga Item width\"\n                        defaultValue={300}\n                        value={DialogItemWidth}\n                        step={10}\n                        min={100}\n                        max={1000}\n                        onChange={handleChange}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogResetItemWidth} color=\"primary\">\n                        Reset to Default\n                    </Button>\n                    <Button onClick={handleDialogCancelItemWidth} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmitItemWidth} color=\"primary\">\n                        OK\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","import React, { useContext, useEffect } from 'react';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemLink from 'components/util/ListItemLink';\nimport NavbarContext from 'components/context/NavbarContext';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport { useQuery } from 'util/client';\n\nexport default function About() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    useEffect(() => {\n        setTitle('About');\n        setAction(<></>);\n    }, []);\n\n    const { data: about } = useQuery<IAbout>('/api/v1/settings/about');\n\n    if (about === undefined) {\n        return <LoadingPlaceholder />;\n    }\n\n    const version = () => {\n        if (about.buildType === 'Stable') return `${about.version}`;\n        return `${about.version}-${about.revision}`;\n    };\n\n    const buildTime = () => new Date(about.buildTime * 1000).toUTCString();\n\n    return (\n        <List>\n            <ListItem>\n                <ListItemText primary=\"Server\" secondary={`${about.name} ${about.buildType}`} />\n            </ListItem>\n            <ListItem>\n                <ListItemText primary=\"Server version\" secondary={version()} />\n            </ListItem>\n            <ListItem>\n                <ListItemText primary=\"Build time\" secondary={buildTime()} />\n            </ListItem>\n            <ListItemLink to={about.github}>\n                <ListItemText primary=\"Github\" secondary={about.github} />\n            </ListItemLink>\n            <ListItemLink to={about.discord}>\n                <ListItemText primary=\"Discord\" secondary={about.discord} />\n            </ListItemLink>\n        </List>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport { fromEvent } from 'file-selector';\nimport client from 'util/client';\nimport makeToast from 'components/util/Toast';\nimport ListItemLink from 'components/util/ListItemLink';\nimport NavbarContext from 'components/context/NavbarContext';\n\nexport default function Backup() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => {\n        setTitle('Backup');\n        setAction(<></>);\n    }, []);\n\n    const { baseURL } = client.defaults;\n\n    const submitBackup = (file: File) => {\n        if (file.name.toLowerCase().endsWith('proto.gz')) {\n            const formData = new FormData();\n            formData.append('backup.proto.gz', file);\n\n            makeToast('Restoring backup....', 'info');\n            client\n                .post('/api/v1/backup/import/file', formData, {\n                    headers: { 'Content-Type': 'multipart/form-data' },\n                })\n                .then(() => makeToast('Backup restore finished!', 'success'))\n                .catch(() => makeToast('Backup restore failed!', 'error'));\n        } else if (file.name.toLowerCase().endsWith('json')) {\n            makeToast('legacy backups are not supported!', 'error');\n        } else {\n            makeToast('invalid file type!', 'error');\n        }\n    };\n\n    const dropHandler = async (e: Event) => {\n        e.preventDefault();\n        const files = await fromEvent(e);\n\n        submitBackup(files[0] as File);\n    };\n\n    const dragOverHandler = (e: Event) => {\n        e.preventDefault();\n    };\n\n    useEffect(() => {\n        document.addEventListener('drop', dropHandler);\n        document.addEventListener('dragover', dragOverHandler);\n\n        const input = document.getElementById('backup-file');\n        input?.addEventListener('change', async (evt) => {\n            const files = await fromEvent(evt);\n            submitBackup(files[0] as File);\n        });\n\n        return () => {\n            document.removeEventListener('drop', dropHandler);\n            document.removeEventListener('dragover', dragOverHandler);\n        };\n    }, []);\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                <ListItemLink to={`${baseURL}/api/v1/backup/export/file`} directLink>\n                    <ListItemText primary=\"Create Backup\" secondary=\"Backup library as a Tachiyomi backup\" />\n                </ListItemLink>\n                <ListItem button onClick={() => document.getElementById('backup-file')?.click()}>\n                    <ListItemText\n                        primary=\"Restore Backup\"\n                        secondary=\"You can also drag and drop the backup file here to restore\"\n                    />\n                </ListItem>\n            </List>\n            <input type=\"file\" id=\"backup-file\" style={{ display: 'none' }} />\n        </>\n    );\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useMemo, useState, useContext, useEffect } from 'react';\nimport { List, ListItem, ListItemText, ListItemIcon, IconButton } from '@mui/material';\nimport {\n    DragDropContext,\n    Droppable,\n    Draggable,\n    DropResult,\n    DraggingStyle,\n    NotDraggingStyle,\n} from 'react-beautiful-dnd';\nimport DragHandleIcon from '@mui/icons-material/DragHandle';\nimport EditIcon from '@mui/icons-material/Edit';\nimport { useTheme, Palette } from '@mui/material/styles';\nimport Fab from '@mui/material/Fab';\nimport AddIcon from '@mui/icons-material/Add';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client, { useQuery } from 'util/client';\n\nconst getItemStyle = (\n    isDragging: boolean,\n    draggableStyle: DraggingStyle | NotDraggingStyle | undefined,\n    palette: Palette,\n) => ({\n    // styles we need to apply on draggables\n    ...draggableStyle,\n\n    ...(isDragging && {\n        background: palette.mode === 'dark' ? '#424242' : 'rgb(235,235,235)',\n    }),\n});\n\nexport default function Categories() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => {\n        setTitle('Categories');\n        setAction(<></>);\n    }, []);\n\n    const { data, mutate } = useQuery<ICategory[]>('/api/v1/category/');\n    const categories = useMemo(() => {\n        const res = [...(data ?? [])];\n        if (res.length > 0 && res[0].name === 'Default') {\n            res.shift();\n        }\n        return res;\n    }, [data]);\n\n    const [categoryToEdit, setCategoryToEdit] = useState<number>(-1); // -1 means new category\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n    const [dialogName, setDialogName] = useState<string>('');\n    const [dialogDefault, setDialogDefault] = useState<boolean>(false);\n    const theme = useTheme();\n\n    const categoryReorder = (list: ICategory[], from: number, to: number) => {\n        const newData = [...list];\n        const [removed] = newData.splice(from, 1);\n        newData.splice(to, 0, removed);\n        mutate(newData, { revalidate: false });\n\n        const formData = new FormData();\n        formData.append('from', `${from + 1}`);\n        formData.append('to', `${to + 1}`);\n        client.patch('/api/v1/category/reorder', formData).finally(() => mutate());\n    };\n\n    const onDragEnd = (result: DropResult) => {\n        // dropped outside the list?\n        if (!result.destination) {\n            return;\n        }\n\n        categoryReorder(categories, result.source.index, result.destination.index);\n    };\n\n    const resetDialog = () => {\n        setDialogName('');\n        setDialogDefault(false);\n        setCategoryToEdit(-1);\n    };\n\n    const handleDialogOpen = () => {\n        resetDialog();\n        setDialogOpen(true);\n    };\n\n    const handleEditDialogOpen = (index: number) => {\n        setDialogName(categories[index].name);\n        setDialogDefault(categories[index].default);\n        setCategoryToEdit(index);\n        setDialogOpen(true);\n    };\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n\n        const formData = new FormData();\n        formData.append('name', dialogName);\n        formData.append('default', dialogDefault.toString());\n\n        if (categoryToEdit === -1) {\n            client.post('/api/v1/category/', formData).finally(() => mutate());\n        } else {\n            const category = categories[categoryToEdit];\n            client.patch(`/api/v1/category/${category.id}`, formData).finally(() => mutate());\n        }\n    };\n\n    const deleteCategory = (index: number) => {\n        const category = categories[index];\n        client.delete(`/api/v1/category/${category.id}`).finally(() => mutate());\n    };\n\n    return (\n        <>\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <List ref={provided.innerRef}>\n                            {categories.map((item, index) => (\n                                <Draggable key={item.id} draggableId={item.id.toString()} index={index}>\n                                    {(provided, snapshot) => (\n                                        <ListItem\n                                            ContainerProps={{ ref: provided.innerRef } as any}\n                                            {...provided.draggableProps}\n                                            {...provided.dragHandleProps}\n                                            style={getItemStyle(\n                                                snapshot.isDragging,\n                                                provided.draggableProps.style,\n                                                theme.palette,\n                                            )}\n                                            ref={provided.innerRef}\n                                        >\n                                            <ListItemIcon>\n                                                <DragHandleIcon />\n                                            </ListItemIcon>\n                                            <ListItemText primary={item.name} />\n                                            <IconButton\n                                                onClick={() => {\n                                                    handleEditDialogOpen(index);\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <EditIcon />\n                                            </IconButton>\n                                            <IconButton\n                                                onClick={() => {\n                                                    deleteCategory(index);\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <DeleteIcon />\n                                            </IconButton>\n                                        </ListItem>\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </List>\n                    )}\n                </Droppable>\n            </DragDropContext>\n            <Fab\n                color=\"primary\"\n                aria-label=\"add\"\n                style={{\n                    position: 'absolute',\n                    bottom: theme.spacing(2),\n                    right: theme.spacing(2),\n                }}\n                onClick={handleDialogOpen}\n            >\n                <AddIcon />\n            </Fab>\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogTitle id=\"form-dialog-title\">\n                    {categoryToEdit === -1 ? 'New Catalog' : 'Edit Catalog'}\n                </DialogTitle>\n                <DialogContent>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Category Name\"\n                        type=\"text\"\n                        fullWidth\n                        value={dialogName}\n                        onChange={(e) => setDialogName(e.target.value)}\n                    />\n                    <FormControlLabel\n                        control={\n                            <Checkbox\n                                checked={dialogDefault}\n                                onChange={(e) => setDialogDefault(e.target.checked)}\n                                color=\"default\"\n                            />\n                        }\n                        label=\"Default category when adding new manga to library\"\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        Submit\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React, { useContext, useEffect } from 'react';\nimport NavbarContext from 'components/context/NavbarContext';\nimport { Box } from '@mui/system';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport { requestUpdateServerMetadata } from 'util/metadata';\nimport makeToast from 'components/util/Toast';\nimport {\n    checkAndHandleMissingStoredReaderSettings,\n    getDefaultSettings,\n    useDefaultReaderSettings,\n} from 'util/readerSettings';\nimport ReaderSettingsOptions from 'components/reader/ReaderSettingsOptions';\n\nexport default function DefaultReaderSettings() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => {\n        setTitle('Default Reader Settings');\n        setAction(<></>);\n    }, []);\n\n    const { metadata, settings, loading } = useDefaultReaderSettings();\n\n    const setSettingValue = (key: keyof IReaderSettings, value: string | boolean) => {\n        requestUpdateServerMetadata(metadata ?? {}, [[key, value]]).catch(() =>\n            makeToast('Failed to save the default reader settings to the server', 'warning'),\n        );\n    };\n\n    if (loading) {\n        return (\n            <Box\n                sx={{\n                    height: '100vh',\n                    width: '100vw',\n                    display: 'grid',\n                    placeItems: 'center',\n                }}\n            >\n                <CircularProgress thickness={5} />\n            </Box>\n        );\n    }\n\n    checkAndHandleMissingStoredReaderSettings({ meta: metadata }, 'server', getDefaultSettings()).catch(() => {});\n\n    return (\n        <ReaderSettingsOptions\n            setSettingValue={setSettingValue}\n            staticNav={settings.staticNav}\n            showPageNumber={settings.showPageNumber}\n            loadNextOnEnding={settings.loadNextOnEnding}\n            readerType={settings.readerType}\n        />\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemSecondaryAction from '@mui/material/ListItemSecondaryAction';\nimport Switch from '@mui/material/Switch';\nimport Checkbox from '@mui/material/Checkbox';\n\nfunction getTwoStateType(type: 'Checkbox' | 'Switch') {\n    if (type === 'Switch') {\n        return Switch;\n    }\n    return Checkbox;\n}\n\nfunction TwoSatePreference(props: TwoStatePreferenceProps) {\n    const { title, summary, currentValue, updateValue, type } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<boolean>(currentValue);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    return (\n        <ListItem>\n            <ListItemText primary={title} secondary={summary} />\n            <ListItemSecondaryAction>\n                {React.createElement(getTwoStateType(type), {\n                    edge: 'end',\n                    checked: internalCurrentValue,\n                    onChange: () => {\n                        updateValue(!currentValue);\n\n                        // appear smooth\n                        setInternalCurrentValue(!currentValue);\n                    },\n                })}\n            </ListItemSecondaryAction>\n        </ListItem>\n    );\n}\n\nexport function CheckBoxPreference(props: CheckBoxPreferenceProps) {\n    return <TwoSatePreference {...props} type=\"Checkbox\" />;\n}\n\nexport function SwitchPreferenceCompat(props: SwitchPreferenceCompatProps) {\n    return <TwoSatePreference {...props} type=\"Switch\" />;\n}\n\nexport default { CheckBoxPreference, SwitchPreferenceCompat };\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport RadioGroup from '@mui/material/RadioGroup';\nimport Radio from '@mui/material/Radio';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Button from '@mui/material/Button';\n\ninterface IListDialogProps {\n    value: string;\n    open: boolean;\n    onClose: (arg0: string | null) => void;\n    options: string[];\n    title: string;\n}\n\nfunction ListDialog(props: IListDialogProps) {\n    const { value: valueProp, open, onClose, options, title } = props;\n    const [value, setValue] = React.useState(valueProp);\n    const radioGroupRef = React.useRef<HTMLDivElement>(null);\n\n    React.useEffect(() => {\n        if (!open) {\n            setValue(valueProp);\n        }\n    }, [valueProp, open]);\n\n    const handleEntering = () => {\n        if (radioGroupRef.current != null) {\n            radioGroupRef?.current.focus();\n        }\n    };\n\n    const handleCancel = () => {\n        onClose(null);\n    };\n\n    const handleOk = () => {\n        onClose(value);\n    };\n\n    const handleChange = (event: any) => {\n        setValue(event.target.value);\n    };\n\n    return (\n        <Dialog\n            sx={{ '& .MuiDialog-paper': { width: '80%', maxHeight: 435 } }}\n            maxWidth=\"xs\"\n            TransitionProps={{ onEntering: handleEntering }}\n            open={open}\n        >\n            <DialogTitle>{title}</DialogTitle>\n            <DialogContent dividers>\n                <RadioGroup ref={radioGroupRef} value={value} onChange={handleChange}>\n                    {options.map((option) => (\n                        <FormControlLabel value={option} key={option} control={<Radio />} label={option} />\n                    ))}\n                </RadioGroup>\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel}>\n                    Cancel\n                </Button>\n                <Button onClick={handleOk}>Ok</Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n\nexport default function ListPreference(props: ListPreferenceProps) {\n    const { title, summary, currentValue, updateValue, entryValues, entries } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    const findEntryOf = (value: string) => {\n        const idx = entryValues.indexOf(value);\n        return entries[idx];\n    };\n\n    const findEntryValueOf = (value: string) => {\n        const idx = entries.indexOf(value);\n        return entryValues[idx];\n    };\n\n    const getSummary = () => {\n        if (summary === '%s') {\n            return findEntryOf(currentValue);\n        }\n        return summary;\n    };\n\n    const handleDialogClose = (newValue: string | null) => {\n        if (newValue !== null) {\n            updateValue(findEntryValueOf(newValue));\n\n            // appear smooth\n            setInternalCurrentValue(newValue);\n        }\n\n        setDialogOpen(false);\n    };\n\n    return (\n        <>\n            <ListItem button onClick={() => setDialogOpen(true)}>\n                <ListItemText primary={title} secondary={getSummary()} />\n            </ListItem>\n            <ListDialog\n                title={title}\n                open={dialogOpen}\n                onClose={handleDialogClose}\n                value={findEntryOf(internalCurrentValue)}\n                options={entries}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport DialogActions from '@mui/material/DialogActions';\nimport TextField from '@mui/material/TextField';\nimport Button from '@mui/material/Button';\n\nexport default function EditTextPreference(props: EditTextPreferenceProps) {\n    const { title, summary, dialogTitle, dialogMessage, currentValue, updateValue } = props;\n\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n\n        // reset the dialog\n        setInternalCurrentValue(currentValue);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n\n        updateValue(internalCurrentValue);\n    };\n\n    return (\n        <>\n            <ListItem button onClick={() => setDialogOpen(true)}>\n                <ListItemText primary={title} secondary={summary} />\n            </ListItem>\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogTitle>{dialogTitle}</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>{dialogMessage}</DialogContentText>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        type=\"text\"\n                        fullWidth\n                        value={internalCurrentValue}\n                        onChange={(e) => setInternalCurrentValue(e.target.value)}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        OK\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useEffect } from 'react';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport FormGroup from '@mui/material/FormGroup';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Button from '@mui/material/Button';\nimport cloneObject from 'util/cloneObject';\n\ninterface IListDialogProps {\n    selectedValues: string[];\n    open: boolean;\n    onClose: (arg0: string[] | null) => void;\n    values: string[];\n    title: string;\n}\n\nfunction ListDialog(props: IListDialogProps) {\n    const { selectedValues: selectedValuesProp, open, onClose, values, title } = props;\n    const [selectedValues, setSelectedValues] = React.useState(selectedValuesProp);\n\n    React.useEffect(() => {\n        if (!open) {\n            setSelectedValues(selectedValuesProp);\n        }\n    }, [selectedValuesProp, open]);\n\n    const handleCancel = () => {\n        onClose(null);\n    };\n\n    const handleOk = () => {\n        onClose(selectedValues);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, value: string) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        const hasEntry = selectedValues.some((selectedValue) => value === selectedValue);\n        if (checked) {\n            if (!hasEntry) {\n                const selectedValuesClone = cloneObject(selectedValues) as string[];\n                selectedValuesClone.push(value);\n                setSelectedValues(selectedValuesClone);\n            }\n        } else if (hasEntry) {\n            // not checked and has entry\n            const selectedValuesClone = cloneObject(selectedValues) as string[];\n            const index = selectedValuesClone.indexOf(value);\n            selectedValuesClone.splice(index, 1);\n            setSelectedValues(selectedValuesClone);\n        }\n    };\n\n    return (\n        <Dialog sx={{ '& .MuiDialog-paper': { width: '80%', maxHeight: 435 } }} maxWidth=\"xs\" open={open}>\n            <DialogTitle>{title}</DialogTitle>\n            <DialogContent dividers>\n                <FormGroup>\n                    {values.map((value) => (\n                        <FormControlLabel\n                            control={\n                                <Checkbox\n                                    checked={selectedValues.some((selectedValue) => value === selectedValue)}\n                                    onChange={(e) => handleChange(e, value)}\n                                    color=\"default\"\n                                />\n                            }\n                            label={value}\n                            key={value}\n                        />\n                    ))}\n                </FormGroup>\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel}>\n                    Cancel\n                </Button>\n                <Button onClick={handleOk}>Ok</Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n\nexport default function MultiSelectListPreference(props: MultiSelectListPreferenceProps) {\n    const { title, summary, currentValue, updateValue, entryValues, entries } = props;\n    const [internalCurrentValue, setInternalCurrentValue] = useState<string[]>(currentValue);\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        setInternalCurrentValue(currentValue);\n    }, [currentValue]);\n\n    const findEntriesOf = (values: string[]) =>\n        values.map((value) => {\n            const idx = entryValues.indexOf(value);\n            return entries[idx];\n        });\n\n    const findEntryValuesOf = (values: string[]) =>\n        values.map((value) => {\n            const idx = entries.indexOf(value);\n            return entryValues[idx];\n        });\n\n    const getSummary = () => summary;\n\n    const handleDialogClose = (newValue: string[] | null) => {\n        if (newValue !== null) {\n            // console.log(newValue);\n            updateValue(findEntryValuesOf(newValue));\n\n            // appear smooth\n            setInternalCurrentValue(newValue);\n        }\n\n        setDialogOpen(false);\n    };\n\n    return (\n        <>\n            <ListItem button onClick={() => setDialogOpen(true)}>\n                <ListItemText primary={title} secondary={getSummary()} />\n            </ListItem>\n            <ListDialog\n                title={title}\n                open={dialogOpen}\n                onClose={handleDialogClose}\n                selectedValues={findEntriesOf(internalCurrentValue)}\n                values={entries}\n            />\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\nimport NavbarContext from 'components/context/NavbarContext';\nimport { useParams } from 'react-router-dom';\nimport client, { useQuery } from 'util/client';\nimport { SwitchPreferenceCompat, CheckBoxPreference } from 'components/sourceConfiguration/TwoStatePreference';\nimport ListPreference from 'components/sourceConfiguration/ListPreference';\nimport EditTextPreference from 'components/sourceConfiguration/EditTextPreference';\nimport MultiSelectListPreference from 'components/sourceConfiguration/MultiSelectListPreference';\nimport List from '@mui/material/List';\nimport cloneObject from 'util/cloneObject';\n\nfunction getPrefComponent(type: string) {\n    switch (type) {\n        case 'CheckBoxPreference':\n            return CheckBoxPreference;\n        case 'SwitchPreferenceCompat':\n            return SwitchPreferenceCompat;\n        case 'ListPreference':\n            return ListPreference;\n        case 'EditTextPreference':\n            return EditTextPreference;\n        case 'MultiSelectListPreference':\n            return MultiSelectListPreference;\n        default:\n            return CheckBoxPreference;\n    }\n}\n\nexport default function SourceConfigure() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    useEffect(() => {\n        setTitle('Source Configuration');\n        setAction(<></>);\n    }, []);\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const { data: sourcePreferences = [], mutate } = useQuery<SourcePreferences[]>(\n        `/api/v1/source/${sourceId}/preferences`,\n    );\n\n    const convertToString = (position: number, value: any): string => {\n        switch (sourcePreferences[position].props.defaultValueType) {\n            case 'Set<String>':\n                return JSON.stringify(value);\n            default:\n                return value.toString();\n        }\n    };\n\n    const updateValue = (position: number) => (value: any) => {\n        client\n            .post(\n                `/api/v1/source/${sourceId}/preferences`,\n                JSON.stringify({ position, value: convertToString(position, value) }),\n            )\n            .then(() => mutate());\n    };\n\n    return (\n        <>\n            <List sx={{ padding: 0 }}>\n                {sourcePreferences.map((it, index) => {\n                    const props = cloneObject(it.props);\n                    props.updateValue = updateValue(index);\n                    props.key = index;\n\n                    // TypeScript is dumb in detecting extra props\n                    // @ts-ignore\n                    return React.createElement(getPrefComponent(it.type), props);\n                })}\n            </List>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React from 'react';\nimport MangaGrid, { IMangaGridProps } from 'components/MangaGrid';\n\nconst FILTERED_OUT_MESSAGE = 'There are no Manga matching this filter';\n\nfunction filterManga(mangas: IMangaCard[]): IMangaCard[] {\n    return mangas;\n}\n\nexport default function SourceMangaGrid(props: IMangaGridProps) {\n    const { mangas, isLoading, hasNextPage, lastPageNum, setLastPageNum, message, messageExtra, gridLayout } = props;\n\n    const filteredManga = filterManga(mangas);\n    const showFilteredOutMessage = filteredManga.length === 0 && mangas.length > 0;\n\n    return (\n        <MangaGrid\n            mangas={filteredManga}\n            isLoading={isLoading}\n            hasNextPage={hasNextPage}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n            message={showFilteredOutMessage ? FILTERED_OUT_MESSAGE : message}\n            messageExtra={messageExtra}\n            gridLayout={gridLayout}\n            inLibraryIndicator\n        />\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport CheckboxInput from 'components/atoms/CheckboxInput';\nimport React from 'react';\n\ninterface Props {\n    state: boolean;\n    name: string;\n    position: number;\n    group: number | undefined;\n    updateFilterValue: Function;\n    update: any;\n}\n\nconst CheckBoxFilter: React.FC<Props> = (props: Props) => {\n    const { state, name, position, group, updateFilterValue, update } = props;\n    const [val, setval] = React.useState(state);\n\n    const handleChange = (event: { target: { name: any; checked: any } }) => {\n        setval(event.target.checked);\n        const upd = update.filter(\n            (e: { position: number; group: number | undefined }) => !(position === e.position && group === e.group),\n        );\n        updateFilterValue([...upd, { position, state: event.target.checked.toString(), group }]);\n    };\n\n    if (state !== undefined) {\n        return <CheckboxInput label={name} checked={val} onChange={handleChange} />;\n    }\n    return null;\n};\n\nexport default CheckBoxFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport { Typography } from '@mui/material';\nimport React from 'react';\n\ninterface Props {\n    name: string;\n}\n\nconst HeaderFilter: React.FC<Props> = ({ name }) => (\n    <Typography key={name} sx={{ mt: 2 }} variant=\"subtitle2\">\n        {name}\n    </Typography>\n);\n\nexport default HeaderFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport React from 'react';\nimport InputLabel from '@mui/material/InputLabel';\nimport FormControl from '@mui/material/FormControl';\nimport MenuItem from '@mui/material/MenuItem';\nimport Select from '@mui/material/Select';\n\ninterface Props {\n    values: any;\n    name: string;\n    state: number;\n    selected: Selected | undefined;\n    position: number;\n    updateFilterValue: Function;\n    group: number | undefined;\n    update: any;\n}\n\ninterface Selected {\n    displayname: string;\n    value: string;\n    _value: string;\n}\n\nfunction hasSelect(\n    values: Selected[],\n    name: string,\n    state: number,\n    position: number,\n    updateFilterValue: Function,\n    update: any,\n    group?: number,\n) {\n    const [val, setval] = React.useState(state);\n    if (values) {\n        const handleChange = (event: { target: { name: any; value: any } }) => {\n            const vall = values.map((e) => e.displayname).indexOf(`${event.target.value}`);\n            setval(vall);\n            const upd = update.filter(\n                (e: { position: number; group: number | undefined }) => !(position === e.position && group === e.group),\n            );\n            updateFilterValue([...upd, { position, state: vall.toString(), group }]);\n        };\n\n        const rett = values.map((e: Selected) => (\n            <MenuItem key={`${name} ${e.displayname}`} value={e.displayname}>\n                {e.displayname}\n            </MenuItem>\n        ));\n        return (\n            <FormControl sx={{ my: 1 }} variant=\"standard\">\n                <InputLabel>{name}</InputLabel>\n                <Select name={name} value={values[val].displayname} label={name} onChange={handleChange}>\n                    {rett}\n                </Select>\n            </FormControl>\n        );\n    }\n    return null;\n}\n\nfunction noSelect(\n    values: string[],\n    name: string,\n    state: number,\n    position: number,\n    updateFilterValue: Function,\n    update: any,\n    group?: number,\n) {\n    const [val, setval] = React.useState(state);\n\n    if (values) {\n        const handleChange = (event: { target: { name: any; value: any } }) => {\n            const vall = values.indexOf(`${event.target.value}`);\n            setval(vall);\n            const upd = update.filter(\n                (e: { position: number; group: number | undefined }) => !(position === e.position && group === e.group),\n            );\n            updateFilterValue([...upd, { position, state: vall.toString(), group }]);\n        };\n\n        const rett = values.map((value: string) => (\n            <MenuItem key={`${name} ${value}`} value={value}>\n                {value}\n            </MenuItem>\n        ));\n        return (\n            <FormControl sx={{ my: 1 }} variant=\"standard\">\n                <InputLabel>{name}</InputLabel>\n                <Select name={name} value={values[val]} label={name} onChange={handleChange}>\n                    {rett}\n                </Select>\n            </FormControl>\n        );\n    }\n    return null;\n}\n\nconst SelectFilter: React.FC<Props> = ({\n    values,\n    name,\n    state,\n    selected,\n    position,\n    updateFilterValue,\n    update,\n    group,\n}) => {\n    if (selected === undefined) {\n        return noSelect(values, name, state, position, updateFilterValue, update, group);\n    }\n\n    return hasSelect(values, name, state, position, updateFilterValue, update, group);\n};\n\nexport default SelectFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { ExpandLess, ExpandMore } from '@mui/icons-material';\nimport { Collapse, ListItemButton, ListItemText, Stack } from '@mui/material';\nimport { Box } from '@mui/system';\nimport SortRadioInput from 'components/atoms/SortRadioInput';\nimport React from 'react';\n\ninterface Props {\n    values: any;\n    name: string;\n    state: IState;\n    position: number;\n    group: number | undefined;\n    updateFilterValue: Function;\n    update: any;\n}\n\nconst SortFilter: React.FC<Props> = (props: Props) => {\n    const { values, name, state, position, group, updateFilterValue, update } = props;\n    const [val, setval] = React.useState(state);\n\n    const [open, setOpen] = React.useState(false);\n\n    const handleClick = () => {\n        setOpen(!open);\n    };\n\n    if (values) {\n        const handleChange = (index: number) => {\n            const tmp = val;\n            if (tmp.index === index) {\n                tmp.ascending = !tmp.ascending;\n            } else {\n                tmp.ascending = true;\n            }\n            tmp.index = index;\n            setval(tmp);\n            const upd = update.filter(\n                (e: { position: number; group: number | undefined }) => !(position === e.position && group === e.group),\n            );\n            updateFilterValue([...upd, { position, state: JSON.stringify(tmp), group }]);\n        };\n\n        return (\n            <Box sx={{ mx: -2 }}>\n                <ListItemButton onClick={handleClick}>\n                    <ListItemText primary={name} />\n                    {open ? <ExpandLess /> : <ExpandMore />}\n                </ListItemButton>\n                <Collapse in={open}>\n                    <Stack sx={{ mx: 4 }}>\n                        {values.map((value: string, index: number) => (\n                            <SortRadioInput\n                                key={`${name} ${value}`}\n                                label={value}\n                                checked={val.index === index}\n                                sortDescending={!val.ascending}\n                                onClick={() => handleChange(index)}\n                            />\n                        ))}\n                    </Stack>\n                </Collapse>\n            </Box>\n        );\n    }\n    return null;\n};\n\nexport default SortFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport SearchIcon from '@mui/icons-material/Search';\nimport { FormControl, Input, InputAdornment, InputLabel } from '@mui/material';\nimport React from 'react';\n\ninterface Props {\n    state: string;\n    name: string;\n    position: number;\n    group: number | undefined;\n    updateFilterValue: Function;\n    update: any;\n}\n\nconst TextFilter: React.FC<Props> = (props) => {\n    const { state, name, position, group, updateFilterValue, update } = props;\n    const [Search, setsearch] = React.useState(state || '');\n    let typingTimer: NodeJS.Timeout;\n\n    function doneTyping(e: React.ChangeEvent<HTMLInputElement>) {\n        const upd = update.filter(\n            (el: { position: number; group: number | undefined }) => !(position === el.position && group === el.group),\n        );\n        updateFilterValue([...upd, { position, state: e.target.value, group }]);\n    }\n\n    function handleChange(e: React.ChangeEvent<HTMLInputElement>) {\n        setsearch(e.target.value);\n\n        clearTimeout(typingTimer);\n        typingTimer = setTimeout(() => {\n            doneTyping(e);\n        }, 2500);\n    }\n\n    if (state !== undefined) {\n        return (\n            <FormControl sx={{ my: 1 }} variant=\"standard\">\n                <InputLabel>{name}</InputLabel>\n                <Input\n                    name={name}\n                    value={Search || ''}\n                    onChange={handleChange}\n                    endAdornment={\n                        <InputAdornment position=\"end\">\n                            <SearchIcon />\n                        </InputAdornment>\n                    }\n                />\n            </FormControl>\n        );\n    }\n    return <></>;\n};\n\nexport default TextFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport ThreeStateCheckboxInput from 'components/atoms/ThreeStateCheckboxInput';\nimport React from 'react';\n\ninterface Props {\n    state: number;\n    name: string;\n    position: number;\n    group: number | undefined;\n    updateFilterValue: Function;\n    update: any;\n}\n\nconst TriStateFilter: React.FC<Props> = (props) => {\n    const { state, name, position, group, updateFilterValue, update } = props;\n    const [val, setval] = React.useState<number>(Number(state));\n\n    const handleChange = (checked: boolean | null | undefined) => {\n        // eslint-disable-next-line no-nested-ternary\n        const newState = checked === undefined ? 0 : checked ? 1 : 2;\n        setval(newState);\n        const upd = update.filter(\n            (e: { position: number; group: number | undefined }) => !(position === e.position && group === e.group),\n        );\n        updateFilterValue([\n            ...upd,\n            {\n                position,\n                state: newState.toString(),\n                group,\n            },\n        ]);\n    };\n\n    if (state !== undefined) {\n        return (\n            <ThreeStateCheckboxInput\n                label={name}\n                checked={[undefined, true, false][val]}\n                onChange={(checked) => handleChange(checked)}\n            />\n        );\n    }\n    return <></>;\n};\n\nexport default TriStateFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { ExpandLess, ExpandMore } from '@mui/icons-material';\nimport { Collapse, ListItemButton, ListItemText, Stack } from '@mui/material';\nimport { Box } from '@mui/system';\nimport React from 'react';\n// eslint-disable-next-line import/no-cycle\nimport { Options } from 'components/source/SourceOptions';\n\ninterface Props {\n    state: ISourceFilters[];\n    name: string;\n    position: number;\n    updateFilterValue: Function;\n    update: any;\n}\n\nconst GroupFilter: React.FC<Props> = (props: Props) => {\n    const { state, name, position, updateFilterValue, update } = props;\n\n    const [open, setOpen] = React.useState(false);\n\n    return (\n        <Box sx={{ mx: -2 }}>\n            <ListItemButton onClick={() => setOpen(!open)}>\n                <ListItemText primary={name} />\n                {open ? <ExpandLess /> : <ExpandMore />}\n            </ListItemButton>\n            <Collapse in={open}>\n                {/* Container is moved outside 2, so content has to go inside 4 */}\n                <Stack sx={{ mx: 4 }}>\n                    <Options\n                        sourceFilter={state}\n                        group={position}\n                        updateFilterValue={updateFilterValue}\n                        update={update}\n                    />\n                </Stack>\n            </Collapse>\n        </Box>\n    );\n};\n\nexport default GroupFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { Divider } from '@mui/material';\nimport React from 'react';\n\ninterface Props {\n    name: string;\n}\n\nconst SeparatorFilter: React.FC<Props> = ({ name }) => (\n    <Divider key={name} sx={{ my: 1 }} textAlign=\"center\">\n        {name}\n    </Divider>\n);\n\nexport default SeparatorFilter;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\n\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport { Button, Fab, Stack } from '@mui/material';\nimport { Box } from '@mui/system';\nimport OptionsPanel from 'components/molecules/OptionsPanel';\nimport React from 'react';\nimport CheckBoxFilter from 'components/source/filters/CheckBoxFilter';\nimport HeaderFilter from 'components/source/filters/HeaderFilter';\nimport SelectFilter from 'components/source/filters/SelectFilter';\nimport SortFilter from 'components/source/filters/SortFilter';\nimport TextFilter from 'components/source/filters/TextFilter';\nimport TriStateFilter from 'components/source/filters/TriStateFilter';\n// this can only cycle once, so should be fine\n// eslint-disable-next-line import/no-cycle\nimport GroupFilter from 'components/source/filters/GroupFilter';\nimport SeperatorFilter from 'components/source/filters/SeparatorFilter';\n\ninterface IFilters {\n    sourceFilter: ISourceFilters[];\n    updateFilterValue: Function;\n    group: number | undefined;\n    update: any;\n}\n\ninterface IFilters1 {\n    sourceFilter: ISourceFilters[];\n    updateFilterValue: Function;\n    resetFilterValue: Function;\n    setTriggerUpdate: Function;\n    setSearch: Function;\n    update: any;\n}\n\nexport function Options({ sourceFilter, group, updateFilterValue, update }: IFilters) {\n    return (\n        <Stack key={`filters ${group}`}>\n            {sourceFilter.map((e: ISourceFilters, index) => {\n                let checkif = update.find(\n                    (el: { group: number | undefined; position: number }) =>\n                        el.group === group && el.position === index,\n                );\n                checkif = checkif ? checkif.state : checkif;\n                switch (e.type) {\n                    case 'CheckBox':\n                        return (\n                            <CheckBoxFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                state={checkif === 'false' || (e.filter.state as boolean)}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'Group':\n                        return (\n                            <GroupFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                state={e.filter.state as ISourceFilters[]}\n                                position={index}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'Header':\n                        return <HeaderFilter key={`filters ${e.filter.name}`} name={e.filter.name} />;\n                    case 'Select':\n                        return (\n                            <SelectFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                values={e.filter.displayValues}\n                                state={parseInt(checkif, 10) || (e.filter.state as number)}\n                                selected={e.filter.selected}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'Separator':\n                        return <SeperatorFilter key={`filters ${e.filter.name}`} name={e.filter.name} />;\n                    case 'Sort':\n                        return (\n                            <SortFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                values={e.filter.values}\n                                state={checkif ? JSON.parse(checkif) : (e.filter.state as IState)}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'Text':\n                        return (\n                            <TextFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                state={checkif || (e.filter.state as string)}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    case 'TriState':\n                        return (\n                            <TriStateFilter\n                                key={`filters ${e.filter.name}`}\n                                name={e.filter.name}\n                                state={parseInt(checkif, 10) || (e.filter.state as number)}\n                                position={index}\n                                group={group}\n                                updateFilterValue={updateFilterValue}\n                                update={update}\n                            />\n                        );\n                    default:\n                        return <Box key={`${e.filter.name}null`} />;\n                }\n            })}\n        </Stack>\n    );\n}\n\nexport default function SourceOptions({\n    sourceFilter,\n    updateFilterValue,\n    resetFilterValue,\n    setTriggerUpdate,\n    setSearch,\n    update,\n}: IFilters1) {\n    const [FilterOptions, setFilterOptions] = React.useState(false);\n\n    function handleReset() {\n        resetFilterValue(0);\n        setFilterOptions(false);\n    }\n\n    function handleSubmit() {\n        setTriggerUpdate(0);\n        setSearch(true);\n        setFilterOptions(false);\n    }\n\n    return (\n        <>\n            <Fab\n                sx={{ position: 'fixed', bottom: '2em', right: '3em' }}\n                onClick={() => setFilterOptions(!FilterOptions)}\n                variant=\"extended\"\n                color=\"primary\"\n            >\n                <FilterListIcon />\n                Filter\n            </Fab>\n\n            <OptionsPanel open={FilterOptions} onClose={() => setFilterOptions(false)}>\n                <Box sx={{ display: 'flex', p: 2, pb: 0 }}>\n                    <Button onClick={handleReset}>Reset</Button>\n                    <Button sx={{ marginLeft: 'auto' }} variant=\"contained\" onClick={handleSubmit}>\n                        Submit\n                    </Button>\n                </Box>\n                <Box\n                    sx={{\n                        pb: 2,\n                        mx: 2,\n                    }}\n                >\n                    <Options\n                        sourceFilter={sourceFilter}\n                        updateFilterValue={updateFilterValue}\n                        group={undefined}\n                        update={update}\n                    />\n                </Box>\n            </OptionsPanel>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { IconButton, Menu, MenuItem, FormControlLabel, Radio } from '@mui/material';\nimport React from 'react';\nimport ViewModuleIcon from '@mui/icons-material/ViewModule';\nimport { GridLayout, useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\n\n// TODO: clean up this to use a FormControl, and remove dependency on name o radio button\nexport default function SourceGridLayout() {\n    const {\n        options: { SourcegridLayout },\n        setOptions,\n    } = useLibraryOptionsContext();\n\n    const [anchorEl, setAnchorEl] = React.useState(null);\n    const open = Boolean(anchorEl);\n    const handleClick = (event: any) => {\n        setAnchorEl(event.currentTarget);\n    };\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    function setGridContextOptions(e: React.ChangeEvent<HTMLInputElement>, checked: boolean) {\n        if (checked) {\n            setOptions((prev: any) => ({ ...prev, SourcegridLayout: parseInt(e.target.name, 10) }));\n        }\n    }\n\n    return (\n        <>\n            <IconButton\n                onClick={handleClick}\n                size=\"small\"\n                sx={{ ml: 2 }}\n                aria-controls={open ? 'account-menu' : undefined}\n                aria-haspopup=\"true\"\n                aria-expanded={open ? 'true' : undefined}\n            >\n                <ViewModuleIcon />\n            </IconButton>\n            <Menu\n                id=\"basic-menu\"\n                anchorEl={anchorEl}\n                open={open}\n                onClose={handleClose}\n                MenuListProps={{ 'aria-labelledby': 'basic-button' }}\n            >\n                <MenuItem onClick={handleClose}>\n                    <FormControlLabel\n                        label=\"Compact grid\"\n                        value={GridLayout.Compact}\n                        control={\n                            <Radio\n                                name={GridLayout.Compact.toString()}\n                                checked={SourcegridLayout === GridLayout.Compact || SourcegridLayout === undefined}\n                                onChange={setGridContextOptions}\n                            />\n                        }\n                    />\n                </MenuItem>\n                <MenuItem onClick={handleClose}>\n                    <FormControlLabel\n                        label=\"Comfortable grid\"\n                        control={\n                            <Radio\n                                name={GridLayout.Comfortable.toString()}\n                                checked={SourcegridLayout === GridLayout.Comfortable}\n                                onChange={setGridContextOptions}\n                            />\n                        }\n                    />\n                </MenuItem>\n                <MenuItem onClick={handleClose}>\n                    <FormControlLabel\n                        label=\"List\"\n                        control={\n                            <Radio\n                                name={GridLayout.List.toString()}\n                                checked={SourcegridLayout === GridLayout.List}\n                                onChange={setGridContextOptions}\n                            />\n                        }\n                    />\n                </MenuItem>\n            </Menu>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport IconButton from '@mui/material/IconButton';\nimport SourceMangaGrid from 'components/source/SourceMangaGrid';\nimport NavbarContext from 'components/context/NavbarContext';\nimport client from 'util/client';\nimport SettingsIcon from '@mui/icons-material/Settings';\nimport SourceOptions from 'components/source/SourceOptions';\nimport AppbarSearch from 'components/util/AppbarSearch';\nimport { useQueryParam, StringParam } from 'use-query-params';\nimport SourceGridLayout from 'components/source/GridLayouts';\nimport { useLibraryOptionsContext } from 'components/context/LibraryOptionsContext';\n\ninterface IPos {\n    position: number;\n    state: any;\n    group?: number;\n}\n\nexport default function SourceMangas(props: { popular: boolean }) {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const history = useHistory();\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const [isConfigurable, setIsConfigurable] = useState<boolean>(false);\n    const [mangas, setMangas] = useState<IMangaCard[]>([]);\n    const [hasNextPage, setHasNextPage] = useState<boolean>(false);\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n    const [fetched, setFetched] = useState<boolean>(false);\n\n    const [Search, setSearch] = useState<boolean>();\n    const [query, setquery] = useQueryParam('query', StringParam);\n    const [reset, setReset] = React.useState(2);\n    const [update, setUpdate] = useState<IPos[]>([]);\n    const [triggerUpdate, setTriggerUpdate] = useState<number>(2);\n    const [Data, SetData] = useState<ISourceFilters[]>();\n\n    const [Init, setInit] = useState<undefined | null>();\n    const [Noreset, setNoreset] = useQueryParam('R');\n\n    const { options } = useLibraryOptionsContext();\n\n    function makeFilters() {\n        client\n            .get(`/api/v1/source/${sourceId}/filters`)\n            .then((response) => response.data)\n            .then((data: ISourceFilters[]) => {\n                SetData(data);\n            });\n    }\n\n    useEffect(() => {\n        setTitle('Source'); // title is later set after a fetch but we set it here once\n    }, []);\n\n    useEffect(() => {\n        client\n            .get(`/api/v1/source/${sourceId}`)\n            .then((response) => response.data)\n            .then((data: ISource) => {\n                setTitle(data.displayName);\n                setIsConfigurable(data.isConfigurable);\n            });\n    }, []);\n\n    useEffect(() => {\n        if (triggerUpdate === 2) {\n            return;\n        }\n        if (triggerUpdate === 0) {\n            setTriggerUpdate(1);\n            return;\n        }\n        if (update.length > 0) {\n            const rep = update;\n            setUpdate([]);\n            client\n                .post(\n                    `/api/v1/source/${sourceId}/filters`,\n                    rep.map((e: IPos) => {\n                        const { position, state, group }: IPos = e;\n                        return group === undefined\n                            ? {\n                                  position,\n                                  state,\n                              }\n                            : {\n                                  position: group,\n                                  state: JSON.stringify({\n                                      position,\n                                      state,\n                                  }),\n                              };\n                    }),\n                )\n                .then(() => {\n                    setTriggerUpdate(0);\n                    makeFilters();\n                });\n        } else {\n            setFetched(false);\n            setMangas([]);\n            setLastPageNum(0);\n            if (Noreset === undefined && Search) {\n                setNoreset(null);\n            }\n        }\n    }, [triggerUpdate]);\n\n    useEffect(() => {\n        if (reset === 0) {\n            setquery(undefined);\n            setNoreset(undefined);\n            setReset(1);\n        } else if (Noreset === undefined) {\n            client.get(`/api/v1/source/${sourceId}/filters?reset=true`).then(() => {\n                makeFilters();\n                setSearch(false);\n                if (reset === 1) {\n                    setTriggerUpdate(0);\n                }\n            });\n            return;\n        }\n        makeFilters();\n    }, [reset]);\n\n    useEffect(() => {\n        setAction(\n            <>\n                <SourceGridLayout />\n                <AppbarSearch />\n                {isConfigurable && (\n                    <IconButton\n                        onClick={() => history.push(`/sources/${sourceId}/configure/`)}\n                        aria-label=\"display more actions\"\n                        edge=\"end\"\n                        color=\"inherit\"\n                        size=\"large\"\n                    >\n                        <SettingsIcon />\n                    </IconButton>\n                )}\n            </>,\n        );\n\n        return () => {\n            setAction(<></>);\n        };\n    }, [isConfigurable]);\n\n    useEffect(() => {\n        if (query) {\n            setSearch(true);\n        } else {\n            setSearch(false);\n        }\n        if (Noreset === undefined) {\n            setInit(null);\n        }\n    }, [query]);\n\n    useEffect(() => {\n        if (Search !== undefined && query !== undefined && Init === null) {\n            const delayDebounceFn = setTimeout(() => {\n                setTriggerUpdate(0);\n            }, 1000);\n            return () => clearTimeout(delayDebounceFn);\n        }\n        if (Search !== undefined) {\n            setInit(null);\n        }\n        return () => {};\n    }, [Search, query]);\n\n    useEffect(() => {\n        if (lastPageNum !== 0) {\n            const sourceType = props.popular ? 'popular' : 'latest';\n            client\n                .get(\n                    `/api/v1/source/${sourceId}/${\n                        query !== undefined || Search || Noreset === null ? 'search' : sourceType\n                    }${\n                        query !== undefined || Search || Noreset === null\n                            ? `?searchTerm=${query || ''}&pageNum=${lastPageNum}`\n                            : `/${lastPageNum}`\n                    }`,\n                )\n                .then((response) => response.data)\n                .then((data: { mangaList: IManga[]; hasNextPage: boolean }) => {\n                    setMangas([\n                        ...mangas,\n                        ...data.mangaList.map((it) => ({\n                            title: it.title,\n                            thumbnailUrl: it.thumbnailUrl,\n                            id: it.id,\n                            inLibrary: it.inLibrary,\n                            genre: it.genre,\n                        })),\n                    ]);\n                    setHasNextPage(data.hasNextPage);\n                    setFetched(true);\n                });\n        } else {\n            setLastPageNum(1);\n        }\n    }, [lastPageNum]);\n\n    let message;\n    let messageExtra;\n\n    if (fetched) {\n        message = 'No manga was found!';\n        if (sourceId === '0') {\n            messageExtra = (\n                <>\n                    <span>Check out </span>\n                    <a href=\"https://github.com/Suwayomi/Tachidesk-Server/wiki/Local-Source\">Local source guide</a>\n                </>\n            );\n        }\n    }\n\n    return (\n        <>\n            <SourceMangaGrid\n                mangas={mangas}\n                hasNextPage={hasNextPage}\n                lastPageNum={lastPageNum}\n                setLastPageNum={setLastPageNum}\n                message={message}\n                messageExtra={messageExtra}\n                isLoading={!fetched}\n                gridLayout={options.SourcegridLayout}\n            />\n            {Data !== undefined && (\n                <SourceOptions\n                    sourceFilter={Data}\n                    updateFilterValue={setUpdate}\n                    resetFilterValue={setReset}\n                    setTriggerUpdate={setTriggerUpdate}\n                    setSearch={setSearch}\n                    update={update}\n                />\n            )}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport DownloadIcon from '@mui/icons-material/Download';\nimport { CardActionArea } from '@mui/material';\nimport Avatar from '@mui/material/Avatar';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport IconButton from '@mui/material/IconButton';\nimport Typography from '@mui/material/Typography';\nimport { Box } from '@mui/system';\nimport NavbarContext from 'components/context/NavbarContext';\nimport DownloadStateIndicator from 'components/molecules/DownloadStateIndicator';\nimport EmptyView from 'components/util/EmptyView';\nimport LoadingPlaceholder from 'components/util/LoadingPlaceholder';\nimport React, { useContext, useEffect, useRef, useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\n\nfunction epochToDate(epoch: number) {\n    const date = new Date(0); // The 0 there is the key, which sets the date to the epoch\n    date.setUTCSeconds(epoch);\n    return date;\n}\n\nfunction isTheSameDay(first: Date, second: Date) {\n    return (\n        first.getDate() === second.getDate() &&\n        first.getMonth() === second.getMonth() &&\n        first.getFullYear() === second.getFullYear()\n    );\n}\n\nfunction getDateString(date: Date) {\n    const today = new Date();\n    if (isTheSameDay(today, date)) return 'TODAY';\n    // calculate yesterday\n    const yesterday = new Date();\n    yesterday.setDate(today.getDate() - 1);\n    if (isTheSameDay(yesterday, date)) return 'YESTERDAY';\n    return date.toLocaleDateString();\n}\n\nfunction groupByDate(updates: IMangaChapter[]): [string, { item: IMangaChapter; globalIdx: number }[]][] {\n    if (updates.length === 0) return [];\n\n    const groups = {};\n    updates.forEach((item, globalIdx) => {\n        const key = getDateString(epochToDate(item.chapter.fetchedAt));\n        // @ts-ignore\n        if (groups[key] === undefined) groups[key] = [];\n        // @ts-ignore\n        groups[key].push({ item, globalIdx });\n    });\n\n    // @ts-ignore\n    return Object.keys(groups).map((key) => [key, groups[key]]);\n}\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\nconst Updates: React.FC = () => {\n    const history = useHistory();\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [updateEntries, setUpdateEntries] = useState<IMangaChapter[]>([]);\n    const [hasNextPage, setHasNextPage] = useState(true);\n    const [fetched, setFetched] = useState(false);\n    const [lastPageNum, setLastPageNum] = useState(0);\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [useCache] = useLocalStorage<boolean>('useCache', true);\n\n    const [, setWsClient] = useState<WebSocket>();\n    const [{ queue }, setQueueState] = useState<IQueue>(initialQueue);\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/downloads`);\n        wsc.onmessage = (e) => {\n            const data = JSON.parse(e.data) as IQueue;\n            setQueueState(data);\n        };\n\n        setWsClient(wsc);\n\n        return () => wsc.close();\n    }, []);\n\n    useEffect(() => {\n        setTitle('Updates');\n\n        setAction(<></>);\n    }, []);\n\n    useEffect(() => {\n        if (hasNextPage) {\n            client\n                .get(`/api/v1/update/recentChapters/${lastPageNum}`)\n                .then((response) => response.data)\n                .then(({ hasNextPage: fetchedHasNextPage, page }: PaginatedList<IMangaChapter>) => {\n                    setUpdateEntries([...updateEntries, ...page]);\n                    setHasNextPage(fetchedHasNextPage);\n                    setFetched(true);\n                });\n        }\n    }, [lastPageNum]);\n\n    const lastEntry = useRef<HTMLDivElement>(null);\n\n    const scrollHandler = () => {\n        if (lastEntry.current) {\n            const rect = lastEntry.current.getBoundingClientRect();\n            if ((rect.y + rect.height) / window.innerHeight < 2 && hasNextPage) {\n                setLastPageNum(lastPageNum + 1);\n            }\n        }\n    };\n    useEffect(() => {\n        window.addEventListener('scroll', scrollHandler, true);\n        return () => {\n            window.removeEventListener('scroll', scrollHandler, true);\n        };\n    }, [hasNextPage, updateEntries]);\n\n    if (!fetched) {\n        return <LoadingPlaceholder />;\n    }\n    if (fetched && updateEntries.length === 0) {\n        return <EmptyView message=\"You don't have any updates yet.\" />;\n    }\n\n    const downloadForChapter = (chapter: IChapter) => {\n        const { index, mangaId } = chapter;\n        return queue.find((q) => index === q.chapterIndex && mangaId === q.mangaId);\n    };\n\n    const downloadChapter = (chapter: IChapter) => {\n        client.get(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`);\n    };\n\n    return (\n        <>\n            {groupByDate(updateEntries).map((dateGroup) => (\n                <div key={dateGroup[0]}>\n                    <Typography\n                        variant=\"h5\"\n                        sx={{\n                            ml: 3,\n                            my: 2,\n                            fontWeight: 700,\n                        }}\n                    >\n                        {dateGroup[0]}\n                    </Typography>\n                    {dateGroup[1].map(({ item: { chapter, manga }, globalIdx }) => {\n                        const download = downloadForChapter(chapter);\n                        return (\n                            <Card\n                                ref={globalIdx === updateEntries.length - 1 ? lastEntry : undefined}\n                                key={globalIdx}\n                                sx={{ margin: '10px' }}\n                            >\n                                <CardActionArea\n                                    component={Link}\n                                    to={{\n                                        pathname: `/manga/${chapter.mangaId}/chapter/${chapter.index}`,\n                                        state: history.location.state,\n                                    }}\n                                >\n                                    <CardContent\n                                        sx={{\n                                            display: 'flex',\n                                            justifyContent: 'space-between',\n                                            alignItems: 'center',\n                                            padding: 2,\n                                        }}\n                                    >\n                                        <Box sx={{ display: 'flex' }}>\n                                            <Avatar\n                                                variant=\"rounded\"\n                                                sx={{\n                                                    width: 56,\n                                                    height: 56,\n                                                    flex: '0 0 auto',\n                                                    marginRight: 2,\n                                                    imageRendering: 'pixelated',\n                                                }}\n                                                src={`${serverAddress}${manga.thumbnailUrl}?useCache=${useCache}`}\n                                            />\n                                            <Box sx={{ display: 'flex', flexDirection: 'column' }}>\n                                                <Typography variant=\"h5\" component=\"h2\">\n                                                    {manga.title}\n                                                </Typography>\n                                                <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                                    {chapter.name}\n                                                </Typography>\n                                            </Box>\n                                        </Box>\n                                        {download && <DownloadStateIndicator download={download} />}\n                                        {download == null && !chapter.downloaded && (\n                                            <IconButton\n                                                onClick={(e) => {\n                                                    e.stopPropagation();\n                                                    e.preventDefault();\n                                                    downloadChapter(chapter);\n                                                }}\n                                                size=\"large\"\n                                            >\n                                                <DownloadIcon />\n                                            </IconButton>\n                                        )}\n                                    </CardContent>\n                                </CardActionArea>\n                            </Card>\n                        );\n                    })}\n                </div>\n            ))}\n        </>\n    );\n};\n\nexport default Updates;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport en from 'i18n/locale/en.json';\n\nconst translationHelper = (lng: any) => ({\n    translation: lng,\n});\n\nconst resources = {\n    en: translationHelper(en),\n};\n\nexport default resources;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Container } from '@mui/material';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport AppContext from 'components/context/AppContext';\nimport DefaultNavBar from 'components/navbar/DefaultNavBar';\nimport React from 'react';\nimport { Redirect, Route, Switch } from 'react-router-dom';\nimport Browse from 'screens/Browse';\nimport DownloadQueue from 'screens/DownloadQueue';\nimport Extensions from 'screens/Extensions';\nimport Library from 'screens/Library';\nimport Manga from 'screens/Manga';\nimport Reader from 'screens/Reader';\nimport SearchAll from 'screens/SearchAll';\nimport Settings from 'screens/Settings';\nimport About from 'screens/settings/About';\nimport Backup from 'screens/settings/Backup';\nimport Categories from 'screens/settings/Categories';\nimport DefaultReaderSettings from 'screens/settings/DefaultReaderSettings';\nimport SourceConfigure from 'screens/SourceConfigure';\nimport SourceMangas from 'screens/SourceMangas';\nimport Sources from 'screens/Sources';\nimport Updates from 'screens/Updates';\nimport 'i18n';\n\nconst App: React.FC = () => (\n    <AppContext>\n        <CssBaseline />\n        <DefaultNavBar />\n        <Container\n            id=\"appMainContainer\"\n            maxWidth={false}\n            disableGutters\n            sx={{\n                mt: 8,\n                ml: { sm: 8 },\n                mb: { xs: 8, sm: 0 },\n                width: 'auto',\n                overflow: 'auto',\n            }}\n        >\n            <Switch>\n                {/* General Routes */}\n                <Route exact path=\"/\" render={() => <Redirect to=\"/library\" />} />\n                <Route path=\"/settings/about\">\n                    <About />\n                </Route>\n                <Route path=\"/settings/categories\">\n                    <Categories />\n                </Route>\n                <Route path=\"/settings/defaultReaderSettings\">\n                    <DefaultReaderSettings />\n                </Route>\n                <Route path=\"/settings/backup\">\n                    <Backup />\n                </Route>\n                <Route path=\"/settings\">\n                    <Settings />\n                </Route>\n\n                {/* Manga Routes */}\n\n                <Route path=\"/sources/:sourceId/popular/\">\n                    <SourceMangas popular />\n                </Route>\n                <Route path=\"/sources/:sourceId/latest/\">\n                    <SourceMangas popular={false} />\n                </Route>\n                <Route path=\"/sources/:sourceId/configure/\">\n                    <SourceConfigure />\n                </Route>\n                <Route path=\"/sources/all/search/\">\n                    <SearchAll />\n                </Route>\n                <Route path=\"/downloads\">\n                    <DownloadQueue />\n                </Route>\n                <Route path=\"/manga/:mangaId/chapter/:chapterNum\">\n                    <></>\n                </Route>\n                <Route path=\"/manga/:id\">\n                    <Manga />\n                </Route>\n                <Route path=\"/library\">\n                    <Library />\n                </Route>\n                <Route path=\"/updates\">\n                    <Updates />\n                </Route>\n                <Route path=\"/sources\">\n                    <Sources />\n                </Route>\n                <Route path=\"/extensions\">\n                    <Extensions />\n                </Route>\n                <Route path=\"/browse\">\n                    <Browse />\n                </Route>\n            </Switch>\n        </Container>\n        <Switch>\n            <Route\n                path=\"/manga/:mangaId/chapter/:chapterIndex\"\n                // passing a key re-mounts the reader\n                // when changing chapters\n                render={(props: any) => <Reader key={props.match.params.chapterIndex} />}\n            />\n        </Switch>\n    </AppContext>\n);\n\nexport default App;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { use } from 'i18next';\nimport { initReactI18next } from 'react-i18next';\nimport resources from 'i18n/translations';\nimport LanguageDetector from 'i18next-browser-languagedetector';\n\nconst i18n = use(initReactI18next)\n    .use(LanguageDetector)\n    .init({\n        resources,\n\n        fallbackLng: 'en',\n        interpolation: {\n            escapeValue: false,\n        },\n        returnNull: false,\n        debug: process.env.NODE_ENV !== 'production',\n    });\n\nexport default i18n;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from 'App';\nimport 'index.css';\n// roboto font\nimport '@fontsource/roboto';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n"],"sourceRoot":""}